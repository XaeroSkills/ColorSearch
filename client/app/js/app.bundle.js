webpackJsonp([0],{177:function(e,t,o){"use strict";o(178);var i=o(180),r=function(e){return e&&e.__esModule?e:{default:e}}(i);angular.module("app",[r.default])},178:function(e,t){},180:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(181),n=i(r);o(183);var l=o(184),a=i(l),s=o(185),c=i(s),d=o(191),u=i(d),f=o(193),h=i(f),g=o(227),p=i(g),v=o(228),m=i(v),y=o(233),_=i(y),b=o(234),C=i(b),w=o(239),$=i(w),k=o(358),S=i(k),P=o(367),x=i(P);o(370);var M=o(371),I=i(M),j=o(372),z=i(j),T=o(376),A=i(T),D=o(381),L=i(D),N=o(384),O=i(N);angular.module("color-search",[n.default,C.default,$.default,S.default,x.default,A.default,L.default,O.default,"angularSpinner"]).config(a.default).config(["$JsonRpcProvider",function(e){e.set({url:"/"})}]).service("colorUtils",u.default).service("colorFactory",p.default).service("colorSetFactory",m.default).service("appSettings",["db",c.default]).service("textColors",h.default).service("login",["$q","jsonrpc",z.default]).controller("RoutingCtrl",_.default).component("colorSearch",{template:I.default,controller:["$scope","$window","login","popupDialog",function(e,t,o,i){function r(){i.loginDialog(function(){var e=this;this.model=o,this.login=function(){e.model.isSet()&&e.model.login().then(function(e){e&&i.close()})}})}o.isRequired().then(function(e){e&&r()}).catch(function(e){i.errorDialog(function(){this.title="Connection error",this.description="Try to reload the application.",this.buttonTitle="Reload",this.button=!0,this.icon="refresh",this.handle=function(){t.location.reload(!0)}})})}]}),t.default="color-search"},184:function(e,t,o){"use strict";function i(e,t){var o={name:"main",url:"/main",data:{page:"main"}},i={name:"main.settings",url:"^/settings",data:{page:"settings"}},r={name:"main.guide",url:"^/guide",data:{page:"guide"}};e.state(o),e.state(i),e.state(r),t.otherwise("/main")}Object.defineProperty(t,"__esModule",{value:!0}),i.$inject=["$stateProvider","$urlRouterProvider"],t.default=i},185:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(1),n=i(r),l=o(2),a=i(l),s=function(){function e(t){(0,n.default)(this,e),this.store="settings",this.db=t}return(0,a.default)(e,[{key:"loadSettings",value:function(e,t,o){this.db.getStore(this.store).getItem("settings").then(function(o){e.deserialize(o),t&&t()}).catch(function(e){console.warn(e),o&&o()})}},{key:"saveSettings",value:function(e,t,o){this.db.getStore(this.store).setItem("settings",e.serialize()).then(function(){t&&t()}).catch(function(e){console.warn(e),o&&o()})}}]),e}(),c=function(){function e(t){(0,n.default)(this,e),this.module="settings",this.dao=new s(t),this.checkSemanticSimilarity=!1,this.searchMode="regular",this.similarityLevel=85,this.distance="euclidean",this.distanceMode="strict",this.supportedDistances=[{id:"euclidean",name:"Euclidean"},{id:"chisquare",name:"Chi-Square"},{id:"s2jsd",name:"S2JSD"}]}return(0,a.default)(e,[{key:"load",value:function(e,t){this.dao.loadSettings(this,e,t)}},{key:"save",value:function(e,t){this.dao.saveSettings(this,e,t)}},{key:"serialize",value:function(){var e={};return e.module="settings",e.checkSemanticSimilarity=this.checkSemanticSimilarity,e.searchMode=this.searchMode,e.similarityLevel=this.similarityLevel,e.distance=this.distance,e.distanceMode=this.distanceMode,e}},{key:"deserialize",value:function(e){e?(this.editorFontSize=e.editorFontSize,this.checkSemanticSimilarity=e.checkSemanticSimilarity,this.searchMode=e.searchMode,this.similarityLevel=e.similarityLevel,this.distance=e.distance,this.distanceMode=e.distanceMode):console.warn("Settings not loaded")}},{key:"getSearchSettings",value:function(){var e={};return e.checkSemanticSimilarity=this.checkSemanticSimilarity,e.searchMode=this.searchMode,e.similarityLevel=this.similarityLevel,e.distance=this.distance,e.distanceMode=this.distanceMode,e}}]),e}();t.default=c},191:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(1),n=i(r),l=o(2),a=i(l),s=o(192),c=i(s),d=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,[{key:"hslToHexString",value:function(e,t){var o=t||1;return(0,c.default)({h:e.h,s:e.s/o,l:e.l/o}).toHexString()}},{key:"hexToHsl",value:function(e,t){var o=t||1,i=(0,c.default)(e).toHsl();return i.s=Math.round(i.s*o),i.l=Math.round(i.l*o),i}},{key:"toHexString",value:function(e){return(0,c.default)(e).toHexString()}},{key:"hslToHslString",value:function(e){return"hsl("+e.h+","+e.s+"%,"+e.l+"%)"}},{key:"hslStringToHsl",value:function(e,t){if(e){var o=t||1,i=(0,c.default)(e).toHsl();return i.s=Math.round(i.s*o),i.l=Math.round(i.l*o),i}return{h:0,s:0,l:0}}},{key:"getFittingColorWithGreaterCR",value:function(e){for(var t=e,o=arguments.length,i=Array(o>1?o-1:0),r=1;r<o;r++)i[r-1]=arguments[r];if(i&&i.length>0){t=i[0];for(var n=this.cr(e,i[0]),l=0;l<i.length;l++){var a=this.cr(e,i[l]);n<a&&(n=a,t=i[l])}}return t}},{key:"cr",value:function(e,t){var o=(0,c.default)(e).toRgb(),i=(0,c.default)(t).toRgb(),r=this._luminanceRGB(o.r,o.g,o.b),n=this._luminanceRGB(i.r,i.g,i.b);if(n>r){var l=[n,r];r=l[0],n=l[1]}return(r+.05)/(n+.05)}},{key:"_luminanceRGB",value:function(e,t,o){var i=e/255,r=t/255,n=o/255;return.2126*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))+.7152*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))}}]),e}();t.default=d},193:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(26),n=i(r),l=o(15),a=i(l),s=o(37),c=i(s),d=o(16),u=i(d),f=o(1),h=i(f),g=o(2),p=i(g),v=o(58),m=i(v),y=function(){function e(){(0,h.default)(this,e),this._words=[],this.colorOccurence=new u.default,this.adjustedColorOccurence=new u.default,this.sPercentage=100,this.lPercentage=100}return(0,p.default)(e,[{key:"clearWords",value:function(){this._words=[]}},{key:"addWord",value:function(e){this._words.push(e)}},{key:"getWords",value:function(){return this._words}},{key:"getColors",value:function(){return[].concat((0,c.default)(this.adjustedColorOccurence.values()))}},{key:"getColorsAndWords",value:function(){var e={};return e.colors=this.getColors(),e.words=this.getWords(),e}},{key:"clear",value:function(){this.clearWords(),this.colorOccurence.clear(),this.adjustedColorOccurence.clear()}},{key:"updateColors",value:function(e){if(this.colorOccurence.clear(),e&&e.size>0){var t=!0,o=!1,i=void 0;try{for(var r,l=(0,a.default)(e.entries());!(t=(r=l.next()).done);t=!0){var s=(0,n.default)(r.value,2),c=(s[0],s[1]);if(c.color&&c.color.isSet()){var d=this.colorOccurence.get(c.color.toString());d?d.setWeight(d.weight+c.color.weight):(d=new m.default(c.color),this.colorOccurence.set(d.toString(),d))}}}catch(e){o=!0,i=e}finally{try{!t&&l.return&&l.return()}finally{if(o)throw i}}}this.calculateAdjustedColors()}},{key:"calculateAdjustedColors",value:function(){this.adjustedColorOccurence.clear();var e=!0,t=!1,o=void 0;try{for(var i,r=(0,a.default)(this.colorOccurence.values());!(e=(i=r.next()).done);e=!0){var n=i.value,l=this._calculate(n.s,this.sPercentage),s=this._calculate(n.l,this.lPercentage),c=new m.default({h:n.h,s:l,l:s,weight:n.weight});n.isAchromatic()&&c.setAchromatic(),this.adjustedColorOccurence.set(c.toString(),c)}}catch(e){t=!0,o=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw o}}}},{key:"_calculate",value:function(e,t){var o=t>100?200:0;return e*((t-o)/(100-o))+(t-100)/(o-100)*(t>100?100:0)}}]),e}();t.default=y},20:function(e,t){e.exports=angular},227:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(1),n=i(r),l=o(2),a=i(l),s=o(58),c=i(s),d=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,[{key:"getInstance",value:function(e){return new c.default(e)}}]),e}();t.default=d},228:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(1),n=i(r),l=o(2),a=i(l),s=o(229),c=i(s),d=function(){function e(){(0,n.default)(this,e)}return(0,a.default)(e,[{key:"getInstance",value:function(){return new c.default}}]),e}();t.default=d},229:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(37),n=i(r),l=o(230),a=i(l),s=o(16),c=i(s),d=o(1),u=i(d),f=o(2),h=i(f),g=function(){function e(){(0,u.default)(this,e),this.map=new c.default,this[a.default]=this.values}return(0,h.default)(e,[{key:"add",value:function(e){this.map.set(e.toIdString(),e)}},{key:"values",value:function(){return this.map.values()}},{key:"getValuesArray",value:function(){return[].concat((0,n.default)(this.map.values()))}}]),e}();t.default=g},233:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(1),r=function(e){return e&&e.__esModule?e:{default:e}}(i),n=function e(t,o,i,n){var l=this;(0,r.default)(this,e),t.page="main",o.onSuccess({},function(e){var o=e.to().data;t.page=o.page,n(function(){t.$broadcast("rzSliderForceRender")},0)}),t.goToSettings=function(){l.page="settings",i.go("main.settings")},t.goToGuide=function(){l.page="guide",i.go("main.guide")},t.goToMain=function(){l.page="main",i.go("main")}};n.$inject=["$scope","$transitions","$state","$timeout"],t.default=n},234:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(235),n=i(r),l=o(1),a=i(l),s=function e(t){(0,a.default)(this,e),this.name="jsonRpcException",this.message=t};angular.module("jsonrpc",[]).provider("$JsonRpc",function(){var e="";this.set=function(t){e=t.url},this.$get=function(){return{url:e}}}).service("jsonrpc",["$q","$http","$JsonRpc",function(e,t,o){function i(e,t){return c+=1,{jsonrpc:"2.0",id:c,method:e,params:t}}function r(e){var t=["jsonrpc","id","result"],o=(0,n.default)(e),i=!1;return o.length===t.length&&(i=!0,o.forEach(function(o){t.indexOf(o)<0&&(i=!1),"jsonrpc"===o&&"2.0"!==e[o]&&(i=!1)})),i}var l=o.url;if(!l)throw new s("Please configure server url");var a={"Content-Type":"application/json"},c=0;this.request=function(o,n){var c=e.defer(),d={method:"POST",url:l,headers:a,data:i(o,n)};return t(d).then(function(e){var t=e.data;e&&t?t&&void 0!==t.result?r(t)?c.resolve(t.result):c.reject(new s("JSON-RPC 2.0 data format must be used.")):c.reject(new s("No data received. HTTP status code: "+t.status)):c.reject(new s("Unknown Error occured. No data received"))},function(e){e?c.reject(new s("Error occured. HTTP status code: "+e.status)):c.reject(new s("Unknown Error occurred"))}),c.promise}}]),t.default="jsonrpc"},239:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),o(240);var r=o(241),n=i(r),l=o(242),a=i(l),s=o(243),c=i(s),d=o(334),u=i(d),f=o(337),h=i(f),g=o(350),p=i(g),v=o(353),m=i(v);angular.module("main-page",[c.default,u.default,h.default,p.default,m.default]).factory("calculateFontColor",["colorUtils",function(e){return function(t){return e.getFittingColorWithGreaterCR(t,"#000000","#ffffff")}}]).component("mainPage",{template:n.default,controller:["$rootScope","$scope","textColors","$timeout","appSettings","colorSetFactory","colorFactory","popupDialog",a.default]}),t.default="main-page"},240:function(e,t){},241:function(e,t){e.exports='<div class=main-page> <color-toolbar closed=true color-modified-handler=$ctrl.colorModifiedHandler(color)></color-toolbar> <div class="colorizer main-page__colorizer"> <text-colorizer colorizer-id=01 on-wordselect=$ctrl.selectWord(word)></text-colorizer> <div class=colorizer__controls> <a class="btn-bodyless btn-bodyless-success colorizer__button" ng-click=$ctrl.inputComplete()><span class="glyphicon glyphicon-ok"></span> OK</a><span class=colorizer__separator></span> <a class="btn-bodyless colorizer__button" ng-click=$ctrl.edit()><span class="glyphicon glyphicon-pencil"></span> Edit</a><span class=colorizer__separator></span> <a class="btn-bodyless btn-bodyless-danger colorizer__button" ng-click=$ctrl.decolorizeDialog()><span class="glyphicon glyphicon-remove"></span> Clear</a><span class=colorizer__separator></span> <a class="btn-bodyless btn-bodyless-danger colorizer__button" ng-click=$ctrl.dropDialog()><span class="glyphicon glyphicon-trash"></span> Drop</a> </div> </div> <div class=main-page__adjustments-container> <div class="panel panel-default main-page__adjustments adjustments"> <div class=adjustments__label>Adjustments & Profiles</div> <div class=adjustments__inner> <div class=adjustments__content> <color-adjuster class=adjustments__adjuster text-colors=$ctrl.textColors></color-adjuster> <div class=adjustments__open-profiles-button> <a ng-model=collapsed ng-click="collapsed=!collapsed" class=btn-bodyless><span class="glyphicon glyphicon-triangle-bottom" ng-class="collapsed ? \'glyphicon-triangle-top\' : \'glyphicon-triangle-bottom\'"></span> Profiles</a> </div> <div ng-show=collapsed class=adjustments__profiles> <color-profiles colors=$ctrl.colors on-load-profile=$ctrl.loadColorProfile(colors)></color-profiles> </div> </div> </div> </div> </div> <div class=main-page__find-button-container> <a class="btn btn-success main-page__find-button" ng-click=$ctrl.search()><span class="glyphicon glyphicon-search"></span> Find!</a> </div> <image-finder></image-finder> </div>'},242:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(15),n=i(r),l=o(16),a=i(l),s=o(1),c=i(s),d=o(2),u=i(d),f=function(){function e(t,o,i,r,n,l,s,d){(0,c.default)(this,e),this.appSettings=n,this.colors=new a.default,this.textColors=i,this.selectedWord={},this.$scope=o,this.colorSetFactory=l,this.colorFactory=s,this.dialog=d}return(0,u.default)(e,[{key:"_updateColors",value:function(){var e=this;this.$scope.$broadcast("text-colorizer",function(t){var o=t.getAllColors();e.textColors.clearWords(),e.colors.clear();var i=!0,r=!1,l=void 0;try{for(var a,s=(0,n.default)(o.values());!(i=(a=s.next()).done);i=!0){var c=a.value,d=c.word.toLowerCase(),u=c.color;if(u.isSet()){e.textColors.addWord(d);var f=e.colors.get(d);if(f)f.add(u);else{var h=e.colorSetFactory.getInstance();h.add(u),e.colors.set(d,h)}}}}catch(e){r=!0,l=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw l}}})}},{key:"loadColorProfile",value:function(e){var t=this;this.$scope.$broadcast("text-colorizer",function(o){o.setColors(e,function(){t._updateColors(),t.textColors.updateColors(o.getAllColors()),t.$scope.$broadcast("colorsChainged")})})}},{key:"selectWord",value:function(e){var t=this;this.$scope.$broadcast("color-toolbar",function(o){t.selectedWord=e,o.setColor(e.color),o.open()})}},{key:"colorModifiedHandler",value:function(e){var t=this;this.$scope.$broadcast("text-colorizer",function(o){e&&o&&(e.isSet()?o.setColor(t.selectedWord,e,function(){t.textColors.updateColors(o.getAllColors()),t.$scope.$broadcast("colorsChainged")}):o.resetColor(t.selectedWord,function(){t.textColors.updateColors(o.getAllColors()),t.$scope.$broadcast("colorsChainged")}),t._updateColors())})}},{key:"inputComplete",value:function(){var e=this;this.$scope.$broadcast("text-colorizer",function(t){t.inputComplete(function(){e._updateColors(),e.textColors.updateColors(t.getAllColors()),e.$scope.$broadcast("colorsChainged")})})}},{key:"drop",value:function(){var e=this;this.$scope.$broadcast("text-colorizer",function(t){t.clear(function(){e._updateColors(),e.textColors.clear(),e.$scope.$broadcast("colorsChainged")})})}},{key:"dropDialog",value:function(){var e=this;this.dialog.confirmDialog(function(){this.yes=function(){e.drop(),e.dialog.close()},this.cancel=function(){e.dialog.close()},this.title='"drop"'})}},{key:"decolorizeDialog",value:function(){var e=this;this.dialog.confirmDialog(function(){this.yes=function(){e.decolorizeText(),e.dialog.close()},this.cancel=function(){e.dialog.close()},this.title='"clear"'})}},{key:"decolorizeText",value:function(){var e=this;this.$scope.$broadcast("text-colorizer",function(t){t.resetAllColors(function(){e._updateColors(),e.textColors.clear(),e.$scope.$broadcast("colorsChainged")})})}},{key:"edit",value:function(){this.$scope.$broadcast("text-colorizer",function(e){e.editMode()})}},{key:"search",value:function(){var e=this;this.$scope.$broadcast("image-finder",function(t){var o=e.textColors.getColorsAndWords();e.appSettings.checkSemanticSimilarity||(o.words=[]),t.search(o,e.appSettings.getSearchSettings())})}}]),e}();t.default=f},243:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(26),n=i(r),l=o(15),a=i(l),s=o(16),c=i(s);o(244);var d=o(293),u=i(d),f=o(174),h=i(f);o(332);var g=o(333),p=i(g);angular.module("color-adjuster",[h.default,u.default]).component("colorAdjuster",{template:p.default,controller:["$scope","$element","$attrs","$timeout","colorUtils","colorFactory","eventFilter",function(e,t,o,i,r,l,s){var d=this,u=this;this.toggle=function(){i(function(){e.$broadcast("rzSliderForceRender")},0,!1)},this.getS=function(){return d.textColors.sPercentage<100?"-"+Math.abs(u.textColors.sPercentage-100):"+"+Math.abs(u.textColors.sPercentage-100)},this.getL=function(){return d.textColors.lPercentage<100?"-"+Math.abs(u.textColors.lPercentage-100):"+"+Math.abs(u.textColors.lPercentage-100)};var f=function(){var t=new c.default,o=[],s=[],f=!0,h=!1,g=void 0;try{for(var p,v=(0,a.default)(d.textColors.adjustedColorOccurence.entries());!(f=(p=v.next()).done);f=!0){var m=(0,n.default)(p.value,2),y=m[0],_=m[1],b=r.toHexString(y),C=t.get(b);if(C)C.weight+=_.weight;else{var w=l.getInstance(_);t.set(b,w)}}}catch(e){h=!0,g=e}finally{try{!f&&v.return&&v.return()}finally{if(h)throw g}}var $=!0,k=!1,S=void 0;try{for(var P,x=(0,a.default)(t);!($=(P=x.next()).done);$=!0){var M=(0,n.default)(P.value,2),y=M[0],I=M[1];s.push(y),o.push(I.weight)}}catch(e){k=!0,S=e}finally{try{!$&&x.return&&x.return()}finally{if(k)throw S}}u.data=o,u.colors=s,i(function(){e.$apply()},0,!1)};this.labels=["huhu","lol"],this.data=[],this.colors=[];var h=s(1e3/30,function(){u.textColors.calculateAdjustedColors(),f()});this.options={tooltips:{enabled:!1},animation:{animateRotate:!1},events:[]},this.slider={value:50,options:{floor:0,ceil:200,step:1,onChange:function(){h.event()},onEnd:function(){u.textColors.calculateAdjustedColors(),f()},hidePointerLabels:!0,hideLimitLabels:!0,disabled:!1}},e.$on("colorsChainged",f),this.$onInit=function(){f()}}],bindings:{textColors:"<"}}),t.default="color-adjuster"},332:function(e,t){},333:function(e,t){e.exports=' <div class=color-adjuster> <canvas class="chart chart-doughnut color-adjuster__diagram" chart-data=$ctrl.data chart-colors=$ctrl.colors chart-labels=$ctrl.labels chart-options=$ctrl.options></canvas> <div class="sliders color-adjuster__sliders"> <div class=sliders__content> <div class=color-adjuster__slider> <div><span class="glyphicon glyphicon-signal"></span> <span>{{$ctrl.getS()}}%</span></div> <rzslider rz-slider-model=$ctrl.textColors.sPercentage rz-slider-options=$ctrl.slider.options></rzslider> </div> <div class=color-adjuster__slider> <div><span class="glyphicon glyphicon-adjust icon-flipped"></span> <span>{{$ctrl.getL()}}%</span></div> <rzslider rz-slider-model=$ctrl.textColors.lPercentage rz-slider-options=$ctrl.slider.options></rzslider> </div> </div> </div> </div> '},334:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(37),n=i(r),l=o(1),a=i(l),s=o(2),c=i(s),d=o(26),u=i(d),f=o(16),h=i(f),g=o(15),p=i(g);o(335);var v=o(336),m=i(v);angular.module("color-profiles",[]).service("colorProfiles",["db","colorFactory",function(e,t){return new y(new b(e,t))}]).component("colorProfiles",{template:m.default,controller:["$rootScope","$scope","$timeout","colorProfiles","colorFactory","colorSetFactory","popupDialog",function(e,t,o,i,r,n,l){var a=this;this.createProfile=!1,this.notDeleteColors=!1,this.newProfileName="",this.colorProfiles=i,this.profiles=[],this.conflictColors=[];var s=[],c="";this.updateProfileDialog=function(){var e=a;l.confirmDialog(function(){this.yes=function(){e.updateProfile(),l.close()},this.cancel=function(){l.close()},this.title='"update profile"'})},this.applyProfileDialog=function(){var e=a;l.confirmDialog(function(){this.yes=function(){e.applyProfile(),l.close()},this.cancel=function(){l.close()},this.title='"apply profile"'})},this.deleteProfileDialog=function(){var e=a;l.confirmDialog(function(){this.yes=function(){e.deleteProfile(),l.close()},this.cancel=function(){l.close()},this.title='"delete profile"'})},this.toggleNewProfile=function(){a.createProfile=!a.createProfile},this.haveProfiles=function(){return a.profiles.length>0},this.selectProfile=function(){var e=i.selectedProfile.name;null!==e&&void 0!==e&&(a._resetColorConflicts(),i.loadColorProfile(e,function(){}))},this.saveProfile=function(){var e=a.newProfileName;if(void 0!==e&&null!==e&&e.length>0&&(a._resetColorConflicts(),c="create",a._testForColorConflicts(),a.conflictColors.length<1)){var t=a._convertColorArrayToMap(s);a._createColorProfile(e,t)}},this.applyProfile=function(){var e=i.selectedProfile.name;null!==e&&void 0!==e&&(a._resetColorConflicts(),a.onLoadProfile({colors:i.getSelectedProfileColors()}))},this.updateProfile=function(){var e=i.selectedProfile.name;if(null!==e&&void 0!==e){a._resetColorConflicts(),c="update";var t=i.getSelectedProfileColors();if(!a.notDeleteColors){var o=!0,r=!1,n=void 0;try{for(var l,d=(0,p.default)(t.keys());!(o=(l=d.next()).done);o=!0){var u=l.value;a.colors.has(u)||t.delete(u)}}catch(e){r=!0,n=e}finally{try{!o&&d.return&&d.return()}finally{if(r)throw n}}}if(a._testForColorConflicts(t),a.conflictColors.length<1){var f=a._convertColorArrayToMap(s);a._updateColorProfile(e,f)}}},this.deleteProfile=function(){var e=i.selectedProfile.name;null!==e&&void 0!==e&&i.deleteColorProfile(e,function(){t.$apply();var e=a.profiles[a.profiles.length-1];a._resetColorConflicts(),i.loadColorProfile(e,function(){t.$apply()})})},this.solveColorConflicts=function(){var e=a._concatColorArraysToMap();switch(c){case"update":var t=i.selectedProfile.name;null!==t&&void 0!==t&&a._updateColorProfile(t,e);break;case"create":var o=a.newProfileName;null!==o&&void 0!==o&&a._createColorProfile(o,e)}},this._resetColorConflicts=function(){a.conflictColors=[],s=[],c=""},this._createColorProfile=function(e,o){i.createColorProfile(e,o,function(){a.newProfileName="",a._resetColorConflicts(),i.loadColorProfile(e,function(){t.$apply()})})},this._updateColorProfile=function(e,r){i.updateColorProfile(e,r,function(){a._resetColorConflicts(),o(function(){t.$apply()},0)})},this._testForColorConflicts=function(e){var t=new h.default,o=!0,i=!1,l=void 0;try{for(var c,d=(0,p.default)(a.colors);!(o=(c=d.next()).done);o=!0){for(var f=(0,u.default)(c.value,2),g=f[0],v=f[1],m=v.getValuesArray(),y=n.getInstance(),_=0;_<m.length;_++)y.add(m[_]);t.set(g,y)}}catch(e){i=!0,l=e}finally{try{!o&&d.return&&d.return()}finally{if(i)throw l}}if(e){var b=!0,C=!1,w=void 0;try{for(var $,k=(0,p.default)(e);!(b=($=k.next()).done);b=!0){var S=(0,u.default)($.value,2),g=S[0],P=S[1],x=r.getInstance(P),M=t.get(g);if(M)M.add(x);else{var I=n.getInstance();I.add(x),t.set(g,I)}}}catch(e){C=!0,w=e}finally{try{!b&&k.return&&k.return()}finally{if(C)throw w}}}var j=!0,z=!1,T=void 0;try{for(var A,D=(0,p.default)(t);!(j=(A=D.next()).done);j=!0){var L=(0,u.default)(A.value,2),g=L[0],v=L[1],N=v.getValuesArray();if(N.length>1){var O=N[0];a.conflictColors.push({word:g,selected:O,colors:N})}else{var P=N[0];s.push({word:g,color:P})}}}catch(e){z=!0,T=e}finally{try{!j&&D.return&&D.return()}finally{if(z)throw T}}},this._concatColorArraysToMap=function(){var e=[];return a.conflictColors.forEach(function(t){e.push({word:t.word,color:t.selected})}),e=e.concat(s),a._convertColorArrayToMap(e)},this._convertColorArrayToMap=function(e){for(var t=new h.default,o=0,i=e.length;o<i;o++){var r=e[o];t.set(r.word,r.color)}return t},this.$onInit=function(){i.load(function(){if(a.profiles=i.getColorProfileNames(),a.profiles&&a.profiles.length>0){var e=a.profiles[a.profiles.length-1];i.loadColorProfile(e,function(){t.$apply()})}})}}],bindings:{colors:"<",onLoadProfile:"&"}});var y=function(){function e(t){(0,a.default)(this,e),this.profileNames=[],this.selectedProfile={},this.dao=t,this.dao.setProfiles(this)}return(0,c.default)(e,[{key:"loadColorProfile",value:function(e,t){this.dao.loadColorProfile(e,t)}},{key:"load",value:function(e){this.dao.loadColorProfiles(e)}},{key:"createColorProfile",value:function(e,t,o){var i=new _(e,t);this.dao.saveColorProfile(i,o)}},{key:"deleteColorProfile",value:function(e,t){this.dao.deleteColorProfile(e,t)}},{key:"getColorProfileNames",value:function(){return this.profileNames}},{key:"getSelectedProfileColors",value:function(){return this.selectedProfile.colors}},{key:"updateColorProfile",value:function(e,t,o){if(this.selectedProfile.name===e){var i=new _(e,t);this.dao.updateColorProfile(i,o)}}},{key:"_removeColorProfileName",value:function(e){for(var t=void 0,o=0;o<this.profileNames.length;o++)if(this.profileNames[o]===e){t=o;break}this.profileNames.splice(t,1)}},{key:"_setColorProfile",value:function(e){this.selectedProfile=e}},{key:"_addColorProfileName",value:function(e){this.profileNames.push(e)}}]),e}(),_=function(){function e(t,o){(0,a.default)(this,e),this.name=t,this.colors=o}return(0,c.default)(e,[{key:"serialize",value:function(){var e=this,t={};return t.name=this.name,t.colors=[].concat((0,n.default)(e.colors)),t}}],[{key:"deserialize",value:function(t,o){var i=t.name,r=new h.default(t.colors),n=!0,l=!1,a=void 0;try{for(var s,c=(0,p.default)(r);!(n=(s=c.next()).done);n=!0){var d=(0,u.default)(s.value,2),f=d[0],g=d[1];r.set(f,o.getInstance(g))}}catch(e){l=!0,a=e}finally{try{!n&&c.return&&c.return()}finally{if(l)throw a}}return new e(i,r)}}]),e}(),b=function(){function e(t,o){(0,a.default)(this,e),this.colorFactory=o,this.profiles=[],this.store="colorprofiles",this.db=t}return(0,c.default)(e,[{key:"setProfiles",value:function(e){this.profiles=e}},{key:"loadColorProfile",value:function(e,t){var o=this;this.db.getStore(this.store).getItem(e).then(function(e){if(e){var i=_.deserialize(e,o.colorFactory);o.profiles._setColorProfile(i)}t&&t()}).catch(function(){console.warn("Database error")})}},{key:"deleteColorProfile",value:function(e,t){var o=this;this.db.getStore(this.store).removeItem(e).then(function(){o.profiles._removeColorProfileName(e),t&&t()}).catch(function(){console.warn("Database error")})}},{key:"saveColorProfile",value:function(e,t){var o=this,i=this.db.getStore(this.store);i.getItem(e.name).then(function(r){return r?null:i.setItem(e.name,e.serialize()).then(function(){o.profiles._addColorProfileName(e.name),o.profiles._setColorProfile(e),t&&t()})}).catch(function(e){console.warn("Database error"),console.error(e)})}},{key:"loadColorProfiles",value:function(e){var t=this;this.db.getStore(this.store).iterate(function(e,o){return t.profiles._addColorProfileName(o)}).then(function(){e&&e()}).catch(function(){console.warn("Database error")})}},{key:"updateColorProfile",value:function(e,t){var o=this;this.db.getStore(this.store).setItem(e.name,e.serialize()).then(function(){o.loadColorProfile(e.name,function(){t&&t()})}).catch(function(){console.warn("Database connection error")})}}]),e}();t.default="color-profiles"},335:function(e,t){},336:function(e,t){e.exports='<div> <select class=color-profiles__profiles ng-change=$ctrl.selectProfile() ng-model=$ctrl.colorProfiles.selectedProfile.name> <option ng-repeat="profile in $ctrl.profiles track by $index" data-colorprofiles-profile={{$index}} value={{profile}}>{{profile}}</option> </select> <div class="control-buttons color-profiles__control-buttons"> <a ng-click=$ctrl.applyProfileDialog() class="btn-bodyless btn-bodyless-success" ng-class="$ctrl.haveProfiles() ? \'\' : \'disabled\'"><span class="glyphicon glyphicon-tint"></span> Apply</a> <a ng-click=$ctrl.updateProfileDialog() class=btn-bodyless ng-class="$ctrl.haveProfiles() ? \'\' : \'disabled\'"><span class="glyphicon glyphicon-floppy-save"></span> Update</a> <a ng-click=$ctrl.deleteProfileDialog() class="btn-bodyless btn-bodyless-danger" ng-class="$ctrl.haveProfiles() ? \'\' : \'disabled\'"><span class="glyphicon glyphicon-trash"></span> Drop</a> <a ng-click=$ctrl.toggleNewProfile() class="btn-bodyless btn-bodyless-success"><span class="glyphicon glyphicon-plus" aria-hidden=true></span> Create</a> </div> <div class="create-profile color-profiles__create-profile"> <div ng-show=$ctrl.createProfile> <input ng-model=$ctrl.newProfileName type=text class="form-control create-profile__profile-name" placeholder=Profile> <a ng-click=$ctrl.saveProfile() class="btn btn-success btn-block"><span class="glyphicon glyphicon-save" aria-hidden=true></span> Save</a> </div> </div> <div ng-show="$ctrl.conflictColors.length>0" class="conflicts color-profiles__conflicts"> <div class=conflicts__title><span>Conflicts</span></div> <div ng-repeat="item in $ctrl.conflictColors track by $index"> {{item.word}} <form> <div ng-repeat="color in item.colors track by $index"> <input ng-model=$ctrl.conflictColors[$parent.$index].selected ng-value=color type=radio> <div class=conflicts__color ng-style="{\'background-color\': color}"></div><span class=conflicts__weight> weight: {{color.weight}}</span> </div> </form> </div> <a ng-click="$ctrl.solveColorConflicts() " class="btn btn-success"><span class="glyphicon glyphicon-ok" aria-hidden=true></span> OK</a> </div> </div>'},337:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(15),n=i(r),l=o(338),a=i(l),s=o(16),c=i(s),d=o(344),u=i(d),f=o(345),h=i(f);o(348);var g=o(349),p=i(g),v=h.default.AllHtmlEntities;angular.module("text-colorizer",[]).component("textColorizer",{template:p.default,controller:["$scope","$element","$attrs","$timeout","$window","calculateFontColor","colorFactory",function(e,t,o,i,r,l,s){function d(e){return e.replace(/#%%%#;|#%%#%;|#%#%%;|##%%%;/g,function(e){return y.get(e)})}var f=this,h=this,g=l,p={widgetSelector:"data-textcolorizer-text",wordSelector:"data-textcolorizer-word",colorSelector:"data-textcolorizer-color",weightSelector:"data-textcolorizer-weight",helperSelector:"data-textcolorizer-helper"},m={root:angular.element(t.find("div["+p.widgetSelector+"]")[0]),words:new c.default,wordsToRemove:new a.default,editMode:!1,idCounter:0,helperCounter:0,wordWidth:5},y=new c.default;y.set("#%%%#;","<"),y.set("#%%#%;",">"),y.set("#%#%%;","</"),y.set("##%%%;",'"');var _={inputComplete:function(e){h.inputComplete(e)},editMode:function(){h.editMode()},setColor:function(e,t,o){h.setColor(e,t,o)},resetColor:function(e,t){h.resetColor(e,t)},resetAllColors:function(e){h.resetAllColors(e)},getAllColors:function(){return h.getAllColors()},setColors:function(e,t){h.setColors(e,t)},clear:function(e){h.clear(e)}};e.$on("text-colorizer",function(e,t){"function"==typeof t&&t(_)}),this._handlePaste=function(e){e.preventDefault(),e.stopPropagation();var t="";e.clipboardData||e.originalEvent.clipboardData?t=(e.originalEvent||e).clipboardData.getData("Text"):r.clipboardData&&(t=r.clipboardData.getData("Text")),r.document.queryCommandSupported("insertText")?r.document.execCommand("insertText",!1,t):r.document.execCommand("paste",!1,t)},this._handleKeydown=function(e){if(13!==e.keyCode&&8!==e.keyCode&&46!==e.keyCode||r.setTimeout(function(){h._deleteEmpty(),h._updateFontStyle()},0),(8===e.keyCode||46===e.keyCode)&&r&&r.getSelection&&r.getSelection().anchorNode&&r.getSelection().getRangeAt(0)){var t=r.getSelection().anchorNode.parentNode;if(angular.element(t).attr(""+p.wordSelector)){var o=r.getSelection();if(o.anchorNode===o.focusNode){var i=o.getRangeAt(0),n=i.startOffset,l=i.endOffset,a=Math.abs(n-l),s=o.anchorNode.nodeValue,c=(0,u.default)("^( )$","gi");a<2&&(8===e.keyCode?1===n||0===n||1===l||0===l?s.trim().length>0&&s[n-1].match(c)&&e.preventDefault():n!==s.length&&l!==s.length||(e.preventDefault(),o.anchorNode.nodeValue=s.slice(0,-2)+" ",f._moveCaretInText(o.anchorNode.nodeValue.length,o.anchorNode)):46===e.keyCode&&(0!==n&&n!==s.length&&0!==l&&l!==s.length||e.preventDefault())),a>1&&a<s.length&&(0===n?(e.preventDefault(),o.anchorNode.nodeValue=" "+s.slice(l),f._moveCaretInText(1,o.anchorNode)):l===s.length&&(e.preventDefault(),o.anchorNode.nodeValue=s.slice(0,-a)+" ",f._moveCaretInText(o.anchorNode.nodeValue.length,o.anchorNode)))}}}},this._updateFontStyle=function(){m.root.css({"font-size":"1em","line-height":"1.7em"})},this._handleCut=function(){r.setTimeout(function(){return colorizer._updateWordsStyle()},0)},this._updateWordsStyle=function(){angular.element(m.root).find("mark["+p.wordSelector+"]").each(function(e,t){var o=angular.element(t),i=o.text().trim();o.text(" "+i+" ")}),f._deleteEmpty(),f._updateFontStyle()},this._moveCaretInText=function(e,t){var o=e,i=r.document.createRange();i.setStart(t,o),i.collapse(!0);var n=r.getSelection();n.removeAllRanges(),n.addRange(i)},this.setColors=function(e,t){f.inputComplete(function(){m.root.find("mark["+p.wordSelector+"]").each(function(t,o){var i=parseInt(angular.element(o).attr(""+p.wordSelector),10),r=m.words.get(i),n=e.get(r.word);n&&h._setWordColor(r,n,angular.element(o))}),t&&t()})},this._setWordColor=function(e,t,o){e.color.setColor(t),o.css({"background-color":t.toString()}),o.css({color:g(t)})},this._deleteEmpty=function(){return m.root.find("mark["+p.wordSelector+"]").filter(function(e,t){var o=!0,i=angular.element(t);return i.text().trim().length<1||"&nbsp;"===i.text().trim()||""===i.text().trim()||i.find("br").length>0&&!i.parent().is(m.root)||(o=!1),o}).remove(),f},this.createWordMark=function(e,t,o,i){return"#%%%#;mark "+p.wordSelector+"="+e+" style = ##%%%;background-color: "+o+"; color: "+i+";##%%%;#%%#%; "+t+" #%#%%;mark#%%#%;"},this._inWordTags=function(){return m.root.find("mark["+p.wordSelector+"]").each(function(e,t){var o=angular.element(t),i=o.attr(p.wordSelector),r=parseInt(i,10),n=o.css("background-color"),l=o.css("color"),a=o.text(),c=(0,u.default)("^(?: [\\pN\\pL]+ )$","i"),h=m.words.get(r);if(!a.match(c)){var g=a.replace((0,u.default)("[\\pN\\pL]+","gi"),function(e){var t=s.getInstance(h.color),o=m.idCounter++;return m.words.set(o,{id:o,color:t,word:e.toLowerCase()}),f.createWordMark(o,e,n,l)});m.wordsToRemove.add(r),o.replaceWith(d(v.encode(g)))}}),f},this._notInTags=function(){var e=(0,u.default)("[\\pN\\pL]+","gi");return m.root.contents().filter(function(e,t){return 3===t.nodeType}).each(function(t,o){var i=o.nodeValue.trim().replace(/\s+/g," "),r=i.replace(e,function(e){var t=s.getInstance(),o=m.idCounter++;return m.words.set(o,{id:o,color:t,word:e.toLowerCase()}),f.createWordMark(o,e,null,null)});angular.element(o).replaceWith(d(v.encode(r)))}).end(),m.root.find("br").replaceWith(" "),f},this._updateWords=function(e){m.root.find("mark["+p.wordSelector+"="+e.id+"]").each(function(t,o){var i=angular.element(o),r=i.text(),n=s.getInstance(e.color),l=m.idCounter++;i.attr(""+p.wordSelector,l),m.words.set(l,{id:l,color:n,word:r.toLowerCase()})})},this._setCaretPosition=function(e){var t=r.document.createRange(),o=r.getSelection();t.setStartAfter(e),t.setEndAfter(e),o.removeAllRanges(),o.addRange(t)},this.inputComplete=function(e){m.editMode=!1,m.root.find(":not(mark["+p.wordSelector+"])").contents().unwrap(),m.root.find(":not(mark["+p.wordSelector+"])").remove(),f._deleteEmpty()._inWordTags()._notInTags(),m.root.find(":not(mark["+p.wordSelector+"])").remove(),m.root.attr("contentEditable",!1);var t=new a.default;m.root.find("mark["+p.wordSelector+"]").each(function(e,o){var i=angular.element(o).attr(p.wordSelector),r=parseInt(i,10);t.add(r)}),m.root.find("mark["+p.wordSelector+"]").each(function(e,t){if(t.nextSibling&&3!==t.nextSibling.nodeType){var o=r.document.createTextNode(" ");t.parentNode.insertBefore(o,t.nextSibling)}});var o=!0,i=!1,l=void 0;try{for(var s,c=(0,n.default)(m.words.keys());!(o=(s=c.next()).done);o=!0){var d=s.value;!m.wordsToRemove.has(d)&&t.has(d)||m.words.delete(d)}}catch(e){i=!0,l=e}finally{try{!o&&c.return&&c.return()}finally{if(i)throw l}}m.wordsToRemove.clear(),e&&e()},this.editMode=function(){m.editMode=!0,m.root.attr("contentEditable",!0);var e=m.root.contents().last()[0]?m.root.contents().last()[0].nodeType:void 0;if(e&&3!==e){var t=r.document.createTextNode(" ");m.root.append(angular.element(t)),h._setCaretPosition(m.root.contents().last()[0])}else e&&(m.root.append("<span "+p.helperSelector+"></span>"),h._setCaretPosition(m.root.find("span["+p.helperSelector+"]")[0]),i(function(){m.root.find("span["+p.helperSelector+"]").remove()},0));m.root[0].focus()},this.setColor=function(e,t,o){if(!m.editMode&&e){var i=m.root.find("mark["+p.wordSelector+"="+e.id+"]");if(i&&i.length>0){var r=m.words.get(e.id);r.color.setColor(t),i.css({"background-color":r.color.toString(),color:g(r.color)})}}o&&o()},this.getAllColors=function(){return m.words},this.resetColor=function(e,t){if(!m.editMode&&e){var o=m.root.find("mark["+p.wordSelector+"="+e.id+"]");if(o&&o.length>0){o.removeAttr("style");var i=m.words.get(e.id);i&&i.color.reset()}}t&&t(f)},this.resetAllColors=function(e){m.root.find("mark["+p.wordSelector+"]").removeAttr("style");var t=!0,o=!1,i=void 0;try{for(var r,l=(0,n.default)(m.words.values());!(t=(r=l.next()).done);t=!0)r.value.color.reset()}catch(e){o=!0,i=e}finally{try{!t&&l.return&&l.return()}finally{if(o)throw i}}e&&e()},this.selectWord=function(e){var t=angular.element(e.target);if(t.length>0&&t[0].hasAttribute(p.wordSelector))if(m.editMode){var o=t.contents().first()[0],i=r.getSelection().anchorNode;if(i&&!o.isSameNode(i)){var n=t.text();if(n[0].trim().length>0){var l=r.document.createTextNode(" "+o.textContent.trim()+" ");o.parentNode.replaceChild(l,o),f._moveCaretInText(1,l)}}}else{e.stopPropagation();var a=t.attr(p.wordSelector),s=m.words.get(parseInt(a,10));f.onWordselect({word:s})}},this.clear=function(e){m.words.clear(),m.root.attr("contentEditable",!0),m.root.empty(),m.root[0].focus(),e()}}],bindings:{control:"<",onWordselect:"&"}}),t.default="text-colorizer"},348:function(e,t){},349:function(e,t){e.exports=" <div class=textcolorizer> <div data-textcolorizer-text ng-click=$ctrl.selectWord($event) ng-keydown=$ctrl._handleKeydown($event) ng-paste=$ctrl._handlePaste($event) ng-cut=$ctrl._handleCut($event) contenteditable=true>Lorem ipsum dolor sit amet</div> <div data-textcolorizer-background></div> </div>"},350:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(174),n=i(r);o(351);var l=o(352),a=i(l);angular.module("color-toolbar",[n.default]).component("colorToolbar",{template:a.default,controller:["$rootScope","$scope","$element","$attrs","$timeout","$window","colorFactory","eventFilter",function(e,t,o,i,r,n,l,a){var s=this,c=this;this.id=i.toolbarId,this.colors=[];for(var d=0;d<360;d+=30){var u=l.getInstance({h:d,s:50,l:50});this.colors.push(u)}var f=l.getInstance({h:0,s:0,l:0}).setAchromatic(),h=l.getInstance({h:0,s:0,l:100}).setAchromatic();this.colors.push(f),this.colors.push(h),this.color=l.getInstance();var g=a(1e3/30,function(){c.colorModifiedHandler({color:c.color})});this.slider={value:50,options:{floor:0,ceil:100,step:1,onChange:function(){g.event()},onEnd:function(){c.colorModifiedHandler({color:c.color})},hidePointerLabels:!0,hideLimitLabels:!0,disabled:!0}},this.increaseWeight=function(){s.color&&s.color.isSet()&&s.color.weight<100&&(c.color.weight++,s.colorModifiedHandler({color:c.color}))},this.decreaseWeight=function(){s.color&&s.color.isSet()&&s.color.weight>1&&(c.color.weight--,s.colorModifiedHandler({color:c.color}))},this.endSlide=function(){s.colorModifiedHandler({color:c.color})},this.selectColor=function(e){var t=e.target;if(t.hasAttribute("data-toolbar-color")||t.parentElement.hasAttribute("data-toolbar-color")){e.stopPropagation();var o=t.hasAttribute("data-toolbar-color")?t:t.parentElement,i=angular.element(o).attr("data-toolbar-color");if(i&&"null"!==i){var r=l.getInstance(s.colors[i]);s.changeColor(r),s.slider.options.disabled=s.color.isAchromatic()}else s.setInitialColor();s.colorModifiedHandler({color:c.color})}},this.changeColor=function(e){e.weight=s.color.weight,!e.isAchromatic()&&!s.color.isAchromatic()&&s.color.s&&s.color.l&&(e.s=s.color.s,e.l=s.color.l),s.color=e},this.setCurrentColor=function(e){e&&e.isSet()?(s.color=e,s.slider.options.disabled=s.color.isAchromatic()):s.setInitialColor()},this.setInitialColor=function(){s.color=l.getInstance(),s.slider.options.disabled=!0},this.close=function(){o.addClass("hide")},this.open=function(){o.removeClass("hide"),r(function(){t.$broadcast("rzSliderForceRender")},0)};var p={setColor:function(e){c.setCurrentColor(e)},close:function(){c.close()},open:function(){c.open()}};t.$on("color-toolbar",function(e,t){"function"==typeof t&&t(p)}),this.$onInit=function(){!0===s.closed&&s.close(),angular.element(n).bind("resize orientationchange",function(){e.$broadcast("rzSliderForceRender")})}}],bindings:{colorModifiedHandler:"&",closed:"<"}}),t.default="color-toolbar"},351:function(e,t){},352:function(e,t){e.exports='<div class=toolbar> <div class=toolbar__content> <div class=toolbar__left> <div class=colorbox ng-click=$ctrl.selectColor($event)> <div ng-repeat="c in $ctrl.colors track by $index"> <div class=colorbox__color data-toolbar-color={{$index}} ng-style="{\'background-color\': c}"></div> </div> <div class=colorbox__color data-toolbar-color=null><span class="glyphicon glyphicon-remove colorbox__clear-icon"></span></div> <div style=clear:both></div> </div> </div> <div class=toolbar__center> <div class=toolbar__adjuster> <div class="sliders toolbar__sliders" ng-disabled=!$ctrl.color.isSet()> <div class=sliders__content> <div class=sliders__saturation-slider> <span class="glyphicon glyphicon-signal"></span> <span>{{$ctrl.color.isSet() ? $ctrl.color.s : 0 }}%</span> <rzslider rz-slider-model=$ctrl.color.s rz-slider-options=$ctrl.slider.options></rzslider> </div> <div class=sliders__lightness-slider> <span class="glyphicon glyphicon-adjust icon-flipped"></span> <span>{{$ctrl.color.isSet() ? $ctrl.color.l : 0 }}%</span> <rzslider rz-slider-model=$ctrl.color.l rz-slider-options=$ctrl.slider.options></rzslider> </div> </div> </div> <div class="weight toolbar__weight"> <div class=weight__title><span class="glyphicon glyphicon-stats"></span> Weight</div> <div class=weight__controls> <div class="weight__buttons btn-group-vertical" role=group> <a type=button class="btn btn-default btn-block btn-square weight__button" ng-click=$ctrl.increaseWeight()>+</a> <a type=button class="btn btn-default btn-block btn-square weight__button" ng-click=$ctrl.decreaseWeight()>-</a> </div> <div class=weight__value>{{$ctrl.color.weight}}</div> </div> </div> </div> </div> <div class=toolbar__right> <div class="selected-color toolbar__selected-color"> <div class=selected-color__value ng-style="{\'background-color\': $ctrl.color}"></div> <div class=selected-color__background></div> </div> <div class="close-button toolbar__close-button" ng-click=$ctrl.close()> <span class="glyphicon glyphicon-menu-up close-button__icon"></span> </div> </div> </div> </div>'},353:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(2),n=i(r),l=o(1),a=i(l),s=o(354),c=i(s);o(355),o(356);var d=o(357),u=i(d);angular.module("image-finder",["jsonrpc",c.default,"ngError"]).service("images",["jsonrpc","login",function(e,t){return new h(new g(e,t))}]).component("imageFinder",{template:u.default,controller:["$scope","$element","images","$window","usSpinnerService",function(e,t,o,i,r){var n=this,l=this;this.selectedImage={},this.imagesToShow=[],this.showImage=!1,this.$onInit=function(){this.imagesToShow=o.getImagesInInterval(0,o.showIndex)};var a={search:function(e,t){e&&e.colors&&e.colors.length>0&&(r.spin("spinner-1"),o.findImages(e,t,function(){r.stop("spinner-1"),l.imagesToShow=o.getImagesInInterval(0,10),o.showIndex=10}))},getImages:function(){return o.getImagesArray()}};e.$on("image-finder",function(e,t){"function"==typeof t&&t(a)}),this.imageLoadingError=function(){n.showImage=!1},this.thumbnailLoadingError=function(e){angular.element(e.target.parentNode).addClass("hidden"),n.showMore()},this.originalURL=function(){i.open(n.selectedImage.originalURL)},this.showMore=function(){n.imagesToShow=n.imagesToShow.concat(o.getImagesInInterval(o.showIndex,o.showIndex+10)),o.showIndex+=10},this.selectImage=function(e){var t=e.target;if(t.hasAttribute("data-imagefinder-image")||angular.element(t).parent()[0].hasAttribute("data-imagefinder-image")){e.stopPropagation();var i=t.hasAttribute("data-imagefinder-image")?parseInt(angular.element(t).attr("data-imagefinder-image")):parseInt(angular.element(t).parent().attr("data-imagefinder-image"));n.selectedImage=o.getImage(i),n.selectedImage&&(angular.element("body").addClass("stop-scrolling"),n.showImage=!0)}},this.closeImagePopup=function(e){e.target.hasAttribute("data-imagefinder-close")&&(e.stopPropagation(),angular.element("body").removeClass("stop-scrolling"),this.showImage=!1)}}]});var f=function e(t,o,i){(0,a.default)(this,e),this.url=t,this.originalURL=o,this.score=i},h=function(){function e(t){(0,a.default)(this,e),this.images=[],this.service=t,this.showIndex=0}return(0,n.default)(e,[{key:"addImage",value:function(e,t,o){var i=new f(e,t,o);this.images.push(i)}},{key:"getImage",value:function(e){return this.images[e]}},{key:"getImagesArray",value:function(){return this.images}},{key:"getImagesInInterval",value:function(e,t){return e>=0&&e<this.images.length?(t>this.images.length&&(t=this.images.length),this.images.slice(e,t)):[]}},{key:"findImages",value:function(e,t,o){this.images.length=0,this.service.findImages(this,e,t,o)}}]),e}(),g=function(){function e(t,o){(0,a.default)(this,e),this.jsonrpc=t,this.login=o}return(0,n.default)(e,[{key:"findImages",value:function(e,t,o,i){var r=this;this.jsonrpc.request("find",{colors:t.colors,words:t.words,settings:o,auth:r.login.auth}).then(function(t){if(t&&t.imgs&&t.imgs.length>0)for(var o=0;o<t.imgs.length;o++){var r=t.imgs[o];e.addImage(r.url,r.originalURL,parseFloat(r.score).toFixed(2))}t=null,i&&i()}).catch(function(e){console.error(e),i&&i()})}}]),e}();t.default="image-finder"},356:function(e,t){},357:function(e,t){e.exports=' <div class=image-finder> <div class=image-finder__container> <div ng-click=$ctrl.selectImage($event) class="images image-finder__images" infinite-scroll=$ctrl.showMore() infinite-scroll-distance=0> <div ng-repeat="img in $ctrl.imagesToShow track by $index"> <div data-imagefinder-image={{$index}} class=images__image> <img ng-src={{img.url}} ng-error=$ctrl.thumbnailLoadingError($event)> </div> </div> </div> </div> <div ng-show=$ctrl.showImage class="image-popup image-finder__popup"> <div class=image-popup__topline> <div class=image-popup__title> <a target=_blank href={{$ctrl.selectedImage.originalURL}}><span class="glyphicon glyphicon-link"></span> Original</a> </div> </div> <div ng-click=$ctrl.closeImagePopup($event) class=image-popup__close-button data-imagefinder-close><span data-imagefinder-close class="glyphicon glyphicon-remove image-popup__close-icon" aria-hidden=true></span></div> <div class=image-popup__image-container ng-click=$ctrl.closeImagePopup($event) data-imagefinder-close> <img class=image-popup__image ng-src={{$ctrl.selectedImage.url}} ng-error=$ctrl.imageLoadingError($event)> </div> </div> </div>'},358:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),o(359);var r=o(360),n=i(r),l=o(361),a=i(l);angular.module("settings-page",[]).component("settingsPage",{template:n.default,controller:["$scope","appSettings",a.default],bindings:{}}),t.default="settings-page"},359:function(e,t){},360:function(e,t){e.exports='<div class=settings-page> <div class="panel panel-default settings-panel settings-page__content"> <div class="panel-heading settings-panel__heading"> <h3 class=panel-title><span class="glyphicon glyphicon-cog"></span>&nbsp;Settings</h3> </div> <div class="panel-body settings-panel__body"> <div class="checkbox analyze-text"> <label> <input ng-model=$ctrl.settings.checkSemanticSimilarity type=checkbox>Analyze semantics (experimental) </label> </div> <div class=search-type> <div class="radio search-type__option"> <label> <input type=radio name=optionsRadios ng-model=$ctrl.settings.searchMode value=regular checked=checked>Regular search (fast) </label> </div> <div class="radio search-type__option"> <label> <input type=radio name=optionsRadios ng-model=$ctrl.settings.searchMode value=special>Special search (slow) </label> </div> </div> <div ng-class="{\'soft-comparison_enabled\': $ctrl.settings.searchMode === \'special\'}" class="checkbox soft-comparison soft-comparison_disabled"> <label> <input ng-model=$ctrl.settings.distanceMode ng-true-value="\'soft\'" ng-false-value="\'strict\'" ng-disabled="$ctrl.settings.searchMode!==\'special\'" class=soft-comparison__input type=checkbox>Soft comparison </label> </div> <select ng-model=$ctrl.settings.distance ng-disabled="$ctrl.settings.searchMode!==\'special\' " disabled=disabled ng-class="{\'similarity-slider_enabled\': $ctrl.settings.searchMode===\'special\'}" class="distances distances_disabled"> <option ng-repeat="distance in $ctrl.settings.supportedDistances track by $index" data-distances-distance={{$index}} value={{distance.id}}>{{distance.name}}</option> </select> <div ng-class="{\'similarity-slider_enabled\': $ctrl.settings.searchMode === \'special\'}" class="similarity-slider similarity-slider_disabled settings__similarity-level"> <div class=similarity-slider__title>Similarity level: <span>{{$ctrl.similarityLevel}}%</span></div> <rzslider rz-slider-model=$ctrl.similarityLevel rz-slider-options=$ctrl.slider.options></rzslider> </div> </div> </div> </div>'},361:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(362),n=i(r),l=o(1),a=i(l),s=function e(t,o){var i=this;(0,a.default)(this,e);var r=this;this.settings=o;var l=(0,n.default)(this.settings.serialize()).join();this.slider={value:50,options:{floor:0,ceil:100,step:1,onChange:function(){},onEnd:function(){r.settings.similarityLevel=r.similarityLevel},hidePointerLabels:!0,hideLimitLabels:!0,disabled:!0}},this.similarityLevel=o.similarityLevel,this.$doCheck=function(){r.slider.options.disabled="regular"===r.settings.searchMode;var e=(0,n.default)(r.settings.serialize()).join();e!==l&&(l=e,r.settings.save(function(){r.similarityLevel=o.similarityLevel,t.$apply()},function(e){console.log("SettingsCtrl: Error occured"),console.log(e)}))},this.$onInit=function(){o.load(function(){i.similarityLevel=o.similarityLevel,t.$apply()},function(e){console.log("SettingsCtrl: Error occured"),console.log(e)})}};t.default=s},367:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o(368);var i=o(369),r=function(e){return e&&e.__esModule?e:{default:e}}(i);angular.module("guide-page",[]).component("guidePage",{template:r.default}),t.default="guide-page"},368:function(e,t){},369:function(e,t){e.exports='<div class=guide-page> <div class="panel panel-default guide-panel guide-page__content"> <div class="panel-heading guide-panel__heading"> <h3 class=panel-title><span class="glyphicon glyphicon-info-sign"></span>&nbsp;Guide</h3> </div> <div class="panel-body guide-panel__body"> Huhu! </div> </div> </div>'},370:function(e,t){},371:function(e,t){e.exports='<div ng-controller=RoutingCtrl> <span us-spinner="{position: \'fixed\', color: \'#428bca\'}" spinner-key=spinner-1></span> <div class=app__content> <div class="header app__header"> <div ng-click=goToMain() class="logo header__logo"><div class=logo__image></div></div> <div class=header__buttons> <a class="btn btn-default header__button_left" ng-click=goToGuide()>How to use?</a> <a class="btn btn-default header__button_right" ng-click=goToSettings()>Settings <span class="glyphicon glyphicon-cog"></span></a> </div> </div> <div class=app__header-line></div> <ui-view name=pages> <main-page class=main-page ng-show="page === \'main\'"></main-page> <settings-page ng-show="page === \'settings\'"></settings-page> <guide-page ng-show="page === \'guide\'"></guide-page> </ui-view> </div> </div>'},372:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(1),n=i(r),l=o(2),a=i(l),s=o(373),c=i(s),d=function(){function e(t,o){(0,n.default)(this,e),this.required=null,this.auth=null,this.success=!1,this.user=null,this.password=null,this.jsonrpc=o,this.$q=t}return(0,a.default)(e,[{key:"isSet",value:function(){return this.user&&this.password}},{key:"isSuccessful",value:function(){return null!==this.auth&&this.success}},{key:"login",value:function(){var e=this,t=this,o=(0,c.default)(""+this.user+this.password);return this.jsonrpc.request("login",{login:o}).then(function(i){return!!i.success&&(t.auth=o,e.success=!0,!0)})}},{key:"isRequired",value:function(){var e=this;return this.required?this.$q.resolve(!0):this.jsonrpc.request("login-required",{}).then(function(t){return e.required=t.required,e.required})}}]),e}();t.default=d},376:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),o(377);var r=o(378),n=i(r),l=o(379),a=i(l),s=o(380),c=i(s);angular.module("dialog",[]).service("popupDialog",["$rootScope","$compile",function(e,t){function o(o,i,n){var a='<div class="dialog" ng-click="close($event)">\n        <div class="dialog__window">'+o+"</div></div>";r=e.$new(!0),r.$ctrl=new i,r.closeByOutside=n,r.close=function(e){angular.element(e.target).hasClass("dialog")&&r.closeByOutside&&s.close()};var c=t(a)(r);l=angular.element(c).appendTo("body")}var i=this,r=null,l=null,s=this;this.close=function(){l&&r&&(l.remove(),r.$destroy(),l=null,r=null)},this.errorDialog=function(e){i.close(),o(c.default,e,!1)},this.confirmDialog=function(e){i.close(),o(n.default,e,!0)},this.loginDialog=function(e){i.close(),o(a.default,e,!1)}}]),t.default="dialog"},377:function(e,t){},378:function(e,t){e.exports='<div class=confirm-dialog> <h4><span class="glyphicon glyphicon-question-sign"></span> Confirm <span class=confirm-dialog__title>{{$ctrl.title}}</span></h4> <p>Are you sure you want to proceed?</p> <div style=float:right> <a class="btn btn-danger" ng-click=$ctrl.cancel()>Cancel</a> <a class="btn btn-success" ng-click=$ctrl.yes()>Yes</a> </div><div style=clear:both></div> </div>'},379:function(e,t){e.exports='<div class=login-dialog> <div class=form-group><input ng-model=$ctrl.model.user type=text class=form-control placeholder=User></div> <div class=form-group><input ng-model=$ctrl.model.password type=password class=form-control placeholder=Password></div> <a ng-click=$ctrl.login() class="btn btn-success btn-block"><span class="glyphicon glyphicon-cloud-upload" aria-hidden=true></span> log in</a> </div>'},380:function(e,t){e.exports='<div class=error-dialog> <h4><span class="glyphicon glyphicon-warning-sign"></span> {{$ctrl.title}}</h4> <p>{{$ctrl.description}}</p> <a ng-show=$ctrl.button ng-click=$ctrl.handle() class="btn btn-danger btn-block"><span ng-show=$ctrl.icon ng-class="\'glyphicon glyphicon-{{$ctrl.icon}}\'"></span> {{$ctrl.buttonTitle}}</a> </div>'},381:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(382),r=function(e){return e&&e.__esModule?e:{default:e}}(i);angular.module("db",[]).service("db",["popupDialog",function(e){r.default.config({driver:[r.default.INDEXEDDB,r.default.WEBSQL,r.default.LOCALSTORAGE],name:"ColorSearch",version:1}),this.getStore=function(e){return r.default.createInstance({name:"ColorSearch",storeName:e})}}]),t.default="db"},384:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(1),n=i(r),l=o(2),a=i(l),s=function(){function e(t,o,i){(0,n.default)(this,e),this._timeWindow=t,this._callback=o,this._$window=i,this._lastEventTime=0,this._timeoutId=null}return(0,a.default)(e,[{key:"event",value:function(){var e=this,t=Date.now();t-this._lastEventTime>=this._timeWindow?(this._timeoutId&&this._$window.clearTimeout(this._timeoutId),this._lastEventTime=t,this._callback()):(this._timeoutId&&this._$window.clearTimeout(this._timeoutId),this._timeoutId=this._$window.setTimeout(function(){e._lastEventTime=t,e._callback()},this._timeWindow))}}]),e}();angular.module("event-filter",[]).factory("eventFilter",["$window",function(e){return function(t,o){return new s(t,o,e)}}]),t.default="event-filter"},58:function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(1),n=i(r),l=o(2),a=i(l),s=function(){function e(t){(0,n.default)(this,e),this.weight=1,this.h=void 0,this.s=void 0,this.l=void 0,this.achromatic=!1,t&&void 0!==t.h&&void 0!==t.s&&void 0!==t.l&&(this.h=parseInt(t.h,10),this.s=parseInt(t.s,10),this.l=parseInt(t.l,10)),t&&t.weight&&(this.weight=parseInt(t.weight,10)),t&&"boolean"==typeof t.achromatic&&(this.achromatic=t.achromatic)}return(0,a.default)(e,[{key:"toString",value:function(){if(this.isSet)return"hsl("+this.h+","+this.s+"%,"+this.l+"%)"}},{key:"toIdString",value:function(){return"hsl("+this.h+","+this.s+"%,"+this.l+"%)"+this.weight}},{key:"isSet",value:function(){return void 0!==this.h&&void 0!==this.s&&void 0!==this.l}},{key:"setH",value:function(e){return this.h=this.achromatic?0:parseInt(e,10),this}},{key:"setS",value:function(e){return this.s=this.achromatic?0:parseInt(e,10),this}},{key:"setL",value:function(e){return this.l=parseInt(e,10),this}},{key:"setWeight",value:function(e){return this.weight=parseInt(e,10),this}},{key:"setAchromatic",value:function(){return this.h=0,this.s=0,this.achromatic=!0,this}},{key:"isAchromatic",value:function(){return this.achromatic}},{key:"setColor",value:function(e){return void 0!==e.h&&void 0!==e.s&&void 0!==e.l&&(this.h=parseInt(e.h,10),this.s=parseInt(e.s,10),this.l=parseInt(e.l,10)),e.weight&&(this.weight=parseInt(e.weight,10)),e&&"boolean"==typeof e.achromatic&&(this.achromatic=e.achromatic),this}},{key:"setColorFromString",value:function(e){var t=/^hsl\(\d+(\.\d+)?,\d+(\.\d+)?%?,\d+(\.\d+)?%?\)$/i;if(e&&t.test(e)){var o=/\d+(\.\d+)?/g;this.h=parseInt(o.exec(e)[0],10),this.s=parseInt(o.exec(e)[0],10),this.l=parseInt(o.exec(e)[0],10)}return this}},{key:"reset",value:function(){return this.h=void 0,this.s=void 0,this.l=void 0,this.weight=1,this.achromatic=!1,this}},{key:"toJSON",value:function(){var e={};return e.achromatic=this.achromatic,e.l=this.l,e.s=this.s,e.h=this.h,e.weight=this.weight,e}}]),e}();t.default=s}},[177]);
//# sourceMappingURL=app.bundle.js.map
webpackJsonp([0],Array(34).concat([function(e,t){e.exports=angular},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(27),s=i(r),n=o(10),l=i(n),a=o(14),c=i(a),d=o(59),u=i(d),h=o(0),f=i(h),g=o(2),v=i(g),p=function(){function e(t,o,i,r){(0,f.default)(this,e),this.name=t,this.colors=o,this.sPercentage=i,this.lPercentage=r}return(0,v.default)(e,[{key:"countWords",value:function(){return this.colors.size}},{key:"getColor",value:function(e){return this.colors.get(e)}},{key:"deleteWord",value:function(e){this.colors.delete(e)}},{key:"serialize",value:function(){var e=this,t={};return t.name=this.name,t.colors=[].concat((0,u.default)(e.colors)),t.sPercentage=this.sPercentage,t.lPercentage=this.lPercentage,t}}],[{key:"deserialize",value:function(t,o){var i=new c.default(t.colors),r=!0,n=!1,a=void 0;try{for(var d,u=(0,l.default)(i);!(r=(d=u.next()).done);r=!0){var h=(0,s.default)(d.value,2),f=h[0],g=h[1];i.set(f,o.getColorInstance(g))}}catch(e){n=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(n)throw a}}var v=Math.round(parseFloat(t.sPercentage)),p=Math.round(parseFloat(t.lPercentage));return new e(t.name,i,v,p)}}]),e}();t.default=p},,function(e,t,o){"use strict";o(124);var i=o(126),r=function(e){return e&&e.__esModule?e:{default:e}}(i);angular.module("app",[r.default])},function(e,t){},,function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),s=i(r),n=o(2),l=i(n),a=o(132),c=i(a);o(159);var d=o(160),u=i(d),h=o(161),f=i(h),g=o(162),v=i(g),p=o(197),m=i(p),_=o(203),y=i(_),w=o(208),$=i(w),C=o(255),k=i(C),b=o(258),P=i(b);o(268);var S=o(269),x=i(S),I=o(270),M=i(I),N=o(274),W=i(N),A=o(279),T=i(A);angular.module("color-search",[c.default,y.default,P.default,$.default,k.default,W.default,T.default,"angularSpinner"]).config(u.default).config(["$JsonRpcProvider",function(e){e.set({url:"/"})}]).service("colorService",v.default).service("appSettings",["db",f.default]).service("textColors",["colorService",m.default]).service("login",["$q","jsonrpc",M.default]).component("colorSearch",{template:x.default,controller:function(){function e(t,o,i,r,n,l,a){var c=this;(0,s.default)(this,e),this.$rootScope=t,this.$timeout=o,this.$window=i,this.$state=n,this._login=l,this._dialog=a,this.page="main",r.onSuccess({},function(e){var i=e.to().data;c.page=i.page,o(function(){t.$broadcast("rzSliderForceRender"),t.$broadcast("refresh")},0,!1)})}return(0,l.default)(e,null,[{key:"$inject",get:function(){return["$rootScope","$timeout","$window","$transitions","$state","login","popupDialog"]}}]),(0,l.default)(e,[{key:"$onInit",value:function(){var e=this;angular.element(this.$window).bind("resize orientationchange",function(){e.$timeout(function(){e.$rootScope.$broadcast("rzSliderForceRender"),e.$rootScope.$broadcast("refresh")})})}},{key:"$postLink",value:function(){var e=this;this._login.isRequired().then(function(t){t&&e.openLoginDialog()}).catch(function(t){console.log(t);var o=e;e._dialog.errorDialog(function(){this.title="Connection error",this.description="Try to reload the application.",this.buttonTitle="Reload",this.button=!0,this.icon="refresh",this.handle=function(){o.$window.location.reload(!0)}})})}},{key:"goToSettings",value:function(){this.page="profiles",this.$state.go("main.profiles")}},{key:"goToGuide",value:function(){this.page="guide",this.$state.go("main.guide")}},{key:"goToMain",value:function(){this.page="main",this.$state.go("main")}},{key:"openLoginDialog",value:function(){var e=this;this._dialog.loginDialog(function(){var t=this;this.model=e._login,this.login=function(){t.model.isSet()&&t.model.login().then(function(t){t&&e._dialog.close()})}})}}]),e}()}),t.default="color-search"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,o){"use strict";function i(e,t){var o={name:"main",url:"/main",data:{page:"main"}},i={name:"main.profiles",url:"^/profiles",data:{page:"profiles"}},r={name:"main.guide",url:"^/guide",data:{page:"guide"}};e.state(o),e.state(i),e.state(r),t.otherwise("/main")}Object.defineProperty(t,"__esModule",{value:!0}),i.$inject=["$stateProvider","$urlRouterProvider"],t.default=i},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),s=i(r),n=o(2),l=i(n),a=function(){function e(t){(0,s.default)(this,e),this.store="settings",this.db=t}return(0,l.default)(e,[{key:"loadSettings",value:function(e,t,o){this.db.getStore(this.store).getItem("settings").then(function(o){e.deserialize(o),t&&t()}).catch(function(e){console.warn(e),o&&o()})}},{key:"saveSettings",value:function(e,t,o){this.db.getStore(this.store).setItem("settings",e.serialize()).then(function(){t&&t()}).catch(function(e){console.warn(e),o&&o()})}}]),e}(),c=function(){function e(t){(0,s.default)(this,e),this.module="settings",this.dao=new a(t),this.checkSemanticSimilarity=!1,this.searchMode="regular",this.similarityLevel=85,this.distance="euclidean",this.supportedDistances=[{id:"euclidean",name:"Euclidean"},{id:"chisquare",name:"Chi-Square"}]}return(0,l.default)(e,[{key:"load",value:function(e,t){this.dao.loadSettings(this,e,t)}},{key:"save",value:function(e,t){this.dao.saveSettings(this,e,t)}},{key:"serialize",value:function(){var e={};return e.module="settings",e.checkSemanticSimilarity=this.checkSemanticSimilarity,e.searchMode=this.searchMode,e.similarityLevel=this.similarityLevel,e.distance=this.distance,e.distanceMode=this.distanceMode,e}},{key:"deserialize",value:function(e){e?(this.editorFontSize=e.editorFontSize,this.checkSemanticSimilarity=e.checkSemanticSimilarity,this.searchMode=e.searchMode,this.similarityLevel=e.similarityLevel,this.distance=e.distance):console.warn("Settings not loaded")}},{key:"getSearchSettings",value:function(){var e={};return e.checkSemanticSimilarity=this.checkSemanticSimilarity,e.searchMode=this.searchMode,e.similarityLevel=this.similarityLevel,e.distance=this.distance,e.distanceMode=this.distanceMode,e}}]),e}();t.default=c},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),s=i(r),n=o(2),l=i(n),a=o(163),c=i(a),d=o(165),u=i(d),h=o(166),f=i(h),g=function(){function e(){(0,s.default)(this,e)}return(0,l.default)(e,[{key:"getColorInstance",value:function(e){return new u.default(e)}},{key:"getColorSetInstance",value:function(){return new f.default}},{key:"hslToHexString",value:function(e){return c.default.fromHsl(e.h,e.s,e.l).toHex()}},{key:"hexToHsl",value:function(e){return c.default.fromHex(e).toHsl()}},{key:"hslToHslString",value:function(e){return"hsl("+e.h+","+e.s+"%,"+e.l+"%)"}},{key:"hslToRgb",value:function(e){return c.default.fromHslObject(e).toRgbObject()}},{key:"rgbToHex",value:function(e){return c.default.fromRgbObject(e).toHex()}},{key:"colorWithGreaterCR",value:function(e){for(var t=e,o=arguments.length,i=Array(o>1?o-1:0),r=1;r<o;r++)i[r-1]=arguments[r];if(i&&i.length>0){t=i[0];for(var s=this.cr(e,i[0]),n=0;n<i.length;n++){var l=this.cr(e,i[n]);s<l&&(s=l,t=i[n])}}return t}},{key:"cr",value:function(e,t){var o=this._luminanceRGB(e.r,e.g,e.b),i=this._luminanceRGB(t.r,t.g,t.b);if(i>o){var r=[i,o];o=r[0],i=r[1]}return(o+.05)/(i+.05)}},{key:"_luminanceRGB",value:function(e,t,o){var i=e/255,r=t/255,s=o/255;return.2126*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))+.7152*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.0722*(s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4))}}]),e}();t.default=g},,,function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),s=i(r),n=o(2),l=i(n),a=function(){function e(t){(0,s.default)(this,e),this.weight=1,this.h=void 0,this.s=void 0,this.l=void 0,this.achromatic=!1,t&&void 0!==t.h&&void 0!==t.s&&void 0!==t.l&&(this.h=parseInt(t.h,10),this.s=parseInt(t.s,10),this.l=parseInt(t.l,10)),t&&t.weight&&(this.weight=parseInt(t.weight,10)),t&&"boolean"==typeof t.achromatic&&(this.achromatic=t.achromatic)}return(0,l.default)(e,[{key:"toString",value:function(){if(this.isSet)return"hsl("+this.h+","+this.s+"%,"+this.l+"%)"}},{key:"toIdString",value:function(){return"hsl("+this.h+","+this.s+"%,"+this.l+"%)"+this.weight}},{key:"isSet",value:function(){return void 0!==this.h&&void 0!==this.s&&void 0!==this.l}},{key:"setH",value:function(e){return this.h=!0===this.achromatic?0:parseInt(e,10),this}},{key:"setS",value:function(e){return this.s=!0===this.achromatic?0:parseInt(e,10),this}},{key:"setL",value:function(e){return this.l=parseInt(e,10),this}},{key:"setWeight",value:function(e){return this.weight=parseInt(e,10),this}},{key:"setAchromatic",value:function(){return this.h=0,this.s=0,this.achromatic=!0,this}},{key:"isAchromatic",value:function(){return this.achromatic}},{key:"setColor",value:function(e){return e&&"boolean"==typeof e.achromatic&&(this.achromatic=e.achromatic),void 0!==e.h&&void 0!==e.s&&void 0!==e.l&&(this.setH(e.h),this.setS(e.s),this.setL(e.l)),e.weight&&this.setWeight(e.weight),this}},{key:"setColorFromString",value:function(e){var t=/^hsl\(\d+(\.\d+)?,\d+(\.\d+)?%?,\d+(\.\d+)?%?\)$/i;if(e&&t.test(e)){var o=/\d+(\.\d+)?/g;this.h=parseInt(o.exec(e)[0],10),this.s=parseInt(o.exec(e)[0],10),this.l=parseInt(o.exec(e)[0],10)}return this}},{key:"interpolateS",value:function(e){return this.setS(this._interpolate(this.s,e)),this}},{key:"interpolateL",value:function(e){return this.setL(this._interpolate(this.l,e)),this}},{key:"_interpolate",value:function(e,t){var o=t<=100?t/100:(t-100)/100;return t<=100?e*o:e*(1-o)+100*o}},{key:"reset",value:function(){return this.h=void 0,this.s=void 0,this.l=void 0,this.weight=1,this.achromatic=!1,this}},{key:"toJSON",value:function(){var e={};return e.achromatic=this.achromatic,e.l=this.l,e.s=this.s,e.h=this.h,e.weight=this.weight,e}}]),e}();t.default=a},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(59),s=i(r),n=o(181),l=i(n),a=o(14),c=i(a),d=o(0),u=i(d),h=o(2),f=i(h),g=function(){function e(){(0,u.default)(this,e),this.map=new c.default,this[l.default]=this.values}return(0,f.default)(e,[{key:"add",value:function(e){this.map.set(e.toIdString(),e)}},{key:"values",value:function(){return this.map.values()}},{key:"getValuesArray",value:function(){return[].concat((0,s.default)(this.map.values()))}},{key:"size",value:function(){return this.map.size}}]),e}();t.default=g},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(59),s=i(r),n=o(27),l=i(n),a=o(10),c=i(a),d=o(14),u=i(d),h=o(0),f=i(h),g=o(2),v=i(g),p=function(){function e(t){(0,f.default)(this,e),this._words=[],this._sPercentage=100,this._lPercentage=100,this._colorService=t,this.colorOccurence=new u.default,this.adjustedColorOccurence=new u.default}return(0,v.default)(e,[{key:"setSLPercentage",value:function(e,t){this._sPercentage=e,this._lPercentage=t,this.calculateAdjustedColors()}},{key:"clear",value:function(){this._words.length=0,this.colorOccurence.clear(),this.adjustedColorOccurence.clear()}},{key:"update",value:function(e,t,o){if(this.clear(),e&&e.size>0){var i=!0,r=!1,s=void 0;try{for(var n,a=(0,c.default)(e.entries());!(i=(n=a.next()).done);i=!0){var d=(0,l.default)(n.value,2),u=(d[0],d[1]);if(u.color&&u.color.isSet()){this._words.push(u.word);var h=this.colorOccurence.get(u.color.toString());h?h.setWeight(h.weight+u.color.weight):(h=this._colorService.getColorInstance(u.color),this.colorOccurence.set(h.toString(),h))}}}catch(e){r=!0,s=e}finally{try{!i&&a.return&&a.return()}finally{if(r)throw s}}}this.sPercentage="number"==typeof t?t:this.sPercentage,this.lPercentage="number"==typeof o?o:this.lPercentage,this.calculateAdjustedColors()}},{key:"calculateAdjustedColors",value:function(){this.adjustedColorOccurence.clear();var e=!0,t=!1,o=void 0;try{for(var i,r=(0,c.default)(this.colorOccurence.values());!(e=(i=r.next()).done);e=!0){var s=i.value,n=this._colorService.getColorInstance(s);n.interpolateS(this.sPercentage).interpolateL(this.lPercentage),s.isAchromatic()&&n.setAchromatic(),this.adjustedColorOccurence.set(n.toString(),n)}}catch(e){t=!0,o=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw o}}}},{key:"words",get:function(){return this._words}},{key:"colors",get:function(){return[].concat((0,s.default)(this.adjustedColorOccurence.values()))}},{key:"colorsAndWords",get:function(){var e={};return e.colors=this.colors,e.words=this.words,e}},{key:"sPercentage",get:function(){return this._sPercentage},set:function(e){this._sPercentage=e,this.calculateAdjustedColors()}},{key:"lPercentage",get:function(){return this._lPercentage},set:function(e){this._lPercentage=e,this.calculateAdjustedColors()}}]),e}();t.default=p},,,,,,function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(204),s=i(r),n=o(0),l=i(n),a=function e(t){(0,l.default)(this,e),this.name="jsonRpcException",this.message=t};angular.module("jsonrpc",[]).provider("$JsonRpc",function(){var e="";this.set=function(t){e=t.url},this.$get=function(){return{url:e}}}).service("jsonrpc",["$q","$http","$JsonRpc",function(e,t,o){function i(e,t){return l+=1,{jsonrpc:"2.0",id:l,method:e,params:t}}function r(e){var t=["jsonrpc","id","result"],o=(0,s.default)(e),i=!1;return o.length===t.length&&(i=!0,o.forEach(function(o){t.indexOf(o)<0&&(i=!1),"jsonrpc"===o&&"2.0"!==e[o]&&(i=!1)})),i}var n=o.url;if(!n)throw new a("Please configure server url");var l=0;this.request=function(o,s){var l=e.defer(),c={method:"POST",url:n,headers:{"Content-Type":"application/json"},data:i(o,s)};return t(c).then(function(e){var t=e.data;e&&t?t&&void 0!==t.result?r(t)?l.resolve(t.result):l.reject(new a("JSON-RPC 2.0 data format must be used.")):(console.log(t),l.reject(new a("No data received. HTTP status code: "+t.error.status))):l.reject(new a("Unknown Error occured. No data received"))},function(e){e?l.reject(new a("Error occured. HTTP status code: "+e.status)):l.reject(new a("Unknown Error occurred"))}),l.promise}}]),t.default="jsonrpc"},,,,,function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(10),s=i(r),n=o(14),l=i(n),a=o(0),c=i(a),d=o(2),u=i(d);o(209);var h=o(210),f=i(h),g=o(211),v=i(g),p=o(217),m=i(p),_=o(232),y=i(_),w=o(235),$=i(w),C=o(247),k=i(C);angular.module("main",[v.default,m.default,y.default,$.default,k.default]).factory("calculateFontColor",["colorService",function(e){return function(t){var o=e.colorWithGreaterCR(e.hslToRgb(t),{r:0,g:0,b:0},{r:255,g:255,b:255});return e.rgbToHex(o)}}]).component("main",{template:f.default,controller:function(){function e(t,o,i,r,s,n,a){(0,c.default)(this,e),this.$rootScope=t,this.$scope=o,this.$timeout=i,this._colorService=n,this._dialog=a,this.textColors=r,this.appSettings=s,this.colors=new l.default,this.settingsOpened=!1,this.selectedWord={},this.textColorizer=null,this.selectedColor=null,this.searchData=null,this.resultFound=null}return(0,u.default)(e,null,[{key:"$inject",get:function(){return["$rootScope","$scope","$timeout","textColors","appSettings","colorService","popupDialog"]}}]),(0,u.default)(e,[{key:"toggleSettings",value:function(){var e=this;this.settingsOpened=!this.settingsOpened,this.$timeout(function(){e.$scope.$broadcast("rzSliderForceRender")},0,!1)}},{key:"loadColorProfile",value:function(e,t,o){var i=this,r=this.getColorizer();r.setColors(e,function(){i._updateColors(),i.textColors.update(r.getAllColors(),t,o),i.$scope.$broadcast("colorsChainged")})}},{key:"selectWord",value:function(e){this.selectedWord=e}},{key:"colorModified",value:function(e,t){var o=this,i=this.getColorizer();e&&i&&(e.isSet()?i.setColor(this.selectedWord,e,t,function(){o.textColors.update(i.getAllColors()),o.$scope.$broadcast("colorsChainged")}):i.resetColor(this.selectedWord,t,function(){o.textColors.update(i.getAllColors()),o.$scope.$broadcast("colorsChainged")}),this._updateColors())}},{key:"inputComplete",value:function(){var e=this,t=this.getColorizer();t.inputComplete(function(){e._updateColors(),e.textColors.update(t.getAllColors()),e.$scope.$broadcast("colorsChainged")})}},{key:"drop",value:function(){var e=this;this.getColorizer().clear(function(){e._updateColors(),e.textColors.clear(),e.$scope.$broadcast("colorsChainged")})}},{key:"dropDialog",value:function(){var e=this;this._dialog.confirmDialog(function(){this.yes=function(){e.drop(),e._dialog.close()},this.cancel=function(){e._dialog.close()},this.title='"drop"'})}},{key:"decolorizeDialog",value:function(){var e=this;this.textColors.colors.length>0&&this._dialog.confirmDialog(function(){this.yes=function(){e.decolorizeText(),e._dialog.close()},this.cancel=function(){e._dialog.close()},this.title='"clear"'})}},{key:"decolorizeText",value:function(){var e=this;this.getColorizer().resetAllColors(function(){e._updateColors(),e.textColors.clear(),e.$scope.$broadcast("colorsChainged")})}},{key:"edit",value:function(){this.getColorizer().editMode()}},{key:"search",value:function(){var e=this,t=this.textColors.colorsAndWords;this.appSettings.checkSemanticSimilarity||(t.words=[]),this.searchData={words:t,settings:e.appSettings}}},{key:"imagesFound",value:function(e){this.resultFound=e.length>0}},{key:"getColorizer",value:function(){var e=this;return this.textColorizer||this.$scope.$broadcast("text-colorizer",function(t){e.textColorizer=t}),this.textColorizer}},{key:"_updateColors",value:function(){var e=this.getColorizer(),t=e.getAllColors();this.colors.clear();var o=!0,i=!1,r=void 0;try{for(var n,l=(0,s.default)(t.values());!(o=(n=l.next()).done);o=!0){var a=n.value,c=a.word.toLowerCase(),d=a.color,u=this.colors.get(c);if(u)u.add(d);else{var h=this._colorService.getColorSetInstance();h.add(d),this.colors.set(c,h)}}}catch(e){i=!0,r=e}finally{try{!o&&l.return&&l.return()}finally{if(i)throw r}}}}]),e}()}),t.default="main"},function(e,t){},function(e,t){e.exports='<div class=main> <color-toolbar closed=true input-color=$ctrl.selectedWord.color color-modified="$ctrl.colorModified(color, linking)" on-close="$ctrl.selectedWord=null"></color-toolbar> <div class=main__colorizer> <text-colorizer on-wordselect=$ctrl.selectWord(word)></text-colorizer> <div class=main__colorizer-controls> <a class="btn-bodyless btn-bodyless-success main__colorizer-button" ng-click=$ctrl.inputComplete()><span class="glyphicon glyphicon-ok"></span> Go!</a><span class=main__colorizer-separator></span> <a class="btn-bodyless main__colorizer-button" ng-click=$ctrl.edit()><span class="glyphicon glyphicon-pencil"></span> Edit</a><span class=main__colorizer-separator></span> <a class="btn-bodyless btn-bodyless-danger main__colorizer-button" ng-click=$ctrl.decolorizeDialog()><span class="glyphicon glyphicon-remove"></span> Clear</a><span class=main__colorizer-separator></span> <a class="btn-bodyless btn-bodyless-danger main__colorizer-button" ng-click=$ctrl.dropDialog()><span class="glyphicon glyphicon-trash"></span> Drop</a> </div> </div> <div class="main__adjustments-section main__section"> <div class=main__section-content> <div class=main__section-title> <div class=main__section-label>Adjustments & Profiles</div> </div> <div class=main__adjustments> <div class=main__adjustments-content> <color-adjuster class=main__adjuster></color-adjuster> <div class=main__profiles> <color-profiles colors=$ctrl.colors on-load-profile="$ctrl.loadColorProfile(colors, sPercentage, lPercentage)"></color-profiles> </div> </div> </div> </div> </div> <div class="main__settings-section main__section"> <div class=main__section-content> <div class=main__section-title> <div ng-click=$ctrl.toggleSettings() class="main__section-label main__settings-label"><span ng-class="$ctrl.settingsOpened ? \'dropup\' : \'dropdown\'"><span class="caret main__caret"></span></span> Settings</div> </div> <div class=main__settings ng-show=$ctrl.settingsOpened> <div class=main__settings-content> <settings></settings> </div> </div> </div> </div> <div class=main__find-container> <a class="btn btn-success main__find-button" ng-click=$ctrl.search()><span class="glyphicon glyphicon-search"></span> Search!</a> </div> <div ng-show=$ctrl.resultFound class=main__image-finder> <image-finder search=$ctrl.searchData on-images-found=$ctrl.imagesFound(images)></image-finder> </div> </div>'},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(27),s=i(r),n=o(10),l=i(n),a=o(14),c=i(a),d=o(0),u=i(d),h=o(2),f=i(h);o(212);var g=o(213),v=i(g),p=o(119),m=i(p);o(215);var _=o(216),y=i(_);angular.module("color-adjuster",[m.default,v.default]).component("colorAdjuster",{template:y.default,controller:function(){function e(t,o,i,r){var s=this;(0,u.default)(this,e),this.$scope=t,this.$timeout=o,this._colorService=i,this.textColors=r,this.chart={};var n=this;this.chart.options={showLabel:!1,donut:!0,donutWidth:40,donutSolid:!0,startAngle:270},this.chart.data={},this.chart.events={draw:function(e){"slice"===e.type&&e.element.attr({style:"fill: "+e.meta})}},this.chart.responsive=[["screen and (min-width: 500px)",{donutWidth:30}]],this.slider={value:50,options:{floor:0,ceil:200,step:1,onChange:function(){r.calculateAdjustedColors(),n._colorsChanged()},onEnd:function(){r.calculateAdjustedColors(),n._colorsChanged()},hidePointerLabels:!0,hideLimitLabels:!0,disabled:!1}},this.$scope.$on("colorsChainged",this._colorsChanged.bind(this)),this.$scope.$on("refresh",function(){s.chart.data={},s._colorsChanged()})}return(0,f.default)(e,null,[{key:"$inject",get:function(){return["$scope","$timeout","colorService","textColors"]}}]),(0,f.default)(e,[{key:"toggle",value:function(){var e=this;this.$timeout(function(){e.$scope.$broadcast("rzSliderForceRender")},0,!1)}},{key:"getS",value:function(){return this.textColors.sPercentage<100?"-"+Math.abs(this.textColors.sPercentage-100):"+"+Math.abs(this.textColors.sPercentage-100)}},{key:"getL",value:function(){return this.textColors.lPercentage<100?"-"+Math.abs(this.textColors.lPercentage-100):"+"+Math.abs(this.textColors.lPercentage-100)}},{key:"_colorsChanged",value:function(){var e=new c.default,t=[],o=!0,i=!1,r=void 0;try{for(var n,a=(0,l.default)(this.textColors.adjustedColorOccurence.entries());!(o=(n=a.next()).done);o=!0){var d=(0,s.default)(n.value,2),u=d[0],h=d[1],f=this._colorService.getColorInstance().setColorFromString(u),g=this._colorService.hslToHexString(f),v=e.has(g)?e.get(g):0;v+=h.weight,e.set(g,v)}}catch(e){i=!0,r=e}finally{try{!o&&a.return&&a.return()}finally{if(i)throw r}}var p=!0,m=!1,_=void 0;try{for(var y,w=(0,l.default)(e);!(p=(y=w.next()).done);p=!0){var $=(0,s.default)(y.value,2),C=$[0],k=$[1];t.push({value:k,meta:C})}}catch(e){m=!0,_=e}finally{try{!p&&w.return&&w.return()}finally{if(m)throw _}}this.chart.data.series=t}}]),e}()}),t.default="color-adjuster"},function(e,t){},,,function(e,t){},function(e,t){e.exports='<div class=color-adjuster> <div class=color-adjuster__chart><chartist class="ct-chart ct-square chart" chartist-events=$ctrl.chart.events chartist-data=$ctrl.chart.data chartist-chart-options=$ctrl.chart.options chartist-responsive-options=$ctrl.chart.responsive chartist-chart-type=Pie></chartist></div> <div class="sliders color-adjuster__sliders"> <div class=color-adjuster__sliders-content> <div class=color-adjuster__slider> <div><span class="glyphicon glyphicon-signal"></span> <span>{{$ctrl.getS()}}%</span></div> <rzslider rz-slider-model=$ctrl.textColors.sPercentage rz-slider-options=$ctrl.slider.options></rzslider> </div> <div class=color-adjuster__slider> <div><span class="glyphicon glyphicon-adjust icon-flipped"></span> <span>{{$ctrl.getL()}}%</span></div> <rzslider rz-slider-model=$ctrl.textColors.lPercentage rz-slider-options=$ctrl.slider.options></rzslider> </div> </div> </div> </div> '},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(27),s=i(r),n=o(10),l=i(n),a=o(218),c=i(a),d=o(0),u=i(d),h=o(2),f=i(h);o(224);var g=o(225),v=i(g),p=o(226),m=i(p),_=o(227),y=i(_),w=o(228),$=i(w),C=o(229),k=i(C);angular.module("text-colorizer",[]).component("textColorizer",{template:v.default,bindings:{onWordselect:"&"},controller:function(){function e(t,o,i,r,s,n){(0,u.default)(this,e),this.$scope=t,this.$element=o,this.$timeout=i,this.$window=r,this.$=angular.element,this.$root=this.$(o).find(".text-colorizer__text"),this.words=new m.default(n,s),this.caret=new y.default(r),this.helper=new $.default(r,this.$,this.$root,this.caret),this.parser=new k.default(this.$,r,this.$root,n,this.words),this.editMode=!0}return(0,f.default)(e,null,[{key:"$inject",get:function(){return["$scope","$element","$timeout","$window","calculateFontColor","colorService"]}}]),(0,f.default)(e,[{key:"$onInit",value:function(){this.switchToEditMode()}},{key:"_api",value:function(){var e=this;return{inputComplete:function(t){e.inputComplete(t)},editMode:function(){e.switchToEditMode()},setColor:function(t,o,i,r){e.setColor(t,o,i,r)},resetColor:function(t,o,i){e.resetColor(t,o,i)},resetAllColors:function(t){e.resetAllColors(t)},getAllColors:function(){return e.getAllColors()},setColors:function(t,o){e.setColors(t,o)},clear:function(t){e.clear(t)},hasColors:function(){return e.getAllColors().size>0}}}},{key:"$postLink",value:function(){var e=this;this.helper.observeEditorChanges(),this.$scope.$on("text-colorizer",function(t,o){"function"==typeof o&&o(e._api())})}},{key:"handleMouseDown",value:function(e){this.editMode&&e.detail>1&&(e.preventDefault(),this.helper.doubleClick(e.originalEvent))}},{key:"handlePaste",value:function(e){this.helper.handlePaste(e)}},{key:"handleKeyDown",value:function(e){this.helper.handleKeyDown(e)}},{key:"inputComplete",value:function(e){var t=this;this.editMode=!1,this.parser.parse();var o=new c.default;this.$root.find("[data-word]").each(function(e,i){var r=t.$(i).attr("data-word"),s=parseInt(r,10);o.add(s);var n=i.nextSibling;n&&3!==n.nodeType&&t.$(i).after(" ")});var i=this.words.getIds(),r=!0,s=!1,n=void 0;try{for(var a,d=(0,l.default)(i);!(r=(a=d.next()).done);r=!0){var u=a.value;o.has(u)||this.words.removeWordNode(u)}}catch(e){s=!0,n=e}finally{try{!r&&d.return&&d.return()}finally{if(s)throw n}}e&&e()}},{key:"switchToEditMode",value:function(){this.editMode=!0,this.$root.attr("contentEditable",!0),this.helper.removeEmptyLast(this.$root);var e=this.helper.getLast(this.$root),t=e&&e[0]?e[0].nodeType:void 0;if(3===t)this.caret.moveTo(e[0]);else if(t){var o=this.$window.document.createTextNode(" ");e.after(o),this.caret.moveTo(o)}this.$root[0].focus()}},{key:"setColor",value:function(e,t,o,i){!this.editMode&&e&&(o?this.words.setColor(e.id,t):this.words.setColorOnce(e.id,t),i&&i())}},{key:"setColors",value:function(e,t){var o=this;this.inputComplete(function(){var i=!0,r=!1,n=void 0;try{for(var a,c=(0,l.default)(e);!(i=(a=c.next()).done);i=!0){var d=(0,s.default)(a.value,2),u=d[0],h=d[1];o.words.setColorByWord(u,h)}}catch(e){r=!0,n=e}finally{try{!i&&c.return&&c.return()}finally{if(r)throw n}}t&&t()})}},{key:"getAllColors",value:function(){return this.words.getAllWordNodes()}},{key:"resetColor",value:function(e,t,o){!this.editMode&&e&&(t?this.words.resetColor(e.id):this.words.resetOneColor(e.id)),o&&o()}},{key:"resetAllColors",value:function(e){this.words.resetAllColors(),e&&e()}},{key:"selectWord",value:function(e){e.stopPropagation();var t=this.$(e.target);if(t.is("[data-word]"))if(this.editMode)this.helper.clickOnWord(t);else{var o=t.attr("data-word"),i=this.words.getWordNode(parseInt(o,10));this.onWordselect({word:i})}}},{key:"clear",value:function(e){this.words.clear(),this.$root.empty(),this.switchToEditMode(),e&&e()}}]),e}()}),t.default="text-colorizer"},,,,,,,function(e,t){},function(e,t){e.exports='<div class=text-colorizer__text ng-click=$ctrl.selectWord($event) ng-mousedown=$ctrl.handleMouseDown($event) ng-keydown=$ctrl.handleKeyDown($event) ng-paste=$ctrl.handlePaste($event) contenteditable={{$ctrl.editMode}} spellcheck=false placeholder="Insert text here..."></div> '},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(10),s=i(r),n=o(14),l=i(n),a=o(0),c=i(a),d=o(2),u=i(d),h=function(){function e(t,o){(0,c.default)(this,e),this.wordNodes=new l.default,this.wordToWordNodes=new l.default,this.colorFactory=t,this.calcFontColor=o}return(0,u.default)(e,[{key:"updateWordNode",value:function(e,t){var o=this.wordNodes.get(e);o&&(o.$domNode=t)}},{key:"getWordNodes",value:function(e){return this.wordToWordNodes.get(e)}},{key:"getWordNode",value:function(e){return this.wordNodes.get(e)}},{key:"getIds",value:function(){return this.wordNodes.keys()}},{key:"getAllWordNodes",value:function(){return this.wordNodes}},{key:"getWordsToWordNodesMap",value:function(){return this.wordToWordNodes}},{key:"addWordNode",value:function(e){this.wordNodes.set(e.id,e),this.wordToWordNodes.has(e.word)||this.wordToWordNodes.set(e.word,new l.default),this.wordToWordNodes.get(e.word).set(e.id,e)}},{key:"removeWordNode",value:function(e){this.wordNodes.delete(e);var t=!0,o=!1,i=void 0;try{for(var r,n=(0,s.default)(this.wordToWordNodes.values());!(t=(r=n.next()).done);t=!0){var l=r.value;if(l.has(e)){l.delete(e);break}}}catch(e){o=!0,i=e}finally{try{!t&&n.return&&n.return()}finally{if(o)throw i}}}},{key:"resetColor",value:function(e){var t=this.wordNodes.get(e),o=this.wordToWordNodes.get(t.word),i=!0,r=!1,n=void 0;try{for(var l,a=(0,s.default)(o.values());!(i=(l=a.next()).done);i=!0)l.value.resetColor()}catch(e){r=!0,n=e}finally{try{!i&&a.return&&a.return()}finally{if(r)throw n}}}},{key:"resetOneColor",value:function(e){this.wordNodes.get(e).resetColor()}},{key:"setColorOnce",value:function(e,t){var o=this.calcFontColor(t);this.wordNodes.get(e).setColor(t,o)}},{key:"setColor",value:function(e,t){var o=this.wordNodes.get(e);this.setColorByWord(o.word,t)}},{key:"setColorByWord",value:function(e,t){var o=this.wordToWordNodes.get(e);if(o){var i=this.calcFontColor(t),r=!0,n=!1,l=void 0;try{for(var a,c=(0,s.default)(o.values());!(r=(a=c.next()).done);r=!0)a.value.setColor(t,i)}catch(e){n=!0,l=e}finally{try{!r&&c.return&&c.return()}finally{if(n)throw l}}}}},{key:"resetAllColors",value:function(){var e=!0,t=!1,o=void 0;try{for(var i,r=(0,s.default)(this.wordNodes.values());!(e=(i=r.next()).done);e=!0)i.value.resetColor()}catch(e){t=!0,o=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw o}}}},{key:"clear",value:function(){this.wordNodes.clear(),this.wordToWordNodes.clear()}}]),e}();t.default=h},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),s=i(r),n=o(2),l=i(n),a=function(){function e(t){(0,s.default)(this,e),this.$window=t}return(0,l.default)(e,[{key:"moveTo",value:function(e){var t=this.$window.document.createRange(),o=this.$window.getSelection();t.setStartAfter(e),t.setEndAfter(e),o.removeAllRanges(),o.addRange(t)}},{key:"moveInText",value:function(e,t){var o=e,i=this.$window.document.createRange();i.setStart(t,o),i.collapse(!0);var r=this.$window.getSelection();r.removeAllRanges(),r.addRange(i)}},{key:"insertTextAtCursor",value:function(e){var t=this.$window.getSelection(),o=t.getRangeAt(0),i=this.$window.document.createTextNode(e);o.insertNode(i),o.setStartAfter(i),o.setEndAfter(i),t.removeAllRanges(),t.addRange(o)}},{key:"insertTextNodeAtCursor",value:function(e){var t=this.$window.getSelection(),o=t.getRangeAt(0);o.insertNode(e),o.setStartAfter(e),o.setEndAfter(e),t.removeAllRanges(),t.addRange(o)}},{key:"getCaretCharacterOffsetWithin",value:function(e){var t=0,o=e.ownerDocument||e.document,i=o.defaultView||o.parentWindow,r=void 0;if(void 0!==i.getSelection){if(r=i.getSelection(),r.rangeCount>0){var s=i.getSelection().getRangeAt(0),n=s.cloneRange();n.selectNodeContents(e),n.setEnd(s.endContainer,s.endOffset),t=n.toString().length}}else if((r=o.selection)&&"Control"!=r.type){var l=r.createRange(),a=o.body.createTextRange();a.moveToElementText(e),a.setEndPoint("EndToEnd",l),t=a.text.length}return t}}]),e}();t.default=a},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(10),s=i(r),n=o(0),l=i(n),a=o(2),c=i(a),d=function(){function e(t,o,i,r){(0,l.default)(this,e),this.$window=t,this.root=i,this.$=o,this.caret=r}return(0,c.default)(e,[{key:"handleKeyDown",value:function(e){var t=this.$window.getSelection().anchorNode,o=t&&t.parentNode?t.parentNode:null;13===e.keyCode&&this.$(o).is("[data-word]")&&e.preventDefault()}},{key:"observeEditorChanges",value:function(){var e=this,t=new MutationObserver(function(t){t.forEach(function(t){var o="true"===e.root.attr("contentEditable");if("childList"===t.type&&o){var i=t.addedNodes,r=!0,n=!1,l=void 0;try{for(var a,c=(0,s.default)(i);!(r=(a=c.next()).done);r=!0){var d=a.value;("FONT"===d.nodeName||"SPAN"===d.nodeName&&d.parentNode&&"FONT"!==d.parentNode.nodeName)&&e.replaceElementWithTextContent(d)}}catch(e){n=!0,l=e}finally{try{!r&&c.return&&c.return()}finally{if(n)throw l}}}})}),o={childList:!0};t.observe(this.root[0],o)}},{key:"replaceElementWithTextContent",value:function(e){var t=this.$(e),o=t.text(),i=this.$window.document.createTextNode(o);t.replaceWith(i);var r=this.$window.getSelection().anchorNode;r&&3===r.nodeType&&this.caret.moveTo(i)}},{key:"doubleClick",value:function(e){var t=this.$window.getSelection(),o=t.anchorNode,i=null;this.$(o).is("[data-word]")?i=o:this.$(o.parentNode).is("[data-word]")?i=o.parentNode:this.$(e.target).is("[data-word]")&&(i=e.target);var r=this.$window.document.createTextNode(" ");if(i){if(i&&!this.$(o).is(this.root)){var s=this.caret.getCaretCharacterOffsetWithin(i),n=this.$(i).text();s===n.length?(this.$(i).after(r),this.caret.moveTo(r)):0===s&&(this.$(i).before(r),this.caret.moveTo(r))}}else this.caret.insertTextNodeAtCursor(r),this.caret.moveTo(r)}},{key:"handlePaste",value:function(e){e.preventDefault(),e.stopPropagation();var t=e.target;if(!this.$(t).is("[data-word]")){var o="";e.clipboardData||e.originalEvent.clipboardData?o=(e.originalEvent||e).clipboardData.getData("Text"):this.$window.clipboardData&&(o=this.$window.clipboardData.getData("Text")),this.$window.document.queryCommandSupported("insertText")?this.$window.document.execCommand("insertText",!1,o):this.$window.document.execCommand("paste",!1,o)}}},{key:"clickOnWord",value:function(e){var t=e.contents().first()[0],o=this.$window.getSelection().anchorNode,i=this.caret.getCaretCharacterOffsetWithin(t);if(o&&0===i){var r=e.text().trim();if(r.length>0){var s=this.$window.document.createTextNode(" "+r);this.$(t).replaceWith(s),this.caret.moveInText(1,s)}}}},{key:"getLast",value:function(e){var t=e.contents().last(),o=e;return t[0]&&(3===t[0].nodeType||t[0].hasAttribute("data-word"))?t:t[0]?this.getLast(t):o}},{key:"removeEmptyLast",value:function(e){var t=e.contents().last(),o=!1;if(t.is("br"))o=!0;else if(t[0]&&3===t[0].nodeType){var i=t[0].nodeValue.trim();i.length<1&&(o=!0)}o&&(t.remove(),this.removeEmptyLast(this.root))}}]),e}();t.default=d},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),s=i(r),n=o(2),l=i(n),a=o(230),c=i(a),d=o(231),u=i(d),h=function(){function e(t,o,i,r,n){(0,s.default)(this,e),this.$=t,this.$window=o,this.$root=i,this._colorService=r,this._idCounter=0,this._words=n,this._wordRegex=(0,c.default)("\\pL+(?:[-'’]?\\pL+)*","gi"),this._wordFormatRegex=(0,c.default)("^(?:\\pL+(?:[-'’]?\\pL+)*)$","i")}return(0,l.default)(e,[{key:"parse",value:function(){this._parseElement(this.$root)}},{key:"_createWordDOMNode",value:function(e,t,o,i,r){var s=this.$window.document.createElement("span");s.setAttribute("data-word",e),s.setAttribute("style","background-color: "+o+"; color: "+i+";");var n=this._createTextDOMNode(t);return s.appendChild(n),r?s.setAttribute("class",r):s.setAttribute("class","unselected"),s}},{key:"_createTextDOMNode",value:function(e){return this.$window.document.createTextNode(e)}},{key:"_parseElement",value:function(e){var t=this;this.$(e).contents().each(function(e,o){switch(o.nodeType){case 1:o.hasAttribute("data-word")?t._analyzeWordElement(o):t._parseElement(o);break;case 3:t._parseTextNode(o)}})}},{key:"_parseText",value:function(e,t,o){for(var i=[],r=[],s=0,n=0;null!==(r=this._wordRegex.exec(t));){var l=r[0],a=r.index;if(a-s+n>1){var c=t.substring(s+n,a),d=this._createTextDOMNode(c);i.push(d)}s=a,n=l.length;var u=o(l);i.push(u)}if(s+n<t.length){var h=t.substring(s+n),f=this._createTextDOMNode(h);i.push(f)}i.length>0&&this.$(e).replaceWith(i)}},{key:"_parseTextNode",value:function(e){var t=this;this._parseText(e,e.nodeValue,function(e){var o=t._idCounter++,i=t._createWordDOMNode(o,e),r=new u.default(o,e.toLowerCase(),t._colorService.getColorInstance(),t.$(i));return t._words.addWordNode(r),i})}},{key:"_analyzeWordElement",value:function(e){var t=this,o=this.$(e),i=parseInt(o.attr("data-word"),10),r=o.text(),s=r.trim(),n=this._words.getWordNode(i);if(r.length>s.length&&o.text(s),!s.match(this._wordFormatRegex)||n.word.trim()!==s){var l=o.css("background-color"),a=o.attr("class"),c=o.css("color");this._words.removeWordNode(i),this._parseText(o,s,function(e){var o=t._idCounter++,i=t._createWordDOMNode(o,e,l,c,a),r=new u.default(o,e.toLowerCase(),t._colorService.getColorInstance(n.color),t.$(i));return t._words.addWordNode(r),i})}}}]),e}();t.default=h},,function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),s=i(r),n=o(2),l=i(n),a=function(){function e(t,o,i,r){(0,s.default)(this,e),this.id=t,this.word=o,this.color=i,this.$domNode=r}return(0,l.default)(e,[{key:"resetColor",value:function(){this.color.reset(),this.$domNode.removeAttr("style"),this.$domNode.removeClass(),this.$domNode.addClass("unselected")}},{key:"setColor",value:function(e,t){this.color.setColor(e),this.$domNode.css({"background-color":e.toString()}),this.$domNode.css({color:t}),this.$domNode.removeClass(),this.$domNode.addClass("selected"),e.l>97&&this.$domNode.addClass("selected_white")}}]),e}();t.default=a},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),s=i(r),n=o(2),l=i(n),a=o(119),c=i(a);o(233);var d=o(234),u=i(d);angular.module("color-toolbar",[c.default]).component("colorToolbar",{template:u.default,bindings:{colorModified:"&",onClose:"&",closed:"<",inputColor:"<"},controller:function(){function e(t,o,i,r,n){(0,s.default)(this,e),this.$scope=t,this.$element=i,this.$timeout=o,this._colorService=r,this._calculateFontColor=n,this.wordLinking=!0,this.colors=[];for(var l=0;l<360;l+=30){var a=r.getColorInstance({h:l,s:80,l:50});this.colors.push(a)}var c=r.getColorInstance({h:0,s:0,l:0}).setAchromatic(),d=r.getColorInstance({h:0,s:0,l:100}).setAchromatic();this.colors.push(c),this.colors.push(d),this.color=r.getColorInstance();var u=this;this.slider={value:50,options:{floor:0,ceil:100,step:1,onChange:function(){u.colorModified({color:u.color,linking:u.wordLinking})},onEnd:function(){u.colorModified({color:u.color,linking:u.wordLinking})},hidePointerLabels:!0,hideLimitLabels:!0,disabled:!0}}}return(0,l.default)(e,null,[{key:"$inject",get:function(){return["$scope","$timeout","$element","colorService","calculateFontColor"]}}]),(0,l.default)(e,[{key:"$onInit",value:function(){!0===this.closed&&this.close()}},{key:"$onChanges",value:function(e){var t=e.inputColor.currentValue;t&&(this.setCurrentColor(t),this.$element.hasClass("hide")&&this.open())}},{key:"increaseWeight",value:function(){var e=this;this.color&&this.color.isSet()&&this.color.weight<100&&(this.color.weight++,this.colorModified({color:e.color,linking:e.wordLinking}))}},{key:"decreaseWeight",value:function(){var e=this;this.color&&this.color.isSet()&&this.color.weight>1&&(e.color.weight--,this.colorModified({color:e.color,linking:e.wordLinking}))}},{key:"endSlide",value:function(){var e=this;this.colorModified({color:e.color,linking:e.wordLinking})}},{key:"linkingIconColor",value:function(){return this.color.isSet()?this._calculateFontColor(this.color):"black"}},{key:"selectColor",value:function(e){var t=this,o=e.target;if(o.hasAttribute("data-toolbar-color")||o.parentElement.hasAttribute("data-toolbar-color")){e.stopPropagation();var i=o.hasAttribute("data-toolbar-color")?o:o.parentElement,r=angular.element(i).attr("data-toolbar-color");if(r&&"null"!==r){var s=this._colorService.getColorInstance(this.colors[r]);this.changeColor(s),this.slider.options.disabled=this.color.isAchromatic()}else this.setInitialColor();this.colorModified({color:t.color,linking:t.wordLinking})}}},{key:"changeColor",value:function(e){e.weight=this.color.weight,!e.isAchromatic()&&!this.color.isAchromatic()&&this.color.s&&this.color.l&&(e.s=this.color.s,e.l=this.color.l),this.color=e}},{key:"setCurrentColor",value:function(e){e&&e.isSet()?(this.color=e,this.slider.options.disabled=this.color.isAchromatic()):this.setInitialColor()}},{key:"setInitialColor",value:function(){this.color=this._colorService.getColorInstance(),this.slider.options.disabled=!0}},{key:"close",value:function(){this.$element.addClass("hide"),this.onClose()}},{key:"open",value:function(){this.$element.removeClass("hide"),this.$scope.$broadcast("rzSliderForceRender")}}]),e}()}),t.default="color-toolbar"},function(e,t){},function(e,t){e.exports='<div class=toolbar> <div class=toolbar__content> <div class=toolbar__left> <div class=toolbar__colorbox ng-click=$ctrl.selectColor($event)> <div ng-repeat="c in $ctrl.colors track by $index"> <div class=toolbar__color data-toolbar-color={{$index}} ng-style="{\'background-color\': c}"></div> </div> <div class=toolbar__color data-toolbar-color=null><span class="glyphicon glyphicon-remove toolbar__clear"></span></div> <div style=clear:both></div> </div> </div> <div class=toolbar__center> <div class=toolbar__adjuster> <div class=toolbar__sliders ng-disabled=!$ctrl.color.isSet()> <div class=toolbar__sliders-content> <div class=toolbar__saturation-slider> <span class="glyphicon glyphicon-signal"></span> <span>{{$ctrl.color.isSet() ? $ctrl.color.s : 0 }}%</span> <rzslider rz-slider-model=$ctrl.color.s rz-slider-options=$ctrl.slider.options></rzslider> </div> <div class=toolbar__lightness-slider> <span class="glyphicon glyphicon-adjust icon-flipped"></span> <span>{{$ctrl.color.isSet() ? $ctrl.color.l : 0 }}%</span> <rzslider rz-slider-model=$ctrl.color.l rz-slider-options=$ctrl.slider.options></rzslider> </div> </div> </div> <div class=toolbar__weight> <div class=toolbar__weight-title>Weight</div> <div class=toolbar__weight-controls> <div class="toolbar__weight-buttons btn-group-vertical" role=group> <a type=button class="btn btn-default btn-block btn-square toolbar__weight-button" ng-click=$ctrl.increaseWeight()>+</a> <a type=button class="btn btn-default btn-block btn-square toolbar__weight-button" ng-click=$ctrl.decreaseWeight()>-</a> </div> <div class=toolbar__weight-value>{{$ctrl.color.weight}}</div> </div> </div> </div> </div> <div class=toolbar__right> <div class=toolbar__selected> <div class=toolbar__selected-color ng-click="$ctrl.wordLinking = !$ctrl.wordLinking" ng-style="{\'background-color\': $ctrl.color}"><span ng-show=$ctrl.wordLinking class="toolbar__linking-icon glyphicon glyphicon-link" ng-style="{color: $ctrl.linkingIconColor()}"></span></div> <div class=toolbar__selected-background></div> </div> <div class=toolbar__close ng-click=$ctrl.close()> <span class="glyphicon glyphicon-menu-up toolbar__close-icon"></span> </div> </div> </div> </div>'},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),s=i(r),n=o(2),l=i(n),a=o(120),c=i(a);o(236),o(237),o(238);var d=o(239),u=i(d),h=o(240),f=i(h),g=o(242),v=i(g),p=o(243),m=i(p),_=o(244);angular.module("image-finder",["jsonrpc",c.default,"ngError","ngLoad"]).service("images",["jsonrpc","login",function(e,t){return new f.default(new v.default(e,t))}]).service("imageInspector",["$window","$document","images",function(e,t,o){return new m.default(e,t,o)}]).component(_.imageViewerCompName,_.imageViewerComp).component("imageFinder",{template:u.default,bindings:{onImagesFound:"&",search:"<"},controller:function(){function e(t,o,i,r){(0,s.default)(this,e),this.$document=t,this._imageInspector=i,this._spinner=r,this._step=10,this._images=o,this._findPending=!1,this.selectedImage=null,this.imagesToShow=[]}return(0,l.default)(e,null,[{key:"$inject",get:function(){return["$document","images","imageInspector","usSpinnerService"]}}]),(0,l.default)(e,[{key:"$onInit",value:function(){this.imagesToShow=this._images.getImagesInInterval(0,this._images.showIndex)}},{key:"$onChanges",value:function(e){var t=this,o=e.search.currentValue;if(o&&!this._findPending){this.imagesToShow.length=0;var i=o.words,r=o.settings;r&&i&&(this._findPending=!0,this._spinner.spin("spinner-1"),this._images.findImages(i,r,function(){t._findPending=!1,t._spinner.stop("spinner-1"),t.imagesToShow=t._images.getImagesInInterval(0,t._step),t._images.showIndex=t._step,t.onImagesFound({images:t._images.getImagesArray()})}))}}},{key:"checkForImageFailure",value:function(e,t){var o=this;this._images.checkForImageFailure(e,function(i){i&&(o._images.removeImage(e),angular.element(t).remove(),o.showMore())})}},{key:"thumbnailLoaded",value:function(e,t){this._imageInspector.inspect(t,e.target,this.checkForImageFailure.bind(this))}},{key:"thumbnailLoadingError",value:function(e,t){this.checkForImageFailure(t,e.target)}},{key:"showMore",value:function(){this.imagesToShow=this.imagesToShow.concat(this._images.getImagesInInterval(this._images.showIndex,this._images.showIndex+this._step)),this._images.showIndex+=this._step}},{key:"selectImage",value:function(e){var t=e.target;if(t.hasAttribute("imagefinder-image")||angular.element(t).parent()[0].hasAttribute("imagefinder-image")){e.stopPropagation();var o=t.hasAttribute("imagefinder-image")?angular.element(t).attr("imagefinder-image"):angular.element(t).parent().attr("imagefinder-image");this.selectedImage=this._images.getImage(o)}}},{key:"imagesUpdated",value:function(){this.imagesToShow=this._images.getImagesInInterval(0,this._images.showIndex)}}]),e}()}),t.default="image-finder"},,,function(e,t){},function(e,t){e.exports='<div class=image-finder> <div class=image-finder__container> <div ng-click=$ctrl.selectImage($event) class=image-finder__images infinite-scroll=$ctrl.showMore() infinite-scroll-distance=0> <div ng-repeat="img in $ctrl.imagesToShow track by img.id"> <img imagefinder-image={{img.id}} ng-src={{img.previewURL}} class=image-finder__image ng-error="$ctrl.thumbnailLoadingError($event, img)" ng-load="$ctrl.thumbnailLoaded($event, img)"> </div> </div> </div> <image-viewer ng-show=$ctrl.selectedImage image=$ctrl.selectedImage on-images-updated=$ctrl.imagesUpdated() on-close="$ctrl.selectedImage = null"></image-viewer> </div>'},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),s=i(r),n=o(2),l=i(n),a=o(241),c=i(a),d=function(){function e(t){(0,s.default)(this,e),this.images=[],this.service=t,this.showIndex=0}return(0,l.default)(e,[{key:"addImage",value:function(e){var t=new c.default(e);this.images.push(t)}},{key:"removeImage",value:function(e){for(var t=0;t<this.images.length;t++)if(this.images[t].id==e.id){this.images.splice(t,1);break}}},{key:"getImage",value:function(e){for(var t=null,o=0,i=this.images.length;o<i;o++)if(this.images[o].id==e){t=this.images[o];break}return t}},{key:"getImagesArray",value:function(){return this.images}},{key:"count",value:function(){return this.images.length}},{key:"getImagesInInterval",value:function(e,t){return e>=0&&e<this.images.length?(t>this.images.length&&(t=this.images.length),this.images.slice(e,t)):[]}},{key:"empty",value:function(){this.images.length=0}},{key:"checkForImageFailure",value:function(e,t){this.service.checkForImageFailure(e,t)}},{key:"findImages",value:function(e,t,o){this.empty(),this.service.findImages(this,e,t,o)}}]),e}();t.default=d},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),r=function(e){return e&&e.__esModule?e:{default:e}}(i),s=function e(t){(0,r.default)(this,e),this.id=t.id,this.url=t.url,this.previewURL=t.previewURL,this.originalURL=t.originalURL,this.score=parseFloat(t.score).toFixed(2),this.source=t.source,this.title=t.title||"unknown",this.owner=t.owner||"unknown"};t.default=s},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),s=i(r),n=o(2),l=i(n),a=function(){function e(t,o){(0,s.default)(this,e),this.jsonrpc=t,this.login=o}return(0,l.default)(e,[{key:"checkForImageFailure",value:function(e,t){this.jsonrpc.request("checkImage",{image:e}).then(function(e){t&&t(e)}).catch(function(e){console.error(e)})}},{key:"findImages",value:function(e,t,o,i){var r=this;this.jsonrpc.request("find",{colors:t.colors,words:t.words,settings:o.serialize(),auth:r.login.auth}).then(function(t){if(t&&t.imgs&&t.imgs.length>0){e.empty();for(var o=0;o<t.imgs.length;o++)e.addImage(t.imgs[o])}t=null,i&&i()}).catch(function(e){console.error(e),i&&i()})}}]),e}();t.default=a},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(14),s=i(r),n=o(10),l=i(n),a=o(0),c=i(a),d=o(2),u=i(d),h=function(){function e(){(0,c.default)(this,e),this._errorWidth=[320,500],this._errorHeight=[240,374]}return(0,u.default)(e,[{key:"inspect",value:function(e){var t=e.imageNode.naturalWidth,o=e.imageNode.naturalHeight;(t===this._errorWidth[0]&&o===this._errorHeight[0]||t===this._errorWidth[1]&&o===this._errorHeight[1])&&e.callback&&e.callback(e.image,e.imageNode)}}]),e}(),f=function(){function e(t,o,i,r){(0,c.default)(this,e),this._imagesToInspect=[],this._strategies=i,this._portion=r,this.$window=t,setInterval(this._inspect.bind(this),500)}return(0,u.default)(e,[{key:"size",value:function(){return this._imagesToInspect.length}},{key:"add",value:function(e){this._imagesToInspect.push(e)}},{key:"_inspect",value:function(){var e=this._imagesToInspect.splice(0,this._portion),t=!0,o=!1,i=void 0;try{for(var r,s=(0,l.default)(e);!(t=(r=s.next()).done);t=!0){var n=r.value,a=this._strategies.get(n.image.source);a&&a.inspect(n)}}catch(e){o=!0,i=e}finally{try{!t&&s.return&&s.return()}finally{if(o)throw i}}}}]),e}(),g=function(){function e(t,o){(0,c.default)(this,e);var i=(new s.default).set("flickr",new h);this.batch=new f(t,o,i,20)}return(0,u.default)(e,[{key:"inspect",value:function(e,t,o){this.batch.add({image:e,imageNode:t,callback:o})}}]),e}();t.default=g},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.imageViewerComp=t.imageViewerCompName=void 0;var r=o(0),s=i(r),n=o(2),l=i(n);o(245);var a=o(246),c=i(a);t.imageViewerCompName="imageViewer",t.imageViewerComp={template:c.default,bindings:{image:"<",onClose:"&",onImagesUpdated:"&"},controller:function(){function e(t,o,i,r,n,l,a,c){(0,s.default)(this,e),this.$scope=t,this.$window=o,this.$element=i,this.$timeout=r,this._imageInspector=l,this._spinner=c,this._images=a,this._canvas=n[0].createElement("canvas"),this._canvasContext=this._canvas.getContext("2d"),this._imageDownload=i.find(".image-viewer__download")[0]}return(0,l.default)(e,null,[{key:"$inject",get:function(){return["$scope","$window","$element","$timeout","$document","imageInspector","images","usSpinnerService"]}}]),(0,l.default)(e,[{key:"$onChanges",value:function(e){this.selectedImage=angular.copy(e.image.currentValue),this.selectedImage&&(this._spinner.spin("spinner-1"),angular.element("body").addClass("stop-scrolling"))}},{key:"$postLink",value:function(){var e=this;this.$window.addEventListener("keydown",function(t){e.selectedImage&&27===t.keyCode&&(e.close(t),e.$scope.$apply())})}},{key:"getScore",value:function(){return this.selectedImage?parseFloat(100*this.selectedImage.score).toFixed(2):null}},{key:"originalURL",value:function(){this.$window.open(this.selectedImage.originalURL)}},{key:"loaded",value:function(e,t){var o=this;this._spinner.stop("spinner-1"),e.target,this._imageInspector.inspect(t,e.target,this._images.checkForImageFailure(t,function(e){e&&(o._images.removeImage(t),angular.element("body").removeClass("stop-scrolling"),o.selectedImage=null,o.onClose(),o.onImagesUpdated())}))}},{key:"loadingError",value:function(e){this._spinner.stop("spinner-1"),this._images.checkForImageFailure(e),this._images.removeImage(e),angular.element("body").removeClass("stop-scrolling"),this.selectedImage=null,this.onClose(),this.onImagesUpdated()}},{key:"save",value:function(){var e=this;if(this._canvasContext.clearRect(0,0,this._canvas.width,this._canvas.height),this._imageDownload.href="",this._imageDownload.download="",this.selectedImage){var t=new Image;t.crossOrigin="anonymous",t.onload=function(){e._canvas.width=t.naturalWidth,e._canvas.height=t.naturalHeight;var o=null;try{e._canvasContext.drawImage(t,0,0),o=t.src.indexOf(".jpg")>-1?e._canvas.toDataURL("image/jpeg"):t.src.indexOf(".gif")>-1?e._canvas.toDataURL("image/gif"):e._canvas.toDataURL("image/png")}catch(e){console.error(e)}o&&(e._imageDownload.href=o,e._imageDownload.download=t.src.split(/(\\|\/)/g).pop(),e.$timeout(function(){e._imageDownload.click()},100,!1))},t.onerror=function(t){console.log(t);var o=e.$window.open(e.selectedImage.url,"_blank");o&&o.focus()},t.src=this.selectedImage.url}}},{key:"close",value:function(e){(e.target.hasAttribute("imageviewer-close")||27===e.keyCode)&&(e.stopPropagation(),this._spinner.stop("spinner-1"),angular.element("body").removeClass("stop-scrolling"),this.selectedImage=null,this._canvasContext.clearRect(0,0,this._canvas.width,this._canvas.height),this._imageDownload.href="",this._imageDownload.download="",this.onClose())}}]),e}()}},function(e,t){},function(e,t){e.exports='<div class=image-viewer> <div class=image-viewer__topline> <div class=image-viewer__topline-main> <div class=image-viewer__topline-content> <a class=image-viewer__original target=_blank href={{$ctrl.selectedImage.originalURL}}>Original</a> <span class=image-viewer__separator></span> <span class=image-viewer__score>{{$ctrl.getScore()}}%</span> <span class=image-viewer__separator></span> <a class=image-viewer__save ng-click=$ctrl.save()> <span class="glyphicon glyphicon-floppy-save image-viewer__save-icon"></span> </a> <div ng-click=$ctrl.close($event) class=image-viewer__close-button imageviewer-close> <span class="glyphicon glyphicon-remove image-viewer__close-icon" aria-hidden=true imageviewer-close></span> </div> </div> </div> <div class=image-viewer__info> <div class=image-viewer__attribution> <div class=image-viewer__title>{{$ctrl.selectedImage.title}}</div> <div>by</div> <div class=image-viewer__owner>{{$ctrl.selectedImage.owner}}</div> </div> </div> </div> <div class=image-viewer__image-container ng-click=$ctrl.close($event) imageviewer-close> <img class=image-viewer__image src={{$ctrl.selectedImage.url}} ng-load="$ctrl.loaded($event, $ctrl.selectedImage)" ng-error=$ctrl.loadingError($ctrl.selectedImage)> <a class=image-viewer__download></a> </div> </div>'},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(248),s=i(r),n=o(0),l=i(n),a=o(2),c=i(a);o(253);var d=o(254),u=i(d);angular.module("settings",[]).component("settings",{template:u.default,controller:function(){function e(t,o){(0,l.default)(this,e);var i=this;this.$scope=t,this._settingsOldState=(0,s.default)(o.serialize()).join(),this.settings=o,this.similarityLevel=o.similarityLevel,this.slider={value:50,options:{floor:50,ceil:100,step:1,onChange:function(){},onEnd:function(){i.settings.similarityLevel=i.similarityLevel},hidePointerLabels:!0,hideLimitLabels:!0,disabled:!1}}}return(0,c.default)(e,null,[{key:"$inject",get:function(){return["$scope","appSettings"]}}]),(0,c.default)(e,[{key:"$doCheck",value:function(){var e=(0,s.default)(this.settings.serialize()).join();e!==this._settingsOldState&&(this._settingsOldState=e,this.similarityLevel=this.settings.similarityLevel,this.settings.save(function(){},function(e){console.log(e)}))}},{key:"$onInit",value:function(){var e=this;this.settings.load(function(){e.similarityLevel=e.settings.similarityLevel},function(e){console.log(e)})}}]),e}()}),t.default="settings"},,,,,,function(e,t){},function(e,t){e.exports="<div class=settings> <div> <div class=radio> <label> <input type=radio name=optionsRadios ng-model=$ctrl.settings.searchMode value=regular checked=checked>Regular search (fast) </label> </div> <div class=radio> <label> <input type=radio name=optionsRadios ng-model=$ctrl.settings.searchMode value=special>Special search (slow) </label> </div> </div> <div ng-class=\"$ctrl.settings.searchMode == 'special' ? 'settings__special-search_show' : 'settings__special-search_hide'\"> <select ng-model=$ctrl.settings.distance> <option ng-repeat=\"distance in $ctrl.settings.supportedDistances track by $index\" data-distances-distance={{$index}} value={{distance.id}}>{{distance.name}}</option> </select> <div class=settings__similarity-level> <div>Similarity level: <span>{{$ctrl.similarityLevel}}%</span></div> <rzslider rz-slider-model=$ctrl.similarityLevel rz-slider-options=$ctrl.slider.options></rzslider> </div> </div> </div> "},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o(256);var i=o(257),r=function(e){return e&&e.__esModule?e:{default:e}}(i);angular.module("guide",[]).component("guide",{template:r.default}),t.default="guide"},function(e,t){},function(e,t){e.exports='<div class=guide> <div class=guide__content> <p class=guide__title>This application allows you to find images by color!</p> <p>1. Write your text in the editor on main page</p> <p>2. Color your text with the color tool bar</p> <p>3. Set your desired search settings (optional)</p> <p class=guide__search-settings>» You can perform a specific search by choosing a desired similarity level and distance function. <br>» You can create and manage multiple color profiles. Contents of the existing color profiles can be inspected in the "Archive" section.</p> <p>4. Search!</p> </div> </div>'},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(120),s=i(r),n=o(259),l=i(n),a=o(261),c=o(265);angular.module("profiles",[s.default]).service("colorProfiles",["db","colorService",function(e,t){return new l.default(e,t)}]).component(a.colorProfilesCompName,a.colorProfilesComp).component(c.profilesViewerCompName,c.profilesViewerComp),t.default="profiles"},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),s=i(r),n=o(2),l=i(n),a=o(121),c=i(a),d=o(260),u=i(d),h=function(){function e(t,o){(0,s.default)(this,e),this.profileNames=[],this.loadedProfile=null,this.dao=new u.default(t,o)}return(0,l.default)(e,[{key:"init",value:function(e){var t=this;this.loadColorProfileNames(function(){t.loadColorProfile(t.profileNames[0],function(){e()})})}},{key:"createColorProfile",value:function(e,t,o,i,r){var s=new c.default(e,t,o,i);this.dao.saveColorProfile(s,this,r)}},{key:"loadColorProfile",value:function(e,t){var o=this;this.dao.loadColorProfile(e,function(e){o.loadedProfile=e,t&&t()})}},{key:"getColorProfile",value:function(e,t){e&&this.dao.loadColorProfile(e,function(e){t(e)})}},{key:"loadColorProfileNames",value:function(e){this.dao.loadColorProfiles(this,e)}},{key:"updateColorProfile",value:function(){for(var e=this,t=null,o=null,i=arguments.length,r=Array(i),s=0;s<i;s++)r[s]=arguments[s];if(r.length>3){var n=[].concat(r),l=n[0],a=n[1],d=n[2],u=n[3];t=new c.default(this.loadedProfile.name,l,a,d),o=u}else if(r.length<3){var h=[].concat(r),f=h[0],g=h[1];t=f,o=g}t&&t.name&&this.dao.updateColorProfile(t,function(){e.loadedProfile&&t.name===e.loadedProfile.name?e.loadColorProfile(e.loadedProfile.name,o):o&&o()})}},{key:"deleteColorProfile",value:function(e,t){var o=this;if(e){var i=this.loadedProfile?this.loadedProfile.name:null;this.dao.deleteColorProfile(e,function(){if(o._removeColorProfileName(e),e===i){var r=o.profileNames.length>0?o.profileNames[0]:null;r?o.loadColorProfile(r,t):(o.loadedProfile=null,t())}else t()})}}},{key:"_removeColorProfileName",value:function(e){for(var t=void 0,o=0;o<this.profileNames.length;o++)if(this.profileNames[o]===e){t=o;break}this.profileNames.splice(t,1)}},{key:"_addColorProfileName",value:function(e){this.profileNames.push(e)}}]),e}();t.default=h},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),s=i(r),n=o(2),l=i(n),a=o(121),c=i(a),d=function(){function e(t,o){(0,s.default)(this,e),this.colorFactory=o,this.store="colorprofiles",this.db=t}return(0,l.default)(e,[{key:"loadColorProfile",value:function(e,t){var o=this;e&&this.db.getStore(this.store).getItem(e).then(function(e){if(e){var i=c.default.deserialize(e,o.colorFactory,o.db);t(i)}}).catch(function(e){console.error(e)})}},{key:"deleteColorProfile",value:function(e,t){e&&this.db.getStore(this.store).removeItem(e).then(function(){t&&t()}).catch(function(e){console.error(e)})}},{key:"saveColorProfile",value:function(e,t,o){if(e&&e.name){var i=this.db.getStore(this.store);i.getItem(e.name).then(function(r){return r?null:i.setItem(e.name,e.serialize()).then(function(){t._addColorProfileName(e.name),o&&o()})}).catch(function(e){console.error(e)})}}},{key:"loadColorProfiles",value:function(e,t){this.db.getStore(this.store).iterate(function(t,o){return e._addColorProfileName(o)}).then(function(){t&&t()}).catch(function(e){console.error(e)})}},{key:"updateColorProfile",value:function(e,t){e&&e.name&&this.db.getStore(this.store).setItem(e.name,e.serialize()).then(function(){t&&t()}).catch(function(e){console.error(e)})}}]),e}();t.default=d},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.colorProfilesComp=t.colorProfilesCompName=void 0;var r=o(14),s=i(r),n=o(27),l=i(n),a=o(10),c=i(a),d=o(0),u=i(d),h=o(2),f=i(h);o(262);var g=o(263),v=i(g),p=o(264),m=i(p);t.colorProfilesCompName="colorProfiles",t.colorProfilesComp={template:v.default,bindings:{colors:"<",onLoadProfile:"&"},controller:function(){function e(t,o,i,r,s,n,l){var a=this;(0,u.default)(this,e),this.$rootScope=t,this.$scope=o,this.$timeout=i,this._colorService=s,this._textColors=n,this._dialog=l,this._mode="",this._utils=new m.default,this._singleColors=[],this.colorProfiles=r,this.openCreateProfile=!1,this.openConflicts=!1,this.newProfileName="",this.colorProfiles=r,this.conflictColors=[],this.$scope.$on("colorsChainged",function(){a.$timeout(function(){var e=a.colorProfiles.loadedProfile;e&&(a._checkColorConflicts(e.colors),a.$scope.$apply())},0,!1)})}return(0,f.default)(e,null,[{key:"$inject",get:function(){return["$rootScope","$scope","$timeout","colorProfiles","colorService","textColors","popupDialog"]}}]),(0,f.default)(e,[{key:"$onInit",value:function(){var e=this;this.colorProfiles.init(function(){e.$scope.$apply()})}},{key:"updateProfileDialog",value:function(){var e=this;this._resetColorConflicts(),this.colorProfiles.loadedProfile&&this._dialog.confirmDialog(function(){this.yes=function(){e.updateProfile(),e._dialog.close()},this.cancel=function(){e._dialog.close()},this.title='"update profile"'})}},{key:"applyProfileDialog",value:function(){var e=this;this.colorProfiles.loadedProfile&&this._dialog.confirmDialog(function(){this.yes=function(){e.applyProfile(),e._dialog.close()},this.cancel=function(){e._dialog.close()},this.title='"apply profile"'})}},{key:"deleteProfileDialog",value:function(){var e=this;this.colorProfiles.loadedProfile&&this._dialog.confirmDialog(function(){this.yes=function(){e.deleteProfile(),e._dialog.close()},this.cancel=function(){e._dialog.close()},this.title='"delete profile"'})}},{key:"toggleNewProfile",value:function(){this.openCreateProfile=!this.openCreateProfile}},{key:"haveProfiles",value:function(){return this.colorProfiles.profileNames.length>0}},{key:"selectProfile",value:function(){this.colorProfiles.loadedProfile&&this.colorProfiles.loadColorProfile(this.colorProfiles.loadedProfile.name)}},{key:"saveProfile",value:function(){var e=this.newProfileName;if(this._resetColorConflicts(),this._mode="create",e&&e.trim().length>0)if(this._checkColorConflicts(),this.conflictColors.length<1){var t=this._utils.convertColorArrayToMap(this._singleColors);this.createColorProfile(e,t)}else this.openConflicts=!0}},{key:"applyProfile",value:function(){var e=this.colorProfiles.loadedProfile;this._resetColorConflicts(),e&&e.name&&this.onLoadProfile({colors:e.colors,sPercentage:e.sPercentage,lPercentage:e.lPercentage})}},{key:"updateProfile",value:function(){var e=this.colorProfiles.loadedProfile;if(this._mode="update",e&&(this._checkColorConflicts(e.colors),this.openConflicts=this.conflictColors.length>0,this.conflictColors.length<1)){var t=this._utils.convertColorArrayToMap(this._singleColors);this.updateColorProfile(e.name,t)}}},{key:"deleteProfile",value:function(){var e=this,t=this.colorProfiles.loadedProfile;this.colorProfiles.deleteColorProfile(t.name,function(){e.$scope.$apply(),e.$rootScope.$broadcast("profilesUpdated")})}},{key:"solveColorConflicts",value:function(){var e=this._utils.concatColorArraysToMap(this.conflictColors,this._singleColors);switch(this._mode){case"update":var t=this.colorProfiles.loadedProfile.name;t&&e.size>0&&(this.updateColorProfile(t,e),this._resetColorConflicts(),this._mode="");break;case"create":var o=this.newProfileName;o&&(this.createColorProfile(o,e),this._resetColorConflicts(),this._mode="")}}},{key:"abortSolveColorConflicts",value:function(){this.openConflicts=!1}},{key:"createColorProfile",value:function(e,t){var o=this,i=!0,r=!1,s=void 0;try{for(var n,a=(0,c.default)(t);!(i=(n=a.next()).done);i=!0){var d=(0,l.default)(n.value,2),u=d[0];d[1].isSet()||t.delete(u)}}catch(e){r=!0,s=e}finally{try{!i&&a.return&&a.return()}finally{if(r)throw s}}this.colorProfiles.createColorProfile(e,t,this._textColors.sPercentage,this._textColors.lPercentage,function(){o.newProfileName="",o.colorProfiles.loadColorProfile(e,function(){o.openCreateProfile=!1,o.$scope.$apply()})})}},{key:"updateColorProfile",value:function(e,t){var o=this,i=!0,r=!1,s=void 0;try{for(var n,a=(0,c.default)(t);!(i=(n=a.next()).done);i=!0){var d=(0,l.default)(n.value,2),u=d[0];d[1].isSet()||t.delete(u)}}catch(e){r=!0,s=e}finally{try{!i&&a.return&&a.return()}finally{if(r)throw s}}this.colorProfiles.updateColorProfile(t,this._textColors.sPercentage,this._textColors.lPercentage,function(){o._resetColorConflicts(),o.$timeout(function(){o.$rootScope.$broadcast("profilesUpdated")},0,!1)})}},{key:"_resetColorConflicts",value:function(){this.conflictColors=[],this._singleColors=[],this.openConflicts=!1}},{key:"_checkColorConflicts",value:function(e){this._resetColorConflicts();var t=new s.default,o=!0,i=!1,r=void 0;try{for(var n,a=(0,c.default)(this.colors);!(o=(n=a.next()).done);o=!0){for(var d=(0,l.default)(n.value,2),u=d[0],h=d[1],f=h.getValuesArray(),g=this._colorService.getColorSetInstance(),v=0;v<f.length;v++)g.add(f[v]);t.set(u,g)}}catch(e){i=!0,r=e}finally{try{!o&&a.return&&a.return()}finally{if(i)throw r}}if(e){var p=!0,m=!1,_=void 0;try{for(var y,w=(0,c.default)(e);!(p=(y=w.next()).done);p=!0){var $=(0,l.default)(y.value,2),u=$[0],C=$[1],k=this._colorService.getColorInstance(C),b=t.get(u);if(b)b.add(k);else{var P=this._colorService.getColorSetInstance();P.add(k),t.set(u,P)}}}catch(e){m=!0,_=e}finally{try{!p&&w.return&&w.return()}finally{if(m)throw _}}}var S=!0,x=!1,I=void 0;try{for(var M,N=(0,c.default)(t);!(S=(M=N.next()).done);S=!0){var W=(0,l.default)(M.value,2),u=W[0],h=W[1],A=h.getValuesArray();if(A.length>1){var T=A[0];this.conflictColors.push({word:u,selected:T,colors:A})}else{var C=A[0];this._singleColors.push({word:u,color:C})}}}catch(e){x=!0,I=e}finally{try{!S&&N.return&&N.return()}finally{if(x)throw I}}}}]),e}()}},function(e,t){},function(e,t){e.exports='<div class=color-profiles> <select class=color-profiles__profiles ng-change=$ctrl.selectProfile() ng-model=$ctrl.colorProfiles.loadedProfile.name> <option ng-show="$ctrl.colorProfiles.profileNames.length < 1" value="">Select profile...</option> <option ng-repeat="profileName in $ctrl.colorProfiles.profileNames" value={{profileName}}>{{profileName}}</option> </select> <div class=color-profiles__controls> <a ng-click=$ctrl.applyProfileDialog() class="btn-bodyless btn-bodyless-primary" ng-class="$ctrl.haveProfiles() ? \'\' : \'disabled\'"><span class="glyphicon glyphicon-tint"></span> Apply</a> <a ng-click=$ctrl.updateProfileDialog() class=btn-bodyless ng-class="$ctrl.haveProfiles() ? \'\' : \'disabled\'"><span class="glyphicon glyphicon-floppy-save"></span> Update</a> <a ng-click=$ctrl.toggleNewProfile() class="btn-bodyless btn-bodyless-success"><span class="glyphicon glyphicon-plus" aria-hidden=true></span> New</a> <a ng-click=$ctrl.deleteProfileDialog() class="btn-bodyless btn-bodyless-danger" ng-class="$ctrl.haveProfiles() ? \'\' : \'disabled\'"><span class="glyphicon glyphicon-trash"></span> Drop</a> </div> <div ng-show=$ctrl.openCreateProfile class=color-profiles__create-profile> <input ng-model=$ctrl.newProfileName type=text class="form-control create-profile__profile-name" placeholder=Profile> <a ng-click=$ctrl.saveProfile() class="btn btn-success btn-block color-profiles__save-profile"><span class="glyphicon glyphicon-save" aria-hidden=true></span> Save</a> </div> <div ng-show=$ctrl.openConflicts class=color-profiles__conflicts> <div class=color-profiles__conflict-title><span> Resolve conflicts</span></div> <ul class=color-profiles__conflict-colors> <li ng-repeat="item in $ctrl.conflictColors track by $index"> {{item.word}} <form> <div class=radio ng-repeat="color in item.colors track by $index"> <label><input ng-model=$ctrl.conflictColors[$parent.$index].selected ng-value=color type=radio><span ng-show=color.isSet() class=color-profiles__conflict-color ng-style="{\'background-color\': color}"></span><span ng-show=color.isSet() class=color-profile__conflict-weight> weight: {{color.weight}}</span><span ng-show=!color.isSet()> none</span></label> </div> </form> </li> </ul> <a ng-click=$ctrl.solveColorConflicts() class="btn btn-success"><span class="glyphicon glyphicon-ok" aria-hidden=true></span> OK</a> <a ng-click=$ctrl.abortSolveColorConflicts() class="btn btn-danger"><span class="glyphicon glyphicon-remove" aria-hidden=true></span> Cancel</a> </div> </div> '},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(14),s=i(r),n=o(0),l=i(n),a=o(2),c=i(a),d=function(){function e(){(0,l.default)(this,e)}return(0,c.default)(e,[{key:"concatColorArraysToMap",value:function(e,t){var o=[];return e.forEach(function(e){o.push({word:e.word,color:e.selected})}),o=o.concat(t),this.convertColorArrayToMap(o)}},{key:"convertColorArrayToMap",value:function(e){for(var t=new s.default,o=0,i=e.length;o<i;o++)t.set(e[o].word,e[o].color);return t}}]),e}();t.default=d},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.profilesViewerComp=t.profilesViewerCompName=void 0;var r=o(27),s=i(r),n=o(10),l=i(n),a=o(0),c=i(a),d=o(2),u=i(d);o(266);var h=o(267),f=i(h);t.profilesViewerCompName="profilesViewer",t.profilesViewerComp={template:f.default,controller:function(){function e(t,o,i,r,s,n){var l=this;(0,c.default)(this,e),this.$scope=t,this.$timeout=o,this._colorService=r,this._dialog=s,this._spinner=n,this._step=10,this._showIndex=0,this._wordsAndColors=[],this.colorProfiles=i,this.words=[],this.profileName="",this.selectedProfile=null,this.searchWord="",this.foundWord=null,this.selectedWord=null,this.$scope.$watch("$ctrl.searchWord",function(e,t){e!==t&&l.findWordAndColor(e)}),this.$scope.$on("profilesUpdated",function(){l.selectedProfile&&l.loadColorProfile(!0)})}return(0,u.default)(e,null,[{key:"$inject",get:function(){return["$scope","$timeout","colorProfiles","colorService","popupDialog","usSpinnerService"]}}]),(0,u.default)(e,[{key:"loadColorProfile",value:function(e){var t=this;this._showIndex=!0===e?this._showIndex:0,this._wordsAndColors=[],this.words=[],this.selectedProfile=null,this.selectedWord=null,this.colorProfiles.getColorProfile(this.profileName,function(o){t.selectedProfile=o;var i=[],r=!0,n=!1,a=void 0;try{for(var c,d=(0,l.default)(o.colors);!(r=(c=d.next()).done);r=!0){var u=(0,s.default)(c.value,2),h=u[0],f=u[1],g=t._colorService.getColorInstance(f);g.interpolateS(o.sPercentage).interpolateL(o.lPercentage),i.push({word:h,color:g,type:"word"})}}catch(e){n=!0,a=e}finally{try{!r&&d.return&&d.return()}finally{if(n)throw a}}i.sort(function(e,t){return e.word>t.word?1:e.word<t.word?-1:0});for(var v=0,p=i.length;v<p;v++){var m=i[v],_=i[v+1],y=!1;0===v&&(t._wordsAndColors.push({word:m.word.charAt(0).toUpperCase(),type:"title"}),t._wordsAndColors.push(m),y=!0),_&&_.word.charAt(0)!==m.word.charAt(0)&&(y||t._wordsAndColors.push(m),t._wordsAndColors.push({word:_.word.charAt(0).toUpperCase(),type:"title"}),y=!0),y||t._wordsAndColors.push(m)}t.words=!0===e?t._wordsAndColors.slice(0,t._showIndex):t._wordsAndColors.slice(0,t._step),t._showIndex+=t._step,t.findWordAndColor(t.searchWord),t.$scope.$apply()})}},{key:"findWordAndColor",value:function(e){if(this.selectedProfile&&this.selectedProfile.name){var t=this.selectedProfile.getColor(e);if(t){var o=this._colorService.getColorInstance(t);o.interpolateS(this.selectedProfile.sPercentage).interpolateL(this.selectedProfile.lPercentage),this.foundWord={word:e,color:o}}else this.foundWord=null}else this.foundWord=null}},{key:"showMore",value:function(){this.words=this.words.concat(this._getWordsInInterval(this._showIndex,this._showIndex+this._step,this._wordsAndColors)),this._showIndex+=this._step}},{key:"clickHandler",value:function(e){var t=e.target;if(t.hasAttribute("word")){e.stopPropagation();var o=t.getAttribute("word");this.selectedWord=this.selectedWord===o?null:o}else if(t.hasAttribute("delete")){e.stopPropagation();var i=t.getAttribute("delete");this.deleteWordDialog(i)}}},{key:"deleteWordDialog",value:function(e){var t=this;this._dialog.confirmDialog(function(){this.yes=function(){t.deleteWord(e),t._dialog.close()},this.cancel=function(){t._dialog.close()},this.title='"delete word"'})}},{key:"deleteWord",value:function(e){var t=this;this.selectedProfile.deleteWord(e),this.colorProfiles.updateColorProfile(this.selectedProfile,function(){t.foundWord=null,t.searchWord="",t.loadColorProfile(!0)})}},{key:"countProfileWords",value:function(){return this.selectedProfile&&this.selectedProfile.countWords?this.selectedProfile.countWords():0}},{key:"_getWordsInInterval",value:function(e,t,o){return e>=0&&e<o.length?(t>o.length&&(t=o.length),o.slice(e,t)):[]}}]),e}()}},function(e,t){},function(e,t){e.exports='<div class=profiles-viewer> <h4>Profiles archive</h4> <select class=profiles-viewer__profiles ng-change=$ctrl.loadColorProfile() ng-model=$ctrl.profileName> <option ng-show="$ctrl.colorProfiles.profileNames.length < 1" value="" selected=selected>Select profile...</option> <option ng-repeat="profile in $ctrl.colorProfiles.profileNames" data-colorprofiles-profile={{$index}} value={{profile}}>{{profile}}</option> </select> <div class=profiles-viewer__search> <input class=profiles-viewer__search-input type=text ng-model=$ctrl.searchWord placeholder="search by word..."> </div> <h5 ng-show=$ctrl.selectedProfile>Total: {{$ctrl.countProfileWords()}} {{$ctrl.countProfileWords() > 1 ? "words" : "word"}} <div ng-show=!$ctrl.foundWord ng-click=$ctrl.clickHandler($event) class=profiles-viewer__words infinite-scroll=$ctrl.showMore() infinite-scroll-distance=0> <div ng-repeat="word in $ctrl.words track by word.word" class=profiles-viewer__section> <span ng-show="$ctrl.selectedWord === word.word" class="glyphicon glyphicon-remove profiles-viewer__delete" ng-attr-delete="{{$ctrl.selectedWord === word.word ? word.word : undefined}}"></span> <div ng-class="{\'profiles-viewer__section-title\': word.type === \'title\', \'profiles-viewer__section-word\': word.type === \'word\'}" ng-attr-word="{{word.type === \'word\' ? word.word : undefined}}">{{word.word}}</div> <div ng-show="word.type === \'word\'" class=profiles-viewer__space></div> <div ng-show="word.type === \'word\'" class=profiles-viewer__color ng-style="{\'background-color\': word.color}"></div> </div> </div> <div ng-click=$ctrl.clickHandler($event) ng-show=$ctrl.foundWord class="profiles-viewer__search-result profiles-viewer__section"> <span ng-show="$ctrl.selectedWord === $ctrl.foundWord.word" class="glyphicon glyphicon-remove profiles-viewer__delete" ng-attr-delete={{$ctrl.foundWord.word}}></span> <div class=profiles-viewer__section-word ng-attr-word={{$ctrl.foundWord.word}}>{{$ctrl.foundWord.word}}</div> <div class=profiles-viewer__space></div> <div class=profiles-viewer__color ng-style="{\'background-color\': $ctrl.foundWord.color}"></div> </div> </h5></div>'},function(e,t){},function(e,t){e.exports='<span us-spinner="{position: \'fixed\', color: \'#428bca\'}" spinner-key=spinner-1></span> <div class=color-search__content> <div class=color-search__header> <div ng-click=$ctrl.goToMain() class=color-search__logo><div class=color-search__logo-image></div></div> <div class=color-search__navigation> <a class="btn-bodyless btn-bodyless-default" ng-click=$ctrl.goToGuide()>Guide</a><span class=color-search__separator></span> <a class="btn-bodyless btn-bodyless-default" ng-click=$ctrl.goToSettings()>Archive</a> </div> </div> <ui-view name=pages> <main ng-show="$ctrl.page == \'main\'"></main> <guide ng-show="$ctrl.page == \'guide\'"></guide> <profiles-viewer ng-show="$ctrl.page === \'profiles\'"></profiles-viewer> </ui-view> </div> '},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),s=i(r),n=o(2),l=i(n),a=o(271),c=i(a),d=function(){function e(t,o){(0,s.default)(this,e),this.required=null,this.auth=null,this.success=!1,this.password=null,this.jsonrpc=o,this.$q=t}return(0,l.default)(e,[{key:"isSet",value:function(){return null!==this.password}},{key:"isSuccessful",value:function(){return null!==this.auth&&this.success}},{key:"login",value:function(){var e=this,t=this,o=(0,c.default)(""+this.password);return this.jsonrpc.request("login",{login:o}).then(function(i){return!!i.success&&(t.auth=o,e.success=!0,!0)})}},{key:"isRequired",value:function(){var e=this;return this.required?this.$q.resolve(!0):this.jsonrpc.request("loginRequired",{}).then(function(t){return e.required=t.required,e.required})}}]),e}();t.default=d},,,,function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),o(275);var r=o(276),s=i(r),n=o(277),l=i(n),a=o(278),c=i(a);angular.module("dialog",[]).service("popupDialog",["$rootScope","$compile",function(e,t){function o(o,i,s){var l='<div class="dialog" ng-click="close($event)">\n        <div class="dialog__window">'+o+"</div></div>";r=e.$new(!0),r.$ctrl=new i,r.closeByOutside=s,r.close=function(e){angular.element(e.target).hasClass("dialog")&&r.closeByOutside&&a.close()};var c=t(l)(r);n=angular.element(c).appendTo("body")}var i=this,r=null,n=null,a=this;this.close=function(){n&&r&&(n.remove(),r.$destroy(),n=null,r=null,angular.element("*").removeAttr("tabindex"))},this.errorDialog=function(e){i.close(),angular.element("*").attr("tabindex",-1),angular.element("*").blur(),o(c.default,e,!1)},this.confirmDialog=function(e){i.close(),angular.element("*").attr("tabindex",-1),angular.element("*").blur(),o(s.default,e,!0)},this.loginDialog=function(e){i.close(),angular.element("*").attr("tabindex",-1),angular.element("*").blur(),o(l.default,e,!1)}}]),t.default="dialog"},function(e,t){},function(e,t){e.exports='<div class=confirm-dialog> <h4><span class="glyphicon glyphicon-question-sign"></span> Confirm <span class=confirm-dialog__title>{{$ctrl.title}}</span></h4> <p>Are you sure you want to proceed?</p> <div style=float:right> <a class="btn btn-danger" ng-click=$ctrl.cancel()>Cancel</a> <a class="btn btn-success" ng-click=$ctrl.yes()>Yes</a> </div><div style=clear:both></div> </div>'},function(e,t){e.exports='<div class=login-dialog> <div class=form-group><input ng-model=$ctrl.model.password type=password class=form-control placeholder=Password></div> <a ng-click=$ctrl.login() class="btn btn-success btn-block"><span class="glyphicon glyphicon-cloud-upload" aria-hidden=true></span> Log in</a> </div>'},function(e,t){e.exports='<div class=error-dialog> <h4><span class="glyphicon glyphicon-warning-sign"></span> {{$ctrl.title}}</h4> <p>{{$ctrl.description}}</p> <a ng-show=$ctrl.button ng-click=$ctrl.handle() class="btn btn-danger btn-block"><span ng-show=$ctrl.icon ng-class="\'glyphicon glyphicon-{{$ctrl.icon}}\'"></span> {{$ctrl.buttonTitle}}</a> </div>'},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(280),r=function(e){return e&&e.__esModule?e:{default:e}}(i);angular.module("db",[]).service("db",[function(){r.default.config({driver:[r.default.INDEXEDDB,r.default.WEBSQL,r.default.LOCALSTORAGE],name:"ColorSearch",version:1}),this.getStore=function(e){return r.default.createInstance({name:"ColorSearch",storeName:e})}}]),t.default="db"}]),[123]);
//# sourceMappingURL=app.bundle.js.map
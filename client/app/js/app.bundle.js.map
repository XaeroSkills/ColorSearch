{"version":3,"sources":["webpack:///js/app.bundle.js","webpack:///external \"angular\"","webpack:///./modules/profiles/classes/ColorProfile.js","webpack:///./app.js","webpack:///./modules/color-search/color-search.js","webpack:///./modules/color-search/core/routing/Routes.js","webpack:///./modules/color-search/core/models/Settings.js","webpack:///./modules/color-search/core/models/ColorService.js","webpack:///./modules/color-search/core/models/HSLColor.js","webpack:///./modules/color-search/core/models/ColorSet.js","webpack:///./modules/color-search/core/models/TextColors.js","webpack:///./modules/color-search/core/services/rpc/JsonRpc.js","webpack:///./modules/main/main.js","webpack:///./modules/main/template/main.html","webpack:///./modules/color-adjuster/color-adjuster.js","webpack:///./modules/color-adjuster/template/color-adjuster.html","webpack:///./modules/text-colorizer/text-colorizer.js","webpack:///./modules/text-colorizer/template/text-colorizer.html","webpack:///./modules/text-colorizer/classes/Words.js","webpack:///./modules/text-colorizer/classes/Caret.js","webpack:///./modules/text-colorizer/classes/Helper.js","webpack:///./modules/text-colorizer/classes/Parser.js","webpack:///./modules/text-colorizer/classes/WordNode.js","webpack:///./modules/color-toolbar/color-toolbar.js","webpack:///./modules/color-toolbar/template/color-toolbar.html","webpack:///./modules/image-finder/image-finder.js","webpack:///./modules/image-finder/template/image-finder.html","webpack:///./modules/image-finder/classes/Images.js","webpack:///./modules/image-finder/classes/Image.js","webpack:///./modules/image-finder/classes/ImagesRPCService.js","webpack:///./modules/image-finder/classes/ImageInspector.js","webpack:///./modules/image-finder/image-viewer/image-viewer.js","webpack:///./modules/image-finder/image-viewer/template/image-viewer.html","webpack:///./modules/settings/settings.js","webpack:///./modules/settings/template/settings.html","webpack:///./modules/guide/guide.js","webpack:///./modules/guide/template/guide.html","webpack:///./modules/profiles/profiles.js","webpack:///./modules/profiles/classes/ColorProfiles.js","webpack:///./modules/profiles/classes/ColorProfilesDAO.js","webpack:///./modules/profiles/color-profiles/color-profiles.js","webpack:///./modules/profiles/color-profiles/template/color-profiles.html","webpack:///./modules/profiles/classes/Utils.js","webpack:///./modules/profiles/profiles-viewer/profiles-viewer.js","webpack:///./modules/profiles/profiles-viewer/template/profiles-viewer.html","webpack:///./modules/color-search/template/color-search.html","webpack:///./modules/color-search/core/models/Login.js","webpack:///./modules/color-search/core/services/dialog/dialog.js","webpack:///./modules/color-search/core/services/dialog/templates/confirm.html","webpack:///./modules/color-search/core/services/dialog/templates/login.html","webpack:///./modules/color-search/core/services/dialog/templates/error.html","webpack:///./modules/color-search/core/services/db/db.js"],"names":["webpackJsonp","Array","concat","module","exports","angular","__webpack_require__","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_slicedToArray2","_slicedToArray3","_getIterator2","_getIterator3","_map","_map2","_toConsumableArray2","_toConsumableArray3","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","ColorProfile","name","colors","sPercentage","lPercentage","this","key","size","word","get","delete","self","o","colorService","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","next","done","_step$value","color","set","getColorInstance","err","return","Math","round","parseFloat","_colorSearch","_colorSearch2","_angularjs","_angularjs2","_Routes","_Routes2","_Settings","_Settings2","_ColorService","_ColorService2","_TextColors","_TextColors2","_JsonRpc","_JsonRpc2","_main","_main2","_guide","_guide2","_profiles","_profiles2","_Login","_Login2","_dialog","_dialog2","_db","_db2","config","provider","url","service","component","template","controller","ColorSearchCtrl","$rootScope","$timeout","$window","$transitions","$state","login","dialog","_this","_login","page","onSuccess","transition","data","to","$broadcast","_this2","element","bind","_this3","isRequired","then","required","openLoginDialog","catch","console","log","errorDialog","title","description","buttonTitle","button","icon","handle","location","reload","go","loginDialog","_this4","model","isSet","succ","close","Routes","$stateProvider","$urlRouterProvider","mainState","settingsState","guideState","state","otherwise","$inject","SettingsDAO","db","store","settings","getStore","getItem","item","deserialize","e","warn","setItem","serialize","Settings","dao","checkSemanticSimilarity","searchMode","similarityLevel","distance","supportedDistances","id","loadSettings","saveSettings","distanceMode","dto","editorFontSize","_colr","_colr2","_HSLColor","_HSLColor2","_ColorSet","_ColorSet2","ColorService","fromHsl","h","s","l","toHex","hex","fromHex","toHsl","fromHslObject","toRgbObject","fromRgbObject","rgbColor","cTemp","_len","arguments","length","rgbColors","_key","crTemp","cr","i","c1","c2","lum1","_luminanceRGB","r","g","b","lum2","_ref","RsRGB","GsRGB","BsRGB","pow","HSLColor","weight","achromatic","parseInt","w","setH","setS","setL","setWeight","str","test","re","exec","percentage","_interpolate","x","xPercentage","a","_iterator2","ColorSet","map","values","toIdString","TextColors","_words","_sPercentage","_lPercentage","_colorService","colorOccurence","adjustedColorOccurence","calculateAdjustedColors","clear","entries","push","toString","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","interpolateS","interpolateL","isAchromatic","setAchromatic","words","_keys","_keys2","JsonRpcException","error","message","conf","$get","$q","$http","jsonrpcConfig","_getInputData","methodName","args","_id","jsonrpc","method","params","_inspectDataFormat","allowedKeys","keys","ret","forEach","indexOf","_url","request","deferred","defer","req","headers","Content-Type","res","result","resolve","reject","status","promise","_colorAdjuster","_colorAdjuster2","_textColorizer","_textColorizer2","_colorToolbar","_colorToolbar2","_imageFinder","_imageFinder2","_settings","_settings2","factory","fontColor","colorWithGreaterCR","hslToRgb","rgbToHex","Main","$scope","textColors","appSettings","settingsOpened","selectedWord","textColorizer","selectedColor","searchData","resultFound","colorizer","getColorizer","setColors","_updateColors","update","getAllColors","linking","setColor","resetColor","inputComplete","_this5","confirmDialog","yes","drop","cancel","decolorizeText","_this6","resetAllColors","editMode","colorsAndWords","images","_this7","cols","toLowerCase","entry","add","colorSet","getColorSetInstance","_angularChartist","_angularChartist2","_angularjsSlider","_angularjsSlider2","ColorAdjusterCtrl","chart","options","showLabel","donut","donutWidth","donutSolid","startAngle","events","draw","context","type","attr","style","meta","responsive","slider","floor","ceil","step","onChange","_colorsChanged","onEnd","hidePointerLabels","hideLimitLabels","disabled","$on","abs","tempColors","keyColor","setColorFromString","hslToHexString","count","has","_step2$value","series","_set","_set2","_Words","_Words2","_Caret","_Caret2","_Helper","_Helper2","_Parser","_Parser2","bindings","onWordselect","TextColorizerCtrl","$element","calculateFontColor","$","$root","find","caret","helper","parser","switchToEditMode","callback","hasColors","observeEditorChanges","event","_api","$event","detail","preventDefault","doubleClick","originalEvent","handlePaste","handleKeyDown","parse","currentIds","each","elem","idString","nextSibling","nodeType","after","ids","getIds","removeWordNode","removeEmptyLast","$last","getLast","lastNodeType","moveTo","node","document","createTextNode","focus","setColorOnce","wordColors","setColorByWord","getAllWordNodes","resetOneColor","stopPropagation","$targetNode","target","is","clickOnWord","savedWord","getWordNode","empty","Words","calcFontColor","wordNodes","wordToWordNodes","colorFactory","$domNode","wordNode","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","Caret","range","createRange","sel","getSelection","setStartAfter","setEndAfter","removeAllRanges","addRange","position","textNode","setStart","collapse","text","getRangeAt","insertNode","caretOffset","doc","ownerDocument","win","defaultView","parentWindow","rangeCount","preCaretRange","cloneRange","selectNodeContents","setEnd","endContainer","endOffset","selection","textRange","preCaretTextRange","body","createTextRange","moveToElementText","setEndPoint","Helper","root","anchorNode","parentNode","keyCode","observer","MutationObserver","mutations","mutation","editable","nodes","addedNodes","nodeName","replaceElementWithTextContent","childList","observe","$elem","replaceWith","anchor","spaceNode","getCaretCharacterOffsetWithin","before","insertTextNodeAtCursor","clipboardData","getData","queryCommandSupported","execCommand","$node","contents","first","trim","spacedText","moveInText","last","$prev","hasAttribute","remove","nodeValue","_xregexp","_xregexp2","_WordNode","_WordNode2","Parser","_idCounter","_wordRegex","_wordFormatRegex","_parseElement","txt","backgroundColor","cssClass","createElement","setAttribute","_createTextDOMNode","appendChild","_analyzeWordElement","_parseTextNode","DOMNodes","index","textLength","needle","currentIndex","substring","notWord","wordDOMNode","_parseText","domNode","_createWordDOMNode","addWordNode","$word","elementText","match","css","newId","newWordNode","WordNode","reset","removeAttr","removeClass","addClass","background-color","colorModified","onClose","closed","inputColor","ColorToolbarCtrl","_calculateFontColor","wordLinking","black","white","changes","currentValue","setCurrentColor","hasClass","open","parentElement","colorElement","colorIndex","changeColor","setInitialColor","_ngInfiniteScroll","_ngInfiniteScroll2","_Images","_Images2","_ImagesRPCService","_ImagesRPCService2","_ImageInspector","_ImageInspector2","_imageViewer","$document","imageViewerCompName","imageViewerComp","onImagesFound","search","ImageFinderCtrl","imageInspector","spinner","_imageInspector","_spinner","_images","_findPending","selectedImage","imagesToShow","getImagesInInterval","showIndex","wordsAndColors","spin","findImages","stop","getImagesArray","img","imgNode","checkForImageFailure","failure","removeImage","showMore","inspect","parent","getImage","_Image","_Image2","Images","image","splice","k","start","end","slice","searchSettings","Image","previewURL","originalURL","score","toFixed","source","owner","ImagesRPCService","auth","imgs","addImage","FlickrInspectingStrategy","_errorWidth","_errorHeight","width","imageNode","naturalWidth","height","naturalHeight","InspectingBatch","strategies","portion","_imagesToInspect","_strategies","_portion","setInterval","_inspect","list","strategy","ImageInspector","batch","_imageViewer2","onImagesUpdated","ImageViewerCtrl","_canvas","_canvasContext","getContext","_imageDownload","copy","addEventListener","$apply","clearRect","href","download","crossOrigin","onload","drawImage","src","toDataURL","split","pop","click","onerror","_values","_values2","SettingsCtrl","_settingsOldState","join","save","load","_ColorProfiles","_ColorProfiles2","_colorProfiles","_profilesViewer","dbService","colorProfilesCompName","colorProfilesComp","profilesViewerCompName","profilesViewerComp","_ColorProfile","_ColorProfile2","_ColorProfilesDAO","_ColorProfilesDAO2","ColorProfiles","profileNames","loadedProfile","loadColorProfileNames","loadColorProfile","profile","saveColorProfile","loadColorProfiles","colorProfile","clb","_ref2","updateColorProfile","loadedProfileName","deleteColorProfile","_removeColorProfileName","profileName","ColorProfilesDAO","removeItem","profiles","_addColorProfileName","iterate","_colorProfiles2","_Utils","_Utils2","onLoadProfile","ColorProfilesCtrl","colorProfiles","_textColors","_mode","_utils","_singleColors","openCreateProfile","openConflicts","newProfileName","conflictColors","_checkColorConflicts","init","_resetColorConflicts","updateProfile","applyProfile","deleteProfile","convertColorArrayToMap","createColorProfile","concatColorArraysToMap","colorsMapTemp","_step3$value","mapColors","colorsArray","getValuesArray","_step4$value","c","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","_step5$value","colorsToWordArray","selected","Utils","singleColors","arr","colorMap","_profilesViewer2","ProfilesViewerCtrl","_showIndex","_wordsAndColors","selectedProfile","searchWord","foundWord","$watch","newValue","oldValue","findWordAndColor","getColorProfile","profileColors","adjustedColor","sort","current","added","charAt","toUpperCase","getColor","_getWordsInInterval","getAttribute","deleteWordDialog","deleteWord","countWords","_md","_md2","Login","success","password","_confirm","_confirm2","_login2","_error","_error2","$compile","create","Control","closeByOutside","html","scope","$new","$ctrl","compiled","appendTo","$destroy","blur","_localforage","_localforage2","driver","INDEXEDDB","WEBSQL","LOCALSTORAGE","version","createInstance","storeName"],"mappings":"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","file":"js/app.bundle.js","sourcesContent":["webpackJsonp([0],Array(20).concat([\n/* 20 */\n/***/ (function(module, exports) {\n\nmodule.exports = angular;\n\n/***/ }),\n/* 21 */,\n/* 22 */,\n/* 23 */,\n/* 24 */,\n/* 25 */,\n/* 26 */,\n/* 27 */,\n/* 28 */,\n/* 29 */,\n/* 30 */,\n/* 31 */,\n/* 32 */,\n/* 33 */,\n/* 34 */,\n/* 35 */,\n/* 36 */,\n/* 37 */,\n/* 38 */,\n/* 39 */,\n/* 40 */,\n/* 41 */,\n/* 42 */,\n/* 43 */,\n/* 44 */,\n/* 45 */,\n/* 46 */,\n/* 47 */,\n/* 48 */,\n/* 49 */,\n/* 50 */,\n/* 51 */,\n/* 52 */,\n/* 53 */,\n/* 54 */,\n/* 55 */,\n/* 56 */,\n/* 57 */,\n/* 58 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _slicedToArray2 = __webpack_require__(16);\n\nvar _slicedToArray3 = _interopRequireDefault(_slicedToArray2);\n\nvar _getIterator2 = __webpack_require__(4);\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _map = __webpack_require__(7);\n\nvar _map2 = _interopRequireDefault(_map);\n\nvar _toConsumableArray2 = __webpack_require__(26);\n\nvar _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n* Represents color Profile\r\n* @constructor\r\n* @param {String} name Name of the profile\r\n* @param {Map} colors Colors\r\n* @param {Number} sPercentage Saturation global setting\r\n* @param {Number} lPercentage Lightness global setting\r\n* @memberof module:profiles\r\n*/\n\nvar ColorProfile = function () {\n    function ColorProfile(name, colors, sPercentage, lPercentage) {\n        (0, _classCallCheck3.default)(this, ColorProfile);\n\n        this.name = name;\n        this.colors = colors;\n        this.sPercentage = sPercentage;\n        this.lPercentage = lPercentage;\n    }\n\n    (0, _createClass3.default)(ColorProfile, [{\n        key: \"countWords\",\n        value: function countWords() {\n            return this.colors.size;\n        }\n    }, {\n        key: \"getColor\",\n        value: function getColor(word) {\n            return this.colors.get(word);\n        }\n    }, {\n        key: \"deleteWord\",\n        value: function deleteWord(word) {\n            this.colors.delete(word);\n        }\n    }, {\n        key: \"serialize\",\n        value: function serialize() {\n            var self = this;\n            var o = {};\n            o.name = this.name;\n            o.colors = [].concat((0, _toConsumableArray3.default)(self.colors));\n            o.sPercentage = this.sPercentage;\n            o.lPercentage = this.lPercentage;\n            return o;\n        }\n    }], [{\n        key: \"deserialize\",\n        value: function deserialize(o, colorService) {\n            var colors = new _map2.default(o.colors);\n            var _iteratorNormalCompletion = true;\n            var _didIteratorError = false;\n            var _iteratorError = undefined;\n\n            try {\n                for (var _iterator = (0, _getIterator3.default)(colors), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                    var _step$value = (0, _slicedToArray3.default)(_step.value, 2),\n                        word = _step$value[0],\n                        color = _step$value[1];\n\n                    colors.set(word, colorService.getColorInstance(color));\n                }\n            } catch (err) {\n                _didIteratorError = true;\n                _iteratorError = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion && _iterator.return) {\n                        _iterator.return();\n                    }\n                } finally {\n                    if (_didIteratorError) {\n                        throw _iteratorError;\n                    }\n                }\n            }\n\n            var sPercentage = Math.round(parseFloat(o.sPercentage));\n            var lPercentage = Math.round(parseFloat(o.lPercentage));\n            return new ColorProfile(o.name, colors, sPercentage, lPercentage);\n        }\n    }]);\n    return ColorProfile;\n}();\n\nexports.default = ColorProfile;\n\n/***/ }),\n/* 59 */,\n/* 60 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n__webpack_require__(61);\n\nvar _colorSearch = __webpack_require__(63);\n\nvar _colorSearch2 = _interopRequireDefault(_colorSearch);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nangular.module('app', [_colorSearch2.default]);\n\n/***/ }),\n/* 61 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 62 */,\n/* 63 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _angularjs = __webpack_require__(69);\n\nvar _angularjs2 = _interopRequireDefault(_angularjs);\n\n__webpack_require__(71);\n\nvar _Routes = __webpack_require__(72);\n\nvar _Routes2 = _interopRequireDefault(_Routes);\n\nvar _Settings = __webpack_require__(73);\n\nvar _Settings2 = _interopRequireDefault(_Settings);\n\nvar _ColorService = __webpack_require__(74);\n\nvar _ColorService2 = _interopRequireDefault(_ColorService);\n\nvar _TextColors = __webpack_require__(110);\n\nvar _TextColors2 = _interopRequireDefault(_TextColors);\n\nvar _JsonRpc = __webpack_require__(116);\n\nvar _JsonRpc2 = _interopRequireDefault(_JsonRpc);\n\nvar _main = __webpack_require__(121);\n\nvar _main2 = _interopRequireDefault(_main);\n\nvar _guide = __webpack_require__(168);\n\nvar _guide2 = _interopRequireDefault(_guide);\n\nvar _profiles = __webpack_require__(171);\n\nvar _profiles2 = _interopRequireDefault(_profiles);\n\n__webpack_require__(181);\n\nvar _colorSearch = __webpack_require__(182);\n\nvar _colorSearch2 = _interopRequireDefault(_colorSearch);\n\nvar _Login = __webpack_require__(183);\n\nvar _Login2 = _interopRequireDefault(_Login);\n\nvar _dialog = __webpack_require__(187);\n\nvar _dialog2 = _interopRequireDefault(_dialog);\n\nvar _db = __webpack_require__(192);\n\nvar _db2 = _interopRequireDefault(_db);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n* Root module, which contains all other application modules.\r\n* @module color-search\r\n* @requires module:@uirouter/angularjs\r\n* @requires module:jsonrpc\r\n* @requires module:profiles\r\n* @requires module:main\r\n* @requires module:guide\r\n* @requires module:dialog\r\n* @requires module:db\r\n* @requires module:angularSpinner\r\n*/\nangular.module('color-search', [_angularjs2.default, _JsonRpc2.default, _profiles2.default, _main2.default, _guide2.default, _dialog2.default, _db2.default, 'angularSpinner']).config(_Routes2.default).config(['$JsonRpcProvider', function (provider) {\n    provider.set({ url: \"/\" });\n}])\n/** Colors model. Creates new Color objects and converts color in/from\r\n* different color spaces.\r\n* @member {Service} colorService\r\n* @memberof module:color-search\r\n* @see ColorService class\r\n* @instance\r\n*/\n.service('colorService', _ColorService2.default)\n/** Application and search settings model.\r\n* @member {Service} appSettings\r\n* @memberof module:color-search\r\n* @see Settings class\r\n* @instance\r\n*/\n.service('appSettings', ['db', _Settings2.default])\n/** TextColors model, which represents words and colors selected by user.\r\n* @member {Service} textColors\r\n* @memberof module:color-search\r\n* @see TextColors class\r\n* @instance\r\n*/\n.service('textColors', ['colorService', _TextColors2.default])\n/** Login model. Contains user login business logic.\r\n* @member {Service} login\r\n* @memberof module:color-search\r\n* @see Login class\r\n* @instance\r\n*/\n.service('login', ['$q', 'jsonrpc', _Login2.default])\n/** Root component of the application.\r\n* Checks on initialization if login is required.\r\n* Contains click handlers for page navigation.\r\n* @member {Component} colorSearch\r\n* @property {ColorSearchCtrl} controller\r\n* @property {String} template\r\n* @memberof module:color-search\r\n* @instance\r\n*/\n.component('colorSearch', {\n    template: _colorSearch2.default,\n    /**\r\n    * Controller for 'colorSearch' component.\r\n    * @constructor ColorSearch\r\n    * @param {Service} $rootScope Angularjs '$rootScope' service\r\n    * @param {Service} $timeout Angularjs '$timeout' service\r\n    * @param {Service} $transitions Angularjs UI Router '$transitions' service\r\n    * @param {Service} $state Angularjs UI Router '$state' service\r\n    * @param {Service} login 'login' service\r\n    * @param {Service} popupDialog 'popupDialog' service from 'dialog' module\r\n    * @see colorSearch component\r\n    * @memberof module:color-search\r\n    */\n    controller: function () {\n        (0, _createClass3.default)(ColorSearchCtrl, null, [{\n            key: '$inject',\n            get: function get() {\n                return ['$rootScope', '$timeout', '$window', '$transitions', '$state', 'login', 'popupDialog'];\n            }\n        }]);\n\n        function ColorSearchCtrl($rootScope, $timeout, $window, $transitions, $state, login, dialog) {\n            var _this = this;\n\n            (0, _classCallCheck3.default)(this, ColorSearchCtrl);\n\n            this.$rootScope = $rootScope;\n            this.$timeout = $timeout;\n            this.$window = $window;\n            this.$state = $state;\n            this._login = login;\n            this._dialog = dialog;\n            this.page = \"main\";\n\n            $transitions.onSuccess({}, function (transition) {\n                var data = transition.to().data;\n                _this.page = data[\"page\"];\n                $timeout(function () {\n                    $rootScope.$broadcast('rzSliderForceRender');\n                    $rootScope.$broadcast('refresh');\n                }, 0, false);\n            });\n        }\n\n        (0, _createClass3.default)(ColorSearchCtrl, [{\n            key: '$onInit',\n            value: function $onInit() {\n                var _this2 = this;\n\n                angular.element(this.$window).bind('resize orientationchange', function () {\n                    _this2.$timeout(function () {\n                        _this2.$rootScope.$broadcast('rzSliderForceRender');\n                        _this2.$rootScope.$broadcast('refresh');\n                    });\n                });\n            }\n        }, {\n            key: '$postLink',\n            value: function $postLink() {\n                var _this3 = this;\n\n                this._login.isRequired().then(function (required) {\n                    if (required) {\n                        _this3.openLoginDialog();\n                    }\n                }).catch(function (err) {\n                    console.log(err);\n                    var self = _this3;\n                    _this3._dialog.errorDialog(function () {\n                        this.title = \"Connection error\";\n                        this.description = \"Try to reload the application.\";\n                        this.buttonTitle = \"Reload\";\n                        this.button = true;\n                        this.icon = 'refresh';\n                        this.handle = function () {\n                            self.$window.location.reload(true);\n                        };\n                    });\n                });\n            }\n\n            /** Navigate to settings page.\r\n            * @method goToSettings\r\n            * @memberof module:color-search.ColorSearch\r\n            * @instance\r\n            */\n\n        }, {\n            key: 'goToSettings',\n            value: function goToSettings() {\n                this.page = \"profiles\";\n                this.$state.go('main.profiles');\n            }\n\n            /** Navigate to guide page.\r\n            * @method goToGuide\r\n            * @memberof module:color-search.ColorSearch\r\n            * @instance\r\n            */\n\n        }, {\n            key: 'goToGuide',\n            value: function goToGuide() {\n                this.page = \"guide\";\n                this.$state.go('main.guide');\n            }\n\n            /** Navigate to main page.\r\n            * @method goToMain\r\n            * @memberof module:color-search.ColorSearch\r\n            * @instance\r\n            */\n\n        }, {\n            key: 'goToMain',\n            value: function goToMain() {\n                this.page = \"main\";\n                this.$state.go('main');\n            }\n\n            /** Open login dialog.\r\n            * @method openLoginDialog\r\n            * @memberof module:color-search.ColorSearch\r\n            * @instance\r\n            */\n\n        }, {\n            key: 'openLoginDialog',\n            value: function openLoginDialog() {\n                var self = this;\n                this._dialog.loginDialog(function () {\n                    var _this4 = this;\n\n                    this.model = self._login;\n                    this.login = function () {\n                        if (_this4.model.isSet()) {\n                            _this4.model.login().then(function (succ) {\n                                if (succ) {\n                                    self._dialog.close();\n                                }\n                            });\n                        }\n                    };\n                });\n            }\n        }]);\n        return ColorSearchCtrl;\n    }()\n});\n\nexports.default = 'color-search';\n\n/***/ }),\n/* 64 */,\n/* 65 */,\n/* 66 */,\n/* 67 */,\n/* 68 */,\n/* 69 */,\n/* 70 */,\n/* 71 */,\n/* 72 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/**\n* Routes to pages\n* @constructor\n* @param {$stateProvider} $stateProvider UI router '$stateProvider'\n* @param {$urlRouterProvider} $urlRouterProvider UI router '$urlRouterProvider'\n* @memberof module:color-search\n*/\nfunction Routes($stateProvider, $urlRouterProvider) {\n    var mainState = {\n        name: 'main',\n        url: '/main',\n        data: { page: \"main\" }\n    };\n\n    var settingsState = {\n        name: 'main.profiles',\n        url: '^/profiles',\n        data: { page: \"profiles\" }\n    };\n\n    var guideState = {\n        name: 'main.guide',\n        url: '^/guide',\n        data: { page: \"guide\" }\n    };\n\n    $stateProvider.state(mainState);\n    $stateProvider.state(settingsState);\n    $stateProvider.state(guideState);\n    $urlRouterProvider.otherwise('/main');\n}\n\nRoutes.$inject = ['$stateProvider', '$urlRouterProvider'];\nexports.default = Routes;\n\n/***/ }),\n/* 73 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n* Data Access Object for Settings model.\n* Used for saving and loading of application & search setttings\n* in client database.\n* @constructor:\n* @param {Service} db 'db' service\n* @memberof module:color-search\n*/\nvar SettingsDAO = function () {\n    function SettingsDAO(db) {\n        (0, _classCallCheck3.default)(this, SettingsDAO);\n\n        this.store = \"settings\";\n        this.db = db;\n    }\n\n    /** Load settings from client database.\n    * @method loadSettings\n    * @param {Settings} settings Settings model\n    * @param {function} succ Callback on success\n    * @param {function} err Callback on error\n    * @memberof module:color-search.SettingsDAO\n    * @instance\n    */\n\n\n    (0, _createClass3.default)(SettingsDAO, [{\n        key: 'loadSettings',\n        value: function loadSettings(settings, succ, err) {\n            this.db.getStore(this.store).getItem('settings').then(function (item) {\n                settings.deserialize(item);\n                if (succ) {\n                    succ();\n                }\n            }).catch(function (e) {\n                console.warn(e);\n                if (err) {\n                    err();\n                }\n            });\n        }\n\n        /** Save settings in client database.\n        * @method saveSettings\n        * @param {Settings} settings Settings model\n        * @param {function} succ Callback on success\n        * @param {function} err Callback on error\n        * @memberof module:color-search.SettingsDAO\n        * @instance\n        */\n\n    }, {\n        key: 'saveSettings',\n        value: function saveSettings(settings, succ, err) {\n            this.db.getStore(this.store).setItem('settings', settings.serialize()).then(function () {\n                if (succ) {\n                    succ();\n                }\n            }).catch(function (e) {\n                console.warn(e);\n                if (err) {\n                    err();\n                }\n            });\n        }\n    }]);\n    return SettingsDAO;\n}();\n\n/**\n* Application & search settings model.\n* @constructor:\n* @param {Service} db 'db' service\n* @memberof module:color-search\n*/\n\n\nvar Settings = function () {\n    function Settings(db) {\n        (0, _classCallCheck3.default)(this, Settings);\n\n        this.module = 'settings';\n        this.dao = new SettingsDAO(db);\n        this.checkSemanticSimilarity = false;\n        this.searchMode = 'regular';\n        this.similarityLevel = 85;\n        this.distance = 'euclidean';\n        this.supportedDistances = [{ id: 'euclidean', name: 'Euclidean' }, { id: 'chisquare', name: 'Chi-Square' }];\n    }\n\n    /** Load settings from database.\n    * @method load\n    * @memberof module:color-search.Settings\n    * @instance\n    */\n\n\n    (0, _createClass3.default)(Settings, [{\n        key: 'load',\n        value: function load(succ, err) {\n            this.dao.loadSettings(this, succ, err);\n        }\n\n        /** Save current settings in database.\n        * @method save\n        * @memberof module:color-search.Settings\n        * @instance\n        */\n\n    }, {\n        key: 'save',\n        value: function save(succ, err) {\n            this.dao.saveSettings(this, succ, err);\n        }\n\n        /** Creates JSON (object literal)\n        * @method serialize\n        * @memberof module:color-search.Settings\n        * @instance\n        */\n\n    }, {\n        key: 'serialize',\n        value: function serialize() {\n            var o = {};\n            o.module = 'settings';\n            o.checkSemanticSimilarity = this.checkSemanticSimilarity;\n            o.searchMode = this.searchMode;\n            o.similarityLevel = this.similarityLevel;\n            o.distance = this.distance;\n            o.distanceMode = this.distanceMode;\n            return o;\n        }\n\n        /** Deserialite settings from database object.\n        * @method deserialize\n        * @param {Object} dto Object from client database.\n        * @memberof module:color-search.Settings\n        * @instance\n        */\n\n    }, {\n        key: 'deserialize',\n        value: function deserialize(dto) {\n            if (dto) {\n                this.editorFontSize = dto.editorFontSize;\n                this.checkSemanticSimilarity = dto.checkSemanticSimilarity;\n                this.searchMode = dto.searchMode;\n                this.similarityLevel = dto.similarityLevel;\n                this.distance = dto.distance;\n            } else {\n                console.warn(\"Settings not loaded\");\n            }\n        }\n\n        /** Get search settings.\n        * @method getSearchSettings\n        * @return {Object}\n        * @memberof module:color-search.Settings\n        * @instance\n        */\n\n    }, {\n        key: 'getSearchSettings',\n        value: function getSearchSettings() {\n            var o = {};\n            o.checkSemanticSimilarity = this.checkSemanticSimilarity;\n            o.searchMode = this.searchMode;\n            o.similarityLevel = this.similarityLevel;\n            o.distance = this.distance;\n            o.distanceMode = this.distanceMode;\n            return o;\n        }\n    }]);\n    return Settings;\n}();\n\nexports.default = Settings;\n\n/***/ }),\n/* 74 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _colr = __webpack_require__(75);\n\nvar _colr2 = _interopRequireDefault(_colr);\n\nvar _HSLColor = __webpack_require__(77);\n\nvar _HSLColor2 = _interopRequireDefault(_HSLColor);\n\nvar _ColorSet = __webpack_require__(78);\n\nvar _ColorSet2 = _interopRequireDefault(_ColorSet);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n* Color manager class. Creates color objects and converts colors\n* in different color spaces and formats.\n* @constructor:\n* @memberof module:color-search\n*/\nvar ColorService = function () {\n    function ColorService() {\n        (0, _classCallCheck3.default)(this, ColorService);\n    }\n\n    (0, _createClass3.default)(ColorService, [{\n        key: 'getColorInstance',\n\n\n        /** Creates new HSLColor instance.\n        * @method getColorInstance\n        * @return {HSLColor}\n        * @memberof module:color-search.ColorService\n        * @instance\n        */\n        value: function getColorInstance(o) {\n            return new _HSLColor2.default(o);\n        }\n\n        /** Creates new ColorSet instance.\n        * @method getColorSetInstance\n        * @return {ColorSet}\n        * @memberof module:color-search.ColorService\n        * @instance\n        */\n\n    }, {\n        key: 'getColorSetInstance',\n        value: function getColorSetInstance() {\n            return new _ColorSet2.default();\n        }\n\n        /** Converts hsl object into hex string color representation.\n        * @method hslToHexString\n        * @param {Object} color Object with h,s,l values\n        * @return {string}\n        * @memberof module:color-search.ColorService\n        * @instance\n        */\n\n    }, {\n        key: 'hslToHexString',\n        value: function hslToHexString(color) {\n            return _colr2.default.fromHsl(color.h, color.s, color.l).toHex();\n        }\n\n        /** Converts hex string color into HSL object.\n        * @method hexToHsl\n        * @param {string} hex Hex-string\n        * @return {HSLColor}\n        * @memberof module:color-search.ColorService\n        * @instance\n        */\n\n    }, {\n        key: 'hexToHsl',\n        value: function hexToHsl(hex) {\n            return _colr2.default.fromHex(hex).toHsl();\n        }\n\n        /** Converts HSL object into HSL string\n        * @method toString\n        * @return {string}\n        * @memberof module:color-search.ColorService\n        * @instance\n        */\n\n    }, {\n        key: 'hslToHslString',\n        value: function hslToHslString(color) {\n            return 'hsl(' + color.h + ',' + color.s + '%,' + color.l + '%)';\n        }\n\n        /** Converts HSL object into RGB object.\n        * @method hslToRgb\n        * @return {Object} Object with r,g,b values\n        * @memberof module:color-search.ColorService\n        * @instance\n        */\n\n    }, {\n        key: 'hslToRgb',\n        value: function hslToRgb(color) {\n            return _colr2.default.fromHslObject(color).toRgbObject();\n        }\n\n        /** Converts RGB object into hex string.\n        * @method rgbToHex\n        * @param {Object} color Object with r,g,b values.\n        * @return {string}\n        * @memberof module:color-search.ColorService\n        * @instance\n        */\n\n    }, {\n        key: 'rgbToHex',\n        value: function rgbToHex(color) {\n            return _colr2.default.fromRgbObject(color).toHex();\n        }\n\n        /** Return color with greater CR value.\n        * @method colorWithGreaterCR\n        * @param {Object} rgbColor Object with r,g,b values.\n        * @param {Object[]} rgbColors Objects, each with r,g,b, values.\n        * @return {Object} Object with r,g,b values.\n        * @memberof module:color-search.ColorService\n        * @instance\n        */\n\n    }, {\n        key: 'colorWithGreaterCR',\n        value: function colorWithGreaterCR(rgbColor) {\n            var cTemp = rgbColor;\n\n            for (var _len = arguments.length, rgbColors = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n                rgbColors[_key - 1] = arguments[_key];\n            }\n\n            if (rgbColors && rgbColors.length > 0) {\n                cTemp = rgbColors[0];\n                var crTemp = this.cr(rgbColor, rgbColors[0]);\n                for (var i = 0; i < rgbColors.length; i++) {\n                    var cr = this.cr(rgbColor, rgbColors[i]);\n                    if (crTemp < cr) {\n                        crTemp = cr;\n                        cTemp = rgbColors[i];\n                    }\n                }\n            }\n            return cTemp;\n        }\n\n        /** Calculate CR value for two given RGB color objects.\n        * Uses W3C recommended algorithm.\n        * @method cr\n        * @param {Object} c1 Object with r,g,b values.\n        * @param {Object} c2 Objects, each with r,g,b, values.\n        * @return {number}\n        * @memberof module:color-search.ColorService\n        * @instance\n        */\n\n    }, {\n        key: 'cr',\n        value: function cr(c1, c2) {\n            var lum1 = this._luminanceRGB(c1.r, c1.g, c1.b);\n            var lum2 = this._luminanceRGB(c2.r, c2.g, c2.b);\n            if (lum2 > lum1) {\n                var _ref = [lum2, lum1];\n                lum1 = _ref[0];\n                lum2 = _ref[1];\n            }\n            return (lum1 + 0.05) / (lum2 + 0.05);\n        }\n    }, {\n        key: '_luminanceRGB',\n        value: function _luminanceRGB(r, g, b) {\n            var RsRGB = r / 255;\n            var GsRGB = g / 255;\n            var BsRGB = b / 255;\n            var R = RsRGB <= 0.03928 ? RsRGB / 12.92 : Math.pow((RsRGB + 0.055) / 1.055, 2.4);\n            var G = GsRGB <= 0.03928 ? GsRGB / 12.92 : Math.pow((GsRGB + 0.055) / 1.055, 2.4);\n            var B = BsRGB <= 0.03928 ? BsRGB / 12.92 : Math.pow((BsRGB + 0.055) / 1.055, 2.4);\n            return 0.2126 * R + 0.7152 * G + 0.0722 * B;\n        }\n    }]);\n    return ColorService;\n}();\n\nexports.default = ColorService;\n\n/***/ }),\n/* 75 */,\n/* 76 */,\n/* 77 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n* Represents HSL color object.\n* @constructor\n* @param {Object} o (optional) Configuration object with values in format\n* {h: number, s: number, l: number, achromatic: boolean, weight: number}.\n* @property {Number} h\n* @property {Number} s\n* @property {Number} l\n* @property {Number} weight\n* @property {Boolean} achromatic\n* @memberof module:color-search\n*/\nvar HSLColor = function () {\n    function HSLColor(o) {\n        (0, _classCallCheck3.default)(this, HSLColor);\n\n        this.weight = 1;\n        this.h = undefined;\n        this.s = undefined;\n        this.l = undefined;\n        this.achromatic = false;\n\n        if (o && o[\"h\"] !== undefined && o[\"s\"] !== undefined && o[\"l\"] !== undefined) {\n            this.h = parseInt(o[\"h\"], 10);\n            this.s = parseInt(o[\"s\"], 10);\n            this.l = parseInt(o[\"l\"], 10);\n        }\n\n        if (o && o[\"weight\"]) {\n            this.weight = parseInt(o[\"weight\"], 10);\n        }\n\n        if (o && typeof o[\"achromatic\"] === \"boolean\") {\n            this.achromatic = o[\"achromatic\"];\n        }\n    }\n\n    /** Return HSL color string in format hsl(h,s%,l%).\n    * @method toString\n    * @return {string}\n    * @memberof module:color-search.HSLColor\n    * @instance\n    */\n\n\n    (0, _createClass3.default)(HSLColor, [{\n        key: \"toString\",\n        value: function toString() {\n            if (this.isSet) {\n                return \"hsl(\" + this.h + \",\" + this.s + \"%,\" + this.l + \"%)\";\n            }\n            return undefined;\n        }\n\n        /** Return unique HSL color string with weight.\n        * @method toIdString\n        * @return {string}\n        * @memberof module:color-search.HSLColor\n        * @instance\n        */\n\n    }, {\n        key: \"toIdString\",\n        value: function toIdString() {\n            return \"hsl(\" + this.h + \",\" + this.s + \"%,\" + this.l + \"%)\" + this.weight;\n        }\n\n        /** Check if color values are set.\n        * @method isSet\n        * @return {boolean}\n        * @memberof module:color-search.HSLColor\n        * @instance\n        */\n\n    }, {\n        key: \"isSet\",\n        value: function isSet() {\n            return this.h !== undefined && this.s !== undefined && this.l !== undefined;\n        }\n\n        /** Set hue\n        * @method setH\n        * @param {number} h Hue\n        * @memberof module:color-search.HSLColor\n        * @instance\n        */\n\n    }, {\n        key: \"setH\",\n        value: function setH(h) {\n            this.h = this.achromatic === true ? 0 : parseInt(h, 10);\n            return this;\n        }\n\n        /** Set saturation\n        * @method setS\n        * @param {number} s Saturation\n        * @memberof module:color-search.HSLColor\n        * @instance\n        */\n\n    }, {\n        key: \"setS\",\n        value: function setS(s) {\n            this.s = this.achromatic === true ? 0 : parseInt(s, 10);\n            return this;\n        }\n\n        /** Set lightness\n        * @method setL\n        * @param {number} l Lightness\n        * @memberof module:color-search.HSLColor\n        * @instance\n        */\n\n    }, {\n        key: \"setL\",\n        value: function setL(l) {\n            this.l = parseInt(l, 10);\n            return this;\n        }\n\n        /** Set weight\n        * @method setWeight\n        * @param {number} w Weight\n        * @memberof module:color-search.HSLColor\n        * @instance\n        */\n\n    }, {\n        key: \"setWeight\",\n        value: function setWeight(w) {\n            this.weight = parseInt(w, 10);\n            return this;\n        }\n\n        /** Set current color to achromatic.\n        * Hue and saturation values will be set to 0.\n        * @method setAchromatic\n        * @memberof module:color-search.HSLColor\n        * @instance\n        */\n\n    }, {\n        key: \"setAchromatic\",\n        value: function setAchromatic() {\n            this.h = 0;\n            this.s = 0;\n            this.achromatic = true;\n            return this;\n        }\n\n        /** Checks if current color is achromatic.\n        * @method isAchromatic\n        * @return {boolean}\n        * @memberof module:color-search.HSLColor\n        * @instance\n        */\n\n    }, {\n        key: \"isAchromatic\",\n        value: function isAchromatic() {\n            return this.achromatic;\n        }\n\n        /** Set color values from given object.\n        * @method setColor\n        * @param {Object} o Configuration object\n        * @memberof module:color-search.HSLColor\n        * @instance\n        */\n\n    }, {\n        key: \"setColor\",\n        value: function setColor(o) {\n            if (o && typeof o[\"achromatic\"] === \"boolean\") {\n                this.achromatic = o[\"achromatic\"];\n            }\n\n            if (o[\"h\"] !== undefined && o[\"s\"] !== undefined && o[\"l\"] !== undefined) {\n                this.setH(o[\"h\"]);\n                this.setS(o[\"s\"]);\n                this.setL(o[\"l\"]);\n            }\n\n            if (o[\"weight\"]) {\n                this.setWeight(o[\"weight\"]);\n            }\n            return this;\n        }\n    }, {\n        key: \"setColorFromString\",\n        value: function setColorFromString(str) {\n            var r = /^hsl\\(\\d+(\\.\\d+)?,\\d+(\\.\\d+)?%?,\\d+(\\.\\d+)?%?\\)$/i;\n            if (str && r.test(str)) {\n                var re = /\\d+(\\.\\d+)?/g;\n                this.h = parseInt(re.exec(str)[0], 10);\n                this.s = parseInt(re.exec(str)[0], 10);\n                this.l = parseInt(re.exec(str)[0], 10);\n            }\n            return this;\n        }\n\n        /** Interpolate saturation. Uses linear interpolation.\n        * @method interpolateS\n        * @param {number} percentage Number from -100 to +100\n        * @memberof module:color-search.HSLColor\n        * @instance\n        */\n\n    }, {\n        key: \"interpolateS\",\n        value: function interpolateS(percentage) {\n            this.setS(this._interpolate(this.s, percentage));\n            return this;\n        }\n\n        /** Interpolate lightness. Uses linear interpolation.\n        * @method interpolateL\n        * @param {number} percentage Number from -100 to +100\n        * @memberof module:color-search.HSLColor\n        * @instance\n        */\n\n    }, {\n        key: \"interpolateL\",\n        value: function interpolateL(percentage) {\n            this.setL(this._interpolate(this.l, percentage));\n            return this;\n        }\n\n        // linear interpolation\n\n    }, {\n        key: \"_interpolate\",\n        value: function _interpolate(x, xPercentage) {\n            var a = xPercentage <= 100 ? xPercentage / 100 : (xPercentage - 100) / 100;\n            return xPercentage <= 100 ? x * a : x * (1 - a) + 100 * a;\n        }\n\n        /** Set all values to init values.\n        * @method reset\n        * @memberof module:color-search.HSLColor\n        * @instance\n        */\n\n    }, {\n        key: \"reset\",\n        value: function reset() {\n            this.h = undefined;\n            this.s = undefined;\n            this.l = undefined;\n            this.weight = 1;\n            this.achromatic = false;\n            return this;\n        }\n\n        /** Return object in JSON (object literal) format.\n        * @method toJSON\n        * @return {Object}\n        * @memberof module:color-search.HSLColor\n        * @instance\n        */\n\n    }, {\n        key: \"toJSON\",\n        value: function toJSON() {\n            var o = {};\n            o.achromatic = this.achromatic;\n            o.l = this.l;\n            o.s = this.s;\n            o.h = this.h;\n            o.weight = this.weight;\n            return o;\n        }\n    }]);\n    return HSLColor;\n}();\n\nexports.default = HSLColor;\n\n/***/ }),\n/* 78 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _toConsumableArray2 = __webpack_require__(26);\n\nvar _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);\n\nvar _iterator = __webpack_require__(94);\n\nvar _iterator2 = _interopRequireDefault(_iterator);\n\nvar _map = __webpack_require__(7);\n\nvar _map2 = _interopRequireDefault(_map);\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n* Iterable ColorSet for colors.\n* @constructor:\n* @memberof module:color-search\n*/\nvar ColorSet = function () {\n    function ColorSet() {\n        (0, _classCallCheck3.default)(this, ColorSet);\n\n        this.map = new _map2.default();\n        this[_iterator2.default] = this.values;\n    }\n\n    /** Add color to ColorSet.\n    * @method add\n    * @param {HSLColor} color\n    * @memberof module:color-search.ColorSet\n    * @instance\n    */\n\n\n    (0, _createClass3.default)(ColorSet, [{\n        key: \"add\",\n        value: function add(color) {\n            this.map.set(color.toIdString(), color);\n        }\n\n        /** Get Iterator for color values\n        * @method values\n        * @return {Iterator<HSLColor>}\n        * @memberof module:color-search.ColorSet\n        * @instance\n        */\n\n    }, {\n        key: \"values\",\n        value: function values() {\n            return this.map.values();\n        }\n\n        /** Get Array of colors\n        * @method getValuesArray\n        * @return {HSLColor[]}\n        * @memberof module:color-search.ColorSet\n        * @instance\n        */\n\n    }, {\n        key: \"getValuesArray\",\n        value: function getValuesArray() {\n            return [].concat((0, _toConsumableArray3.default)(this.map.values()));\n        }\n\n        /** Size of ColorSet\n        * @method size\n        * @return {number}\n        * @memberof module:color-search.ColorSet\n        * @instance\n        */\n\n    }, {\n        key: \"size\",\n        value: function size() {\n            return this.map.size;\n        }\n    }]);\n    return ColorSet;\n}();\n\nexports.default = ColorSet;\n\n/***/ }),\n/* 79 */,\n/* 80 */,\n/* 81 */,\n/* 82 */,\n/* 83 */,\n/* 84 */,\n/* 85 */,\n/* 86 */,\n/* 87 */,\n/* 88 */,\n/* 89 */,\n/* 90 */,\n/* 91 */,\n/* 92 */,\n/* 93 */,\n/* 94 */,\n/* 95 */,\n/* 96 */,\n/* 97 */,\n/* 98 */,\n/* 99 */,\n/* 100 */,\n/* 101 */,\n/* 102 */,\n/* 103 */,\n/* 104 */,\n/* 105 */,\n/* 106 */,\n/* 107 */,\n/* 108 */,\n/* 109 */,\n/* 110 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _toConsumableArray2 = __webpack_require__(26);\n\nvar _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);\n\nvar _slicedToArray2 = __webpack_require__(16);\n\nvar _slicedToArray3 = _interopRequireDefault(_slicedToArray2);\n\nvar _getIterator2 = __webpack_require__(4);\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _map = __webpack_require__(7);\n\nvar _map2 = _interopRequireDefault(_map);\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n* TextColors model. Manages user selected words and colors.\n* @constructor:\n* @param {Service} colorService 'colorService' service\n* @memberof module:color-search\n*/\nvar TextColors = function () {\n    function TextColors(colorService) {\n        (0, _classCallCheck3.default)(this, TextColors);\n\n        this._words = [];\n        this._sPercentage = 100;\n        this._lPercentage = 100;\n        this._colorService = colorService;\n        this.colorOccurence = new _map2.default();\n        this.adjustedColorOccurence = new _map2.default();\n    }\n\n    /** Getter for user selected words.\n    * @method words\n    * @return {string[]}\n    * @memberof module:color-search.TextColors\n    * @instance\n    */\n\n\n    (0, _createClass3.default)(TextColors, [{\n        key: \"setSLPercentage\",\n\n\n        /** Setter for global saturation & lightness percentage\n        * @method setSLPercentage\n        * @param {number} sPercentage\n        * @param {number} lPercentage\n        * @memberof module:color-search.TextColors\n        * @instance\n        */\n        value: function setSLPercentage(sPercentage, lPercentage) {\n            this._sPercentage = sPercentage;\n            this._lPercentage = lPercentage;\n            this.calculateAdjustedColors();\n        }\n\n        /** Delete all colors & words\n        * @method clear\n        * @memberof module:color-search.TextColors\n        * @instance\n        */\n\n    }, {\n        key: \"clear\",\n        value: function clear() {\n            this._words.length = 0;\n            this.colorOccurence.clear();\n            this.adjustedColorOccurence.clear();\n        }\n\n        /** Update all colors.\n        * @method update\n        * @param {Map} colors Hashmap with selected colors\n        * @param {number} sPercentage Global saturation percentage setting (-100 to + 100).\n        * @param {number} lPercentageGlobal Global lightness percentage setting (-100 to +100).\n        * @memberof module:color-search.TextColors\n        * @instance\n        */\n\n    }, {\n        key: \"update\",\n        value: function update(colors, sPercentage, lPercentage) {\n            this.clear();\n            if (colors && colors.size > 0) {\n                var _iteratorNormalCompletion = true;\n                var _didIteratorError = false;\n                var _iteratorError = undefined;\n\n                try {\n                    for (var _iterator = (0, _getIterator3.default)(colors.entries()), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                        var _step$value = (0, _slicedToArray3.default)(_step.value, 2),\n                            key = _step$value[0],\n                            value = _step$value[1];\n\n                        if (value.color && value.color.isSet()) {\n                            this._words.push(value.word);\n                            var color = this.colorOccurence.get(value.color.toString());\n                            if (color) {\n                                color.setWeight(color.weight + value.color.weight);\n                            } else {\n                                color = this._colorService.getColorInstance(value.color);\n                                this.colorOccurence.set(color.toString(), color);\n                            }\n                        }\n                    }\n                } catch (err) {\n                    _didIteratorError = true;\n                    _iteratorError = err;\n                } finally {\n                    try {\n                        if (!_iteratorNormalCompletion && _iterator.return) {\n                            _iterator.return();\n                        }\n                    } finally {\n                        if (_didIteratorError) {\n                            throw _iteratorError;\n                        }\n                    }\n                }\n            }\n            this.sPercentage = typeof sPercentage === \"number\" ? sPercentage : this.sPercentage;\n            this.lPercentage = typeof lPercentage === \"number\" ? lPercentage : this.lPercentage;\n            this.calculateAdjustedColors();\n        }\n\n        /** Recalculate all colors using global sPercentage & lPercentage (interpolation used).\n        * @method calculateAdjustedColors\n        * @memberof module:color-search.TextColors\n        * @instance\n        */\n\n    }, {\n        key: \"calculateAdjustedColors\",\n        value: function calculateAdjustedColors() {\n            this.adjustedColorOccurence.clear();\n            var _iteratorNormalCompletion2 = true;\n            var _didIteratorError2 = false;\n            var _iteratorError2 = undefined;\n\n            try {\n                for (var _iterator2 = (0, _getIterator3.default)(this.colorOccurence.values()), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                    var value = _step2.value;\n\n                    var color = this._colorService.getColorInstance(value);\n                    color.interpolateS(this.sPercentage).interpolateL(this.lPercentage);\n                    if (value.isAchromatic()) {\n                        color.setAchromatic();\n                    }\n                    this.adjustedColorOccurence.set(color.toString(), color);\n                }\n            } catch (err) {\n                _didIteratorError2 = true;\n                _iteratorError2 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                        _iterator2.return();\n                    }\n                } finally {\n                    if (_didIteratorError2) {\n                        throw _iteratorError2;\n                    }\n                }\n            }\n        }\n    }, {\n        key: \"words\",\n        get: function get() {\n            return this._words;\n        }\n\n        /** Getter for user selected colors.\n        * @method colors\n        * @return {HSLColor[]}\n        * @memberof module:color-search.TextColors\n        * @instance\n        */\n\n    }, {\n        key: \"colors\",\n        get: function get() {\n            return [].concat((0, _toConsumableArray3.default)(this.adjustedColorOccurence.values()));\n        }\n\n        /** Getter for user selected colors & words\n        * @method colorsAndWords\n        * @return {Object} Object in form {colors: Map, words: string[]}.\n        * @memberof module:color-search.TextColors\n        * @instance\n        */\n\n    }, {\n        key: \"colorsAndWords\",\n        get: function get() {\n            var o = {};\n            o.colors = this.colors;\n            o.words = this.words;\n            return o;\n        }\n\n        /** Getter for global saturation percentage\n        * @method sPercentage\n        * @return {number}\n        * @memberof module:color-search.TextColors\n        * @instance\n        */\n\n    }, {\n        key: \"sPercentage\",\n        get: function get() {\n            return this._sPercentage;\n        }\n\n        /** Getter for global lightness percentage\n        * @method lPercentage\n        * @return {number}\n        * @memberof module:color-search.TextColors\n        * @instance\n        */\n        ,\n\n\n        /** Setter for global saturation percentage\n        * @method sPercentage\n        * @param {number} sPercentage\n        * @memberof module:color-search.TextColors\n        * @instance\n        */\n        set: function set(sPercentage) {\n            this._sPercentage = sPercentage;\n            this.calculateAdjustedColors();\n        }\n\n        /** Setter for global lightness percentage\n        * @method lPercentage\n        * @param {number} lPercentage\n        * @memberof module:color-search.TextColors\n        * @instance\n        */\n\n    }, {\n        key: \"lPercentage\",\n        get: function get() {\n            return this._lPercentage;\n        },\n        set: function set(lPercentage) {\n            this._lPercentage = lPercentage;\n            this.calculateAdjustedColors();\n        }\n    }]);\n    return TextColors;\n}();\n\nexports.default = TextColors;\n\n/***/ }),\n/* 111 */,\n/* 112 */,\n/* 113 */,\n/* 114 */,\n/* 115 */,\n/* 116 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _keys = __webpack_require__(117);\n\nvar _keys2 = _interopRequireDefault(_keys);\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar JsonRpcException = function JsonRpcException(error) {\n    (0, _classCallCheck3.default)(this, JsonRpcException);\n\n    this.name = \"jsonRpcException\";\n    this.message = error;\n};\n\n/**\n* Connects with server using AJAX and sends\n* requests in JSON-RPC 2.0 message format.\n* @module jsonrpc\n*/\n\n\nangular.module('jsonrpc', []).provider('$JsonRpc', function () {\n    var url = \"\";\n    this.set = function (conf) {\n        url = conf[\"url\"];\n    };\n    this.$get = function () {\n        return {\n            url: url\n        };\n    };\n})\n/** Service for JSON-RPC 2.0 requests.\n* @member {Service} jsonrpc\n* @memberof module:jsonrpc\n* @instance\n*/\n.service(\"jsonrpc\", [\"$q\", \"$http\", \"$JsonRpc\", function ($q, $http, jsonrpcConfig) {\n    var _url = jsonrpcConfig.url;\n    if (!_url) {\n        throw new JsonRpcException('Please configure server url');\n    }\n    var _id = 0;\n    this.request = function (method, params) {\n        var deferred = $q.defer();\n        var req = {\n            method: 'POST',\n            url: _url,\n            headers: { 'Content-Type': 'application/json' },\n            data: _getInputData(method, params)\n        };\n\n        $http(req).then(function (res) {\n            var data = res.data;\n            if (!res || !data) {\n                deferred.reject(new JsonRpcException(\"Unknown Error occured. No data received\"));\n            } else if (data && data.result !== undefined) {\n                if (!_inspectDataFormat(data)) {\n                    deferred.reject(new JsonRpcException(\"JSON-RPC 2.0 data format must be used.\"));\n                } else {\n                    deferred.resolve(data.result);\n                }\n            } else {\n                console.log(data);\n                deferred.reject(new JsonRpcException('No data received. HTTP status code: ' + data.error.status));\n            }\n        }, function (error) {\n            if (error) {\n                deferred.reject(new JsonRpcException('Error occured. HTTP status code: ' + error.status));\n            } else {\n                deferred.reject(new JsonRpcException(\"Unknown Error occurred\"));\n            }\n        });\n        return deferred.promise;\n    };\n\n    function _getInputData(methodName, args) {\n        _id += 1;\n        return {\n            jsonrpc: '2.0',\n            id: _id,\n            method: methodName,\n            params: args\n        };\n    }\n\n    function _inspectDataFormat(data) {\n        var allowedKeys = [\"jsonrpc\", \"id\", \"result\"];\n        var keys = (0, _keys2.default)(data);\n        var ret = false;\n        if (keys.length === allowedKeys.length) {\n            ret = true;\n            keys.forEach(function (key) {\n                if (allowedKeys.indexOf(key) < 0) {\n                    ret = false;\n                }\n                if (key === \"jsonrpc\" && data[key] !== \"2.0\") {\n                    ret = false;\n                }\n            });\n        }\n        return ret;\n    }\n}]);\n\nexports.default = 'jsonrpc';\n\n/***/ }),\n/* 117 */,\n/* 118 */,\n/* 119 */,\n/* 120 */,\n/* 121 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _getIterator2 = __webpack_require__(4);\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _map = __webpack_require__(7);\n\nvar _map2 = _interopRequireDefault(_map);\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\n__webpack_require__(122);\n\nvar _main = __webpack_require__(123);\n\nvar _main2 = _interopRequireDefault(_main);\n\nvar _colorAdjuster = __webpack_require__(124);\n\nvar _colorAdjuster2 = _interopRequireDefault(_colorAdjuster);\n\nvar _textColorizer = __webpack_require__(130);\n\nvar _textColorizer2 = _interopRequireDefault(_textColorizer);\n\nvar _colorToolbar = __webpack_require__(145);\n\nvar _colorToolbar2 = _interopRequireDefault(_colorToolbar);\n\nvar _imageFinder = __webpack_require__(148);\n\nvar _imageFinder2 = _interopRequireDefault(_imageFinder);\n\nvar _settings = __webpack_require__(160);\n\nvar _settings2 = _interopRequireDefault(_settings);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n* @module main\r\n* @requires module:color-adjuster\r\n* @requires module:text-colorizer\r\n* @requires module:color-toolbar\r\n* @requires module:image-finder\r\n* @requires module:settings\r\n*/\nangular.module('main', [_colorAdjuster2.default, _textColorizer2.default, _colorToolbar2.default, _imageFinder2.default, _settings2.default])\n/** Calculates font color according to background color.\r\n*  Uses 'colorService' for calculations.\r\n* @member {Factory} calculateFontColor\r\n* @memberof module:main\r\n* @instance\r\n*/\n.factory('calculateFontColor', ['colorService', function (colorService) {\n    return function (color) {\n        var fontColor = colorService.colorWithGreaterCR(colorService.hslToRgb(color), { r: 0, g: 0, b: 0 }, { r: 255, g: 255, b: 255 });\n        return colorService.rgbToHex(fontColor);\n    };\n}])\n/** Representation of 'main' page in web application.\r\n* Contains several child components which are responsible for main functionality\r\n* of the application. Orchestrates the collaboration of the contained components\r\n* with the help of component bindings.\r\n* @member {Component} main\r\n* @memberof module:main\r\n* @instance\r\n*/\n.component('main', {\n    template: _main2.default,\n    /**\r\n    * Controller class of 'main' component\r\n    * @constructor Main\r\n    * @param {Service} $rootScope Angularjs '$rootScope' service\r\n    * @param {Service} $scope Angularjs '$scope' service\r\n    * @param {Service} $timeout Angularjs '$timeout'\r\n    * @param {Service} textColors 'textColors' model / service\r\n    * @param {Service} appSettings 'appSettings' model / service\r\n    * @param {Service} colorService 'colorService' service\r\n    * @param {Service} popupDialog 'popupDialog' service\r\n    * @see main component\r\n    * @memberof module:main\r\n    */\n    controller: function () {\n        (0, _createClass3.default)(Main, null, [{\n            key: '$inject',\n            get: function get() {\n                return ['$rootScope', '$scope', '$timeout', 'textColors', 'appSettings', 'colorService', 'popupDialog'];\n            }\n        }]);\n\n        function Main($rootScope, $scope, $timeout, textColors, appSettings, colorService, dialog) {\n            (0, _classCallCheck3.default)(this, Main);\n\n            this.$rootScope = $rootScope;\n            this.$scope = $scope;\n            this.$timeout = $timeout;\n            this._colorService = colorService;\n            this._dialog = dialog;\n            this.textColors = textColors;\n            this.appSettings = appSettings;\n            this.colors = new _map2.default();\n            this.settingsOpened = false;\n            this.selectedWord = {};\n            this.textColorizer = null;\n            this.selectedColor = null;\n            this.searchData = null;\n            this.resultFound = null;\n        }\n\n        /** Event-handler that handles open / close of settings component\r\n        * @method toggleSettings\r\n        * @memberof module:main.Main\r\n        * @instance\r\n        */\n\n\n        (0, _createClass3.default)(Main, [{\n            key: 'toggleSettings',\n            value: function toggleSettings() {\n                var _this = this;\n\n                this.settingsOpened = !this.settingsOpened;\n                this.$timeout(function () {\n                    _this.$scope.$broadcast('rzSliderForceRender');\n                }, 0, false);\n            }\n\n            /** If certain color profile was selected and applied,\r\n            *  this method will be called. Sets all colors in text-colorizer.\r\n            * @method  loadColorProfile\r\n            * @param {Map} colors\r\n            * @param {Number} sPercentage\r\n            * @param {Number} lPercentage\r\n            * @memberof module:main.Main\r\n            * @instance\r\n            */\n\n        }, {\n            key: 'loadColorProfile',\n            value: function loadColorProfile(colors, sPercentage, lPercentage) {\n                var _this2 = this;\n\n                var colorizer = this.getColorizer();\n                colorizer.setColors(colors, function () {\n                    _this2._updateColors();\n                    _this2.textColors.update(colorizer.getAllColors(), sPercentage, lPercentage);\n                    _this2.$scope.$broadcast(\"colorsChainged\");\n                });\n            }\n\n            /** Handler for click on certain word in text editor.\r\n            * @method  selectWord\r\n            * @param {WordNode} word\r\n            * @memberof module:main.Main\r\n            * @instance\r\n            */\n\n        }, {\n            key: 'selectWord',\n            value: function selectWord(word) {\n                this.selectedWord = word;\n            }\n\n            /** If color was modified, this method will be called.\r\n            * @method colorModified\r\n            * @param {HSLColor} color\r\n            * @param {Boolean} linking\r\n            * @memberof module:main.Main\r\n            * @instance\r\n            */\n\n        }, {\n            key: 'colorModified',\n            value: function colorModified(color, linking) {\n                var _this3 = this;\n\n                var colorizer = this.getColorizer();\n                if (color && colorizer) {\n                    if (color.isSet()) {\n                        colorizer.setColor(this.selectedWord, color, linking, function () {\n                            _this3.textColors.update(colorizer.getAllColors());\n                            _this3.$scope.$broadcast(\"colorsChainged\");\n                        });\n                    } else {\n                        colorizer.resetColor(this.selectedWord, linking, function () {\n                            _this3.textColors.update(colorizer.getAllColors());\n                            _this3.$scope.$broadcast(\"colorsChainged\");\n                        });\n                    }\n                    this._updateColors();\n                }\n            }\n\n            /**\r\n            * @method  inputComplete\r\n            * @memberof module:main.Main\r\n            * @instance\r\n            */\n\n        }, {\n            key: 'inputComplete',\n            value: function inputComplete() {\n                var _this4 = this;\n\n                var colorizer = this.getColorizer();\n                colorizer.inputComplete(function () {\n                    _this4._updateColors();\n                    _this4.textColors.update(colorizer.getAllColors());\n                    _this4.$scope.$broadcast(\"colorsChainged\");\n                });\n            }\n\n            /** Delete all colors and words\r\n            * @method  drop\r\n            * @memberof module:main.Main\r\n            * @instance\r\n            */\n\n        }, {\n            key: 'drop',\n            value: function drop() {\n                var _this5 = this;\n\n                var colorizer = this.getColorizer();\n                colorizer.clear(function () {\n                    _this5._updateColors();\n                    _this5.textColors.clear();\n                    _this5.$scope.$broadcast(\"colorsChainged\");\n                });\n            }\n\n            /** Opens confirm dialog\r\n            * @method  dropDialog\r\n            * @memberof module:main.Main\r\n            * @instance\r\n            */\n\n        }, {\n            key: 'dropDialog',\n            value: function dropDialog() {\n                var self = this;\n                this._dialog.confirmDialog(function () {\n                    this.yes = function () {\n                        self.drop();\n                        self._dialog.close();\n                    };\n                    this.cancel = function () {\n                        self._dialog.close();\n                    };\n                    this.title = '\"drop\"';\n                });\n            }\n\n            /** Opens confirm dialog\r\n            * @method  decolorizeDialog\r\n            * @memberof module:main.Main\r\n            * @instance\r\n            */\n\n        }, {\n            key: 'decolorizeDialog',\n            value: function decolorizeDialog() {\n                var self = this;\n                var colors = this.textColors.colors;\n                if (colors.length > 0) {\n                    this._dialog.confirmDialog(function () {\n                        this.yes = function () {\n                            self.decolorizeText();\n                            self._dialog.close();\n                        };\n                        this.cancel = function () {\n                            self._dialog.close();\n                        };\n                        this.title = '\"clear\"';\n                    });\n                }\n            }\n\n            /** Decolorize all words\r\n            * @method  decolorizeText\r\n            * @memberof module:main.Main\r\n            * @instance\r\n            */\n\n        }, {\n            key: 'decolorizeText',\n            value: function decolorizeText() {\n                var _this6 = this;\n\n                var colorizer = this.getColorizer();\n                colorizer.resetAllColors(function () {\n                    _this6._updateColors();\n                    _this6.textColors.clear();\n                    _this6.$scope.$broadcast(\"colorsChainged\");\n                });\n            }\n\n            /** Enables edit mode in text editor.\r\n            * @method  edit\r\n            * @memberof module:main.Main\r\n            * @instance\r\n            */\n\n        }, {\n            key: 'edit',\n            value: function edit() {\n                var colorizer = this.getColorizer();\n                colorizer.editMode();\n            }\n\n            /** Search for similar images.\r\n            * @method  search\r\n            * @memberof module:main.Main\r\n            * @instance\r\n            */\n\n        }, {\n            key: 'search',\n            value: function search() {\n                var self = this;\n                var colorsAndWords = this.textColors.colorsAndWords;\n                if (!this.appSettings.checkSemanticSimilarity) {\n                    colorsAndWords.words = [];\n                }\n                this.searchData = { words: colorsAndWords, settings: self.appSettings };\n            }\n\n            /** Checks if search result exists.\r\n            * @method  imagesFound\r\n            * @param {Image[]} images\r\n            * @memberof module:main.Main\r\n            * @instance\r\n            */\n\n        }, {\n            key: 'imagesFound',\n            value: function imagesFound(images) {\n                this.resultFound = images.length > 0;\n            }\n\n            /** Gets text-colorizer component\r\n            * @method  getColorizer\r\n            * @memberof module:main.Main\r\n            * @instance\r\n            */\n\n        }, {\n            key: 'getColorizer',\n            value: function getColorizer() {\n                var _this7 = this;\n\n                if (!this.textColorizer) {\n                    this.$scope.$broadcast(\"text-colorizer\", function (colorizer) {\n                        _this7.textColorizer = colorizer;\n                    });\n                }\n                return this.textColorizer;\n            }\n        }, {\n            key: '_updateColors',\n            value: function _updateColors() {\n                var colorizer = this.getColorizer();\n                var cols = colorizer.getAllColors();\n                this.colors.clear();\n                var _iteratorNormalCompletion = true;\n                var _didIteratorError = false;\n                var _iteratorError = undefined;\n\n                try {\n                    for (var _iterator = (0, _getIterator3.default)(cols.values()), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                        var value = _step.value;\n\n                        var word = value.word.toLowerCase();\n                        var color = value.color;\n                        var entry = this.colors.get(word);\n                        if (entry) {\n                            entry.add(color);\n                        } else {\n                            var colorSet = this._colorService.getColorSetInstance();\n                            colorSet.add(color);\n                            this.colors.set(word, colorSet);\n                        }\n                    }\n                } catch (err) {\n                    _didIteratorError = true;\n                    _iteratorError = err;\n                } finally {\n                    try {\n                        if (!_iteratorNormalCompletion && _iterator.return) {\n                            _iterator.return();\n                        }\n                    } finally {\n                        if (_didIteratorError) {\n                            throw _iteratorError;\n                        }\n                    }\n                }\n            }\n        }]);\n        return Main;\n    }()\n});\n\nexports.default = 'main';\n\n/***/ }),\n/* 122 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 123 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=main> <color-toolbar closed=true input-color=$ctrl.selectedWord.color color-modified=\\\"$ctrl.colorModified(color, linking)\\\" on-close=\\\"$ctrl.selectedWord=null\\\"></color-toolbar> <div class=main__colorizer> <text-colorizer on-wordselect=$ctrl.selectWord(word)></text-colorizer> <div class=main__colorizer-controls> <a class=\\\"btn-bodyless btn-bodyless-success main__colorizer-button\\\" ng-click=$ctrl.inputComplete()><span class=\\\"glyphicon glyphicon-ok\\\"></span> Go!</a><span class=main__colorizer-separator></span> <a class=\\\"btn-bodyless main__colorizer-button\\\" ng-click=$ctrl.edit()><span class=\\\"glyphicon glyphicon-pencil\\\"></span> Edit</a><span class=main__colorizer-separator></span> <a class=\\\"btn-bodyless btn-bodyless-danger main__colorizer-button\\\" ng-click=$ctrl.decolorizeDialog()><span class=\\\"glyphicon glyphicon-remove\\\"></span> Clear</a><span class=main__colorizer-separator></span> <a class=\\\"btn-bodyless btn-bodyless-danger main__colorizer-button\\\" ng-click=$ctrl.dropDialog()><span class=\\\"glyphicon glyphicon-trash\\\"></span> Drop</a> </div> </div> <div class=\\\"main__adjustments-section main__section\\\"> <div class=main__section-content> <div class=main__section-title> <div class=main__section-label>Adjustments & Profiles</div> </div> <div class=main__adjustments> <div class=main__adjustments-content> <color-adjuster class=main__adjuster></color-adjuster> <div class=main__profiles> <color-profiles colors=$ctrl.colors on-load-profile=\\\"$ctrl.loadColorProfile(colors, sPercentage, lPercentage)\\\"></color-profiles> </div> </div> </div> </div> </div> <div class=\\\"main__settings-section main__section\\\"> <div class=main__section-content> <div class=main__section-title> <div ng-click=$ctrl.toggleSettings() class=\\\"main__section-label main__settings-label\\\"><span ng-class=\\\"$ctrl.settingsOpened ? 'dropup' : 'dropdown'\\\"><span class=\\\"caret main__caret\\\"></span></span> Settings</div> </div> <div class=main__settings ng-show=$ctrl.settingsOpened> <div class=main__settings-content> <settings></settings> </div> </div> </div> </div> <div class=main__find-container> <a class=\\\"btn btn-success main__find-button\\\" ng-click=$ctrl.search()><span class=\\\"glyphicon glyphicon-search\\\"></span> Search!</a> </div> <div ng-show=$ctrl.resultFound class=main__image-finder> <image-finder search=$ctrl.searchData on-images-found=$ctrl.imagesFound(images)></image-finder> </div> </div>\";\n\n/***/ }),\n/* 124 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _slicedToArray2 = __webpack_require__(16);\n\nvar _slicedToArray3 = _interopRequireDefault(_slicedToArray2);\n\nvar _getIterator2 = __webpack_require__(4);\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _map = __webpack_require__(7);\n\nvar _map2 = _interopRequireDefault(_map);\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\n__webpack_require__(125);\n\nvar _angularChartist = __webpack_require__(126);\n\nvar _angularChartist2 = _interopRequireDefault(_angularChartist);\n\nvar _angularjsSlider = __webpack_require__(56);\n\nvar _angularjsSlider2 = _interopRequireDefault(_angularjsSlider);\n\n__webpack_require__(128);\n\nvar _colorAdjuster = __webpack_require__(129);\n\nvar _colorAdjuster2 = _interopRequireDefault(_colorAdjuster);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n* @module color-adjuster\n* @requires module:angularjs-slider\n* @requires module:angular-chartist\n*/\nangular.module('color-adjuster', [_angularjsSlider2.default, _angularChartist2.default])\n/** Adjusting of all selected colors (saturation & lightness).\n* The global distribution of selected colors is shown in the chart.\n* @member {Component} colorAdjuster\n* @property {ColorAdjusterCtrl} controller\n* @memberof module:color-adjuster\n* @instance\n*/\n.component('colorAdjuster', {\n    template: _colorAdjuster2.default,\n    /**\n    * Controller for 'colorAdjuster' component.\n    * @constructor ColorAdjusterCtrl\n    * @param {Service} $rootScope Angularjs '$scope'\n    * @param {Service} $timeout Angularjs '$timeout' service\n    * @param {Service} colorService 'colorService' service\n    * @param {Service} textColors 'textColors' service\n    * @see colorAdjuster component\n    * @memberof module:color-adjuster\n    */\n    controller: function () {\n        (0, _createClass3.default)(ColorAdjusterCtrl, null, [{\n            key: '$inject',\n            get: function get() {\n                return ['$scope', '$timeout', 'colorService', 'textColors'];\n            }\n        }]);\n\n        function ColorAdjusterCtrl($scope, $timeout, colorService, textColors) {\n            var _this = this;\n\n            (0, _classCallCheck3.default)(this, ColorAdjusterCtrl);\n\n            this.$scope = $scope;\n            this.$timeout = $timeout;\n            this._colorService = colorService;\n            this.textColors = textColors;\n            this.chart = {};\n            var self = this;\n            this.chart.options = {\n                showLabel: false,\n                donut: true,\n                donutWidth: 40,\n                donutSolid: true,\n                startAngle: 270\n            };\n            this.chart.data = {};\n            this.chart.events = {\n                draw: function draw(context) {\n                    if (context.type === \"slice\") {\n                        context.element.attr({\n                            style: 'fill: ' + context.meta\n                        });\n                    }\n                }\n            };\n            this.chart.responsive = [['screen and (min-width: 500px)', {\n                donutWidth: 30\n            }]];\n            this.slider = {\n                value: 50,\n                options: {\n                    floor: 0,\n                    ceil: 200,\n                    step: 1,\n                    onChange: function onChange() {\n                        textColors.calculateAdjustedColors();\n                        self._colorsChanged();\n                    },\n                    onEnd: function onEnd() {\n                        textColors.calculateAdjustedColors();\n                        self._colorsChanged();\n                    },\n                    hidePointerLabels: true,\n                    hideLimitLabels: true,\n                    disabled: false\n                }\n            };\n            this.$scope.$on(\"colorsChainged\", this._colorsChanged.bind(this));\n            this.$scope.$on(\"refresh\", function () {\n                _this.chart.data = {};\n                _this._colorsChanged();\n            });\n        }\n\n        /**\n        * @method toggle\n        * @memberof module:color-adjuster.ColorAdjuster\n        * @instance\n        */\n\n\n        (0, _createClass3.default)(ColorAdjusterCtrl, [{\n            key: 'toggle',\n            value: function toggle() {\n                var _this2 = this;\n\n                this.$timeout(function () {\n                    _this2.$scope.$broadcast('rzSliderForceRender');\n                }, 0, false);\n            }\n\n            /**\n            * @method getS\n            * @return {string}\n            * @memberof module:color-adjuster.ColorAdjuster\n            * @instance\n            */\n\n        }, {\n            key: 'getS',\n            value: function getS() {\n                return this.textColors.sPercentage < 100 ? '-' + Math.abs(this.textColors.sPercentage - 100) : '+' + Math.abs(this.textColors.sPercentage - 100);\n            }\n\n            /**\n            * @method getL\n            * @return {string}\n            * @memberof module:color-adjuster.ColorAdjuster\n            * @instance\n            */\n\n        }, {\n            key: 'getL',\n            value: function getL() {\n                return this.textColors.lPercentage < 100 ? '-' + Math.abs(this.textColors.lPercentage - 100) : '+' + Math.abs(this.textColors.lPercentage - 100);\n            }\n        }, {\n            key: '_colorsChanged',\n            value: function _colorsChanged() {\n                var tempColors = new _map2.default();\n                var data = [];\n                var _iteratorNormalCompletion = true;\n                var _didIteratorError = false;\n                var _iteratorError = undefined;\n\n                try {\n                    for (var _iterator = (0, _getIterator3.default)(this.textColors.adjustedColorOccurence.entries()), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                        var _step$value = (0, _slicedToArray3.default)(_step.value, 2),\n                            key = _step$value[0],\n                            color = _step$value[1];\n\n                        var keyColor = this._colorService.getColorInstance().setColorFromString(key);\n                        var hex = this._colorService.hslToHexString(keyColor);\n                        var count = tempColors.has(hex) ? tempColors.get(hex) : 0;\n                        count += color.weight;\n                        tempColors.set(hex, count);\n                    }\n                } catch (err) {\n                    _didIteratorError = true;\n                    _iteratorError = err;\n                } finally {\n                    try {\n                        if (!_iteratorNormalCompletion && _iterator.return) {\n                            _iterator.return();\n                        }\n                    } finally {\n                        if (_didIteratorError) {\n                            throw _iteratorError;\n                        }\n                    }\n                }\n\n                var _iteratorNormalCompletion2 = true;\n                var _didIteratorError2 = false;\n                var _iteratorError2 = undefined;\n\n                try {\n                    for (var _iterator2 = (0, _getIterator3.default)(tempColors), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                        var _step2$value = (0, _slicedToArray3.default)(_step2.value, 2),\n                            _hex = _step2$value[0],\n                            _count = _step2$value[1];\n\n                        data.push({ value: _count, meta: _hex });\n                    }\n                } catch (err) {\n                    _didIteratorError2 = true;\n                    _iteratorError2 = err;\n                } finally {\n                    try {\n                        if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                            _iterator2.return();\n                        }\n                    } finally {\n                        if (_didIteratorError2) {\n                            throw _iteratorError2;\n                        }\n                    }\n                }\n\n                this.chart.data.series = data;\n            }\n        }]);\n        return ColorAdjusterCtrl;\n    }()\n});\n\nexports.default = 'color-adjuster';\n\n/***/ }),\n/* 125 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 126 */,\n/* 127 */,\n/* 128 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 129 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=color-adjuster> <div class=color-adjuster__chart><chartist class=\\\"ct-chart ct-square chart\\\" chartist-events=$ctrl.chart.events chartist-data=$ctrl.chart.data chartist-chart-options=$ctrl.chart.options chartist-responsive-options=$ctrl.chart.responsive chartist-chart-type=Pie></chartist></div> <div class=\\\"sliders color-adjuster__sliders\\\"> <div class=color-adjuster__sliders-content> <div class=color-adjuster__slider> <div><span class=\\\"glyphicon glyphicon-signal\\\"></span> <span>{{$ctrl.getS()}}%</span></div> <rzslider rz-slider-model=$ctrl.textColors.sPercentage rz-slider-options=$ctrl.slider.options></rzslider> </div> <div class=color-adjuster__slider> <div><span class=\\\"glyphicon glyphicon-adjust icon-flipped\\\"></span> <span>{{$ctrl.getL()}}%</span></div> <rzslider rz-slider-model=$ctrl.textColors.lPercentage rz-slider-options=$ctrl.slider.options></rzslider> </div> </div> </div> </div> \";\n\n/***/ }),\n/* 130 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _slicedToArray2 = __webpack_require__(16);\n\nvar _slicedToArray3 = _interopRequireDefault(_slicedToArray2);\n\nvar _getIterator2 = __webpack_require__(4);\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _set = __webpack_require__(131);\n\nvar _set2 = _interopRequireDefault(_set);\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\n__webpack_require__(137);\n\nvar _textColorizer = __webpack_require__(138);\n\nvar _textColorizer2 = _interopRequireDefault(_textColorizer);\n\nvar _Words = __webpack_require__(139);\n\nvar _Words2 = _interopRequireDefault(_Words);\n\nvar _Caret = __webpack_require__(140);\n\nvar _Caret2 = _interopRequireDefault(_Caret);\n\nvar _Helper = __webpack_require__(141);\n\nvar _Helper2 = _interopRequireDefault(_Helper);\n\nvar _Parser = __webpack_require__(142);\n\nvar _Parser2 = _interopRequireDefault(_Parser);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n* @module text-colorizer\n*/\nangular.module('text-colorizer', [])\n/** Text editor. Responsible for parsing and visualization of\n* user text, words and selected colors. Text editor is fully editable.\n* The text can be modificated, deleted\n* or decolorized at any time. Text modifications will be applied after\n* invokation of the 'inputComplete' method.\n* @member {Component} textColorizer\n* @property {TextColorizerCtrl} controller\n* @property {String} template\n* @property {Object} bindings {onWordselect: '&'}\n* @memberof module:text-colorizer\n* @instance\n*/\n.component('textColorizer', {\n    template: _textColorizer2.default,\n    bindings: {\n        onWordselect: '&'\n    },\n    /**\n    * Controller class of 'textColorizer' component\n    * @constructor TextColorizerCtrl\n    * @param {Service} $scope Angularjs '$scope' service\n    * @param {Service} $element Angularjs '$element' service\n    * @param {Service} $timeout Angularjs '$timeout' service\n    * @param {Service} $window Angularjs '$window' service\n    * @param {Factory} calculateFontColor 'calculateFontColor' factory\n    * @param {Service} colorService 'colorService' service\n    * @see textColorizer component\n    * @memberof module:text-colorizer\n    */\n    controller: function () {\n        (0, _createClass3.default)(TextColorizerCtrl, null, [{\n            key: '$inject',\n            get: function get() {\n                return [\"$scope\", \"$element\", \"$timeout\", \"$window\", \"calculateFontColor\", \"colorService\"];\n            }\n        }]);\n\n        function TextColorizerCtrl($scope, $element, $timeout, $window, calculateFontColor, colorService) {\n            (0, _classCallCheck3.default)(this, TextColorizerCtrl);\n\n            this.$scope = $scope;\n            this.$element = $element;\n            this.$timeout = $timeout;\n            this.$window = $window;\n            this.$ = angular.element;\n            this.$root = this.$($element).find('.text-colorizer__text');\n            this.words = new _Words2.default(colorService, calculateFontColor);\n            this.caret = new _Caret2.default($window);\n            this.helper = new _Helper2.default($window, this.$, this.$root, this.caret);\n            this.parser = new _Parser2.default(this.$, $window, this.$root, colorService, this.words);\n            this.editMode = true;\n        }\n\n        (0, _createClass3.default)(TextColorizerCtrl, [{\n            key: '$onInit',\n            value: function $onInit() {\n                this.switchToEditMode();\n            }\n\n            /** Exposes public api object.\n            * @method _api\n            * @return {Object}\n            * @memberof module:text-colorizer.TextColorizer\n            * @instance\n            */\n\n        }, {\n            key: '_api',\n            value: function _api() {\n                var self = this;\n                return {\n                    inputComplete: function inputComplete(callback) {\n                        self.inputComplete(callback);\n                    },\n                    editMode: function editMode() {\n                        self.switchToEditMode();\n                    },\n                    setColor: function setColor(word, color, linking, callback) {\n                        self.setColor(word, color, linking, callback);\n                    },\n                    resetColor: function resetColor(word, linking, callback) {\n                        self.resetColor(word, linking, callback);\n                    },\n                    resetAllColors: function resetAllColors(callback) {\n                        self.resetAllColors(callback);\n                    },\n                    getAllColors: function getAllColors() {\n                        return self.getAllColors();\n                    },\n                    setColors: function setColors(colors, callback) {\n                        self.setColors(colors, callback);\n                    },\n                    clear: function clear(callback) {\n                        self.clear(callback);\n                    },\n                    hasColors: function hasColors() {\n                        return self.getAllColors().size > 0;\n                    }\n                };\n            }\n\n            /** Component hook method, which is called after linking phase.\n            * Registrates $on handler in the $scope for \"text-colorizer\" event.\n            * Returns the public api for this component as a callback parameter\n            * in the event handler for \"text-colorizer\" event.\n            * @method $postLink\n            * @memberof module:text-colorizer.TextColorizer\n            * @instance\n            */\n\n        }, {\n            key: '$postLink',\n            value: function $postLink() {\n                var _this = this;\n\n                this.helper.observeEditorChanges();\n                this.$scope.$on(\"text-colorizer\", function (event, callback) {\n                    if (typeof callback === \"function\") {\n                        callback(_this._api());\n                    }\n                });\n            }\n\n            /** Event-handler. Handles double clicks in editor in 'edit' mode.\n             * Adds spaces in editor on doubleclicks and improves usability.\n            * @method handleMouseDown\n            * @param {Object} $event - Angularjs $event object\n            * @memberof module:text-colorizer.TextColorizer\n            * @instance\n            */\n\n        }, {\n            key: 'handleMouseDown',\n            value: function handleMouseDown($event) {\n                if (this.editMode) {\n                    if ($event.detail > 1) {\n                        $event.preventDefault();\n                        this.helper.doubleClick($event.originalEvent);\n                    }\n                }\n            }\n\n            /** Event-handler. Handles 'paste' events in text editor.\n             * Allows only plain text paste in text editor.\n            * @function handlePaste\n            * @param {Object} $event - Angularjs $event object\n            * @memberof module:text-colorizer.TextColorizer\n            * @instance\n            */\n\n        }, {\n            key: 'handlePaste',\n            value: function handlePaste($event) {\n                this.helper.handlePaste($event);\n            }\n\n            /** Event-handler. Handles 'keydown' events in editor.\n            * @function handleKeyDown\n            * @param {Object} $event - Angularjs $event object\n            * @memberof module:text-colorizer.TextColorizer\n            * @instance\n            */\n\n        }, {\n            key: 'handleKeyDown',\n            value: function handleKeyDown($event) {\n                this.helper.handleKeyDown($event);\n            }\n\n            /** Applies changes and detects words in text editor.\n            * @function inputComplete\n            * @param {Function} callback - Callback function (optional)\n            * @memberof module:text-colorizer.TextColorizer\n            * @instance\n            */\n\n        }, {\n            key: 'inputComplete',\n            value: function inputComplete(callback) {\n                var _this2 = this;\n\n                this.editMode = false;\n                this.parser.parse();\n                var currentIds = new _set2.default();\n                this.$root.find('[data-word]').each(function (i, elem) {\n                    var idString = _this2.$(elem).attr(\"data-word\");\n                    var id = parseInt(idString, 10);\n                    currentIds.add(id);\n                    var nextSibling = elem.nextSibling;\n                    if (nextSibling && nextSibling.nodeType !== 3) {\n                        _this2.$(elem).after('\\xA0');\n                    }\n                });\n                var ids = this.words.getIds();\n                var _iteratorNormalCompletion = true;\n                var _didIteratorError = false;\n                var _iteratorError = undefined;\n\n                try {\n                    for (var _iterator = (0, _getIterator3.default)(ids), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                        var id = _step.value;\n\n                        if (!currentIds.has(id)) {\n                            this.words.removeWordNode(id);\n                        }\n                    }\n                } catch (err) {\n                    _didIteratorError = true;\n                    _iteratorError = err;\n                } finally {\n                    try {\n                        if (!_iteratorNormalCompletion && _iterator.return) {\n                            _iterator.return();\n                        }\n                    } finally {\n                        if (_didIteratorError) {\n                            throw _iteratorError;\n                        }\n                    }\n                }\n\n                if (callback) {\n                    callback();\n                }\n            }\n\n            /** Switch to 'edit' mode and move caret to the end of input text.\n            * @function  switchToEditMode\n            * @memberof module:text-colorizer.TextColorizer\n            * @instance\n            */\n\n        }, {\n            key: 'switchToEditMode',\n            value: function switchToEditMode() {\n                this.editMode = true;\n                this.$root.attr(\"contentEditable\", true);\n                this.helper.removeEmptyLast(this.$root);\n                var $last = this.helper.getLast(this.$root);\n                var lastNodeType = $last && $last[0] ? $last[0].nodeType : undefined;\n                if (lastNodeType === 3) {\n                    this.caret.moveTo($last[0]);\n                } else if (lastNodeType) {\n                    var node = this.$window.document.createTextNode('\\xA0');\n                    $last.after(node);\n                    this.caret.moveTo(node);\n                }\n                this.$root[0].focus();\n            }\n\n            /** Set  color for specific word.\n            * @function setColor\n            * @param {Word} word Word object\n            * @param {Color} color Color object\n            * @param {boolean} linking Flag if the operation must be applied to all equal words\n            * @param {Function} callback Callback function (optional)\n            * @memberof module:text-colorizer.TextColorizer\n            * @instance\n            */\n\n        }, {\n            key: 'setColor',\n            value: function setColor(word, color, linking, callback) {\n                if (!this.editMode && word) {\n                    if (linking) {\n                        this.words.setColor(word.id, color);\n                    } else {\n                        this.words.setColorOnce(word.id, color);\n                    }\n                    if (callback) {\n                        callback();\n                    }\n                }\n            }\n\n            /** Colorize words.\n            * @function setColors\n            * @param {Map} wordColors HashMap with colors and words\n            * @param {Function} callback Callback function (optional)\n            * @memberof module:text-colorizer.TextColorizer\n            * @instance\n            */\n\n        }, {\n            key: 'setColors',\n            value: function setColors(wordColors, callback) {\n                var _this3 = this;\n\n                this.inputComplete(function () {\n                    var _iteratorNormalCompletion2 = true;\n                    var _didIteratorError2 = false;\n                    var _iteratorError2 = undefined;\n\n                    try {\n                        for (var _iterator2 = (0, _getIterator3.default)(wordColors), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                            var _step2$value = (0, _slicedToArray3.default)(_step2.value, 2),\n                                word = _step2$value[0],\n                                color = _step2$value[1];\n\n                            _this3.words.setColorByWord(word, color);\n                        }\n                    } catch (err) {\n                        _didIteratorError2 = true;\n                        _iteratorError2 = err;\n                    } finally {\n                        try {\n                            if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                                _iterator2.return();\n                            }\n                        } finally {\n                            if (_didIteratorError2) {\n                                throw _iteratorError2;\n                            }\n                        }\n                    }\n\n                    if (callback) {\n                        callback();\n                    }\n                });\n            }\n\n            /** Return all colors as map\n            * @function getAllColors\n            * @return {Map}\n            * @memberof module:text-colorizer.TextColorizer\n            * @instance\n            */\n\n        }, {\n            key: 'getAllColors',\n            value: function getAllColors() {\n                return this.words.getAllWordNodes();\n            }\n\n            /** Resets one color (decolorize word).\n            * @function resetColor\n            * @param {Word} word Word object\n            * @param {boolean} linking Flag if the operation must be applied to all equal words\n            * @param {Function} callback Callback function (optional)\n            * @memberof module:text-colorizer.TextColorizer\n            * @instance\n            */\n\n        }, {\n            key: 'resetColor',\n            value: function resetColor(word, linking, callback) {\n                if (!this.editMode && word) {\n                    if (linking) {\n                        this.words.resetColor(word.id);\n                    } else {\n                        this.words.resetOneColor(word.id);\n                    }\n                }\n                if (callback) {\n                    callback();\n                }\n            }\n\n            /** Resets all colors in all words (decolorize words).\n            * @function resetAllColors\n            * @param {Function} callback Callback function (optional)\n            * @memberof module:text-colorizer.TextColorizer\n            * @instance\n            */\n\n        }, {\n            key: 'resetAllColors',\n            value: function resetAllColors(callback) {\n                this.words.resetAllColors();\n                if (callback) {\n                    callback();\n                }\n            }\n\n            /** Eventhandler. Handles simple clicks on words in editor.\n            * @function selectWord\n            * @param {Object} $event Angularjs $event object\n            * @memberof module:text-colorizer.TextColorizer\n            * @instance\n            */\n\n        }, {\n            key: 'selectWord',\n            value: function selectWord($event) {\n                $event.stopPropagation();\n                var $targetNode = this.$($event.target);\n                if ($targetNode.is(\"[data-word]\")) {\n                    if (!this.editMode) {\n                        var id = $targetNode.attr(\"data-word\");\n                        var savedWord = this.words.getWordNode(parseInt(id, 10));\n                        this.onWordselect({ word: savedWord });\n                    } else {\n                        this.helper.clickOnWord($targetNode);\n                    }\n                }\n            }\n\n            /** Deletes all colors and words in text editor.\n            * @function clear\n            * @param {Function} callback Callback function (optional)\n            * @memberof module:text-colorizer.TextColorizer\n            * @instance\n            */\n\n        }, {\n            key: 'clear',\n            value: function clear(callback) {\n                this.words.clear();\n                this.$root.empty();\n                this.switchToEditMode();\n                if (callback) {\n                    callback();\n                }\n            }\n        }]);\n        return TextColorizerCtrl;\n    }()\n});\n\nexports.default = 'text-colorizer';\n\n/***/ }),\n/* 131 */,\n/* 132 */,\n/* 133 */,\n/* 134 */,\n/* 135 */,\n/* 136 */,\n/* 137 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 138 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=text-colorizer__text ng-click=$ctrl.selectWord($event) ng-mousedown=$ctrl.handleMouseDown($event) ng-keydown=$ctrl.handleKeyDown($event) ng-paste=$ctrl.handlePaste($event) contenteditable={{$ctrl.editMode}} spellcheck=false placeholder=\\\"Insert text here...\\\"></div> \";\n\n/***/ }),\n/* 139 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _getIterator2 = __webpack_require__(4);\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _map = __webpack_require__(7);\n\nvar _map2 = _interopRequireDefault(_map);\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n* Represents a word node in the parsing tree. Contains DOM node\r\n* for fast access and modifications.\r\n* @constructor\r\n* @param {Service} colorService Angularjs 'colorService' service\r\n* @param {Factory} calcFontcolor Angularjs factory for calculation of font color according to the background color\r\n* @memberof module:text-colorizer\r\n*/\nvar Words = function () {\n    function Words(colorService, calcFontColor) {\n        (0, _classCallCheck3.default)(this, Words);\n\n        this.wordNodes = new _map2.default();\n        this.wordToWordNodes = new _map2.default();\n        this.colorFactory = colorService;\n        this.calcFontColor = calcFontColor;\n    }\n\n    /** Assigns new dom node to the word node by id.\r\n    * @method updateWordNode\r\n    * @param {number} id Word node id\r\n    * @param {Object} $domNode DOM node in jquery wrapper\r\n    * @memberof module:text-colorizer.Words\r\n    * @instance\r\n    */\n\n\n    (0, _createClass3.default)(Words, [{\n        key: \"updateWordNode\",\n        value: function updateWordNode(id, $domNode) {\n            var wordNode = this.wordNodes.get(id);\n            if (wordNode) {\n                wordNode.$domNode = $domNode;\n            }\n        }\n\n        /** Get all word nodes associated with given word.\r\n        * @method getWordNodes\r\n        * @param {string} word Word\r\n        * @memberof module:text-colorizer.Words\r\n        * @return {WordNode[]}\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"getWordNodes\",\n        value: function getWordNodes(word) {\n            return this.wordToWordNodes.get(word);\n        }\n\n        /** Returns word node by its id.\r\n        * @method getWordNode\r\n        * @param {number} id - Word node id\r\n        * @return {WordNode}\r\n        * @memberof module:text-colorizer.Words\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"getWordNode\",\n        value: function getWordNode(id) {\n            return this.wordNodes.get(id);\n        }\n\n        /** Returns ids of all word nodes.\r\n        * @method getIds\r\n        * @return {number[]}\r\n        * @memberof module:text-colorizer.Words\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"getIds\",\n        value: function getIds() {\n            return this.wordNodes.keys();\n        }\n\n        /** Returns all word nodes.\r\n        * @method getAllWordNodes\r\n        * @return {WordNode[]}\r\n        * @memberof module:text-colorizer.Words\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"getAllWordNodes\",\n        value: function getAllWordNodes() {\n            return this.wordNodes;\n        }\n\n        /** Returns a HashMap\r\n        * @method getWordsToWordNodesMap\r\n        * @return {Map<string, WordNode[]>}\r\n        * @memberof module:text-colorizer.Words\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"getWordsToWordNodesMap\",\n        value: function getWordsToWordNodesMap() {\n            return this.wordToWordNodes;\n        }\n\n        /** Inserts new word node.\r\n        * @method addWordNode\r\n        * @param {WordNode} wordNode\r\n        * @memberof module:text-colorizer.Words\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"addWordNode\",\n        value: function addWordNode(wordNode) {\n            this.wordNodes.set(wordNode.id, wordNode);\n            if (!this.wordToWordNodes.has(wordNode.word)) {\n                this.wordToWordNodes.set(wordNode.word, new _map2.default());\n            }\n            var wordNodes = this.wordToWordNodes.get(wordNode.word);\n            wordNodes.set(wordNode.id, wordNode);\n        }\n\n        /** Removes word node by id.\r\n        * @method removeWordNode\r\n        * @param {number} id\r\n        * @memberof module:text-colorizer.Words\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"removeWordNode\",\n        value: function removeWordNode(id) {\n            this.wordNodes.delete(id);\n            var _iteratorNormalCompletion = true;\n            var _didIteratorError = false;\n            var _iteratorError = undefined;\n\n            try {\n                for (var _iterator = (0, _getIterator3.default)(this.wordToWordNodes.values()), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                    var wordNodes = _step.value;\n\n                    if (wordNodes.has(id)) {\n                        wordNodes.delete(id);\n                        break;\n                    }\n                }\n            } catch (err) {\n                _didIteratorError = true;\n                _iteratorError = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion && _iterator.return) {\n                        _iterator.return();\n                    }\n                } finally {\n                    if (_didIteratorError) {\n                        throw _iteratorError;\n                    }\n                }\n            }\n        }\n\n        /** Reset colors of word node by id.\r\n        * Resets all word nodes with the same word.\r\n        * @method resetColor\r\n        * @param {number} id\r\n        * @memberof module:text-colorizer.Words\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"resetColor\",\n        value: function resetColor(id) {\n            var wordNode = this.wordNodes.get(id);\n            var wordNodes = this.wordToWordNodes.get(wordNode.word);\n            var _iteratorNormalCompletion2 = true;\n            var _didIteratorError2 = false;\n            var _iteratorError2 = undefined;\n\n            try {\n                for (var _iterator2 = (0, _getIterator3.default)(wordNodes.values()), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                    var node = _step2.value;\n\n                    node.resetColor();\n                }\n            } catch (err) {\n                _didIteratorError2 = true;\n                _iteratorError2 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                        _iterator2.return();\n                    }\n                } finally {\n                    if (_didIteratorError2) {\n                        throw _iteratorError2;\n                    }\n                }\n            }\n        }\n\n        /** Resets color only in word node with given id.\r\n        * @method resetOneColor\r\n        * @param {number} id\r\n        * @memberof module:text-colorizer.Words\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"resetOneColor\",\n        value: function resetOneColor(id) {\n            var wordNode = this.wordNodes.get(id);\n            wordNode.resetColor();\n        }\n\n        /** Set color in one specific word node by given id.\r\n        * @method setColorOnce\r\n        * @param {number} id Word node id\r\n        * @param {Color} color Color object\r\n        * @memberof module:text-colorizer.Words\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"setColorOnce\",\n        value: function setColorOnce(id, color) {\n            var fontColor = this.calcFontColor(color);\n            var wordNode = this.wordNodes.get(id);\n            wordNode.setColor(color, fontColor);\n        }\n\n        /** Set color in all word nodes with the same word by given id.\r\n        * @method setColor\r\n        * @param {number} id Word node id\r\n        * @param {Color} color Color object\r\n        * @memberof module:text-colorizer.Words\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"setColor\",\n        value: function setColor(id, color) {\n            var wordNode = this.wordNodes.get(id);\n            this.setColorByWord(wordNode.word, color);\n        }\n\n        /** Set color in all word nodes with the same word by given word.\r\n        * @method setColorByWord\r\n        * @param {string} word Word\r\n        * @param {Color} color Color object\r\n        * @memberof module:text-colorizer.Words\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"setColorByWord\",\n        value: function setColorByWord(word, color) {\n            var wordNodes = this.wordToWordNodes.get(word);\n            if (wordNodes) {\n                var fontColor = this.calcFontColor(color);\n                var _iteratorNormalCompletion3 = true;\n                var _didIteratorError3 = false;\n                var _iteratorError3 = undefined;\n\n                try {\n                    for (var _iterator3 = (0, _getIterator3.default)(wordNodes.values()), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n                        var node = _step3.value;\n\n                        node.setColor(color, fontColor);\n                    }\n                } catch (err) {\n                    _didIteratorError3 = true;\n                    _iteratorError3 = err;\n                } finally {\n                    try {\n                        if (!_iteratorNormalCompletion3 && _iterator3.return) {\n                            _iterator3.return();\n                        }\n                    } finally {\n                        if (_didIteratorError3) {\n                            throw _iteratorError3;\n                        }\n                    }\n                }\n            }\n        }\n\n        /** Resets all word nodes (decolorize words).\r\n        * @method resetAllColors\r\n        * @memberof module:text-colorizer.Words\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"resetAllColors\",\n        value: function resetAllColors() {\n            var _iteratorNormalCompletion4 = true;\n            var _didIteratorError4 = false;\n            var _iteratorError4 = undefined;\n\n            try {\n                for (var _iterator4 = (0, _getIterator3.default)(this.wordNodes.values()), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n                    var wordNode = _step4.value;\n\n                    wordNode.resetColor();\n                }\n            } catch (err) {\n                _didIteratorError4 = true;\n                _iteratorError4 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion4 && _iterator4.return) {\n                        _iterator4.return();\n                    }\n                } finally {\n                    if (_didIteratorError4) {\n                        throw _iteratorError4;\n                    }\n                }\n            }\n        }\n\n        /** Deletes all word nodes\r\n        * @method clear\r\n        * @memberof module:text-colorizer.Words\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"clear\",\n        value: function clear() {\n            this.wordNodes.clear();\n            this.wordToWordNodes.clear();\n        }\n    }]);\n    return Words;\n}();\n\nexports.default = Words;\n\n/***/ }),\n/* 140 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n* Helper class for caret position in text editor\r\n* @constructor\r\n* @param {Service} $window - Angularjs $window service wrapper for window object\r\n* @memberof module:text-colorizer\r\n*/\nvar Caret = function () {\n    function Caret($window) {\n        (0, _classCallCheck3.default)(this, Caret);\n\n        this.$window = $window;\n    }\n\n    // move caret to the html node\n    // @params: html node\n\n\n    (0, _createClass3.default)(Caret, [{\n        key: \"moveTo\",\n        value: function moveTo(node) {\n            var range = this.$window.document.createRange();\n            var sel = this.$window.getSelection();\n            range.setStartAfter(node);\n            range.setEndAfter(node);\n            sel.removeAllRanges();\n            sel.addRange(range);\n        }\n\n        // move caret to special position in textnode\n\n    }, {\n        key: \"moveInText\",\n        value: function moveInText(position, textNode) {\n            var caret = position;\n            var range = this.$window.document.createRange();\n            range.setStart(textNode, caret);\n            range.collapse(true);\n            var sel = this.$window.getSelection();\n            sel.removeAllRanges();\n            sel.addRange(range);\n        }\n    }, {\n        key: \"insertTextAtCursor\",\n        value: function insertTextAtCursor(text) {\n            var sel = this.$window.getSelection();\n            var range = sel.getRangeAt(0);\n            var node = this.$window.document.createTextNode(text);\n            range.insertNode(node);\n            range.setStartAfter(node);\n            range.setEndAfter(node);\n            sel.removeAllRanges();\n            sel.addRange(range);\n        }\n    }, {\n        key: \"insertTextNodeAtCursor\",\n        value: function insertTextNodeAtCursor(node) {\n            var sel = this.$window.getSelection();\n            var range = sel.getRangeAt(0);\n            range.insertNode(node);\n            range.setStartAfter(node);\n            range.setEndAfter(node);\n            sel.removeAllRanges();\n            sel.addRange(range);\n        }\n\n        // https://stackoverflow.com/questions/4811822/get-a-ranges-start-and-end-offsets-relative-to-its-parent-container/4812022#4812022\n\n    }, {\n        key: \"getCaretCharacterOffsetWithin\",\n        value: function getCaretCharacterOffsetWithin(element) {\n            var caretOffset = 0;\n            var doc = element.ownerDocument || element.document;\n            var win = doc.defaultView || doc.parentWindow;\n            var sel = void 0;\n            if (typeof win.getSelection !== \"undefined\") {\n                sel = win.getSelection();\n                if (sel.rangeCount > 0) {\n                    var range = win.getSelection().getRangeAt(0);\n                    var preCaretRange = range.cloneRange();\n                    preCaretRange.selectNodeContents(element);\n                    preCaretRange.setEnd(range.endContainer, range.endOffset);\n                    caretOffset = preCaretRange.toString().length;\n                }\n            } else if ((sel = doc.selection) && sel.type != \"Control\") {\n                var textRange = sel.createRange();\n                var preCaretTextRange = doc.body.createTextRange();\n                preCaretTextRange.moveToElementText(element);\n                preCaretTextRange.setEndPoint(\"EndToEnd\", textRange);\n                caretOffset = preCaretTextRange.text.length;\n            }\n            return caretOffset;\n        }\n    }]);\n    return Caret;\n}();\n\nexports.default = Caret;\n\n/***/ }),\n/* 141 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _getIterator2 = __webpack_require__(4);\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Helper = function () {\n    function Helper($window, $, root, caret) {\n        (0, _classCallCheck3.default)(this, Helper);\n\n        this.$window = $window;\n        this.root = root;\n        this.$ = $;\n        this.caret = caret;\n    }\n\n    (0, _createClass3.default)(Helper, [{\n        key: \"handleKeyDown\",\n        value: function handleKeyDown(event) {\n            // prevents \"enter\" within detected words\n            var anchorNode = this.$window.getSelection().anchorNode;\n            var target = anchorNode && anchorNode.parentNode ? anchorNode.parentNode : null;\n            if (event.keyCode === 13 && this.$(target).is(\"[data-word]\")) {\n                event.preventDefault();\n            }\n        }\n\n        // workaround for webkit / chrome\n        // https://stackoverflow.com/questions/19243432/prevent-contenteditable-mode-from-creating-span-tags\n        // https://github.com/yabwe/medium-editor/issues/543\n\n    }, {\n        key: \"observeEditorChanges\",\n        value: function observeEditorChanges() {\n            var _this = this;\n\n            var observer = new MutationObserver(function (mutations) {\n                mutations.forEach(function (mutation) {\n                    var editable = _this.root.attr(\"contentEditable\") === \"true\";\n                    if (mutation.type === \"childList\" && editable) {\n                        var nodes = mutation.addedNodes;\n                        var _iteratorNormalCompletion = true;\n                        var _didIteratorError = false;\n                        var _iteratorError = undefined;\n\n                        try {\n                            for (var _iterator = (0, _getIterator3.default)(nodes), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                                var node = _step.value;\n\n                                if (node.nodeName === \"FONT\" || node.nodeName === \"SPAN\" && node.parentNode && node.parentNode.nodeName !== \"FONT\") {\n                                    _this.replaceElementWithTextContent(node);\n                                }\n                            }\n                        } catch (err) {\n                            _didIteratorError = true;\n                            _iteratorError = err;\n                        } finally {\n                            try {\n                                if (!_iteratorNormalCompletion && _iterator.return) {\n                                    _iterator.return();\n                                }\n                            } finally {\n                                if (_didIteratorError) {\n                                    throw _iteratorError;\n                                }\n                            }\n                        }\n                    }\n                });\n            });\n            var config = { childList: true };\n            observer.observe(this.root[0], config);\n        }\n    }, {\n        key: \"replaceElementWithTextContent\",\n        value: function replaceElementWithTextContent(node) {\n            var $elem = this.$(node);\n            var text = $elem.text();\n            var textNode = this.$window.document.createTextNode(text);\n            $elem.replaceWith(textNode);\n            var anchor = this.$window.getSelection().anchorNode;\n            if (anchor && anchor.nodeType === 3) {\n                this.caret.moveTo(textNode);\n            }\n        }\n    }, {\n        key: \"doubleClick\",\n        value: function doubleClick(event) {\n            var sel = this.$window.getSelection();\n            var anchorNode = sel.anchorNode;\n            var wordNode = null;\n            if (this.$(anchorNode).is(\"[data-word]\")) {\n                wordNode = anchorNode;\n            } else if (this.$(anchorNode.parentNode).is(\"[data-word]\")) {\n                wordNode = anchorNode.parentNode;\n            } else if (this.$(event.target).is(\"[data-word]\")) {\n                wordNode = event.target;\n            }\n            var spaceNode = this.$window.document.createTextNode(\"\\xA0\");\n            if (!wordNode) {\n                this.caret.insertTextNodeAtCursor(spaceNode);\n                this.caret.moveTo(spaceNode);\n            } else if (wordNode && !this.$(anchorNode).is(this.root)) {\n                var position = this.caret.getCaretCharacterOffsetWithin(wordNode);\n                var text = this.$(wordNode).text();\n                if (position === text.length) {\n                    this.$(wordNode).after(spaceNode);\n                    this.caret.moveTo(spaceNode);\n                } else if (position === 0) {\n                    this.$(wordNode).before(spaceNode);\n                    this.caret.moveTo(spaceNode);\n                }\n            }\n        }\n    }, {\n        key: \"handlePaste\",\n        value: function handlePaste(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            var target = e.target;\n            if (this.$(target).is(\"[data-word]\")) {\n                return;\n            }\n            var text = '';\n            if (e.clipboardData || e.originalEvent.clipboardData) {\n                text = (e.originalEvent || e).clipboardData.getData('Text');\n            } else if (this.$window.clipboardData) {\n                text = this.$window.clipboardData.getData('Text');\n            }\n            if (this.$window.document.queryCommandSupported('insertText')) {\n                this.$window.document.execCommand('insertText', false, text);\n            } else {\n                this.$window.document.execCommand('paste', false, text);\n            }\n        }\n    }, {\n        key: \"clickOnWord\",\n        value: function clickOnWord($node) {\n            // for better handling in webkit\n            var textNode = $node.contents().first()[0];\n            var anchorNode = this.$window.getSelection().anchorNode;\n            var position = this.caret.getCaretCharacterOffsetWithin(textNode);\n            if (anchorNode && position === 0) {\n                var text = $node.text().trim();\n                if (text.length > 0) {\n                    var spacedText = this.$window.document.createTextNode(\"\\xA0\" + text);\n                    this.$(textNode).replaceWith(spacedText);\n                    this.caret.moveInText(1, spacedText);\n                }\n            }\n        }\n    }, {\n        key: \"getLast\",\n        value: function getLast($node) {\n            var $last = $node.contents().last();\n            var $prev = $node;\n            if ($last[0] && ($last[0].nodeType === 3 || $last[0].hasAttribute(\"data-word\"))) {\n                return $last;\n            } else if (!$last[0]) {\n                return $prev;\n            }\n            return this.getLast($last);\n        }\n    }, {\n        key: \"removeEmptyLast\",\n        value: function removeEmptyLast($node) {\n            var $last = $node.contents().last();\n            var remove = false;\n            if ($last.is(\"br\")) {\n                remove = true;\n            } else if ($last[0] && $last[0].nodeType === 3) {\n                var value = $last[0].nodeValue.trim();\n                if (value.length < 1) {\n                    remove = true;\n                }\n            }\n            if (remove) {\n                $last.remove();\n                this.removeEmptyLast(this.root);\n            }\n        }\n    }]);\n    return Helper;\n}();\n\nexports.default = Helper;\n\n/***/ }),\n/* 142 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _xregexp = __webpack_require__(143);\n\nvar _xregexp2 = _interopRequireDefault(_xregexp);\n\nvar _WordNode = __webpack_require__(144);\n\nvar _WordNode2 = _interopRequireDefault(_WordNode);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n* Parser for parsing user text in text editor. Splits text into words and handles\r\n* changes in already dicovered words.\r\n* @constructor\r\n* @param {Object} $  Jquery selector for element in the component scope\r\n* @param {Service} $window  Angularjs '$window' service wrapper for window object\r\n* @param {Object} $root Juery selector for text editor\r\n* @param {Service} colorService 'colorService' service\r\n* @param {Words} words Words\r\n* @memberof module:text-colorizer\r\n*/\nvar Parser = function () {\n    function Parser($, $window, $root, colorService, words) {\n        (0, _classCallCheck3.default)(this, Parser);\n\n        this.$ = $;\n        this.$window = $window;\n        this.$root = $root;\n        this._colorService = colorService;\n        this._idCounter = 0;\n        this._words = words;\n        this._wordRegex = (0, _xregexp2.default)(\"\\\\pL+(?:[-']?\\\\pL+)*\", 'gi');\n        this._wordFormatRegex = (0, _xregexp2.default)(\"^(?:\\\\pL+(?:[-']?\\\\pL+)*)$\", 'i');\n    }\n\n    /** Parse text in text editor and splits it into separate words.\r\n    * There are two different nodes possible: raw text nodes and\r\n    * already processed (and eventually colorized) words.\r\n    * Raw text nodes will be splitted into separate words. Word nodes will be checked\r\n    * for changes. If the word node containes actually more than one word,\r\n    * it will be splitted in multiple word nodes with new ids.\r\n    * @method parse\r\n    * @memberof module:text-colorizer.Parser\r\n    * @instance\r\n    */\n\n\n    (0, _createClass3.default)(Parser, [{\n        key: 'parse',\n        value: function parse() {\n            this._parseElement(this.$root);\n        }\n    }, {\n        key: '_createWordDOMNode',\n        value: function _createWordDOMNode(id, txt, backgroundColor, fontColor, cssClass) {\n            var element = this.$window.document.createElement(\"span\");\n            element.setAttribute(\"data-word\", id);\n            element.setAttribute(\"style\", 'background-color: ' + backgroundColor + '; color: ' + fontColor + ';');\n            var textNode = this._createTextDOMNode(txt);\n            element.appendChild(textNode);\n            if (cssClass) {\n                element.setAttribute(\"class\", cssClass);\n            } else {\n                element.setAttribute(\"class\", \"unselected\");\n            }\n            return element;\n        }\n    }, {\n        key: '_createTextDOMNode',\n        value: function _createTextDOMNode(text) {\n            return this.$window.document.createTextNode(text);\n        }\n    }, {\n        key: '_parseElement',\n        value: function _parseElement(element) {\n            var _this = this;\n\n            this.$(element).contents().each(function (i, node) {\n                switch (node.nodeType) {\n                    case 1:\n                        if (!node.hasAttribute(\"data-word\")) {\n                            _this._parseElement(node);\n                        } else {\n                            _this._analyzeWordElement(node);\n                        }break;\n                    case 3:\n                        _this._parseTextNode(node);break;\n                    default:\n                        break;\n                }\n            });\n        }\n    }, {\n        key: '_parseText',\n        value: function _parseText(node, txt, callback) {\n            var DOMNodes = [];\n            var result = [];\n            var index = 0;\n            var textLength = 0;\n            while ((result = this._wordRegex.exec(txt)) !== null) {\n                var needle = result[0];\n                var currentIndex = result.index;\n                if (currentIndex - index + textLength > 1) {\n                    var text = txt.substring(index + textLength, currentIndex);\n                    var notWord = this._createTextDOMNode(text);\n                    DOMNodes.push(notWord);\n                }\n                index = currentIndex;\n                textLength = needle.length;\n                var wordDOMNode = callback(needle);\n                DOMNodes.push(wordDOMNode);\n            }\n            if (index + textLength < txt.length) {\n                var _text = txt.substring(index + textLength);\n                var _notWord = this._createTextDOMNode(_text);\n                DOMNodes.push(_notWord);\n            }\n            if (DOMNodes.length > 0) {\n                this.$(node).replaceWith(DOMNodes);\n            }\n        }\n    }, {\n        key: '_parseTextNode',\n        value: function _parseTextNode(node) {\n            var _this2 = this;\n\n            this._parseText(node, node.nodeValue, function (needle) {\n                var id = _this2._idCounter++;\n                var domNode = _this2._createWordDOMNode(id, needle);\n                var wordNode = new _WordNode2.default(id, needle.toLowerCase(), _this2._colorService.getColorInstance(), _this2.$(domNode));\n                _this2._words.addWordNode(wordNode);\n                return domNode;\n            });\n        }\n    }, {\n        key: '_analyzeWordElement',\n        value: function _analyzeWordElement(element) {\n            var _this3 = this;\n\n            var $word = this.$(element);\n            var id = parseInt($word.attr(\"data-word\"), 10);\n            var elementText = $word.text();\n            var text = elementText.trim();\n            var wordNode = this._words.getWordNode(id);\n            if (elementText.length > text.length) {\n                $word.text(text);\n            }\n            if (!text.match(this._wordFormatRegex) || wordNode.word.trim() !== text) {\n                var backgroundColor = $word.css(\"background-color\");\n                var cssClass = $word.attr('class');\n                var fontColor = $word.css(\"color\");\n                this._words.removeWordNode(id);\n                this._parseText($word, text, function (needle) {\n                    var newId = _this3._idCounter++;\n                    var domNode = _this3._createWordDOMNode(newId, needle, backgroundColor, fontColor, cssClass);\n                    var newWordNode = new _WordNode2.default(newId, needle.toLowerCase(), _this3._colorService.getColorInstance(wordNode.color), _this3.$(domNode));\n                    _this3._words.addWordNode(newWordNode);\n                    return domNode;\n                });\n            }\n        }\n    }]);\n    return Parser;\n}();\n\nexports.default = Parser;\n\n/***/ }),\n/* 143 */,\n/* 144 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n* Represents a word node in the parsing tree. Contains DOM node\r\n* for fast access and modifications.\r\n* @constructor\r\n* @param {Number} id Id of the word node\r\n* @param {String} word Word\r\n* @param {Color} color Color\r\n* @param {Object} $domNode DOM node in jquery wrapper\r\n* @property {Number} id\r\n* @property {String} word\r\n* @property {HSLColor} color\r\n* @property {Object} $domNode\r\n* @memberof module:text-colorizer\r\n*/\n\nvar WordNode = function () {\n    function WordNode(id, word, color, $domNode) {\n        (0, _classCallCheck3.default)(this, WordNode);\n\n        this.id = id;\n        this.word = word;\n        this.color = color;\n        this.$domNode = $domNode;\n    }\n\n    /** Resets color object and style in dom node.\r\n    * @method resetColor\r\n    * @memberof module:text-colorizer.WordNode\r\n    * @instance\r\n    */\n\n\n    (0, _createClass3.default)(WordNode, [{\n        key: \"resetColor\",\n        value: function resetColor() {\n            this.color.reset();\n            this.$domNode.removeAttr(\"style\");\n            this.$domNode.removeClass();\n            this.$domNode.addClass(\"unselected\");\n        }\n\n        /** Set color\r\n        * @method setColor\r\n        * @param {Color} color Color object\r\n        * @param {Color} fontColor Color object with calculated color for font\r\n        * @memberof module:text-colorizer.WordNode\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"setColor\",\n        value: function setColor(color, fontColor) {\n            this.color.setColor(color);\n            this.$domNode.css({ \"background-color\": color.toString() });\n            this.$domNode.css({ color: fontColor });\n            this.$domNode.removeClass();\n            this.$domNode.addClass(\"selected\");\n            if (color.l > 97) {\n                this.$domNode.addClass(\"selected_white\");\n            }\n        }\n    }]);\n    return WordNode;\n}();\n\nexports.default = WordNode;\n\n/***/ }),\n/* 145 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _angularjsSlider = __webpack_require__(56);\n\nvar _angularjsSlider2 = _interopRequireDefault(_angularjsSlider);\n\n__webpack_require__(146);\n\nvar _colorToolbar = __webpack_require__(147);\n\nvar _colorToolbar2 = _interopRequireDefault(_colorToolbar);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n* @module color-toolbar\n* @requires module:angularjs-slider\n*/\nangular.module('color-toolbar', [_angularjsSlider2.default])\n/**\n* Adjusting and vizualization of selected word color. Each color modification is \n* transfered to the main component through the 'colorModified' binding.\n* The word color selection in the main component is transfered\n* to the toolbar component through 'inputColor' binding.\n* @member {Component} colorToolbar\n* @memberof module:color-toolbar\n* @property {ColorToolbarCtrl} controller\n* @property {String} template\n* @property {Object} bindings {colorModified: '&', onClose: '&', closed: '<', inputColor: '<'}\n* @instance\n*/\n.component('colorToolbar', {\n    template: _colorToolbar2.default,\n    bindings: {\n        colorModified: '&',\n        onClose: '&',\n        closed: '<',\n        inputColor: '<'\n    },\n    /**\n    * Controller for 'colorToolbar' component.\n    * @constructor ColorToolbarCtrl\n    * @param {Service} $scope Angularjs '$scope' service\n    * @param {Service} $timeout Angularjs '$timeout' service\n    * @param {Service} $element Angularjs '$element' service\n    * @param {Service} colorService 'colorService' service\n    * @param {Factory} calculateFontColor 'calculateFontColor' factory\n    * @see colorToolbar component\n    * @memberof module:color-toolbar\n    */\n    controller: function () {\n        (0, _createClass3.default)(ColorToolbarCtrl, null, [{\n            key: '$inject',\n            get: function get() {\n                return ['$scope', '$timeout', '$element', 'colorService', 'calculateFontColor'];\n            }\n        }]);\n\n        function ColorToolbarCtrl($scope, $timeout, $element, colorService, calculateFontColor) {\n            (0, _classCallCheck3.default)(this, ColorToolbarCtrl);\n\n            this.$scope = $scope;\n            this.$element = $element;\n            this.$timeout = $timeout;\n            this._colorService = colorService;\n            this._calculateFontColor = calculateFontColor;\n            this.wordLinking = true;\n            this.colors = [];\n            for (var i = 0; i < 360; i += 30) {\n                var color = colorService.getColorInstance({ h: i, s: 80, l: 50 });\n                this.colors.push(color);\n            }\n            var black = colorService.getColorInstance({ h: 0, s: 0, l: 0 }).setAchromatic();\n            var white = colorService.getColorInstance({ h: 0, s: 0, l: 100 }).setAchromatic();\n            this.colors.push(black);\n            this.colors.push(white);\n            this.color = colorService.getColorInstance();\n            var self = this;\n            this.slider = {\n                value: 50,\n                options: {\n                    floor: 0,\n                    ceil: 100,\n                    step: 1,\n                    onChange: function onChange() {\n                        self.colorModified({ color: self.color, linking: self.wordLinking });\n                    },\n                    onEnd: function onEnd() {\n                        self.colorModified({ color: self.color, linking: self.wordLinking });\n                    },\n\n                    hidePointerLabels: true,\n                    hideLimitLabels: true,\n                    disabled: true\n                }\n            };\n        }\n\n        (0, _createClass3.default)(ColorToolbarCtrl, [{\n            key: '$onInit',\n            value: function $onInit() {\n                if (this.closed === true) {\n                    this.close();\n                }\n            }\n        }, {\n            key: '$onChanges',\n            value: function $onChanges(changes) {\n                var color = changes.inputColor.currentValue;\n                if (color) {\n                    this.setCurrentColor(color);\n                    if (this.$element.hasClass(\"hide\")) {\n                        this.open();\n                    }\n                }\n            }\n\n            /**\n            * @method increaseWeight\n            * @memberof module:color-toolbar.ColorToolbar\n            * @instance\n            */\n\n        }, {\n            key: 'increaseWeight',\n            value: function increaseWeight() {\n                var self = this;\n                if (this.color && this.color.isSet() && this.color.weight < 100) {\n                    this.color.weight++;\n                    this.colorModified({ color: self.color, linking: self.wordLinking });\n                }\n            }\n\n            /**\n            * @method decreaseWeight\n            * @memberof module:color-toolbar.ColorToolbar\n            * @instance\n            */\n\n        }, {\n            key: 'decreaseWeight',\n            value: function decreaseWeight() {\n                var self = this;\n                if (this.color && this.color.isSet() && this.color.weight > 1) {\n                    self.color.weight--;\n                    this.colorModified({ color: self.color, linking: self.wordLinking });\n                }\n            }\n\n            /**\n            * @method endSlide\n            * @memberof module:color-toolbar.ColorToolbar\n            * @instance\n            */\n\n        }, {\n            key: 'endSlide',\n            value: function endSlide() {\n                var self = this;\n                this.colorModified({ color: self.color, linking: self.wordLinking });\n            }\n\n            /**\n            * @method linkingIconColor\n            * @memberof module:color-toolbar.ColorToolbar\n            * @instance\n            */\n\n        }, {\n            key: 'linkingIconColor',\n            value: function linkingIconColor() {\n                return this.color.isSet() ? this._calculateFontColor(this.color) : \"black\";\n            }\n\n            /**\n            * @method selectColor\n            * @param {Object} $event Angularjs $event object\n            * @memberof module:color-toolbar.ColorToolbar\n            * @instance\n            */\n\n        }, {\n            key: 'selectColor',\n            value: function selectColor($event) {\n                var self = this;\n                var target = $event.target;\n                if (target.hasAttribute(\"data-toolbar-color\") || target.parentElement.hasAttribute(\"data-toolbar-color\")) {\n                    $event.stopPropagation();\n                    var colorElement = target.hasAttribute(\"data-toolbar-color\") ? target : target.parentElement;\n                    var colorIndex = angular.element(colorElement).attr(\"data-toolbar-color\");\n                    if (colorIndex && colorIndex !== \"null\") {\n                        var color = this._colorService.getColorInstance(this.colors[colorIndex]);\n                        this.changeColor(color);\n                        this.slider.options.disabled = this.color.isAchromatic();\n                    } else {\n                        this.setInitialColor();\n                    }\n                    this.colorModified({ color: self.color, linking: self.wordLinking });\n                }\n            }\n\n            /**\n            * @method changecolor\n            * @memberof module:color-toolbar.ColorToolbar\n            * @instance\n            */\n\n        }, {\n            key: 'changeColor',\n            value: function changeColor(color) {\n                color.weight = this.color.weight;\n                if (!color.isAchromatic() && !this.color.isAchromatic() && this.color.s && this.color.l) {\n                    color.s = this.color.s;\n                    color.l = this.color.l;\n                }\n                this.color = color;\n            }\n\n            /**\n            * @method setCurrentColor\n            * @memberof module:color-toolbar.ColorToolbar\n            * @instance\n            */\n\n        }, {\n            key: 'setCurrentColor',\n            value: function setCurrentColor(color) {\n                if (color && color.isSet()) {\n                    this.color = color;\n                    this.slider.options.disabled = this.color.isAchromatic();\n                } else {\n                    this.setInitialColor();\n                }\n            }\n\n            /**\n            * @method setInitialColor\n            * @memberof module:color-toolbar.ColorToolbar\n            * @instance\n            */\n\n        }, {\n            key: 'setInitialColor',\n            value: function setInitialColor() {\n                this.color = this._colorService.getColorInstance();\n                this.slider.options.disabled = true;\n            }\n\n            /**\n            * @method close\n            * @memberof module:color-toolbar.ColorToolbar\n            * @instance\n            */\n\n        }, {\n            key: 'close',\n            value: function close() {\n                this.$element.addClass(\"hide\");\n                this.onClose();\n            }\n\n            /**\n            * @method open\n            * @memberof module:color-toolbar.ColorToolbar\n            * @instance\n            */\n\n        }, {\n            key: 'open',\n            value: function open() {\n                this.$element.removeClass(\"hide\");\n                this.$scope.$broadcast('rzSliderForceRender');\n            }\n        }]);\n        return ColorToolbarCtrl;\n    }()\n});\n\nexports.default = 'color-toolbar';\n\n/***/ }),\n/* 146 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 147 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=toolbar> <div class=toolbar__content> <div class=toolbar__left> <div class=toolbar__colorbox ng-click=$ctrl.selectColor($event)> <div ng-repeat=\\\"c in $ctrl.colors track by $index\\\"> <div class=toolbar__color data-toolbar-color={{$index}} ng-style=\\\"{'background-color': c}\\\"></div> </div> <div class=toolbar__color data-toolbar-color=null><span class=\\\"glyphicon glyphicon-remove toolbar__clear\\\"></span></div> <div style=clear:both></div> </div> </div> <div class=toolbar__center> <div class=toolbar__adjuster> <div class=toolbar__sliders ng-disabled=!$ctrl.color.isSet()> <div class=toolbar__sliders-content> <div class=toolbar__saturation-slider> <span class=\\\"glyphicon glyphicon-signal\\\"></span> <span>{{$ctrl.color.isSet() ? $ctrl.color.s : 0 }}%</span> <rzslider rz-slider-model=$ctrl.color.s rz-slider-options=$ctrl.slider.options></rzslider> </div> <div class=toolbar__lightness-slider> <span class=\\\"glyphicon glyphicon-adjust icon-flipped\\\"></span> <span>{{$ctrl.color.isSet() ? $ctrl.color.l : 0 }}%</span> <rzslider rz-slider-model=$ctrl.color.l rz-slider-options=$ctrl.slider.options></rzslider> </div> </div> </div> <div class=toolbar__weight> <div class=toolbar__weight-title>Weight</div> <div class=toolbar__weight-controls> <div class=\\\"toolbar__weight-buttons btn-group-vertical\\\" role=group> <a type=button class=\\\"btn btn-default btn-block btn-square toolbar__weight-button\\\" ng-click=$ctrl.increaseWeight()>+</a> <a type=button class=\\\"btn btn-default btn-block btn-square toolbar__weight-button\\\" ng-click=$ctrl.decreaseWeight()>-</a> </div> <div class=toolbar__weight-value>{{$ctrl.color.weight}}</div> </div> </div> </div> </div> <div class=toolbar__right> <div class=toolbar__selected> <div class=toolbar__selected-color ng-click=\\\"$ctrl.wordLinking = !$ctrl.wordLinking\\\" ng-style=\\\"{'background-color': $ctrl.color}\\\"><span ng-show=$ctrl.wordLinking class=\\\"toolbar__linking-icon glyphicon glyphicon-link\\\" ng-style=\\\"{color: $ctrl.linkingIconColor()}\\\"></span></div> <div class=toolbar__selected-background></div> </div> <div class=toolbar__close ng-click=$ctrl.close()> <span class=\\\"glyphicon glyphicon-menu-up toolbar__close-icon\\\"></span> </div> </div> </div> </div>\";\n\n/***/ }),\n/* 148 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _ngInfiniteScroll = __webpack_require__(57);\n\nvar _ngInfiniteScroll2 = _interopRequireDefault(_ngInfiniteScroll);\n\n__webpack_require__(149);\n\n__webpack_require__(150);\n\n__webpack_require__(151);\n\nvar _imageFinder = __webpack_require__(152);\n\nvar _imageFinder2 = _interopRequireDefault(_imageFinder);\n\nvar _Images = __webpack_require__(153);\n\nvar _Images2 = _interopRequireDefault(_Images);\n\nvar _ImagesRPCService = __webpack_require__(155);\n\nvar _ImagesRPCService2 = _interopRequireDefault(_ImagesRPCService);\n\nvar _ImageInspector = __webpack_require__(156);\n\nvar _ImageInspector2 = _interopRequireDefault(_ImageInspector);\n\nvar _imageViewer = __webpack_require__(157);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n* Module for image search and result representation.\n* Uses 'jsonrpc' module for server connection and scrolling module\n* for the on-scroll lazy loading of images.\n* @module image-finder\n* @requires module:jsonrpc\n* @requires module:ng-infinite-scroll\n* @requires module:ng-error\n* @requires module:ng-load\n*/\nangular.module('image-finder', ['jsonrpc', _ngInfiniteScroll2.default, 'ngError', 'ngLoad'])\n/** Images model.\n* @member {Service} images\n* @memberof module:image-finder\n* @see Images class\n* @instance\n*/\n.service('images', ['jsonrpc', 'login', function (jsonrpc, login) {\n    return new _Images2.default(new _ImagesRPCService2.default(jsonrpc, login));\n}])\n/** Image inspector model.\n* @member {Service} imageInspector\n* @memberof module:image-finder\n* @see ImageInspector class\n* @instance\n*/\n.service('imageInspector', ['$window', '$document', 'images', function ($window, $document, images) {\n    return new _ImageInspector2.default($window, $document, images);\n}])\n/** Component for image detailed view.\n* @member {Component} imageViewer\n* @property {ImageViewerCtrl} controller\n* @property {String} template\n* @property {Object} bindings {image: '<', onClose: '&', onImagesUpdated: '&'}\n* @memberof module:image-finder\n* @instance\n*/\n.component(_imageViewer.imageViewerCompName, _imageViewer.imageViewerComp)\n/** Main component of the module.\n* Searches for images and represents the search results.\n* @member {Component} imageFinder\n* @property {ImageFinderCtrl} controller\n* @property {String} template\n* @property {Object} bindings {onImagesFound: '&', search: '<'}\n* @memberof module:image-finder\n* @instance\n*/\n.component('imageFinder', {\n    template: _imageFinder2.default,\n    bindings: {\n        onImagesFound: '&',\n        search: '<'\n    },\n    /**\n    * Controller for 'imageFinder' component.\n    * @constructor ImageFinderCtrl\n    * @param {Service} $document Angularjs '$document'\n    * @param {Service} images 'images' service\n    * @param {Service} imageInspector 'imageInspectro' service\n    * @param {Service} usSpinnerService 'usSpinnerService' service\n    * @see imageFinder component\n    * @memberof module:image-finder\n    */\n    controller: function () {\n        (0, _createClass3.default)(ImageFinderCtrl, null, [{\n            key: '$inject',\n            get: function get() {\n                return ['$document', 'images', 'imageInspector', 'usSpinnerService'];\n            }\n        }]);\n\n        function ImageFinderCtrl($document, images, imageInspector, spinner) {\n            (0, _classCallCheck3.default)(this, ImageFinderCtrl);\n\n            this.$document = $document;\n            this._imageInspector = imageInspector;\n            this._spinner = spinner;\n            this._step = 10;\n            this._images = images;\n            this._findPending = false;\n            this.selectedImage = null;\n            this.imagesToShow = [];\n        }\n\n        /** Component hook method\n        * @method $onInit\n        * @memberof module:image-finder.ImageFinderCtrl\n        * @instance\n        */\n\n\n        (0, _createClass3.default)(ImageFinderCtrl, [{\n            key: '$onInit',\n            value: function $onInit() {\n                this.imagesToShow = this._images.getImagesInInterval(0, this._images.showIndex);\n            }\n\n            /** Component hook method\n            * @method $onChanges\n            * @param {Object} changes\n            * @memberof module:image-finder.ImageFinderCtrl\n            * @instance\n            */\n\n        }, {\n            key: '$onChanges',\n            value: function $onChanges(changes) {\n                var _this = this;\n\n                var search = changes.search.currentValue;\n                if (search && !this._findPending) {\n                    this.imagesToShow.length = 0;\n                    var wordsAndColors = search.words;\n                    var settings = search.settings;\n                    if (settings && wordsAndColors) {\n                        this._findPending = true;\n                        this._spinner.spin('spinner-1');\n                        this._images.findImages(wordsAndColors, settings, function () {\n                            _this._findPending = false;\n                            _this._spinner.stop('spinner-1');\n                            _this.imagesToShow = _this._images.getImagesInInterval(0, _this._step);\n                            _this._images.showIndex = _this._step;\n                            _this.onImagesFound({\n                                images: _this._images.getImagesArray()\n                            });\n                        });\n                    }\n                }\n            }\n\n            /**\n            * @method checkForImageFailure\n            * @param {Image} img\n            * @param {Object} imgNode Image DOM node\n            * @memberof module:image-finder.ImageFinderCtrl\n            * @instance\n            */\n\n        }, {\n            key: 'checkForImageFailure',\n            value: function checkForImageFailure(img, imgNode) {\n                var _this2 = this;\n\n                this._images.checkForImageFailure(img, function (failure) {\n                    if (failure) {\n                        _this2._images.removeImage(img);\n                        angular.element(imgNode).remove();\n                        _this2.showMore();\n                    }\n                });\n            }\n\n            /** Event handler\n            * @method  thumbnailLoaded\n            * @param {Object} $event Angularjs '$event'\n            * @param {Image} img\n            * @memberof module:image-finder.ImageFinderCtrl\n            * @instance\n            */\n\n        }, {\n            key: 'thumbnailLoaded',\n            value: function thumbnailLoaded($event, img) {\n                this._imageInspector.inspect(img, $event.target, this.checkForImageFailure.bind(this));\n            }\n\n            /** Event handler\n            * @method thumbnailLoadingError\n            * @param {Object} $event Angularjs '$event'\n            * @param {Image} img\n            * @memberof module:image-finder.ImageFinderCtrl\n            * @instance\n            */\n\n        }, {\n            key: 'thumbnailLoadingError',\n            value: function thumbnailLoadingError($event, img) {\n                this.checkForImageFailure(img, $event.target);\n            }\n\n            /** Show more images on scroll.\n            * @method showMore\n            * @memberof module:image-finder.ImageFinderCtrl\n            * @instance\n            */\n\n        }, {\n            key: 'showMore',\n            value: function showMore() {\n                this.imagesToShow = this.imagesToShow.concat(this._images.getImagesInInterval(this._images.showIndex, this._images.showIndex + this._step));\n                this._images.showIndex += this._step;\n            }\n\n            /** Selects current image. A change of current\n            * image will be propagated to the 'imageViewer'\n            *  component through bindings. Thus a selected\n            * image will be shown in detailed view.\n            * @method selectImage\n            * @param {Object} $event Angularjs '$event'\n            * @memberof module:image-finder.ImageFinderCtrl\n            * @instance\n            */\n\n        }, {\n            key: 'selectImage',\n            value: function selectImage($event) {\n                var target = $event.target;\n                if (target.hasAttribute('imagefinder-image') || angular.element(target).parent()[0].hasAttribute('imagefinder-image')) {\n                    $event.stopPropagation();\n                    var id = target.hasAttribute('imagefinder-image') ? angular.element(target).attr('imagefinder-image') : angular.element(target).parent().attr('imagefinder-image');\n                    this.selectedImage = this._images.getImage(id);\n                }\n            }\n\n            /** Invoked if the result set was updated, for example if some\n            * images were removed.\n            * @method imagesUpdated\n            * @memberof module:image-finder.ImageFinderCtrl\n            * @instance\n            */\n\n        }, {\n            key: 'imagesUpdated',\n            value: function imagesUpdated() {\n                this.imagesToShow = this._images.getImagesInInterval(0, this._images.showIndex);\n            }\n        }]);\n        return ImageFinderCtrl;\n    }()\n});\n\nexports.default = 'image-finder';\n\n/***/ }),\n/* 149 */,\n/* 150 */,\n/* 151 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 152 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=image-finder> <div class=image-finder__container> <div ng-click=$ctrl.selectImage($event) class=image-finder__images infinite-scroll=$ctrl.showMore() infinite-scroll-distance=0> <div ng-repeat=\\\"img in $ctrl.imagesToShow track by img.id\\\"> <img imagefinder-image={{img.id}} ng-src={{img.previewURL}} class=image-finder__image ng-error=\\\"$ctrl.thumbnailLoadingError($event, img)\\\" ng-load=\\\"$ctrl.thumbnailLoaded($event, img)\\\"> </div> </div> </div> <image-viewer ng-show=$ctrl.selectedImage image=$ctrl.selectedImage on-images-updated=$ctrl.imagesUpdated() on-close=\\\"$ctrl.selectedImage = null\\\"></image-viewer> </div>\";\n\n/***/ }),\n/* 153 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _Image = __webpack_require__(154);\n\nvar _Image2 = _interopRequireDefault(_Image);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n* Images model class.\r\n* Manages images and requests server with the help of 'ImagesRPCService'.\r\n* @constructor:\r\n* @param {ImagesRPCService} service 'ImagesRPCService' instance\r\n* @memberof module:image-finder\r\n*/\nvar Images = function () {\n    function Images(service) {\n        (0, _classCallCheck3.default)(this, Images);\n\n        this.images = [];\n        this.service = service;\n        this.showIndex = 0;\n    }\n\n    /** Creates new image and adds it to the result set.\r\n    * @method addImage\r\n    * @param {Object} o Object that contains data for image creation\r\n    * @memberof module:image-finder.Images\r\n    * @instance\r\n    */\n\n\n    (0, _createClass3.default)(Images, [{\n        key: \"addImage\",\n        value: function addImage(o) {\n            var img = new _Image2.default(o);\n            this.images.push(img);\n        }\n\n        /** Removes image from result set.\r\n        * @method removeImage\r\n        * @param {Image} image Image object\r\n        * @memberof module:image-finder.Images\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"removeImage\",\n        value: function removeImage(image) {\n            for (var i = 0; i < this.images.length; i++) {\n                if (this.images[i].id == image.id) {\n                    this.images.splice(i, 1);\n                    break;\n                }\n            }\n        }\n\n        /** Returns image by id.\r\n        * @method getImage\r\n        * @param {Number} id Image id\r\n        * @return {Image}\r\n        * @memberof module:image-finder.Images\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"getImage\",\n        value: function getImage(id) {\n            var image = null;\n            for (var i = 0, k = this.images.length; i < k; i++) {\n                if (this.images[i].id == id) {\n                    image = this.images[i];\n                    break;\n                }\n            }\n            return image;\n        }\n\n        /** Returns all images (result set) as array.\r\n        * @method getImagesArray\r\n        * @return {Image[]}\r\n        * @memberof module:image-finder.Images\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"getImagesArray\",\n        value: function getImagesArray() {\n            return this.images;\n        }\n\n        /** Number of images in result set.\r\n        * @method count\r\n        * @return {Number}\r\n        * @memberof module:image-finder.Images\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"count\",\n        value: function count() {\n            return this.images.length;\n        }\n\n        /** Returns images from result set in given interval.\r\n        * @method getImagesInInterval\r\n        * @param {Number} start Start index\r\n        * @param {Number} end End index\r\n        * @return {Image[]}\r\n        * @memberof module:image-finder.Images\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"getImagesInInterval\",\n        value: function getImagesInInterval(start, end) {\n            if (start >= 0 && start < this.images.length) {\n                if (end > this.images.length) {\n                    end = this.images.length;\n                }\n                return this.images.slice(start, end);\n            }\n            return [];\n        }\n\n        /** Deletes all images from result set.\r\n        * @method empty\r\n        * @memberof module:image-finder.Images\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"empty\",\n        value: function empty() {\n            this.images.length = 0;\n        }\n\n        /** Checks if the image is faulty.\r\n        * @method checkForImageFailure\r\n        * @param {Image} img Image to check\r\n        * @param {Function} callback Callback function (optional).\r\n        * @memberof module:image-finder.Images\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"checkForImageFailure\",\n        value: function checkForImageFailure(img, callback) {\n            this.service.checkForImageFailure(img, callback);\n        }\n\n        /** Search for images.\r\n        * @method findImages\r\n        * @param {Object} data Colors and words.\r\n        * @param {Service} searchSettings Search settings model.\r\n        * @param {Function} callback Callback function.\r\n        * @memberof module:image-finder.Images\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"findImages\",\n        value: function findImages(data, searchSettings, callback) {\n            this.empty();\n            this.service.findImages(this, data, searchSettings, callback);\n        }\n    }]);\n    return Images;\n}();\n\nexports.default = Images;\n\n/***/ }),\n/* 154 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n* Represents image.\r\n* @constructor\r\n* @param {Object} conf Configuration object with image data\r\n* @property {Number} id\r\n* @property {String} url\r\n* @property {String} previewURL\r\n* @property {Number} score\r\n* @property {String} source\r\n* @property {String} title\r\n* @property {String} owner\r\n* @memberof module:image-finder\r\n*/\nvar Image = function Image(conf) {\n    (0, _classCallCheck3.default)(this, Image);\n\n    this.id = conf.id;\n    this.url = conf.url;\n    this.previewURL = conf.previewURL;\n    this.originalURL = conf.originalURL;\n    this.score = parseFloat(conf.score).toFixed(2);\n    this.source = conf.source;\n    this.title = conf.title || \"unknown\";\n    this.owner = conf.owner || \"unknown\";\n};\n\nexports.default = Image;\n\n/***/ }),\n/* 155 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n* Sends requests to the server using JsonRPC service.\r\n* Uses Login service for client-server authentication.\r\n* @constructor\r\n* @param {Service} jsonrpc - 'jsonrpc' service\r\n* @param {Service} login - 'login' service\r\n* @memberof module:image-finder\r\n*/\nvar ImagesRPCService = function () {\n    function ImagesRPCService(jsonrpc, login) {\n        (0, _classCallCheck3.default)(this, ImagesRPCService);\n\n        this.jsonrpc = jsonrpc;\n        this.login = login;\n    }\n\n    /** Check image for failure. Sends request to the server.\r\n    * @method checkForImageFailure\r\n    * @param {Image} img Object that contains data for image creation\r\n    * @param {Function} callback (optional) Callback function\r\n    * @memberof module:image-finder.ImagesRPCService\r\n    * @instance\r\n    */\n\n\n    (0, _createClass3.default)(ImagesRPCService, [{\n        key: 'checkForImageFailure',\n        value: function checkForImageFailure(img, callback) {\n            this.jsonrpc.request('checkImage', { image: img }).then(function (failure) {\n                if (callback) {\n                    callback(failure);\n                }\n            }).catch(function (error) {\n                console.error(error);\n            });\n        }\n\n        /** Searching for similar images. Sends request to the server.\r\n        * @method findImages\r\n        * @param {Images} images Images model\r\n        * @param {Object} data Object with data for search {colors: HSLImage[], words: string[]}\r\n        * @param {Settings} searchSettings Settings model\r\n        * @param {Function} callback Callback function\r\n        * @memberof module:image-finder.ImagesRPCService\r\n        * @instance\r\n        */\n\n    }, {\n        key: 'findImages',\n        value: function findImages(images, data, searchSettings, callback) {\n            var self = this;\n            this.jsonrpc.request('find', { colors: data.colors, words: data.words, settings: searchSettings.serialize(), auth: self.login.auth }).then(function (result) {\n                if (result && result.imgs && result.imgs.length > 0) {\n                    images.empty();\n                    for (var i = 0; i < result.imgs.length; i++) {\n                        images.addImage(result.imgs[i]);\n                    }\n                }\n                result = null;\n                if (callback) {\n                    callback();\n                }\n            }).catch(function (error) {\n                console.error(error);\n                if (callback) {\n                    callback();\n                }\n            });\n        }\n    }]);\n    return ImagesRPCService;\n}();\n\nexports.default = ImagesRPCService;\n\n/***/ }),\n/* 156 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _map = __webpack_require__(7);\n\nvar _map2 = _interopRequireDefault(_map);\n\nvar _getIterator2 = __webpack_require__(4);\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n* Inspects flickr images and decides if an image could be faulty.\r\n* Calls user callback if the image is suspicious.\r\n* @constructor FlickrInspectingStrategy\r\n* @memberof module:image-finder\r\n*/\nvar FlickrInspectingStrategy = function () {\n    function FlickrInspectingStrategy() {\n        (0, _classCallCheck3.default)(this, FlickrInspectingStrategy);\n\n        this._errorWidth = [320, 500];\n        this._errorHeight = [240, 374];\n    }\n\n    /** Inspects one element and call callback function if\r\n    * image tend to be faulty.\r\n    * @method inspect\r\n    * @param {Object} elem {imageNode: DOMnode, image: Image, callback: Function}\r\n    * @memberof module:image-finder.FlickrInspectingStrategy\r\n    * @instance\r\n    */\n\n\n    (0, _createClass3.default)(FlickrInspectingStrategy, [{\n        key: \"inspect\",\n        value: function inspect(elem) {\n            var width = elem.imageNode.naturalWidth;\n            var height = elem.imageNode.naturalHeight;\n            if (width === this._errorWidth[0] && height === this._errorHeight[0] || width === this._errorWidth[1] && height === this._errorHeight[1]) {\n                if (elem.callback) {\n                    elem.callback(elem.image, elem.imageNode);\n                }\n            }\n        }\n    }]);\n    return FlickrInspectingStrategy;\n}();\n\n/**\r\n* Batch for loaded images, which must be inspected.\r\n* @constructor InspectingBatch\r\n* @param {$window} $window Angularjs '$window' service\r\n* @param {$document} $document Angularjs '$document' service\r\n* @param {Map} strategies HashMap with inspecting strategies\r\n* @param {number} portion Portion of images which will be inspected in one step\r\n* @memberof module:image-finder\r\n*/\n\n\nvar InspectingBatch = function () {\n    function InspectingBatch($window, $document, strategies, portion) {\n        (0, _classCallCheck3.default)(this, InspectingBatch);\n\n        this._imagesToInspect = [];\n        this._strategies = strategies;\n        this._portion = portion;\n        this.$window = $window;\n        setInterval(this._inspect.bind(this), 500);\n    }\n\n    /** Size of the batch\r\n    * @method size\r\n    * @return {Number}\r\n    * @memberof module:image-finder.InspectingBatch\r\n    * @instance\r\n    */\n\n\n    (0, _createClass3.default)(InspectingBatch, [{\n        key: \"size\",\n        value: function size() {\n            return this._imagesToInspect.length;\n        }\n\n        /** Adds one element into batch.\r\n        * @method add\r\n        * @param {Object} element {imageNode: DOMnode, image: Image, callback: Function}\r\n        * @memberof module:image-finder.InspectingBatch\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"add\",\n        value: function add(element) {\n            this._imagesToInspect.push(element);\n        }\n    }, {\n        key: \"_inspect\",\n        value: function _inspect() {\n            var list = this._imagesToInspect.splice(0, this._portion);\n            var _iteratorNormalCompletion = true;\n            var _didIteratorError = false;\n            var _iteratorError = undefined;\n\n            try {\n                for (var _iterator = (0, _getIterator3.default)(list), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                    var elem = _step.value;\n\n                    var strategy = this._strategies.get(elem.image.source);\n                    if (strategy) {\n                        strategy.inspect(elem);\n                    }\n                }\n            } catch (err) {\n                _didIteratorError = true;\n                _iteratorError = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion && _iterator.return) {\n                        _iterator.return();\n                    }\n                } finally {\n                    if (_didIteratorError) {\n                        throw _iteratorError;\n                    }\n                }\n            }\n        }\n    }]);\n    return InspectingBatch;\n}();\n\n/**\r\n* Inspects images for failure\r\n* @constructor\r\n* @param {$window} $window Angularjs '$window' service\r\n* @param {$document} $document Angularjs '$document' service\r\n* @memberof module:image-finder\r\n*/\n\n\nvar ImageInspector = function () {\n    function ImageInspector($window, $document) {\n        (0, _classCallCheck3.default)(this, ImageInspector);\n\n        var strategies = new _map2.default().set(\"flickr\", new FlickrInspectingStrategy());\n        this.batch = new InspectingBatch($window, $document, strategies, 20);\n    }\n\n    /** Add element for inspection.\r\n    * @method inspect\r\n    * @param {Image} image Image object\r\n    * @param {Object} imageNode Image DOM node\r\n    * @param {function} callback Callback function will be called, if image tend to be faulty.\r\n    * @memberof module:image-finder.ImageInspector\r\n    * @instance\r\n    */\n\n\n    (0, _createClass3.default)(ImageInspector, [{\n        key: \"inspect\",\n        value: function inspect(image, imageNode, callback) {\n            this.batch.add({ image: image, imageNode: imageNode, callback: callback });\n        }\n    }]);\n    return ImageInspector;\n}();\n\nexports.default = ImageInspector;\n\n/***/ }),\n/* 157 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.imageViewerComp = exports.imageViewerCompName = undefined;\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\n__webpack_require__(158);\n\nvar _imageViewer = __webpack_require__(159);\n\nvar _imageViewer2 = _interopRequireDefault(_imageViewer);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar imageViewerCompName = exports.imageViewerCompName = 'imageViewer';\nvar imageViewerComp = exports.imageViewerComp = {\n    template: _imageViewer2.default,\n    bindings: {\n        image: '<',\n        onClose: '&',\n        onImagesUpdated: '&'\n    },\n    controller: function () {\n        (0, _createClass3.default)(ImageViewerCtrl, null, [{\n            key: '$inject',\n            get: function get() {\n                return ['$scope', '$window', '$element', '$timeout', '$document', 'imageInspector', 'images', 'usSpinnerService'];\n            }\n        }]);\n\n        function ImageViewerCtrl($scope, $window, $element, $timeout, $document, imageInspector, images, spinner) {\n            (0, _classCallCheck3.default)(this, ImageViewerCtrl);\n\n            this.$scope = $scope;\n            this.$window = $window;\n            this.$element = $element;\n            this.$timeout = $timeout;\n            this._imageInspector = imageInspector;\n            this._spinner = spinner;\n            this._images = images;\n            this._canvas = $document[0].createElement('canvas');\n            this._canvasContext = this._canvas.getContext(\"2d\");\n            this._imageDownload = $element.find(\".image-viewer__download\")[0];\n        }\n\n        (0, _createClass3.default)(ImageViewerCtrl, [{\n            key: '$onChanges',\n            value: function $onChanges(changes) {\n                this.selectedImage = angular.copy(changes.image.currentValue);\n                if (this.selectedImage) {\n                    this._spinner.spin('spinner-1');\n                    angular.element('body').addClass('stop-scrolling');\n                }\n            }\n        }, {\n            key: '$postLink',\n            value: function $postLink() {\n                var _this = this;\n\n                this.$window.addEventListener('keydown', function (event) {\n                    if (_this.selectedImage && event.keyCode === 27) {\n                        _this.close(event);\n                        _this.$scope.$apply();\n                    }\n                });\n            }\n        }, {\n            key: 'getScore',\n            value: function getScore() {\n                if (this.selectedImage) {\n                    return parseFloat(this.selectedImage.score * 100).toFixed(2);\n                }\n                return null;\n            }\n        }, {\n            key: 'originalURL',\n            value: function originalURL() {\n                this.$window.open(this.selectedImage.originalURL);\n            }\n        }, {\n            key: 'loaded',\n            value: function loaded($event, img) {\n                var _this2 = this;\n\n                this._spinner.stop('spinner-1');\n                var imageNode = $event.target;\n                this._imageInspector.inspect(img, $event.target, this._images.checkForImageFailure(img, function (failure) {\n                    if (failure) {\n                        _this2._images.removeImage(img);\n                        angular.element('body').removeClass('stop-scrolling');\n                        _this2.selectedImage = null;\n                        _this2.onClose();\n                        _this2.onImagesUpdated();\n                    }\n                }));\n            }\n        }, {\n            key: 'loadingError',\n            value: function loadingError(image) {\n                this._spinner.stop('spinner-1');\n                this._images.checkForImageFailure(image);\n                this._images.removeImage(image);\n                angular.element('body').removeClass('stop-scrolling');\n                this.selectedImage = null;\n                this.onClose();\n                this.onImagesUpdated();\n            }\n        }, {\n            key: 'save',\n            value: function save() {\n                var _this3 = this;\n\n                this._canvasContext.clearRect(0, 0, this._canvas.width, this._canvas.height);\n                this._imageDownload.href = \"\";\n                this._imageDownload.download = \"\";\n                if (this.selectedImage) {\n                    var image = new Image();\n                    image.crossOrigin = \"anonymous\";\n                    image.onload = function () {\n                        _this3._canvas.width = image.naturalWidth;\n                        _this3._canvas.height = image.naturalHeight;\n                        var url = null;\n                        try {\n                            _this3._canvasContext.drawImage(image, 0, 0);\n                            if (image.src.indexOf(\".jpg\") > -1) {\n                                url = _this3._canvas.toDataURL(\"image/jpeg\");\n                            } else if (image.src.indexOf(\".gif\") > -1) {\n                                url = _this3._canvas.toDataURL(\"image/gif\");\n                            } else {\n                                url = _this3._canvas.toDataURL(\"image/png\");\n                            }\n                        } catch (e) {\n                            console.error(e);\n                        }\n                        if (url) {\n                            _this3._imageDownload.href = url;\n                            _this3._imageDownload.download = image.src.split(/(\\\\|\\/)/g).pop();\n                            _this3.$timeout(function () {\n                                _this3._imageDownload.click();\n                            }, 100, false);\n                        }\n                    };\n                    image.onerror = function (e) {\n                        console.log(e);\n                        var win = _this3.$window.open(_this3.selectedImage.url, '_blank');\n                        win ? win.focus() : null;\n                    };\n                    image.src = this.selectedImage.url;\n                }\n            }\n        }, {\n            key: 'close',\n            value: function close($event) {\n                var target = $event.target;\n                if (target.hasAttribute(\"imageviewer-close\") || $event.keyCode === 27) {\n                    $event.stopPropagation();\n                    this._spinner.stop('spinner-1');\n                    angular.element('body').removeClass('stop-scrolling');\n                    this.selectedImage = null;\n                    this._canvasContext.clearRect(0, 0, this._canvas.width, this._canvas.height);\n                    this._imageDownload.href = \"\";\n                    this._imageDownload.download = \"\";\n                    this.onClose();\n                }\n            }\n        }]);\n        return ImageViewerCtrl;\n    }()\n};\n\n/***/ }),\n/* 158 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 159 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=image-viewer> <div class=image-viewer__topline> <div class=image-viewer__topline-main> <div class=image-viewer__topline-content> <a class=image-viewer__original target=_blank href={{$ctrl.selectedImage.originalURL}}>Original</a> <span class=image-viewer__separator></span> <span class=image-viewer__score>{{$ctrl.getScore()}}%</span> <span class=image-viewer__separator></span> <a class=image-viewer__save ng-click=$ctrl.save()> <span class=\\\"glyphicon glyphicon-floppy-save image-viewer__save-icon\\\"></span> </a> <div ng-click=$ctrl.close($event) class=image-viewer__close-button imageviewer-close> <span class=\\\"glyphicon glyphicon-remove image-viewer__close-icon\\\" aria-hidden=true imageviewer-close></span> </div> </div> </div> <div class=image-viewer__info> <div class=image-viewer__attribution> <div class=image-viewer__title>{{$ctrl.selectedImage.title}}</div> <div>by</div> <div class=image-viewer__owner>{{$ctrl.selectedImage.owner}}</div> </div> </div> </div> <div class=image-viewer__image-container ng-click=$ctrl.close($event) imageviewer-close> <img class=image-viewer__image src={{$ctrl.selectedImage.url}} ng-load=\\\"$ctrl.loaded($event, $ctrl.selectedImage)\\\" ng-error=$ctrl.loadingError($ctrl.selectedImage)> <a class=image-viewer__download></a> </div> </div>\";\n\n/***/ }),\n/* 160 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _values = __webpack_require__(161);\n\nvar _values2 = _interopRequireDefault(_values);\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\n__webpack_require__(166);\n\nvar _settings = __webpack_require__(167);\n\nvar _settings2 = _interopRequireDefault(_settings);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n* @module settings\r\n*/\nangular.module('settings', [])\n\n/** Settings component which is responsible for visualization\r\n* of app (search) settings.\r\n* @member {Component} settings\r\n* @property {SettingsCtrl} controller\r\n* @property {String} template\r\n* @memberof module:settings\r\n* @instance\r\n*/\n.component('settings', {\n    template: _settings2.default,\n\n    /**\r\n    * Controller class of 'settings' component\r\n    * @constructor SettingsCtrl\r\n    * @param {Service} $scope Angularjs '$scope' service\r\n    * @param {Service} appSettings 'appSettings' service\r\n    * @see settings component\r\n    * @memberof module:settings\r\n    */\n    controller: function () {\n        (0, _createClass3.default)(SettingsCtrl, null, [{\n            key: '$inject',\n            get: function get() {\n                return ['$scope', 'appSettings'];\n            }\n        }]);\n\n        function SettingsCtrl($scope, settings) {\n            (0, _classCallCheck3.default)(this, SettingsCtrl);\n\n            var self = this;\n            this.$scope = $scope;\n            this._settingsOldState = (0, _values2.default)(settings.serialize()).join();\n            this.settings = settings;\n            this.similarityLevel = settings.similarityLevel;\n            this.slider = {\n                value: 50,\n                options: {\n                    floor: 50,\n                    ceil: 100,\n                    step: 1,\n                    onChange: function onChange() {},\n                    onEnd: function onEnd() {\n                        self.settings.similarityLevel = self.similarityLevel;\n                    },\n                    hidePointerLabels: true,\n                    hideLimitLabels: true,\n                    disabled: false\n                }\n            };\n        }\n\n        (0, _createClass3.default)(SettingsCtrl, [{\n            key: '$doCheck',\n            value: function $doCheck() {\n                var state = (0, _values2.default)(this.settings.serialize()).join();\n                if (state !== this._settingsOldState) {\n                    this._settingsOldState = state;\n                    this.similarityLevel = this.settings.similarityLevel;\n                    this.settings.save(function () {}, function (e) {\n                        console.log(e);\n                    });\n                }\n            }\n        }, {\n            key: '$onInit',\n            value: function $onInit() {\n                var _this = this;\n\n                this.settings.load(function () {\n                    _this.similarityLevel = _this.settings.similarityLevel;\n                }, function (e) {\n                    console.log(e);\n                });\n            }\n        }]);\n        return SettingsCtrl;\n    }()\n});\n\nexports.default = 'settings';\n\n/***/ }),\n/* 161 */,\n/* 162 */,\n/* 163 */,\n/* 164 */,\n/* 165 */,\n/* 166 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 167 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=settings> <div class=checkbox> <label> <input ng-model=$ctrl.settings.checkSemanticSimilarity type=checkbox>Analyze semantics (experimental) </label> </div> <div> <div class=radio> <label> <input type=radio name=optionsRadios ng-model=$ctrl.settings.searchMode value=regular checked=checked>Regular search (fast) </label> </div> <div class=radio> <label> <input type=radio name=optionsRadios ng-model=$ctrl.settings.searchMode value=special>Special search (slow) </label> </div> </div> <div ng-class=\\\"$ctrl.settings.searchMode == 'special' ? 'settings__special-search_show' : 'settings__special-search_hide'\\\"> <select ng-model=$ctrl.settings.distance> <option ng-repeat=\\\"distance in $ctrl.settings.supportedDistances track by $index\\\" data-distances-distance={{$index}} value={{distance.id}}>{{distance.name}}</option> </select> <div class=settings__similarity-level> <div>Similarity level: <span>{{$ctrl.similarityLevel}}%</span></div> <rzslider rz-slider-model=$ctrl.similarityLevel rz-slider-options=$ctrl.slider.options></rzslider> </div> </div> </div> \";\n\n/***/ }),\n/* 168 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\n__webpack_require__(169);\n\nvar _guide = __webpack_require__(170);\n\nvar _guide2 = _interopRequireDefault(_guide);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n* Module \r\n* @module guide\r\n*/\nangular.module('guide', [])\n/** Guide component. Represents a 'guide' page in the web application.\r\n* @member {Component} guide\r\n* @property {String} template\r\n* @memberof module:guide\r\n* @instance\r\n*/\n.component('guide', {\n    template: _guide2.default\n});\n\nexports.default = 'guide';\n\n/***/ }),\n/* 169 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 170 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=guide> <div class=guide__content> <p class=guide__title>This application allows you to find images by color!</p> <p>1. Write your text in the editor on main page</p> <p>2. Color your text with the color tool bar</p> <p>3. Set your desired search settings (optional)</p> <p class=guide__search-settings><span class=\\\"glyphicon glyphicon-triangle-right\\\"></span> The experimental feature for semantic similarity calculates the semantic similarity rank for each similar image and sorts the result set by this value. You can perform a specific search by choosing a desired similarity level and distance function. <br><span class=\\\"glyphicon glyphicon-triangle-right\\\"></span> You can create and manage multiple color profiles. Contents of the existing color profiles can be inspected in the \\\"Archive\\\" section.</p> <p>4. Search!</p> </div> </div>\";\n\n/***/ }),\n/* 171 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _ngInfiniteScroll = __webpack_require__(57);\n\nvar _ngInfiniteScroll2 = _interopRequireDefault(_ngInfiniteScroll);\n\nvar _ColorProfiles = __webpack_require__(172);\n\nvar _ColorProfiles2 = _interopRequireDefault(_ColorProfiles);\n\nvar _colorProfiles = __webpack_require__(174);\n\nvar _profilesViewer = __webpack_require__(178);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n* Module for color profiles\r\n* @module profiles\r\n* @requires module:ng-infinite-scroll\r\n*/\nangular.module('profiles', [_ngInfiniteScroll2.default])\n/** Color profiles model.\r\n* @member {Service} colorProfiles\r\n* @memberof module:profiles\r\n* @see ColorProfiles class\r\n* @instance\r\n*/\n.service('colorProfiles', ['db', 'colorService', function (dbService, colorService) {\n    return new _ColorProfiles2.default(dbService, colorService);\n}])\n/** Color profiles component. Used to create, update and load of color profiles.\r\n* @member {Component} colorProfiles\r\n* @property {ColorProfilesCtrl} controller\r\n* @property {String} template\r\n* @memberof module:profiles\r\n* @instance\r\n*/\n.component(_colorProfiles.colorProfilesCompName, _colorProfiles.colorProfilesComp)\n/** Color profiles viewer component. Shows color profiles\r\n* which are saved in client database.\r\n* @member {Component} profilesViewer\r\n* @property {ProfilesViewerCtrl} controller\r\n* @property {String} template\r\n* @memberof module:profiles\r\n* @instance\r\n*/\n.component(_profilesViewer.profilesViewerCompName, _profilesViewer.profilesViewerComp);\n\nexports.default = 'profiles';\n\n/***/ }),\n/* 172 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _ColorProfile = __webpack_require__(58);\n\nvar _ColorProfile2 = _interopRequireDefault(_ColorProfile);\n\nvar _ColorProfilesDAO = __webpack_require__(173);\n\nvar _ColorProfilesDAO2 = _interopRequireDefault(_ColorProfilesDAO);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n* Saves, loads and updates color profiles.\r\n* @constructor\r\n* @param {Service} dbService - 'db' service\r\n* @param {Service} colorService - 'colorService' service\r\n* @memberof module:profiles\r\n*/\nvar ColorProfiles = function () {\n    function ColorProfiles(dbService, colorService) {\n        (0, _classCallCheck3.default)(this, ColorProfiles);\n\n        this.profileNames = [];\n        this.loadedProfile = null;\n        this.dao = new _ColorProfilesDAO2.default(dbService, colorService);\n    }\n\n    /** Loads all existing color profile names while initialization\r\n    * and sets the first one as a current color profile.\r\n    * @method init\r\n    * @memberof module:profiles.ColorProfiles\r\n    * @instance\r\n    */\n\n\n    (0, _createClass3.default)(ColorProfiles, [{\n        key: \"init\",\n        value: function init(callback) {\n            var _this = this;\n\n            this.loadColorProfileNames(function () {\n                _this.loadColorProfile(_this.profileNames[0], function () {\n                    callback();\n                });\n            });\n        }\n\n        /** Creates new color profile.\r\n        * @method createColorProfile\r\n        * @param {String} name Name of color profile\r\n        * @param {Map} colors Word-to-Color HashMap\r\n        * @param {Number} sPercentage Saturation settings\r\n        * @param {Number} lPercentage Lightness settings\r\n        * @param {Function} callback Callback function\r\n        * @memberof module:profiles.ColorProfiles\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"createColorProfile\",\n        value: function createColorProfile(name, colors, sPercentage, lPercentage, callback) {\n            var profile = new _ColorProfile2.default(name, colors, sPercentage, lPercentage);\n            this.dao.saveColorProfile(profile, this, callback);\n        }\n\n        /** Loads and sets color profile from database.\r\n        * @method loadColorProfile\r\n        * @param {String} name Name of color profile\r\n        * @param {Function} callback Callback function\r\n        * @memberof module:profiles.ColorProfiles\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"loadColorProfile\",\n        value: function loadColorProfile(name, callback) {\n            var _this2 = this;\n\n            this.dao.loadColorProfile(name, function (profile) {\n                _this2.loadedProfile = profile;\n                if (callback) {\n                    callback();\n                }\n            });\n        }\n\n        /** Loads and returns color profile from database by name.\r\n        * @method getColorProfile\r\n        * @param {String} name Name of color profile\r\n        * @param {Function} callback Callback function\r\n        * @memberof module:profiles.ColorProfiles\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"getColorProfile\",\n        value: function getColorProfile(name, callback) {\n            if (name) {\n                this.dao.loadColorProfile(name, function (profile) {\n                    callback(profile);\n                });\n            }\n        }\n\n        /** Loads all existing color profile names from client database.\r\n        * @method loadColorProfileNames\r\n        * @param {Function} callback Callback function\r\n        * @memberof module:profiles.ColorProfiles\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"loadColorProfileNames\",\n        value: function loadColorProfileNames(callback) {\n            this.dao.loadColorProfiles(this, callback);\n        }\n\n        /** Updates current selected color profile.\r\n        * @method updateColorProfile\r\n        * @param {Map} colors Word-to-Color HashMap\r\n        * @param {Number} sPercentage Saturation settings\r\n        * @param {Number} lPercentage Lightness settings\r\n        * @param {Function} callback Callback function\r\n        * @memberof module:profiles.ColorProfiles\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"updateColorProfile\",\n        value: function updateColorProfile() {\n            var _this3 = this;\n\n            var colorProfile = null;\n            var clb = null;\n\n            for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n                args[_key] = arguments[_key];\n            }\n\n            if (args.length > 3) {\n                var _ref = [].concat(args),\n                    colors = _ref[0],\n                    sPercentage = _ref[1],\n                    lPercentage = _ref[2],\n                    callback = _ref[3];\n\n                colorProfile = new _ColorProfile2.default(this.loadedProfile.name, colors, sPercentage, lPercentage);\n                clb = callback;\n            } else if (args.length < 3) {\n                var _ref2 = [].concat(args),\n                    profile = _ref2[0],\n                    _callback = _ref2[1];\n\n                colorProfile = profile;\n                clb = _callback;\n            }\n            if (colorProfile && colorProfile.name) {\n                this.dao.updateColorProfile(colorProfile, function () {\n                    if (_this3.loadedProfile && colorProfile.name === _this3.loadedProfile.name) {\n                        _this3.loadColorProfile(_this3.loadedProfile.name, clb);\n                    } else if (clb) {\n                        clb();\n                    }\n                });\n            }\n        }\n\n        /** Deletes color profile from client database.\r\n        * @method deleteColorProfile\r\n        * @param {String} name Name of color profile\r\n        * @param {Function} callback Callback function\r\n        * @memberof module:profiles.ColorProfiles\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"deleteColorProfile\",\n        value: function deleteColorProfile(name, callback) {\n            var _this4 = this;\n\n            if (name) {\n                var loadedProfileName = this.loadedProfile ? this.loadedProfile.name : null;\n                this.dao.deleteColorProfile(name, function () {\n                    _this4._removeColorProfileName(name);\n                    if (name === loadedProfileName) {\n                        var profileName = _this4.profileNames.length > 0 ? _this4.profileNames[0] : null;\n                        if (profileName) {\n                            _this4.loadColorProfile(profileName, callback);\n                        } else {\n                            _this4.loadedProfile = null;\n                            callback();\n                        }\n                    } else {\n                        callback();\n                    }\n                });\n            }\n        }\n    }, {\n        key: \"_removeColorProfileName\",\n        value: function _removeColorProfileName(name) {\n            var index = void 0;\n            for (var i = 0; i < this.profileNames.length; i++) {\n                if (this.profileNames[i] === name) {\n                    index = i;\n                    break;\n                }\n            }\n            this.profileNames.splice(index, 1);\n        }\n    }, {\n        key: \"_addColorProfileName\",\n        value: function _addColorProfileName(name) {\n            this.profileNames.push(name);\n        }\n    }]);\n    return ColorProfiles;\n}();\n\nexports.default = ColorProfiles;\n\n/***/ }),\n/* 173 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _ColorProfile = __webpack_require__(58);\n\nvar _ColorProfile2 = _interopRequireDefault(_ColorProfile);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n* Data Access Object for saving and loading color profiles from\r\n* client database.\r\n* @constructor\r\n* @param {Service} dbService - 'db' service\r\n* @param {Service} colorService - 'colorService' service\r\n* @memberof module:profiles\r\n*/\nvar ColorProfilesDAO = function () {\n    function ColorProfilesDAO(dbService, colorService) {\n        (0, _classCallCheck3.default)(this, ColorProfilesDAO);\n\n        this.colorFactory = colorService;\n        this.store = 'colorprofiles';\n        this.db = dbService;\n    }\n\n    /** Loads color profile from client database.\r\n    * @method loadColorProfile\r\n    * @param {String} name Name of color profile\r\n    * @param {Function} callback Callback function\r\n    * @memberof module:profiles.ColorProfilesDAO\r\n    * @instance\r\n    */\n\n\n    (0, _createClass3.default)(ColorProfilesDAO, [{\n        key: \"loadColorProfile\",\n        value: function loadColorProfile(name, callback) {\n            var _this = this;\n\n            if (name) {\n                this.db.getStore(this.store).getItem(name).then(function (item) {\n                    if (item) {\n                        var profile = _ColorProfile2.default.deserialize(item, _this.colorFactory, _this.db);\n                        callback(profile);\n                    }\n                }).catch(function (e) {\n                    console.error(e);\n                });\n            }\n        }\n\n        /** Deletes color profile from client database. \r\n        * @method deleteColorProfile\r\n        * @param {String} name Name of color profile\r\n        * @param {Function} callback Callback function\r\n        * @memberof module:profiles.ColorProfilesDAO\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"deleteColorProfile\",\n        value: function deleteColorProfile(name, callback) {\n            if (name) {\n                this.db.getStore(this.store).removeItem(name).then(function () {\n                    if (callback) {\n                        callback();\n                    }\n                }).catch(function (e) {\n                    console.error(e);\n                });\n            }\n        }\n\n        /** Save color profile in client database.\r\n        * @method saveColorProfile\r\n        * @param {ColorProfile} profile Color profile\r\n        * @param {ColorProfiles} profiles Color profiles model\r\n        * @param {Function} callback Callback function\r\n        * @memberof module:profiles.ColorProfilesDAO\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"saveColorProfile\",\n        value: function saveColorProfile(profile, profiles, callback) {\n            if (profile && profile.name) {\n                var store = this.db.getStore(this.store);\n                store.getItem(profile.name).then(function (item) {\n                    if (!item) {\n                        return store.setItem(profile.name, profile.serialize()).then(function () {\n                            profiles._addColorProfileName(profile.name);\n                            if (callback) {\n                                callback();\n                            }\n                        });\n                    }\n                    return null;\n                }).catch(function (e) {\n                    console.error(e);\n                });\n            }\n        }\n\n        /** Load names of existing color profiles.\r\n        * @method loadColorProfiles\r\n        * @param {ColorProfiles} profiles Color profiles model\r\n        * @param {Function} callback Callback function\r\n        * @memberof module:profiles.ColorProfilesDAO\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"loadColorProfiles\",\n        value: function loadColorProfiles(profiles, callback) {\n            this.db.getStore(this.store).iterate(function (value, key) {\n                return profiles._addColorProfileName(key);\n            }).then(function () {\n                if (callback) {\n                    callback();\n                }\n            }).catch(function (e) {\n                console.error(e);\n            });\n        }\n\n        /** Updates color profile.\r\n        * @method updateColorProfile\r\n        * @param {ColorProfile} profile Color profile with new values\r\n        * @param {Function} callback Callback function\r\n        * @memberof module:profiles.ColorProfilesDAO\r\n        * @instance\r\n        */\n\n    }, {\n        key: \"updateColorProfile\",\n        value: function updateColorProfile(profile, callback) {\n            if (profile && profile.name) {\n                this.db.getStore(this.store).setItem(profile.name, profile.serialize()).then(function () {\n                    if (callback) {\n                        callback();\n                    }\n                }).catch(function (e) {\n                    console.error(e);\n                });\n            }\n        }\n    }]);\n    return ColorProfilesDAO;\n}();\n\nexports.default = ColorProfilesDAO;\n\n/***/ }),\n/* 174 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.colorProfilesComp = exports.colorProfilesCompName = undefined;\n\nvar _map = __webpack_require__(7);\n\nvar _map2 = _interopRequireDefault(_map);\n\nvar _slicedToArray2 = __webpack_require__(16);\n\nvar _slicedToArray3 = _interopRequireDefault(_slicedToArray2);\n\nvar _getIterator2 = __webpack_require__(4);\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\n__webpack_require__(175);\n\nvar _colorProfiles = __webpack_require__(176);\n\nvar _colorProfiles2 = _interopRequireDefault(_colorProfiles);\n\nvar _Utils = __webpack_require__(177);\n\nvar _Utils2 = _interopRequireDefault(_Utils);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar colorProfilesCompName = exports.colorProfilesCompName = 'colorProfiles';\nvar colorProfilesComp = exports.colorProfilesComp = {\n    template: _colorProfiles2.default,\n    bindings: {\n        colors: '<',\n        onLoadProfile: '&'\n    },\n    controller: function () {\n        (0, _createClass3.default)(ColorProfilesCtrl, null, [{\n            key: '$inject',\n            get: function get() {\n                return ['$rootScope', '$scope', '$timeout', 'colorProfiles', 'colorService', 'textColors', 'popupDialog'];\n            }\n        }]);\n\n        function ColorProfilesCtrl($rootScope, $scope, $timeout, colorProfiles, colorService, textColors, dialog) {\n            var _this = this;\n\n            (0, _classCallCheck3.default)(this, ColorProfilesCtrl);\n\n            this.$rootScope = $rootScope;\n            this.$scope = $scope;\n            this.$timeout = $timeout;\n            this._colorService = colorService;\n            this._textColors = textColors;\n            this._dialog = dialog;\n            this._mode = \"\";\n            this._utils = new _Utils2.default();\n            this._singleColors = [];\n            this.colorProfiles = colorProfiles;\n            this.openCreateProfile = false;\n            this.openConflicts = false;\n            this.newProfileName = \"\";\n            this.colorProfiles = colorProfiles;\n            this.conflictColors = [];\n\n            this.$scope.$on(\"colorsChainged\", function () {\n                _this.$timeout(function () {\n                    var profile = _this.colorProfiles.loadedProfile;\n                    if (profile) {\n                        _this._checkColorConflicts(profile.colors);\n                        _this.$scope.$apply();\n                    }\n                }, 0, false);\n            });\n        }\n\n        (0, _createClass3.default)(ColorProfilesCtrl, [{\n            key: '$onInit',\n            value: function $onInit() {\n                var _this2 = this;\n\n                this.colorProfiles.init(function () {\n                    _this2.$scope.$apply();\n                });\n            }\n        }, {\n            key: 'updateProfileDialog',\n            value: function updateProfileDialog() {\n                var self = this;\n                this._resetColorConflicts();\n                if (this.colorProfiles.loadedProfile) {\n                    this._dialog.confirmDialog(function () {\n                        this.yes = function () {\n                            self.updateProfile();\n                            self._dialog.close();\n                        };\n                        this.cancel = function () {\n                            self._dialog.close();\n                        };\n                        this.title = '\"update profile\"';\n                    });\n                }\n            }\n        }, {\n            key: 'applyProfileDialog',\n            value: function applyProfileDialog() {\n                var self = this;\n                if (this.colorProfiles.loadedProfile) {\n                    this._dialog.confirmDialog(function () {\n                        this.yes = function () {\n                            self.applyProfile();\n                            self._dialog.close();\n                        };\n                        this.cancel = function () {\n                            self._dialog.close();\n                        };\n                        this.title = '\"apply profile\"';\n                    });\n                }\n            }\n        }, {\n            key: 'deleteProfileDialog',\n            value: function deleteProfileDialog() {\n                var self = this;\n                if (this.colorProfiles.loadedProfile) {\n                    this._dialog.confirmDialog(function () {\n                        this.yes = function () {\n                            self.deleteProfile();\n                            self._dialog.close();\n                        };\n                        this.cancel = function () {\n                            self._dialog.close();\n                        };\n                        this.title = '\"delete profile\"';\n                    });\n                }\n            }\n        }, {\n            key: 'toggleNewProfile',\n            value: function toggleNewProfile() {\n                this.openCreateProfile = !this.openCreateProfile;\n            }\n        }, {\n            key: 'haveProfiles',\n            value: function haveProfiles() {\n                return this.colorProfiles.profileNames.length > 0;\n            }\n        }, {\n            key: 'selectProfile',\n            value: function selectProfile() {\n                if (this.colorProfiles.loadedProfile) {\n                    this.colorProfiles.loadColorProfile(this.colorProfiles.loadedProfile.name);\n                }\n            }\n        }, {\n            key: 'saveProfile',\n            value: function saveProfile() {\n                var name = this.newProfileName;\n                this._resetColorConflicts();\n                this._mode = \"create\";\n                if (name && name.trim().length > 0) {\n                    this._checkColorConflicts();\n                    if (this.conflictColors.length < 1) {\n                        var colors = this._utils.convertColorArrayToMap(this._singleColors);\n                        this.createColorProfile(name, colors);\n                    } else {\n                        this.openConflicts = true;\n                    }\n                }\n            }\n        }, {\n            key: 'applyProfile',\n            value: function applyProfile() {\n                var profile = this.colorProfiles.loadedProfile;\n                this._resetColorConflicts();\n                if (profile && profile.name) {\n                    this.onLoadProfile({\n                        colors: profile.colors,\n                        sPercentage: profile.sPercentage,\n                        lPercentage: profile.lPercentage\n                    });\n                }\n            }\n        }, {\n            key: 'updateProfile',\n            value: function updateProfile() {\n                var profile = this.colorProfiles.loadedProfile;\n                this._mode = \"update\";\n                if (profile) {\n                    this._checkColorConflicts(profile.colors);\n                    this.openConflicts = this.conflictColors.length > 0;\n                    if (this.conflictColors.length < 1) {\n                        var colors = this._utils.convertColorArrayToMap(this._singleColors);\n                        this.updateColorProfile(profile.name, colors);\n                    }\n                }\n            }\n        }, {\n            key: 'deleteProfile',\n            value: function deleteProfile() {\n                var _this3 = this;\n\n                var profile = this.colorProfiles.loadedProfile;\n                this.colorProfiles.deleteColorProfile(profile.name, function () {\n                    _this3.$scope.$apply();\n                    _this3.$rootScope.$broadcast(\"profilesUpdated\");\n                });\n            }\n        }, {\n            key: 'solveColorConflicts',\n            value: function solveColorConflicts() {\n                var colors = this._utils.concatColorArraysToMap(this.conflictColors, this._singleColors);\n                switch (this._mode) {\n                    case 'update':\n                        {\n                            var name = this.colorProfiles.loadedProfile.name;\n                            if (name && colors.size > 0) {\n                                this.updateColorProfile(name, colors);\n                                this._resetColorConflicts();\n                                this._mode = \"\";\n                            }\n                        }break;\n                    case 'create':\n                        {\n                            var _name = this.newProfileName;\n                            if (_name) {\n                                this.createColorProfile(_name, colors);\n                                this._resetColorConflicts();\n                                this._mode = \"\";\n                            }\n                        }break;\n                    default:\n                        break;\n                }\n            }\n        }, {\n            key: 'abortSolveColorConflicts',\n            value: function abortSolveColorConflicts() {\n                this.openConflicts = false;\n            }\n        }, {\n            key: 'createColorProfile',\n            value: function createColorProfile(name, colors) {\n                var _this4 = this;\n\n                var _iteratorNormalCompletion = true;\n                var _didIteratorError = false;\n                var _iteratorError = undefined;\n\n                try {\n                    for (var _iterator = (0, _getIterator3.default)(colors), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                        var _step$value = (0, _slicedToArray3.default)(_step.value, 2),\n                            word = _step$value[0],\n                            color = _step$value[1];\n\n                        if (!color.isSet()) {\n                            colors.delete(word);\n                        }\n                    }\n                } catch (err) {\n                    _didIteratorError = true;\n                    _iteratorError = err;\n                } finally {\n                    try {\n                        if (!_iteratorNormalCompletion && _iterator.return) {\n                            _iterator.return();\n                        }\n                    } finally {\n                        if (_didIteratorError) {\n                            throw _iteratorError;\n                        }\n                    }\n                }\n\n                this.colorProfiles.createColorProfile(name, colors, this._textColors.sPercentage, this._textColors.lPercentage, function () {\n                    _this4.newProfileName = \"\";\n                    _this4.colorProfiles.loadColorProfile(name, function () {\n                        _this4.openCreateProfile = false;\n                        _this4.$scope.$apply();\n                    });\n                });\n            }\n        }, {\n            key: 'updateColorProfile',\n            value: function updateColorProfile(name, colors) {\n                var _this5 = this;\n\n                var _iteratorNormalCompletion2 = true;\n                var _didIteratorError2 = false;\n                var _iteratorError2 = undefined;\n\n                try {\n                    for (var _iterator2 = (0, _getIterator3.default)(colors), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                        var _step2$value = (0, _slicedToArray3.default)(_step2.value, 2),\n                            word = _step2$value[0],\n                            color = _step2$value[1];\n\n                        if (!color.isSet()) {\n                            colors.delete(word);\n                        }\n                    }\n                } catch (err) {\n                    _didIteratorError2 = true;\n                    _iteratorError2 = err;\n                } finally {\n                    try {\n                        if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                            _iterator2.return();\n                        }\n                    } finally {\n                        if (_didIteratorError2) {\n                            throw _iteratorError2;\n                        }\n                    }\n                }\n\n                this.colorProfiles.updateColorProfile(colors, this._textColors.sPercentage, this._textColors.lPercentage, function () {\n                    _this5._resetColorConflicts();\n                    _this5.$timeout(function () {\n                        _this5.$rootScope.$broadcast(\"profilesUpdated\");\n                    }, 0, false);\n                });\n            }\n        }, {\n            key: '_resetColorConflicts',\n            value: function _resetColorConflicts() {\n                this.conflictColors = [];\n                this._singleColors = [];\n                this.openConflicts = false;\n            }\n        }, {\n            key: '_checkColorConflicts',\n            value: function _checkColorConflicts(colors) {\n                this._resetColorConflicts();\n                var colorsMapTemp = new _map2.default();\n                var _iteratorNormalCompletion3 = true;\n                var _didIteratorError3 = false;\n                var _iteratorError3 = undefined;\n\n                try {\n                    for (var _iterator3 = (0, _getIterator3.default)(this.colors), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n                        var _step3$value = (0, _slicedToArray3.default)(_step3.value, 2),\n                            word = _step3$value[0],\n                            mapColors = _step3$value[1];\n\n                        var colorsArray = mapColors.getValuesArray();\n                        var _colorSet = this._colorService.getColorSetInstance();\n                        for (var i = 0; i < colorsArray.length; i++) {\n                            _colorSet.add(colorsArray[i]);\n                        }\n                        colorsMapTemp.set(word, _colorSet);\n                    }\n                } catch (err) {\n                    _didIteratorError3 = true;\n                    _iteratorError3 = err;\n                } finally {\n                    try {\n                        if (!_iteratorNormalCompletion3 && _iterator3.return) {\n                            _iterator3.return();\n                        }\n                    } finally {\n                        if (_didIteratorError3) {\n                            throw _iteratorError3;\n                        }\n                    }\n                }\n\n                if (colors) {\n                    var _iteratorNormalCompletion4 = true;\n                    var _didIteratorError4 = false;\n                    var _iteratorError4 = undefined;\n\n                    try {\n                        for (var _iterator4 = (0, _getIterator3.default)(colors), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n                            var _step4$value = (0, _slicedToArray3.default)(_step4.value, 2),\n                                word = _step4$value[0],\n                                color = _step4$value[1];\n\n                            var c = this._colorService.getColorInstance(color);\n                            var entry = colorsMapTemp.get(word);\n                            if (entry) {\n                                entry.add(c);\n                            } else {\n                                var colorSet = this._colorService.getColorSetInstance();\n                                colorSet.add(c);\n                                colorsMapTemp.set(word, colorSet);\n                            }\n                        }\n                    } catch (err) {\n                        _didIteratorError4 = true;\n                        _iteratorError4 = err;\n                    } finally {\n                        try {\n                            if (!_iteratorNormalCompletion4 && _iterator4.return) {\n                                _iterator4.return();\n                            }\n                        } finally {\n                            if (_didIteratorError4) {\n                                throw _iteratorError4;\n                            }\n                        }\n                    }\n                }\n\n                var _iteratorNormalCompletion5 = true;\n                var _didIteratorError5 = false;\n                var _iteratorError5 = undefined;\n\n                try {\n                    for (var _iterator5 = (0, _getIterator3.default)(colorsMapTemp), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n                        var _step5$value = (0, _slicedToArray3.default)(_step5.value, 2),\n                            word = _step5$value[0],\n                            mapColors = _step5$value[1];\n\n                        var colorsToWordArray = mapColors.getValuesArray();\n                        if (colorsToWordArray.length > 1) {\n                            var sel = colorsToWordArray[0];\n                            this.conflictColors.push({ word: word, selected: sel, colors: colorsToWordArray });\n                        } else {\n                            var color = colorsToWordArray[0];\n                            this._singleColors.push({ word: word, color: color });\n                        }\n                    }\n                } catch (err) {\n                    _didIteratorError5 = true;\n                    _iteratorError5 = err;\n                } finally {\n                    try {\n                        if (!_iteratorNormalCompletion5 && _iterator5.return) {\n                            _iterator5.return();\n                        }\n                    } finally {\n                        if (_didIteratorError5) {\n                            throw _iteratorError5;\n                        }\n                    }\n                }\n            }\n        }]);\n        return ColorProfilesCtrl;\n    }()\n};\n\n/***/ }),\n/* 175 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 176 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=color-profiles> <select class=color-profiles__profiles ng-change=$ctrl.selectProfile() ng-model=$ctrl.colorProfiles.loadedProfile.name> <option ng-show=\\\"$ctrl.colorProfiles.profileNames.length < 1\\\" value=\\\"\\\">Select profile...</option> <option ng-repeat=\\\"profileName in $ctrl.colorProfiles.profileNames\\\" value={{profileName}}>{{profileName}}</option> </select> <div class=color-profiles__controls> <a ng-click=$ctrl.applyProfileDialog() class=\\\"btn-bodyless btn-bodyless-primary\\\" ng-class=\\\"$ctrl.haveProfiles() ? '' : 'disabled'\\\"><span class=\\\"glyphicon glyphicon-tint\\\"></span> Apply</a> <a ng-click=$ctrl.updateProfileDialog() class=btn-bodyless ng-class=\\\"$ctrl.haveProfiles() ? '' : 'disabled'\\\"><span class=\\\"glyphicon glyphicon-floppy-save\\\"></span> Update</a> <a ng-click=$ctrl.toggleNewProfile() class=\\\"btn-bodyless btn-bodyless-success\\\"><span class=\\\"glyphicon glyphicon-plus\\\" aria-hidden=true></span> New</a> <a ng-click=$ctrl.deleteProfileDialog() class=\\\"btn-bodyless btn-bodyless-danger\\\" ng-class=\\\"$ctrl.haveProfiles() ? '' : 'disabled'\\\"><span class=\\\"glyphicon glyphicon-trash\\\"></span> Drop</a> </div> <div ng-show=$ctrl.openCreateProfile class=color-profiles__create-profile> <input ng-model=$ctrl.newProfileName type=text class=\\\"form-control create-profile__profile-name\\\" placeholder=Profile> <a ng-click=$ctrl.saveProfile() class=\\\"btn btn-success btn-block color-profiles__save-profile\\\"><span class=\\\"glyphicon glyphicon-save\\\" aria-hidden=true></span> Save</a> </div> <div ng-show=$ctrl.openConflicts class=color-profiles__conflicts> <div class=color-profiles__conflict-title><span> Resolve conflicts</span></div> <ul class=color-profiles__conflict-colors> <li ng-repeat=\\\"item in $ctrl.conflictColors track by $index\\\"> {{item.word}} <form> <div class=radio ng-repeat=\\\"color in item.colors track by $index\\\"> <label><input ng-model=$ctrl.conflictColors[$parent.$index].selected ng-value=color type=radio><span ng-show=color.isSet() class=color-profiles__conflict-color ng-style=\\\"{'background-color': color}\\\"></span><span ng-show=color.isSet() class=color-profile__conflict-weight> weight: {{color.weight}}</span><span ng-show=!color.isSet()> none</span></label> </div> </form> </li> </ul> <a ng-click=$ctrl.solveColorConflicts() class=\\\"btn btn-success\\\"><span class=\\\"glyphicon glyphicon-ok\\\" aria-hidden=true></span> OK</a> <a ng-click=$ctrl.abortSolveColorConflicts() class=\\\"btn btn-danger\\\"><span class=\\\"glyphicon glyphicon-remove\\\" aria-hidden=true></span> Cancel</a> </div> </div> \";\n\n/***/ }),\n/* 177 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _map = __webpack_require__(7);\n\nvar _map2 = _interopRequireDefault(_map);\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Utils = function () {\n    function Utils() {\n        (0, _classCallCheck3.default)(this, Utils);\n    }\n\n    (0, _createClass3.default)(Utils, [{\n        key: \"concatColorArraysToMap\",\n        value: function concatColorArraysToMap(conflictColors, singleColors) {\n            var colors = [];\n            conflictColors.forEach(function (item) {\n                colors.push({ word: item.word, color: item.selected });\n            });\n            colors = colors.concat(singleColors);\n            var colorMap = this.convertColorArrayToMap(colors);\n            return colorMap;\n        }\n    }, {\n        key: \"convertColorArrayToMap\",\n        value: function convertColorArrayToMap(arr) {\n            var colorMap = new _map2.default();\n            for (var i = 0, k = arr.length; i < k; i++) {\n                colorMap.set(arr[i].word, arr[i].color);\n            }\n            return colorMap;\n        }\n    }]);\n    return Utils;\n}();\n\nexports.default = Utils;\n\n/***/ }),\n/* 178 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.profilesViewerComp = exports.profilesViewerCompName = undefined;\n\nvar _slicedToArray2 = __webpack_require__(16);\n\nvar _slicedToArray3 = _interopRequireDefault(_slicedToArray2);\n\nvar _getIterator2 = __webpack_require__(4);\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\n__webpack_require__(179);\n\nvar _profilesViewer = __webpack_require__(180);\n\nvar _profilesViewer2 = _interopRequireDefault(_profilesViewer);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar profilesViewerCompName = exports.profilesViewerCompName = 'profilesViewer';\nvar profilesViewerComp = exports.profilesViewerComp = {\n    template: _profilesViewer2.default,\n    controller: function () {\n        (0, _createClass3.default)(ProfilesViewerCtrl, null, [{\n            key: '$inject',\n            get: function get() {\n                return ['$scope', '$timeout', 'colorProfiles', 'colorService', 'popupDialog', 'usSpinnerService'];\n            }\n        }]);\n\n        function ProfilesViewerCtrl($scope, $timeout, colorProfiles, colorService, dialog, spinner) {\n            var _this = this;\n\n            (0, _classCallCheck3.default)(this, ProfilesViewerCtrl);\n\n            this.$scope = $scope;\n            this.$timeout = $timeout;\n            this._colorService = colorService;\n            this._dialog = dialog;\n            this._spinner = spinner;\n            this._step = 10;\n            this._showIndex = 0;\n            this._wordsAndColors = [];\n            this.colorProfiles = colorProfiles;\n            this.words = [];\n            this.profileName = \"\";\n            this.selectedProfile = null;\n            this.searchWord = \"\";\n            this.foundWord = null;\n            this.selectedWord = null;\n\n            this.$scope.$watch(\"$ctrl.searchWord\", function (newValue, oldValue) {\n                if (newValue !== oldValue) {\n                    _this.findWordAndColor(newValue);\n                }\n            });\n\n            this.$scope.$on(\"profilesUpdated\", function () {\n                if (_this.selectedProfile) {\n                    _this.loadColorProfile(true);\n                }\n            });\n        }\n\n        (0, _createClass3.default)(ProfilesViewerCtrl, [{\n            key: 'loadColorProfile',\n            value: function loadColorProfile(update) {\n                var _this2 = this;\n\n                this._showIndex = update === true ? this._showIndex : 0;\n                this._wordsAndColors = [];\n                this.words = [];\n                this.selectedProfile = null;\n                this.selectedWord = null;\n                this.colorProfiles.getColorProfile(this.profileName, function (profile) {\n                    _this2.selectedProfile = profile;\n                    var profileColors = [];\n                    var _iteratorNormalCompletion = true;\n                    var _didIteratorError = false;\n                    var _iteratorError = undefined;\n\n                    try {\n                        for (var _iterator = (0, _getIterator3.default)(profile.colors), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                            var _step$value = (0, _slicedToArray3.default)(_step.value, 2),\n                                word = _step$value[0],\n                                color = _step$value[1];\n\n                            var adjustedColor = _this2._colorService.getColorInstance(color);\n                            adjustedColor.interpolateS(profile.sPercentage).interpolateL(profile.lPercentage);\n                            profileColors.push({ word: word, color: adjustedColor, type: \"word\" });\n                        }\n                    } catch (err) {\n                        _didIteratorError = true;\n                        _iteratorError = err;\n                    } finally {\n                        try {\n                            if (!_iteratorNormalCompletion && _iterator.return) {\n                                _iterator.return();\n                            }\n                        } finally {\n                            if (_didIteratorError) {\n                                throw _iteratorError;\n                            }\n                        }\n                    }\n\n                    profileColors.sort(function (a, b) {\n                        if (a.word > b.word) {\n                            return 1;\n                        }\n                        if (a.word < b.word) {\n                            return -1;\n                        }\n                        return 0;\n                    });\n                    for (var i = 0, k = profileColors.length; i < k; i++) {\n                        var current = profileColors[i];\n                        var next = profileColors[i + 1];\n                        var added = false;\n                        if (i === 0) {\n                            _this2._wordsAndColors.push({ word: current.word.charAt(0).toUpperCase(), type: \"title\" });\n                            _this2._wordsAndColors.push(current);\n                            added = true;\n                        }\n                        if (next && next.word.charAt(0) !== current.word.charAt(0)) {\n                            if (!added) {\n                                _this2._wordsAndColors.push(current);\n                            }\n                            _this2._wordsAndColors.push({ word: next.word.charAt(0).toUpperCase(), type: \"title\" });\n                            added = true;\n                        }\n                        if (!added) {\n                            _this2._wordsAndColors.push(current);\n                        }\n                    }\n                    _this2.words = update === true ? _this2._wordsAndColors.slice(0, _this2._showIndex) : _this2._wordsAndColors.slice(0, _this2._step);\n                    _this2._showIndex += _this2._step;\n                    _this2.findWordAndColor(_this2.searchWord);\n                    _this2.$scope.$apply();\n                });\n            }\n        }, {\n            key: 'findWordAndColor',\n            value: function findWordAndColor(word) {\n                if (this.selectedProfile && this.selectedProfile.name) {\n                    var color = this.selectedProfile.getColor(word);\n                    if (color) {\n                        var adjustedColor = this._colorService.getColorInstance(color);\n                        adjustedColor.interpolateS(this.selectedProfile.sPercentage).interpolateL(this.selectedProfile.lPercentage);\n                        this.foundWord = { word: word, color: adjustedColor };\n                    } else {\n                        this.foundWord = null;\n                    }\n                } else {\n                    this.foundWord = null;\n                }\n            }\n        }, {\n            key: 'showMore',\n            value: function showMore() {\n                this.words = this.words.concat(this._getWordsInInterval(this._showIndex, this._showIndex + this._step, this._wordsAndColors));\n                this._showIndex += this._step;\n            }\n        }, {\n            key: 'clickHandler',\n            value: function clickHandler($event) {\n                var target = $event.target;\n                if (target.hasAttribute(\"word\")) {\n                    $event.stopPropagation();\n                    var word = target.getAttribute(\"word\");\n                    this.selectedWord = this.selectedWord === word ? null : word;\n                } else if (target.hasAttribute(\"delete\")) {\n                    $event.stopPropagation();\n                    var _word = target.getAttribute(\"delete\");\n                    this.deleteWordDialog(_word);\n                }\n            }\n        }, {\n            key: 'deleteWordDialog',\n            value: function deleteWordDialog(word) {\n                var self = this;\n                this._dialog.confirmDialog(function () {\n                    this.yes = function () {\n                        self.deleteWord(word);\n                        self._dialog.close();\n                    };\n                    this.cancel = function () {\n                        self._dialog.close();\n                    };\n                    this.title = '\"delete word\"';\n                });\n            }\n        }, {\n            key: 'deleteWord',\n            value: function deleteWord(word) {\n                var _this3 = this;\n\n                this.selectedProfile.deleteWord(word);\n                this.colorProfiles.updateColorProfile(this.selectedProfile, function () {\n                    _this3.foundWord = null;\n                    _this3.searchWord = \"\";\n                    _this3.loadColorProfile(true);\n                });\n            }\n        }, {\n            key: 'countProfileWords',\n            value: function countProfileWords() {\n                return this.selectedProfile && this.selectedProfile.countWords ? this.selectedProfile.countWords() : 0;\n            }\n        }, {\n            key: '_getWordsInInterval',\n            value: function _getWordsInInterval(start, end, words) {\n                if (start >= 0 && start < words.length) {\n                    if (end > words.length) {\n                        end = words.length;\n                    }\n                    return words.slice(start, end);\n                }\n                return [];\n            }\n        }]);\n        return ProfilesViewerCtrl;\n    }()\n};\n\n/***/ }),\n/* 179 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 180 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=profiles-viewer> <h4>Profiles archive</h4> <select class=profiles-viewer__profiles ng-change=$ctrl.loadColorProfile() ng-model=$ctrl.profileName> <option ng-show=\\\"$ctrl.colorProfiles.profileNames.length < 1\\\" value=\\\"\\\" selected=selected>Select profile...</option> <option ng-repeat=\\\"profile in $ctrl.colorProfiles.profileNames\\\" data-colorprofiles-profile={{$index}} value={{profile}}>{{profile}}</option> </select> <div class=profiles-viewer__search> <input class=profiles-viewer__search-input type=text ng-model=$ctrl.searchWord placeholder=\\\"search by word...\\\"> </div> <h5 ng-show=$ctrl.selectedProfile>Total: {{$ctrl.countProfileWords()}} {{$ctrl.countProfileWords() > 1 ? \\\"words\\\" : \\\"word\\\"}} <div ng-show=!$ctrl.foundWord ng-click=$ctrl.clickHandler($event) class=profiles-viewer__words infinite-scroll=$ctrl.showMore() infinite-scroll-distance=0> <div ng-repeat=\\\"word in $ctrl.words track by word.word\\\" class=profiles-viewer__section> <span ng-show=\\\"$ctrl.selectedWord === word.word\\\" class=\\\"glyphicon glyphicon-remove profiles-viewer__delete\\\" ng-attr-delete=\\\"{{$ctrl.selectedWord === word.word ? word.word : undefined}}\\\"></span> <div ng-class=\\\"{'profiles-viewer__section-title': word.type === 'title', 'profiles-viewer__section-word': word.type === 'word'}\\\" ng-attr-word=\\\"{{word.type === 'word' ? word.word : undefined}}\\\">{{word.word}}</div> <div ng-show=\\\"word.type === 'word'\\\" class=profiles-viewer__space></div> <div ng-show=\\\"word.type === 'word'\\\" class=profiles-viewer__color ng-style=\\\"{'background-color': word.color}\\\"></div> </div> </div> <div ng-click=$ctrl.clickHandler($event) ng-show=$ctrl.foundWord class=\\\"profiles-viewer__search-result profiles-viewer__section\\\"> <span ng-show=\\\"$ctrl.selectedWord === $ctrl.foundWord.word\\\" class=\\\"glyphicon glyphicon-remove profiles-viewer__delete\\\" ng-attr-delete={{$ctrl.foundWord.word}}></span> <div class=profiles-viewer__section-word ng-attr-word={{$ctrl.foundWord.word}}>{{$ctrl.foundWord.word}}</div> <div class=profiles-viewer__space></div> <div class=profiles-viewer__color ng-style=\\\"{'background-color': $ctrl.foundWord.color}\\\"></div> </div> </h5></div>\";\n\n/***/ }),\n/* 181 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 182 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<span us-spinner=\\\"{position: 'fixed', color: '#428bca'}\\\" spinner-key=spinner-1></span> <div class=color-search__content> <div class=color-search__header> <div ng-click=$ctrl.goToMain() class=color-search__logo><div class=color-search__logo-image></div></div> <div class=color-search__navigation> <a class=\\\"btn-bodyless btn-bodyless-default\\\" ng-click=$ctrl.goToGuide()>Guide</a><span class=color-search__separator></span> <a class=\\\"btn-bodyless btn-bodyless-default\\\" ng-click=$ctrl.goToSettings()>Archive</a> </div> </div> <ui-view name=pages> <main ng-show=\\\"$ctrl.page == 'main'\\\"></main> <guide ng-show=\\\"$ctrl.page == 'guide'\\\"></guide> <profiles-viewer ng-show=\\\"$ctrl.page === 'profiles'\\\"></profiles-viewer> </ui-view> </div> \";\n\n/***/ }),\n/* 183 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(0);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(1);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _md = __webpack_require__(184);\n\nvar _md2 = _interopRequireDefault(_md);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n* Login model. Implements user login business logic.\r\n* @constructor:\r\n* @param {Service} $q Angularjs '$q' service\r\n* @param {Service} jsonrpc 'jsonrpc' service\r\n* @memberof module:color-search\r\n*/\nvar Login = function () {\n    function Login($q, jsonrpc) {\n        (0, _classCallCheck3.default)(this, Login);\n\n        this.required = null;\n        this.auth = null;\n        this.success = false;\n        this.password = null;\n        this.jsonrpc = jsonrpc;\n        this.$q = $q;\n    }\n\n    /** Check if login data exists.\r\n    * @method isSet\r\n    * @return {boolean}\r\n    * @memberof module:color-search.Login\r\n    * @instance\r\n    */\n\n\n    (0, _createClass3.default)(Login, [{\n        key: 'isSet',\n        value: function isSet() {\n            return this.password !== null;\n        }\n\n        /** Checks if login was successful.\r\n        * @method isSuccessful\r\n        * @return {boolean}\r\n        * @memberof module:color-search.Login\r\n        * @instance\r\n        */\n\n    }, {\n        key: 'isSuccessful',\n        value: function isSuccessful() {\n            return this.auth !== null && this.success;\n        }\n\n        /** Sends server login request.\r\n        * @method login\r\n        * @memberof module:color-search.Login\r\n        * @instance\r\n        */\n\n    }, {\n        key: 'login',\n        value: function login() {\n            var _this = this;\n\n            var self = this;\n            var auth = (0, _md2.default)('' + this.password);\n            return this.jsonrpc.request('login', { login: auth }).then(function (data) {\n                if (data.success) {\n                    self.auth = auth;\n                    _this.success = true;\n                    return true;\n                }\n                return false;\n            });\n        }\n\n        /** Sends server request and checks if login is requered.\r\n        * @method isRequired\r\n        * @memberof module:color-search.Login\r\n        * @instance\r\n        */\n\n    }, {\n        key: 'isRequired',\n        value: function isRequired() {\n            var _this2 = this;\n\n            if (this.required) {\n                return this.$q.resolve(true);\n            }\n            return this.jsonrpc.request('loginRequired', {}).then(function (data) {\n                _this2.required = data.required;\n                return _this2.required;\n            });\n        }\n    }]);\n    return Login;\n}();\n\nexports.default = Login;\n\n/***/ }),\n/* 184 */,\n/* 185 */,\n/* 186 */,\n/* 187 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\n__webpack_require__(188);\n\nvar _confirm = __webpack_require__(189);\n\nvar _confirm2 = _interopRequireDefault(_confirm);\n\nvar _login = __webpack_require__(190);\n\nvar _login2 = _interopRequireDefault(_login);\n\nvar _error = __webpack_require__(191);\n\nvar _error2 = _interopRequireDefault(_error);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n* Module for creating dialogs\r\n* @module dialog\r\n*/\nangular.module('dialog', [])\n/** Service for creating pop-up dialogs on-the-fly\r\n* @member {Service} popupDialog\r\n* @memberof module:dialog\r\n* @instance\r\n*/\n.service('popupDialog', ['$rootScope', '$compile', function ($rootScope, $compile) {\n    var _this = this;\n\n    var scope = null;\n    var element = null;\n    var self = this;\n\n    function create(template, Control, closeByOutside) {\n        var html = '<div class=\"dialog\" ng-click=\"close($event)\">\\n        <div class=\"dialog__window\">' + template + '</div></div>';\n        scope = $rootScope.$new(true);\n        scope.$ctrl = new Control();\n        scope.closeByOutside = closeByOutside;\n        scope.close = function ($event) {\n            var target = angular.element($event.target);\n            if (target.hasClass(\"dialog\") && scope.closeByOutside) {\n                self.close();\n            }\n        };\n        var compiled = $compile(html)(scope);\n        element = angular.element(compiled).appendTo(\"body\");\n    }\n\n    this.close = function () {\n        if (element && scope) {\n            element.remove();\n            scope.$destroy();\n            element = null;\n            scope = null;\n            angular.element(\"*\").removeAttr(\"tabindex\");\n        }\n    };\n\n    this.errorDialog = function (Control) {\n        _this.close();\n        angular.element(\"*\").attr(\"tabindex\", -1);\n        angular.element(\"*\").blur();\n        create(_error2.default, Control, false);\n    };\n\n    this.confirmDialog = function (Control) {\n        _this.close();\n        angular.element(\"*\").attr(\"tabindex\", -1);\n        angular.element(\"*\").blur();\n        create(_confirm2.default, Control, true);\n    };\n\n    this.loginDialog = function (Control) {\n        _this.close();\n        angular.element(\"*\").attr(\"tabindex\", -1);\n        angular.element(\"*\").blur();\n        create(_login2.default, Control, false);\n    };\n}]);\n\nexports.default = \"dialog\";\n\n/***/ }),\n/* 188 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 189 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=confirm-dialog> <h4><span class=\\\"glyphicon glyphicon-question-sign\\\"></span> Confirm <span class=confirm-dialog__title>{{$ctrl.title}}</span></h4> <p>Are you sure you want to proceed?</p> <div style=float:right> <a class=\\\"btn btn-danger\\\" ng-click=$ctrl.cancel()>Cancel</a> <a class=\\\"btn btn-success\\\" ng-click=$ctrl.yes()>Yes</a> </div><div style=clear:both></div> </div>\";\n\n/***/ }),\n/* 190 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=login-dialog> <div class=form-group><input ng-model=$ctrl.model.password type=password class=form-control placeholder=Password></div> <a ng-click=$ctrl.login() class=\\\"btn btn-success btn-block\\\"><span class=\\\"glyphicon glyphicon-cloud-upload\\\" aria-hidden=true></span> Log in</a> </div>\";\n\n/***/ }),\n/* 191 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=error-dialog> <h4><span class=\\\"glyphicon glyphicon-warning-sign\\\"></span> {{$ctrl.title}}</h4> <p>{{$ctrl.description}}</p> <a ng-show=$ctrl.button ng-click=$ctrl.handle() class=\\\"btn btn-danger btn-block\\\"><span ng-show=$ctrl.icon ng-class=\\\"'glyphicon glyphicon-{{$ctrl.icon}}'\\\"></span> {{$ctrl.buttonTitle}}</a> </div>\";\n\n/***/ }),\n/* 192 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _localforage = __webpack_require__(193);\n\nvar _localforage2 = _interopRequireDefault(_localforage);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\r\n* Abstracts client database technology from application.\r\n* Uses 'localforage' library, which supports INDEXEDDB, WEBSQL and LOCALSTORAGE.\r\n* @module db\r\n* @requires localforage\r\n*/\nangular.module('db', [])\n/** Service which returns 'store' object of configurated database.\r\n* @member {Service} db\r\n* @memberof module:db\r\n* @instance\r\n*/\n.service('db', [function () {\n    _localforage2.default.config({\n        driver: [_localforage2.default.INDEXEDDB, _localforage2.default.WEBSQL, _localforage2.default.LOCALSTORAGE],\n        name: 'ColorSearch',\n        version: 1.0\n    });\n    this.getStore = function (store) {\n        return _localforage2.default.createInstance({ name: 'ColorSearch', storeName: store });\n    };\n}]);\n\nexports.default = \"db\";\n\n/***/ })\n]),[60]);\n\n\n// WEBPACK FOOTER //\n// js/app.bundle.js","module.exports = angular;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"angular\"\n// module id = 20\n// module chunks = 0","/**\r\n* Represents color Profile\r\n* @constructor\r\n* @param {String} name Name of the profile\r\n* @param {Map} colors Colors\r\n* @param {Number} sPercentage Saturation global setting\r\n* @param {Number} lPercentage Lightness global setting\r\n* @memberof module:profiles\r\n*/\r\n\r\nclass ColorProfile {\r\n\r\n    constructor(name, colors, sPercentage, lPercentage) {\r\n        this.name = name;\r\n        this.colors = colors;\r\n        this.sPercentage = sPercentage;\r\n        this.lPercentage = lPercentage;\r\n    }\r\n\r\n    countWords() {\r\n        return this.colors.size;\r\n    }\r\n\r\n    getColor(word) {\r\n        return this.colors.get(word);\r\n    }\r\n\r\n    deleteWord(word) {\r\n        this.colors.delete(word);\r\n    }\r\n\r\n    static deserialize(o, colorService) {\r\n        const colors = new Map(o.colors);\r\n        for (const [word, color] of colors) {\r\n            colors.set(word, colorService.getColorInstance(color));\r\n        }\r\n        const sPercentage = Math.round(parseFloat(o.sPercentage));\r\n        const lPercentage = Math.round(parseFloat(o.lPercentage));\r\n        return new ColorProfile(o.name, colors, sPercentage, lPercentage);\r\n    }\r\n\r\n    serialize() {\r\n        const self = this;\r\n        const o = {};\r\n        o.name = this.name;\r\n        o.colors = [...self.colors];\r\n        o.sPercentage = this.sPercentage;\r\n        o.lPercentage = this.lPercentage;\r\n        return o;\r\n    }\r\n}\r\n\r\nexport default ColorProfile;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/profiles/classes/ColorProfile.js","import './assets/scss/styles.scss';\nimport colorSearch from \"./modules/color-search/color-search\";\n\nangular.module('app', [colorSearch]);\n\n\n\n// WEBPACK FOOTER //\n// ./app.js","import uirouter from '@uirouter/angularjs';\r\nimport 'angular-spinner';\r\nimport Routes from './core/routing/Routes';\r\nimport Settings from './core/models/Settings';\r\nimport ColorService from './core/models/ColorService';\r\nimport TextColors from './core/models/TextColors';\r\nimport JSONrpc from './core/services/rpc/JsonRpc';\r\nimport main from \"../main/main\";\r\nimport guide from \"../guide/guide\";\r\nimport profiles from '../profiles/profiles';\r\nimport './scss/color-search.scss';\r\nimport template from './template/color-search.html';\r\nimport Login from './core/models/Login';\r\nimport popupDialog from './core/services/dialog/dialog';\r\nimport db from './core/services/db/db';\r\n\r\n/**\r\n* Root module, which contains all other application modules.\r\n* @module color-search\r\n* @requires module:@uirouter/angularjs\r\n* @requires module:jsonrpc\r\n* @requires module:profiles\r\n* @requires module:main\r\n* @requires module:guide\r\n* @requires module:dialog\r\n* @requires module:db\r\n* @requires module:angularSpinner\r\n*/\r\nangular.module('color-search', [uirouter, JSONrpc, profiles, main, guide, popupDialog, db, 'angularSpinner'])\r\n.config(Routes)\r\n.config(['$JsonRpcProvider', (provider) => {\r\n    provider.set({ url: \"/\" });\r\n}])\r\n/** Colors model. Creates new Color objects and converts color in/from\r\n* different color spaces.\r\n* @member {Service} colorService\r\n* @memberof module:color-search\r\n* @see ColorService class\r\n* @instance\r\n*/\r\n.service('colorService', ColorService)\r\n/** Application and search settings model.\r\n* @member {Service} appSettings\r\n* @memberof module:color-search\r\n* @see Settings class\r\n* @instance\r\n*/\r\n.service('appSettings', ['db', Settings])\r\n/** TextColors model, which represents words and colors selected by user.\r\n* @member {Service} textColors\r\n* @memberof module:color-search\r\n* @see TextColors class\r\n* @instance\r\n*/\r\n.service('textColors', ['colorService', TextColors])\r\n/** Login model. Contains user login business logic.\r\n* @member {Service} login\r\n* @memberof module:color-search\r\n* @see Login class\r\n* @instance\r\n*/\r\n.service('login', ['$q', 'jsonrpc', Login])\r\n/** Root component of the application.\r\n* Checks on initialization if login is required.\r\n* Contains click handlers for page navigation.\r\n* @member {Component} colorSearch\r\n* @property {ColorSearchCtrl} controller\r\n* @property {String} template\r\n* @memberof module:color-search\r\n* @instance\r\n*/\r\n.component('colorSearch', {\r\n    template,\r\n    /**\r\n    * Controller for 'colorSearch' component.\r\n    * @constructor ColorSearch\r\n    * @param {Service} $rootScope Angularjs '$rootScope' service\r\n    * @param {Service} $timeout Angularjs '$timeout' service\r\n    * @param {Service} $transitions Angularjs UI Router '$transitions' service\r\n    * @param {Service} $state Angularjs UI Router '$state' service\r\n    * @param {Service} login 'login' service\r\n    * @param {Service} popupDialog 'popupDialog' service from 'dialog' module\r\n    * @see colorSearch component\r\n    * @memberof module:color-search\r\n    */\r\n    controller: class ColorSearchCtrl {\r\n        static get $inject() {\r\n            return ['$rootScope', '$timeout', '$window', '$transitions', '$state', 'login', 'popupDialog'];\r\n        }\r\n\r\n        constructor($rootScope, $timeout, $window, $transitions, $state, login, dialog) {\r\n            this.$rootScope = $rootScope;\r\n            this.$timeout = $timeout;\r\n            this.$window = $window;\r\n            this.$state = $state;\r\n            this._login = login;\r\n            this._dialog = dialog;\r\n            this.page = \"main\";\r\n\r\n            $transitions.onSuccess({}, (transition) => {\r\n                const data = transition.to().data;\r\n                this.page = data[\"page\"];\r\n                $timeout(() => {\r\n                   $rootScope.$broadcast('rzSliderForceRender');\r\n                   $rootScope.$broadcast('refresh');\r\n                }, 0, false);\r\n            });\r\n        }\r\n\r\n        $onInit() {\r\n            angular.element(this.$window).bind('resize orientationchange', () => {\r\n                this.$timeout(() => {\r\n                    this.$rootScope.$broadcast('rzSliderForceRender');\r\n                    this.$rootScope.$broadcast('refresh');\r\n                });\r\n            });\r\n        }\r\n\r\n        $postLink() {\r\n            this._login.isRequired()\r\n            .then((required) => {\r\n                if (required) {\r\n                    this.openLoginDialog();\r\n                }\r\n            }).catch((err) => {\r\n                console.log(err);\r\n                const self = this;\r\n                this._dialog.errorDialog(function () {\r\n                    this.title = \"Connection error\";\r\n                    this.description = \"Try to reload the application.\";\r\n                    this.buttonTitle = \"Reload\";\r\n                    this.button = true;\r\n                    this.icon = 'refresh';\r\n                    this.handle = () => {\r\n                        self.$window.location.reload(true);\r\n                    };\r\n                });\r\n            });\r\n        }\r\n\r\n        /** Navigate to settings page.\r\n        * @method goToSettings\r\n        * @memberof module:color-search.ColorSearch\r\n        * @instance\r\n        */\r\n        goToSettings() {\r\n            this.page = \"profiles\";\r\n            this.$state.go('main.profiles');\r\n        }\r\n\r\n        /** Navigate to guide page.\r\n        * @method goToGuide\r\n        * @memberof module:color-search.ColorSearch\r\n        * @instance\r\n        */\r\n        goToGuide() {\r\n            this.page = \"guide\";\r\n            this.$state.go('main.guide');\r\n        }\r\n\r\n        /** Navigate to main page.\r\n        * @method goToMain\r\n        * @memberof module:color-search.ColorSearch\r\n        * @instance\r\n        */\r\n        goToMain() {\r\n            this.page = \"main\";\r\n            this.$state.go('main');\r\n        }\r\n\r\n        /** Open login dialog.\r\n        * @method openLoginDialog\r\n        * @memberof module:color-search.ColorSearch\r\n        * @instance\r\n        */\r\n        openLoginDialog() {\r\n            const self = this;\r\n            this._dialog.loginDialog(function () {\r\n                this.model = self._login;\r\n                this.login = () => {\r\n                    if (this.model.isSet()) {\r\n                        this.model.login()\r\n                        .then((succ) => {\r\n                            if (succ) {\r\n                                self._dialog.close();\r\n                            }\r\n                        });\r\n                    }\r\n                };\r\n            });\r\n        }\r\n    },\r\n});\r\n\r\nexport default 'color-search';\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/color-search/color-search.js","/**\n* Routes to pages\n* @constructor\n* @param {$stateProvider} $stateProvider UI router '$stateProvider'\n* @param {$urlRouterProvider} $urlRouterProvider UI router '$urlRouterProvider'\n* @memberof module:color-search\n*/\nfunction Routes($stateProvider, $urlRouterProvider) {\n    const mainState = {\n        name: 'main',\n        url: '/main',\n        data: { page: \"main\" },\n    };\n\n    const settingsState = {\n        name: 'main.profiles',\n        url: '^/profiles',\n        data: { page: \"profiles\" },\n    };\n\n    const guideState = {\n        name: 'main.guide',\n        url: '^/guide',\n        data: { page: \"guide\" },\n    };\n\n    $stateProvider.state(mainState);\n    $stateProvider.state(settingsState);\n    $stateProvider.state(guideState);\n    $urlRouterProvider.otherwise('/main');\n}\n\nRoutes.$inject = ['$stateProvider', '$urlRouterProvider'];\nexport default Routes;\n\n\n\n\n// WEBPACK FOOTER //\n// ./modules/color-search/core/routing/Routes.js","/**\n* Data Access Object for Settings model.\n* Used for saving and loading of application & search setttings\n* in client database.\n* @constructor:\n* @param {Service} db 'db' service\n* @memberof module:color-search\n*/\nclass SettingsDAO {\n\n    constructor(db) {\n        this.store = \"settings\";\n        this.db = db;\n    }\n\n    /** Load settings from client database.\n    * @method loadSettings\n    * @param {Settings} settings Settings model\n    * @param {function} succ Callback on success\n    * @param {function} err Callback on error\n    * @memberof module:color-search.SettingsDAO\n    * @instance\n    */\n    loadSettings(settings, succ, err) {\n        this.db.getStore(this.store)\n        .getItem('settings')\n        .then((item) => {\n            settings.deserialize(item);\n            if (succ) {\n                succ();\n            }\n        })\n        .catch((e) => {\n            console.warn(e);\n            if (err) {\n                err();\n            }\n        });\n    }\n\n    /** Save settings in client database.\n    * @method saveSettings\n    * @param {Settings} settings Settings model\n    * @param {function} succ Callback on success\n    * @param {function} err Callback on error\n    * @memberof module:color-search.SettingsDAO\n    * @instance\n    */\n    saveSettings(settings, succ, err) {\n        this.db.getStore(this.store)\n        .setItem('settings', settings.serialize())\n        .then(() => {\n            if (succ) {\n                succ();\n            }\n        })\n        .catch((e) => {\n            console.warn(e);\n            if (err) {\n                err();\n            }\n        });\n    }\n}\n\n/**\n* Application & search settings model.\n* @constructor:\n* @param {Service} db 'db' service\n* @memberof module:color-search\n*/\nclass Settings {\n\n    constructor(db) {\n        this.module = 'settings';\n        this.dao = new SettingsDAO(db);\n        this.checkSemanticSimilarity = false;\n        this.searchMode = 'regular';\n        this.similarityLevel = 85;\n        this.distance = 'euclidean';\n        this.supportedDistances = [\n            { id: 'euclidean', name: 'Euclidean' },\n            { id: 'chisquare', name: 'Chi-Square' }];\n    }\n\n    /** Load settings from database.\n    * @method load\n    * @memberof module:color-search.Settings\n    * @instance\n    */\n    load(succ, err) {\n        this.dao.loadSettings(this, succ, err);\n    }\n\n    /** Save current settings in database.\n    * @method save\n    * @memberof module:color-search.Settings\n    * @instance\n    */\n    save(succ, err) {\n        this.dao.saveSettings(this, succ, err);\n    }\n\n    /** Creates JSON (object literal)\n    * @method serialize\n    * @memberof module:color-search.Settings\n    * @instance\n    */\n    serialize() {\n        const o = {};\n        o.module = 'settings';\n        o.checkSemanticSimilarity = this.checkSemanticSimilarity;\n        o.searchMode = this.searchMode;\n        o.similarityLevel = this.similarityLevel;\n        o.distance = this.distance;\n        o.distanceMode = this.distanceMode;\n        return o;\n    }\n\n    /** Deserialite settings from database object.\n    * @method deserialize\n    * @param {Object} dto Object from client database.\n    * @memberof module:color-search.Settings\n    * @instance\n    */\n    deserialize(dto) {\n        if (dto) {\n            this.editorFontSize = dto.editorFontSize;\n            this.checkSemanticSimilarity = dto.checkSemanticSimilarity;\n            this.searchMode = dto.searchMode;\n            this.similarityLevel = dto.similarityLevel;\n            this.distance = dto.distance;\n        } else {\n            console.warn(\"Settings not loaded\");\n        }\n    }\n\n    /** Get search settings.\n    * @method getSearchSettings\n    * @return {Object}\n    * @memberof module:color-search.Settings\n    * @instance\n    */\n    getSearchSettings() {\n        const o = {};\n        o.checkSemanticSimilarity = this.checkSemanticSimilarity;\n        o.searchMode = this.searchMode;\n        o.similarityLevel = this.similarityLevel;\n        o.distance = this.distance;\n        o.distanceMode = this.distanceMode;\n        return o;\n    }\n}\n\nexport default Settings;\n\n\n\n// WEBPACK FOOTER //\n// ./modules/color-search/core/models/Settings.js","import Colr from 'colr';\nimport HSLColor from './HSLColor';\nimport ColorSet from './ColorSet';\n\n/**\n* Color manager class. Creates color objects and converts colors\n* in different color spaces and formats.\n* @constructor:\n* @memberof module:color-search\n*/\nclass ColorService {\n\n    /** Creates new HSLColor instance.\n    * @method getColorInstance\n    * @return {HSLColor}\n    * @memberof module:color-search.ColorService\n    * @instance\n    */\n    getColorInstance(o) {\n        return new HSLColor(o);\n    }\n\n    /** Creates new ColorSet instance.\n    * @method getColorSetInstance\n    * @return {ColorSet}\n    * @memberof module:color-search.ColorService\n    * @instance\n    */\n    getColorSetInstance() {\n        return new ColorSet();\n    }\n\n    /** Converts hsl object into hex string color representation.\n    * @method hslToHexString\n    * @param {Object} color Object with h,s,l values\n    * @return {string}\n    * @memberof module:color-search.ColorService\n    * @instance\n    */\n    hslToHexString(color) {\n        return Colr.fromHsl(color.h, color.s, color.l).toHex();\n    }\n\n    /** Converts hex string color into HSL object.\n    * @method hexToHsl\n    * @param {string} hex Hex-string\n    * @return {HSLColor}\n    * @memberof module:color-search.ColorService\n    * @instance\n    */\n    hexToHsl(hex) {\n        return Colr.fromHex(hex).toHsl();\n    }\n\n    /** Converts HSL object into HSL string\n    * @method toString\n    * @return {string}\n    * @memberof module:color-search.ColorService\n    * @instance\n    */\n    hslToHslString(color) {\n        return `hsl(${color.h},${color.s}%,${color.l}%)`;\n    }\n\n    /** Converts HSL object into RGB object.\n    * @method hslToRgb\n    * @return {Object} Object with r,g,b values\n    * @memberof module:color-search.ColorService\n    * @instance\n    */\n    hslToRgb(color) {\n        return Colr.fromHslObject(color).toRgbObject();\n    }\n\n    /** Converts RGB object into hex string.\n    * @method rgbToHex\n    * @param {Object} color Object with r,g,b values.\n    * @return {string}\n    * @memberof module:color-search.ColorService\n    * @instance\n    */\n    rgbToHex(color) {\n        return Colr.fromRgbObject(color).toHex();\n    }\n\n    /** Return color with greater CR value.\n    * @method colorWithGreaterCR\n    * @param {Object} rgbColor Object with r,g,b values.\n    * @param {Object[]} rgbColors Objects, each with r,g,b, values.\n    * @return {Object} Object with r,g,b values.\n    * @memberof module:color-search.ColorService\n    * @instance\n    */\n    colorWithGreaterCR(rgbColor, ...rgbColors) {\n        let cTemp = rgbColor;\n        if (rgbColors && rgbColors.length > 0) {\n            cTemp = rgbColors[0];\n            let crTemp = this.cr(rgbColor, rgbColors[0]);\n            for (let i = 0; i < rgbColors.length; i++) {\n                const cr = this.cr(rgbColor, rgbColors[i]);\n                if (crTemp < cr) {\n                    crTemp = cr;\n                    cTemp = rgbColors[i];\n                }\n            }\n        }\n        return cTemp;\n    }\n\n    /** Calculate CR value for two given RGB color objects.\n    * Uses W3C recommended algorithm.\n    * @method cr\n    * @param {Object} c1 Object with r,g,b values.\n    * @param {Object} c2 Objects, each with r,g,b, values.\n    * @return {number}\n    * @memberof module:color-search.ColorService\n    * @instance\n    */\n    cr(c1, c2) {\n        let lum1 = this._luminanceRGB(c1.r, c1.g, c1.b);\n        let lum2 = this._luminanceRGB(c2.r, c2.g, c2.b);\n        if (lum2 > lum1) {\n            [lum1, lum2] = [lum2, lum1];\n        }\n        return (lum1 + 0.05) / (lum2 + 0.05);\n    }\n\n    _luminanceRGB(r, g, b) {\n        const RsRGB = r / 255;\n        const GsRGB = g / 255;\n        const BsRGB = b / 255;\n        const R = (RsRGB <= 0.03928) ? RsRGB / 12.92 : Math.pow(((RsRGB + 0.055) / 1.055), 2.4);\n        const G = (GsRGB <= 0.03928) ? GsRGB / 12.92 : Math.pow(((GsRGB + 0.055) / 1.055), 2.4);\n        const B = (BsRGB <= 0.03928) ? BsRGB / 12.92 : Math.pow(((BsRGB + 0.055) / 1.055), 2.4);\n        return 0.2126 * R + 0.7152 * G + 0.0722 * B;\n    }\n}\n\nexport default ColorService;\n\n\n\n\n// WEBPACK FOOTER //\n// ./modules/color-search/core/models/ColorService.js","/**\n* Represents HSL color object.\n* @constructor\n* @param {Object} o (optional) Configuration object with values in format\n* {h: number, s: number, l: number, achromatic: boolean, weight: number}.\n* @property {Number} h\n* @property {Number} s\n* @property {Number} l\n* @property {Number} weight\n* @property {Boolean} achromatic\n* @memberof module:color-search\n*/\nclass HSLColor {\n\n    constructor(o) {\n        this.weight = 1;\n        this.h = undefined;\n        this.s = undefined;\n        this.l = undefined;\n        this.achromatic = false;\n\n        if (o && o[\"h\"] !== undefined && o[\"s\"] !== undefined && o[\"l\"] !== undefined) {\n            this.h = parseInt(o[\"h\"], 10);\n            this.s = parseInt(o[\"s\"], 10);\n            this.l = parseInt(o[\"l\"], 10);\n        }\n\n        if (o && o[\"weight\"]) {\n            this.weight = parseInt(o[\"weight\"], 10);\n        }\n\n        if (o && typeof o[\"achromatic\"] === \"boolean\") {\n            this.achromatic = o[\"achromatic\"];\n        }\n    }\n\n    /** Return HSL color string in format hsl(h,s%,l%).\n    * @method toString\n    * @return {string}\n    * @memberof module:color-search.HSLColor\n    * @instance\n    */\n    toString() {\n        if (this.isSet) {\n            return `hsl(${this.h},${this.s}%,${this.l}%)`;\n        }\n        return undefined;\n    }\n\n    /** Return unique HSL color string with weight.\n    * @method toIdString\n    * @return {string}\n    * @memberof module:color-search.HSLColor\n    * @instance\n    */\n    toIdString() {\n        return `hsl(${this.h},${this.s}%,${this.l}%)${this.weight}`;\n    }\n\n    /** Check if color values are set.\n    * @method isSet\n    * @return {boolean}\n    * @memberof module:color-search.HSLColor\n    * @instance\n    */\n    isSet() {\n        return (this.h !== undefined && this.s !== undefined && this.l !== undefined);\n    }\n\n    /** Set hue\n    * @method setH\n    * @param {number} h Hue\n    * @memberof module:color-search.HSLColor\n    * @instance\n    */\n    setH(h) {\n       this.h = this.achromatic === true ? 0 : parseInt(h, 10);\n       return this;\n    }\n\n    /** Set saturation\n    * @method setS\n    * @param {number} s Saturation\n    * @memberof module:color-search.HSLColor\n    * @instance\n    */\n    setS(s) {\n       this.s = this.achromatic === true ? 0 : parseInt(s, 10);\n       return this;\n    }\n\n    /** Set lightness\n    * @method setL\n    * @param {number} l Lightness\n    * @memberof module:color-search.HSLColor\n    * @instance\n    */\n    setL(l) {\n       this.l = parseInt(l, 10);\n       return this;\n    }\n\n     /** Set weight\n    * @method setWeight\n    * @param {number} w Weight\n    * @memberof module:color-search.HSLColor\n    * @instance\n    */\n    setWeight(w) {\n        this.weight = parseInt(w, 10);\n        return this;\n    }\n\n    /** Set current color to achromatic.\n    * Hue and saturation values will be set to 0.\n    * @method setAchromatic\n    * @memberof module:color-search.HSLColor\n    * @instance\n    */\n    setAchromatic() {\n        this.h = 0;\n        this.s = 0;\n        this.achromatic = true;\n        return this;\n    }\n\n    /** Checks if current color is achromatic.\n    * @method isAchromatic\n    * @return {boolean}\n    * @memberof module:color-search.HSLColor\n    * @instance\n    */\n    isAchromatic() {\n        return this.achromatic;\n    }\n\n    /** Set color values from given object.\n    * @method setColor\n    * @param {Object} o Configuration object\n    * @memberof module:color-search.HSLColor\n    * @instance\n    */\n    setColor(o) {\n        if (o && typeof o[\"achromatic\"] === \"boolean\") {\n            this.achromatic = o[\"achromatic\"];\n        }\n\n        if (o[\"h\"] !== undefined && o[\"s\"] !== undefined && o[\"l\"] !== undefined) {\n            this.setH(o[\"h\"]);\n            this.setS(o[\"s\"]);\n            this.setL(o[\"l\"]);\n        }\n\n        if (o[\"weight\"]) {\n            this.setWeight(o[\"weight\"]);\n        }\n        return this;\n    }\n\n    setColorFromString(str) {\n        const r = /^hsl\\(\\d+(\\.\\d+)?,\\d+(\\.\\d+)?%?,\\d+(\\.\\d+)?%?\\)$/i;\n        if (str && r.test(str)) {\n            const re = /\\d+(\\.\\d+)?/g;\n            this.h = parseInt(re.exec(str)[0], 10);\n            this.s = parseInt(re.exec(str)[0], 10);\n            this.l = parseInt(re.exec(str)[0], 10);\n        }\n        return this;\n    }\n\n    /** Interpolate saturation. Uses linear interpolation.\n    * @method interpolateS\n    * @param {number} percentage Number from -100 to +100\n    * @memberof module:color-search.HSLColor\n    * @instance\n    */\n    interpolateS(percentage) {\n        this.setS(this._interpolate(this.s, percentage));\n        return this;\n    }\n\n    /** Interpolate lightness. Uses linear interpolation.\n    * @method interpolateL\n    * @param {number} percentage Number from -100 to +100\n    * @memberof module:color-search.HSLColor\n    * @instance\n    */\n    interpolateL(percentage) {\n        this.setL(this._interpolate(this.l, percentage));\n        return this;\n    }\n\n    // linear interpolation\n    _interpolate(x, xPercentage) {\n       const a = (xPercentage <= 100) ? xPercentage / 100 : (xPercentage - 100) / 100;\n       return (xPercentage <= 100) ? x * a : x * (1 - a) + 100 * a;\n    }\n\n    /** Set all values to init values.\n    * @method reset\n    * @memberof module:color-search.HSLColor\n    * @instance\n    */\n    reset() {\n      this.h = undefined;\n      this.s = undefined;\n      this.l = undefined;\n      this.weight = 1;\n      this.achromatic = false;\n      return this;\n    }\n\n    /** Return object in JSON (object literal) format.\n    * @method toJSON\n    * @return {Object}\n    * @memberof module:color-search.HSLColor\n    * @instance\n    */\n    toJSON() {\n        const o = {};\n        o.achromatic = this.achromatic;\n        o.l = this.l;\n        o.s = this.s;\n        o.h = this.h;\n        o.weight = this.weight;\n        return o;\n    }\n}\n\nexport default HSLColor;\n\n\n\n// WEBPACK FOOTER //\n// ./modules/color-search/core/models/HSLColor.js","/**\n* Iterable ColorSet for colors.\n* @constructor:\n* @memberof module:color-search\n*/\nclass ColorSet {\n\n    constructor() {\n        this.map = new Map();\n        this[Symbol.iterator] = this.values;\n    }\n\n    /** Add color to ColorSet.\n    * @method add\n    * @param {HSLColor} color\n    * @memberof module:color-search.ColorSet\n    * @instance\n    */\n    add(color) {\n        this.map.set(color.toIdString(), color);\n    }\n\n    /** Get Iterator for color values\n    * @method values\n    * @return {Iterator<HSLColor>}\n    * @memberof module:color-search.ColorSet\n    * @instance\n    */\n    values() {\n        return this.map.values();\n    }\n\n    /** Get Array of colors\n    * @method getValuesArray\n    * @return {HSLColor[]}\n    * @memberof module:color-search.ColorSet\n    * @instance\n    */\n    getValuesArray() {\n        return [...this.map.values()];\n    }\n\n    /** Size of ColorSet\n    * @method size\n    * @return {number}\n    * @memberof module:color-search.ColorSet\n    * @instance\n    */\n    size() {\n        return this.map.size;\n    }\n}\n\nexport default ColorSet;\n\n\n\n// WEBPACK FOOTER //\n// ./modules/color-search/core/models/ColorSet.js","/**\n* TextColors model. Manages user selected words and colors.\n* @constructor:\n* @param {Service} colorService 'colorService' service\n* @memberof module:color-search\n*/\nclass TextColors {\n\n    constructor(colorService) {\n        this._words = [];\n        this._sPercentage = 100;\n        this._lPercentage = 100;\n        this._colorService = colorService;\n        this.colorOccurence = new Map();\n        this.adjustedColorOccurence = new Map();\n    }\n\n    /** Getter for user selected words.\n    * @method words\n    * @return {string[]}\n    * @memberof module:color-search.TextColors\n    * @instance\n    */\n    get words() {\n        return this._words;\n    }\n\n    /** Getter for user selected colors.\n    * @method colors\n    * @return {HSLColor[]}\n    * @memberof module:color-search.TextColors\n    * @instance\n    */\n    get colors() {\n        return [...this.adjustedColorOccurence.values()];\n    }\n\n    /** Getter for user selected colors & words\n    * @method colorsAndWords\n    * @return {Object} Object in form {colors: Map, words: string[]}.\n    * @memberof module:color-search.TextColors\n    * @instance\n    */\n    get colorsAndWords() {\n        const o = {};\n        o.colors = this.colors;\n        o.words = this.words;\n        return o;\n    }\n\n    /** Getter for global saturation percentage\n    * @method sPercentage\n    * @return {number}\n    * @memberof module:color-search.TextColors\n    * @instance\n    */\n    get sPercentage() {\n        return this._sPercentage;\n    }\n\n    /** Getter for global lightness percentage\n    * @method lPercentage\n    * @return {number}\n    * @memberof module:color-search.TextColors\n    * @instance\n    */\n    get lPercentage() {\n        return this._lPercentage;\n    }\n\n    /** Setter for global saturation percentage\n    * @method sPercentage\n    * @param {number} sPercentage\n    * @memberof module:color-search.TextColors\n    * @instance\n    */\n    set sPercentage(sPercentage) {\n        this._sPercentage = sPercentage;\n        this.calculateAdjustedColors();\n    }\n\n    /** Setter for global lightness percentage\n    * @method lPercentage\n    * @param {number} lPercentage\n    * @memberof module:color-search.TextColors\n    * @instance\n    */\n    set lPercentage(lPercentage) {\n        this._lPercentage = lPercentage;\n        this.calculateAdjustedColors();\n    }\n\n    /** Setter for global saturation & lightness percentage\n    * @method setSLPercentage\n    * @param {number} sPercentage\n    * @param {number} lPercentage\n    * @memberof module:color-search.TextColors\n    * @instance\n    */\n    setSLPercentage(sPercentage, lPercentage) {\n        this._sPercentage = sPercentage;\n        this._lPercentage = lPercentage;\n        this.calculateAdjustedColors();\n    }\n\n    /** Delete all colors & words\n    * @method clear\n    * @memberof module:color-search.TextColors\n    * @instance\n    */\n    clear() {\n        this._words.length = 0;\n        this.colorOccurence.clear();\n        this.adjustedColorOccurence.clear();\n    }\n\n    /** Update all colors.\n    * @method update\n    * @param {Map} colors Hashmap with selected colors\n    * @param {number} sPercentage Global saturation percentage setting (-100 to + 100).\n    * @param {number} lPercentageGlobal Global lightness percentage setting (-100 to +100).\n    * @memberof module:color-search.TextColors\n    * @instance\n    */\n    update(colors, sPercentage, lPercentage) {\n        this.clear();\n        if (colors && colors.size > 0) {\n            for (const [key, value] of colors.entries()) {\n                if (value.color && value.color.isSet()) {\n                    this._words.push(value.word);\n                    let color = this.colorOccurence.get(value.color.toString());\n                    if (color) {\n                        color.setWeight(color.weight + value.color.weight);\n                    } else {\n                        color = this._colorService.getColorInstance(value.color);\n                        this.colorOccurence.set(color.toString(), color);\n                    }\n                }\n            }\n        }\n        this.sPercentage = typeof sPercentage === \"number\" ? sPercentage : this.sPercentage;\n        this.lPercentage = typeof lPercentage === \"number\" ? lPercentage : this.lPercentage;\n        this.calculateAdjustedColors();\n    }\n\n    /** Recalculate all colors using global sPercentage & lPercentage (interpolation used).\n    * @method calculateAdjustedColors\n    * @memberof module:color-search.TextColors\n    * @instance\n    */\n    calculateAdjustedColors() {\n        this.adjustedColorOccurence.clear();\n        for (const value of this.colorOccurence.values()) {\n            const color = this._colorService.getColorInstance(value);\n            color.interpolateS(this.sPercentage).interpolateL(this.lPercentage);\n            if (value.isAchromatic()) {\n                color.setAchromatic();\n            }\n            this.adjustedColorOccurence.set(color.toString(), color);\n        }\n    }\n}\n\nexport default TextColors;\n\n\n\n// WEBPACK FOOTER //\n// ./modules/color-search/core/models/TextColors.js","class JsonRpcException {\n    constructor(error) {\n        this.name = \"jsonRpcException\";\n        this.message = error;\n    }\n}\n\n/**\n* Connects with server using AJAX and sends\n* requests in JSON-RPC 2.0 message format.\n* @module jsonrpc\n*/\nangular.module('jsonrpc', [])\n.provider('$JsonRpc', function () {\n    let url = \"\";\n    this.set = (conf) => {\n        url = conf[\"url\"];\n    };\n    this.$get = () => ({\n        url,\n    });\n})\n/** Service for JSON-RPC 2.0 requests.\n* @member {Service} jsonrpc\n* @memberof module:jsonrpc\n* @instance\n*/\n.service(\"jsonrpc\", [\"$q\", \"$http\", \"$JsonRpc\", function ($q, $http, jsonrpcConfig) {\n    const _url = jsonrpcConfig.url;\n    if (!_url) {\n        throw new JsonRpcException('Please configure server url');\n    }\n    let _id = 0;\n    this.request = (method, params) => {\n        const deferred = $q.defer();\n        const req = {\n            method: 'POST',\n            url: _url,\n            headers: { 'Content-Type': 'application/json' },\n            data: _getInputData(method, params),\n        };\n\n        $http(req).then((res) => {\n            const data = res.data;\n            if (!res || !data) {\n                deferred.reject(new JsonRpcException(\"Unknown Error occured. No data received\"));\n            } else if (data && data.result !== undefined) {\n                if (!_inspectDataFormat(data)) {\n                    deferred.reject(new JsonRpcException(\"JSON-RPC 2.0 data format must be used.\"));\n                } else {\n                    deferred.resolve(data.result);\n                }\n            } else {\n                console.log(data);\n                deferred.reject(new JsonRpcException(`No data received. HTTP status code: ${data.error.status}`));\n            }\n        }, (error) => {\n            if (error) {\n                deferred.reject(new JsonRpcException(`Error occured. HTTP status code: ${error.status}`));\n            } else {\n            deferred.reject(new JsonRpcException(\"Unknown Error occurred\"));\n            }\n        });\n        return deferred.promise;\n    };\n\n    function _getInputData(methodName, args) {\n    _id += 1;\n        return {\n            jsonrpc: '2.0',\n            id: _id,\n            method: methodName,\n            params: args,\n        };\n    }\n\n    function _inspectDataFormat(data) {\n        const allowedKeys = [\"jsonrpc\", \"id\", \"result\"];\n        const keys = Object.keys(data);\n        let ret = false;\n        if (keys.length === allowedKeys.length) {\n            ret = true;\n            keys.forEach((key) => {\n                if (allowedKeys.indexOf(key) < 0) {\n                    ret = false;\n                }\n                if (key === \"jsonrpc\" && data[key] !== \"2.0\") {\n                    ret = false;\n                }\n            });\n        }\n        return ret;\n    }\n}]);\n\n\nexport default 'jsonrpc';\n\n\n\n// WEBPACK FOOTER //\n// ./modules/color-search/core/services/rpc/JsonRpc.js","import './scss/main.scss';\r\nimport template from './template/main.html';\r\nimport colorAdjuster from '../color-adjuster/color-adjuster';\r\nimport textColorizer from '../text-colorizer/text-colorizer';\r\nimport toolbar from '../color-toolbar/color-toolbar';\r\nimport imageFinder from '../image-finder/image-finder';\r\nimport settings from '../settings/settings';\r\n\r\n/**\r\n* @module main\r\n* @requires module:color-adjuster\r\n* @requires module:text-colorizer\r\n* @requires module:color-toolbar\r\n* @requires module:image-finder\r\n* @requires module:settings\r\n*/\r\nangular.module('main', [colorAdjuster, textColorizer, toolbar, imageFinder, settings])\r\n/** Calculates font color according to background color.\r\n*  Uses 'colorService' for calculations.\r\n* @member {Factory} calculateFontColor\r\n* @memberof module:main\r\n* @instance\r\n*/\r\n.factory('calculateFontColor', ['colorService', colorService => (color) => {\r\n        const fontColor = colorService.colorWithGreaterCR(colorService.hslToRgb(color),\r\n        { r: 0, g: 0, b: 0 }, { r: 255, g: 255, b: 255 });\r\n        return colorService.rgbToHex(fontColor);\r\n    },\r\n])\r\n/** Representation of 'main' page in web application.\r\n* Contains several child components which are responsible for main functionality\r\n* of the application. Orchestrates the collaboration of the contained components\r\n* with the help of component bindings.\r\n* @member {Component} main\r\n* @memberof module:main\r\n* @instance\r\n*/\r\n.component('main', {\r\n    template,\r\n    /**\r\n    * Controller class of 'main' component\r\n    * @constructor Main\r\n    * @param {Service} $rootScope Angularjs '$rootScope' service\r\n    * @param {Service} $scope Angularjs '$scope' service\r\n    * @param {Service} $timeout Angularjs '$timeout'\r\n    * @param {Service} textColors 'textColors' model / service\r\n    * @param {Service} appSettings 'appSettings' model / service\r\n    * @param {Service} colorService 'colorService' service\r\n    * @param {Service} popupDialog 'popupDialog' service\r\n    * @see main component\r\n    * @memberof module:main\r\n    */\r\n    controller: class Main {\r\n\r\n        static get $inject() {\r\n            return ['$rootScope', '$scope', '$timeout', 'textColors', 'appSettings', 'colorService', 'popupDialog'];\r\n        }\r\n\r\n        constructor($rootScope, $scope, $timeout, textColors, appSettings, colorService, dialog) {\r\n            this.$rootScope = $rootScope;\r\n            this.$scope = $scope;\r\n            this.$timeout = $timeout;\r\n            this._colorService = colorService;\r\n            this._dialog = dialog;\r\n            this.textColors = textColors;\r\n            this.appSettings = appSettings;\r\n            this.colors = new Map();\r\n            this.settingsOpened = false;\r\n            this.selectedWord = {};\r\n            this.textColorizer = null;\r\n            this.selectedColor = null;\r\n            this.searchData = null;\r\n            this.resultFound = null;\r\n        }\r\n\r\n        /** Event-handler that handles open / close of settings component\r\n        * @method toggleSettings\r\n        * @memberof module:main.Main\r\n        * @instance\r\n        */\r\n        toggleSettings() {\r\n            this.settingsOpened = !this.settingsOpened;\r\n            this.$timeout(() => {\r\n                this.$scope.$broadcast('rzSliderForceRender');\r\n            }, 0, false);\r\n        }\r\n\r\n        /** If certain color profile was selected and applied,\r\n        *  this method will be called. Sets all colors in text-colorizer.\r\n        * @method  loadColorProfile\r\n        * @param {Map} colors\r\n        * @param {Number} sPercentage\r\n        * @param {Number} lPercentage\r\n        * @memberof module:main.Main\r\n        * @instance\r\n        */\r\n        loadColorProfile(colors, sPercentage, lPercentage) {\r\n            const colorizer = this.getColorizer();\r\n            colorizer.setColors(colors, () => {\r\n                this._updateColors();\r\n                this.textColors.update(colorizer.getAllColors(),\r\n                sPercentage, lPercentage);\r\n                this.$scope.$broadcast(\"colorsChainged\");\r\n            });\r\n        }\r\n\r\n        /** Handler for click on certain word in text editor.\r\n        * @method  selectWord\r\n        * @param {WordNode} word\r\n        * @memberof module:main.Main\r\n        * @instance\r\n        */\r\n        selectWord(word) {\r\n            this.selectedWord = word;\r\n        }\r\n\r\n        /** If color was modified, this method will be called.\r\n        * @method colorModified\r\n        * @param {HSLColor} color\r\n        * @param {Boolean} linking\r\n        * @memberof module:main.Main\r\n        * @instance\r\n        */\r\n        colorModified(color, linking) {\r\n            const colorizer = this.getColorizer();\r\n            if (color && colorizer) {\r\n                if (color.isSet()) {\r\n                    colorizer.setColor(this.selectedWord, color, linking, () => {\r\n                        this.textColors.update(colorizer.getAllColors());\r\n                        this.$scope.$broadcast(\"colorsChainged\");\r\n                    });\r\n                } else {\r\n                    colorizer.resetColor(this.selectedWord, linking, () => {\r\n                        this.textColors.update(colorizer.getAllColors());\r\n                        this.$scope.$broadcast(\"colorsChainged\");\r\n                    });\r\n                }\r\n                this._updateColors();\r\n            }\r\n        }\r\n\r\n        /**\r\n        * @method  inputComplete\r\n        * @memberof module:main.Main\r\n        * @instance\r\n        */\r\n        inputComplete() {\r\n            const colorizer = this.getColorizer();\r\n            colorizer.inputComplete(() => {\r\n                this._updateColors();\r\n                this.textColors.update(colorizer.getAllColors());\r\n                this.$scope.$broadcast(\"colorsChainged\");\r\n            });\r\n        }\r\n\r\n        /** Delete all colors and words\r\n        * @method  drop\r\n        * @memberof module:main.Main\r\n        * @instance\r\n        */\r\n        drop() {\r\n            const colorizer = this.getColorizer();\r\n            colorizer.clear(() => {\r\n                this._updateColors();\r\n                this.textColors.clear();\r\n                this.$scope.$broadcast(\"colorsChainged\");\r\n            });\r\n        }\r\n\r\n        /** Opens confirm dialog\r\n        * @method  dropDialog\r\n        * @memberof module:main.Main\r\n        * @instance\r\n        */\r\n        dropDialog() {\r\n            const self = this;\r\n            this._dialog.confirmDialog(function () {\r\n                this.yes = () => {\r\n                    self.drop();\r\n                    self._dialog.close();\r\n                };\r\n                this.cancel = () => {\r\n                    self._dialog.close();\r\n                };\r\n                this.title = '\"drop\"';\r\n            });\r\n        }\r\n\r\n        /** Opens confirm dialog\r\n        * @method  decolorizeDialog\r\n        * @memberof module:main.Main\r\n        * @instance\r\n        */\r\n        decolorizeDialog() {\r\n            const self = this;\r\n            const colors = this.textColors.colors;\r\n            if (colors.length > 0) {\r\n                this._dialog.confirmDialog(function () {\r\n                    this.yes = () => {\r\n                        self.decolorizeText();\r\n                        self._dialog.close();\r\n                    };\r\n                    this.cancel = () => {\r\n                        self._dialog.close();\r\n                    };\r\n                    this.title = '\"clear\"';\r\n                });\r\n            }\r\n        }\r\n\r\n        /** Decolorize all words\r\n        * @method  decolorizeText\r\n        * @memberof module:main.Main\r\n        * @instance\r\n        */\r\n        decolorizeText() {\r\n            const colorizer = this.getColorizer();\r\n            colorizer.resetAllColors(() => {\r\n                this._updateColors();\r\n                this.textColors.clear();\r\n                this.$scope.$broadcast(\"colorsChainged\");\r\n            });\r\n        }\r\n\r\n        /** Enables edit mode in text editor.\r\n        * @method  edit\r\n        * @memberof module:main.Main\r\n        * @instance\r\n        */\r\n        edit() {\r\n            const colorizer = this.getColorizer();\r\n            colorizer.editMode();\r\n        }\r\n\r\n        /** Search for similar images.\r\n        * @method  search\r\n        * @memberof module:main.Main\r\n        * @instance\r\n        */\r\n        search() {\r\n            const self = this;\r\n            const colorsAndWords = this.textColors.colorsAndWords;\r\n            if (!this.appSettings.checkSemanticSimilarity) {\r\n                colorsAndWords.words = [];\r\n            }\r\n            this.searchData = { words: colorsAndWords, settings: self.appSettings };\r\n        }\r\n\r\n        /** Checks if search result exists.\r\n        * @method  imagesFound\r\n        * @param {Image[]} images\r\n        * @memberof module:main.Main\r\n        * @instance\r\n        */\r\n        imagesFound(images) {\r\n            this.resultFound = images.length > 0;\r\n        }\r\n\r\n        /** Gets text-colorizer component\r\n        * @method  getColorizer\r\n        * @memberof module:main.Main\r\n        * @instance\r\n        */\r\n        getColorizer() {\r\n            if (!this.textColorizer) {\r\n                this.$scope.$broadcast(\"text-colorizer\", (colorizer) => {\r\n                    this.textColorizer = colorizer;\r\n                });\r\n            }\r\n            return this.textColorizer;\r\n        }\r\n\r\n        _updateColors() {\r\n            const colorizer = this.getColorizer();\r\n            const cols = colorizer.getAllColors();\r\n            this.colors.clear();\r\n            for (const value of cols.values()) {\r\n                const word = value.word.toLowerCase();\r\n                const color = value.color;\r\n                const entry = this.colors.get(word);\r\n                if (entry) {\r\n                    entry.add(color);\r\n                } else {\r\n                    const colorSet = this._colorService.getColorSetInstance();\r\n                    colorSet.add(color);\r\n                    this.colors.set(word, colorSet);\r\n                }\r\n            }\r\n        }\r\n    },\r\n});\r\n\r\nexport default 'main';\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/main/main.js","module.exports = \"<div class=main> <color-toolbar closed=true input-color=$ctrl.selectedWord.color color-modified=\\\"$ctrl.colorModified(color, linking)\\\" on-close=\\\"$ctrl.selectedWord=null\\\"></color-toolbar> <div class=main__colorizer> <text-colorizer on-wordselect=$ctrl.selectWord(word)></text-colorizer> <div class=main__colorizer-controls> <a class=\\\"btn-bodyless btn-bodyless-success main__colorizer-button\\\" ng-click=$ctrl.inputComplete()><span class=\\\"glyphicon glyphicon-ok\\\"></span> Go!</a><span class=main__colorizer-separator></span> <a class=\\\"btn-bodyless main__colorizer-button\\\" ng-click=$ctrl.edit()><span class=\\\"glyphicon glyphicon-pencil\\\"></span> Edit</a><span class=main__colorizer-separator></span> <a class=\\\"btn-bodyless btn-bodyless-danger main__colorizer-button\\\" ng-click=$ctrl.decolorizeDialog()><span class=\\\"glyphicon glyphicon-remove\\\"></span> Clear</a><span class=main__colorizer-separator></span> <a class=\\\"btn-bodyless btn-bodyless-danger main__colorizer-button\\\" ng-click=$ctrl.dropDialog()><span class=\\\"glyphicon glyphicon-trash\\\"></span> Drop</a> </div> </div> <div class=\\\"main__adjustments-section main__section\\\"> <div class=main__section-content> <div class=main__section-title> <div class=main__section-label>Adjustments & Profiles</div> </div> <div class=main__adjustments> <div class=main__adjustments-content> <color-adjuster class=main__adjuster></color-adjuster> <div class=main__profiles> <color-profiles colors=$ctrl.colors on-load-profile=\\\"$ctrl.loadColorProfile(colors, sPercentage, lPercentage)\\\"></color-profiles> </div> </div> </div> </div> </div> <div class=\\\"main__settings-section main__section\\\"> <div class=main__section-content> <div class=main__section-title> <div ng-click=$ctrl.toggleSettings() class=\\\"main__section-label main__settings-label\\\"><span ng-class=\\\"$ctrl.settingsOpened ? 'dropup' : 'dropdown'\\\"><span class=\\\"caret main__caret\\\"></span></span> Settings</div> </div> <div class=main__settings ng-show=$ctrl.settingsOpened> <div class=main__settings-content> <settings></settings> </div> </div> </div> </div> <div class=main__find-container> <a class=\\\"btn btn-success main__find-button\\\" ng-click=$ctrl.search()><span class=\\\"glyphicon glyphicon-search\\\"></span> Search!</a> </div> <div ng-show=$ctrl.resultFound class=main__image-finder> <image-finder search=$ctrl.searchData on-images-found=$ctrl.imagesFound(images)></image-finder> </div> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./modules/main/template/main.html\n// module id = 123\n// module chunks = 0","import \"chartist/dist/scss/chartist.scss\";\nimport angularChartist from 'angular-chartist.js';\nimport slider from 'angularjs-slider';\nimport './scss/color-adjuster.scss';\nimport template from './template/color-adjuster.html';\n\n/**\n* @module color-adjuster\n* @requires module:angularjs-slider\n* @requires module:angular-chartist\n*/\nangular.module('color-adjuster', [slider, angularChartist])\n/** Adjusting of all selected colors (saturation & lightness).\n* The global distribution of selected colors is shown in the chart.\n* @member {Component} colorAdjuster\n* @property {ColorAdjusterCtrl} controller\n* @memberof module:color-adjuster\n* @instance\n*/\n.component('colorAdjuster', {\n    template,\n    /**\n    * Controller for 'colorAdjuster' component.\n    * @constructor ColorAdjusterCtrl\n    * @param {Service} $rootScope Angularjs '$scope'\n    * @param {Service} $timeout Angularjs '$timeout' service\n    * @param {Service} colorService 'colorService' service\n    * @param {Service} textColors 'textColors' service\n    * @see colorAdjuster component\n    * @memberof module:color-adjuster\n    */\n    controller: class ColorAdjusterCtrl {\n\n        static get $inject() {\n            return ['$scope', '$timeout', 'colorService', 'textColors'];\n        }\n\n        constructor($scope, $timeout, colorService, textColors) {\n            this.$scope = $scope;\n            this.$timeout = $timeout;\n            this._colorService = colorService;\n            this.textColors = textColors;\n            this.chart = {};\n            const self = this;\n            this.chart.options = {\n                showLabel: false,\n                donut: true,\n                donutWidth: 40,\n                donutSolid: true,\n                startAngle: 270,\n            };\n            this.chart.data = {};\n            this.chart.events = {\n                draw: (context) => {\n                    if (context.type === \"slice\") {\n                        context.element.attr({\n                            style: `fill: ${context.meta}`,\n                        });\n                    }\n                },\n            };\n            this.chart.responsive = [\n                ['screen and (min-width: 500px)', {\n                    donutWidth: 30,\n                }],\n            ];\n            this.slider = {\n                value: 50,\n                options: {\n                    floor: 0,\n                    ceil: 200,\n                    step: 1,\n                    onChange: () => {\n                        textColors.calculateAdjustedColors();\n                        self._colorsChanged();\n                    },\n                    onEnd: () => {\n                        textColors.calculateAdjustedColors();\n                        self._colorsChanged();\n                    },\n                    hidePointerLabels: true,\n                    hideLimitLabels: true,\n                    disabled: false,\n                },\n            };\n            this.$scope.$on(\"colorsChainged\", this._colorsChanged.bind(this));\n            this.$scope.$on(\"refresh\", () => {\n                this.chart.data = {};\n                this._colorsChanged();\n            });\n        }\n\n        /**\n        * @method toggle\n        * @memberof module:color-adjuster.ColorAdjuster\n        * @instance\n        */\n        toggle() {\n            this.$timeout(() => {\n                this.$scope.$broadcast('rzSliderForceRender');\n            }, 0, false);\n        }\n\n        /**\n        * @method getS\n        * @return {string}\n        * @memberof module:color-adjuster.ColorAdjuster\n        * @instance\n        */\n        getS() {\n            return this.textColors.sPercentage < 100 ? `-${Math.abs(this.textColors.sPercentage - 100)}` :\n            `+${Math.abs(this.textColors.sPercentage - 100)}`;\n        }\n\n        /**\n        * @method getL\n        * @return {string}\n        * @memberof module:color-adjuster.ColorAdjuster\n        * @instance\n        */\n        getL() {\n            return this.textColors.lPercentage < 100 ? `-${Math.abs(this.textColors.lPercentage - 100)}` :\n            `+${Math.abs(this.textColors.lPercentage - 100)}`;\n        }\n\n        _colorsChanged() {\n            const tempColors = new Map();\n            const data = [];\n            for (const [key, color] of this.textColors.adjustedColorOccurence.entries()) {\n                const keyColor = this._colorService.getColorInstance().setColorFromString(key);\n                const hex = this._colorService.hslToHexString(keyColor);\n                let count = tempColors.has(hex) ? tempColors.get(hex) : 0;\n                count += color.weight;\n                tempColors.set(hex, count);\n            }\n            for (const [hex, count] of tempColors) {\n                data.push({ value: count, meta: hex });\n            }\n            this.chart.data.series = data;\n        }\n    },\n});\n\nexport default 'color-adjuster';\n\n\n\n// WEBPACK FOOTER //\n// ./modules/color-adjuster/color-adjuster.js","module.exports = \"<div class=color-adjuster> <div class=color-adjuster__chart><chartist class=\\\"ct-chart ct-square chart\\\" chartist-events=$ctrl.chart.events chartist-data=$ctrl.chart.data chartist-chart-options=$ctrl.chart.options chartist-responsive-options=$ctrl.chart.responsive chartist-chart-type=Pie></chartist></div> <div class=\\\"sliders color-adjuster__sliders\\\"> <div class=color-adjuster__sliders-content> <div class=color-adjuster__slider> <div><span class=\\\"glyphicon glyphicon-signal\\\"></span> <span>{{$ctrl.getS()}}%</span></div> <rzslider rz-slider-model=$ctrl.textColors.sPercentage rz-slider-options=$ctrl.slider.options></rzslider> </div> <div class=color-adjuster__slider> <div><span class=\\\"glyphicon glyphicon-adjust icon-flipped\\\"></span> <span>{{$ctrl.getL()}}%</span></div> <rzslider rz-slider-model=$ctrl.textColors.lPercentage rz-slider-options=$ctrl.slider.options></rzslider> </div> </div> </div> </div> \";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./modules/color-adjuster/template/color-adjuster.html\n// module id = 129\n// module chunks = 0","import './scss/text-colorizer.scss';\nimport template from './template/text-colorizer.html';\nimport Words from './classes/Words';\nimport Caret from './classes/Caret';\nimport Helper from './classes/Helper';\nimport Parser from './classes/Parser';\n\n/**\n* @module text-colorizer\n*/\nangular.module('text-colorizer', [])\n/** Text editor. Responsible for parsing and visualization of\n* user text, words and selected colors. Text editor is fully editable.\n* The text can be modificated, deleted\n* or decolorized at any time. Text modifications will be applied after\n* invokation of the 'inputComplete' method.\n* @member {Component} textColorizer\n* @property {TextColorizerCtrl} controller\n* @property {String} template\n* @property {Object} bindings {onWordselect: '&'}\n* @memberof module:text-colorizer\n* @instance\n*/\n.component('textColorizer', {\n    template,\n    bindings: {\n        onWordselect: '&',\n    },\n    /**\n    * Controller class of 'textColorizer' component\n    * @constructor TextColorizerCtrl\n    * @param {Service} $scope Angularjs '$scope' service\n    * @param {Service} $element Angularjs '$element' service\n    * @param {Service} $timeout Angularjs '$timeout' service\n    * @param {Service} $window Angularjs '$window' service\n    * @param {Factory} calculateFontColor 'calculateFontColor' factory\n    * @param {Service} colorService 'colorService' service\n    * @see textColorizer component\n    * @memberof module:text-colorizer\n    */\n    controller: class TextColorizerCtrl {\n        static get $inject() {\n            return [\"$scope\", \"$element\", \"$timeout\", \"$window\", \"calculateFontColor\", \"colorService\"];\n        }\n\n        constructor($scope, $element, $timeout, $window, calculateFontColor, colorService) {\n            this.$scope = $scope;\n            this.$element = $element;\n            this.$timeout = $timeout;\n            this.$window = $window;\n            this.$ = angular.element;\n            this.$root = this.$($element).find('.text-colorizer__text');\n            this.words = new Words(colorService, calculateFontColor);\n            this.caret = new Caret($window);\n            this.helper = new Helper($window, this.$, this.$root, this.caret);\n            this.parser = new Parser(this.$, $window, this.$root, colorService, this.words);\n            this.editMode = true;\n        }\n\n        $onInit() {\n            this.switchToEditMode();\n        }\n\n        /** Exposes public api object.\n        * @method _api\n        * @return {Object}\n        * @memberof module:text-colorizer.TextColorizer\n        * @instance\n        */\n        _api() {\n            const self = this;\n            return {\n                inputComplete(callback) {\n                    self.inputComplete(callback);\n                },\n                editMode() {\n                    self.switchToEditMode();\n                },\n                setColor(word, color, linking, callback) {\n                    self.setColor(word, color, linking, callback);\n                },\n                resetColor(word, linking, callback) {\n                    self.resetColor(word, linking, callback);\n                },\n                resetAllColors(callback) {\n                    self.resetAllColors(callback);\n                },\n                getAllColors() {\n                    return self.getAllColors();\n                },\n                setColors(colors, callback) {\n                    self.setColors(colors, callback);\n                },\n                clear(callback) {\n                    self.clear(callback);\n                },\n                hasColors() {\n                    return self.getAllColors().size > 0;\n                },\n            };\n        }\n\n        /** Component hook method, which is called after linking phase.\n        * Registrates $on handler in the $scope for \"text-colorizer\" event.\n        * Returns the public api for this component as a callback parameter\n        * in the event handler for \"text-colorizer\" event.\n        * @method $postLink\n        * @memberof module:text-colorizer.TextColorizer\n        * @instance\n        */\n        $postLink() {\n            this.helper.observeEditorChanges();\n            this.$scope.$on(\"text-colorizer\", (event, callback) => {\n                if (typeof callback === \"function\") {\n                    callback(this._api());\n                }\n            });\n        }\n\n        /** Event-handler. Handles double clicks in editor in 'edit' mode.\n         * Adds spaces in editor on doubleclicks and improves usability.\n        * @method handleMouseDown\n        * @param {Object} $event - Angularjs $event object\n        * @memberof module:text-colorizer.TextColorizer\n        * @instance\n        */\n        handleMouseDown($event) {\n            if (this.editMode) {\n                if ($event.detail > 1) {\n                    $event.preventDefault();\n                    this.helper.doubleClick($event.originalEvent);\n                }\n            }\n        }\n\n        /** Event-handler. Handles 'paste' events in text editor.\n         * Allows only plain text paste in text editor.\n        * @function handlePaste\n        * @param {Object} $event - Angularjs $event object\n        * @memberof module:text-colorizer.TextColorizer\n        * @instance\n        */\n        handlePaste($event) {\n            this.helper.handlePaste($event);\n        }\n\n        /** Event-handler. Handles 'keydown' events in editor.\n        * @function handleKeyDown\n        * @param {Object} $event - Angularjs $event object\n        * @memberof module:text-colorizer.TextColorizer\n        * @instance\n        */\n        handleKeyDown($event) {\n            this.helper.handleKeyDown($event);\n        }\n\n        /** Applies changes and detects words in text editor.\n        * @function inputComplete\n        * @param {Function} callback - Callback function (optional)\n        * @memberof module:text-colorizer.TextColorizer\n        * @instance\n        */\n        inputComplete(callback) {\n            this.editMode = false;\n            this.parser.parse();\n            const currentIds = new Set();\n            this.$root.find(`[data-word]`).each((i, elem) => {\n                const idString = this.$(elem).attr(\"data-word\");\n                const id = parseInt(idString, 10);\n                currentIds.add(id);\n                const nextSibling = elem.nextSibling;\n                if (nextSibling && nextSibling.nodeType !== 3) {\n                    this.$(elem).after(\"\\u00A0\");\n                }\n            });\n            const ids = this.words.getIds();\n            for (const id of ids) {\n                if (!currentIds.has(id)) {\n                    this.words.removeWordNode(id);\n                }\n            }\n            if (callback) {\n                callback();\n            }\n        }\n\n        /** Switch to 'edit' mode and move caret to the end of input text.\n        * @function  switchToEditMode\n        * @memberof module:text-colorizer.TextColorizer\n        * @instance\n        */\n        switchToEditMode() {\n            this.editMode = true;\n            this.$root.attr(\"contentEditable\", true);\n            this.helper.removeEmptyLast(this.$root);\n            const $last = this.helper.getLast(this.$root);\n            const lastNodeType = ($last && $last[0]) ? $last[0].nodeType : undefined;\n            if (lastNodeType === 3) {\n                this.caret.moveTo($last[0]);\n            } else if (lastNodeType) {\n                const node = this.$window.document.createTextNode('\\u00A0');\n                $last.after(node);\n                this.caret.moveTo(node);\n            }\n            this.$root[0].focus();\n        }\n\n        /** Set  color for specific word.\n        * @function setColor\n        * @param {Word} word Word object\n        * @param {Color} color Color object\n        * @param {boolean} linking Flag if the operation must be applied to all equal words\n        * @param {Function} callback Callback function (optional)\n        * @memberof module:text-colorizer.TextColorizer\n        * @instance\n        */\n        setColor(word, color, linking, callback) {\n            if (!this.editMode && word) {\n                if (linking) {\n                    this.words.setColor(word.id, color);\n                } else {\n                    this.words.setColorOnce(word.id, color);\n                }\n                if (callback) {\n                    callback();\n                }\n            }\n        }\n\n        /** Colorize words.\n        * @function setColors\n        * @param {Map} wordColors HashMap with colors and words\n        * @param {Function} callback Callback function (optional)\n        * @memberof module:text-colorizer.TextColorizer\n        * @instance\n        */\n        setColors(wordColors, callback) {\n            this.inputComplete(() => {\n                for (const [word, color] of wordColors) {\n                    this.words.setColorByWord(word, color);\n                }\n                if (callback) {\n                    callback();\n                }\n            });\n        }\n\n        /** Return all colors as map\n        * @function getAllColors\n        * @return {Map}\n        * @memberof module:text-colorizer.TextColorizer\n        * @instance\n        */\n        getAllColors() {\n            return this.words.getAllWordNodes();\n        }\n\n        /** Resets one color (decolorize word).\n        * @function resetColor\n        * @param {Word} word Word object\n        * @param {boolean} linking Flag if the operation must be applied to all equal words\n        * @param {Function} callback Callback function (optional)\n        * @memberof module:text-colorizer.TextColorizer\n        * @instance\n        */\n        resetColor(word, linking, callback) {\n            if (!this.editMode && word) {\n                if (linking) {\n                    this.words.resetColor(word.id);\n                } else {\n                    this.words.resetOneColor(word.id);\n                }\n            }\n            if (callback) {\n                callback();\n            }\n        }\n\n        /** Resets all colors in all words (decolorize words).\n        * @function resetAllColors\n        * @param {Function} callback Callback function (optional)\n        * @memberof module:text-colorizer.TextColorizer\n        * @instance\n        */\n        resetAllColors(callback) {\n            this.words.resetAllColors();\n            if (callback) {\n                callback();\n            }\n        }\n\n        /** Eventhandler. Handles simple clicks on words in editor.\n        * @function selectWord\n        * @param {Object} $event Angularjs $event object\n        * @memberof module:text-colorizer.TextColorizer\n        * @instance\n        */\n        selectWord($event) {\n            $event.stopPropagation();\n            const $targetNode = this.$($event.target);\n            if ($targetNode.is(\"[data-word]\")) {\n                if (!this.editMode) {\n                    const id = $targetNode.attr(\"data-word\");\n                    const savedWord = this.words.getWordNode(parseInt(id, 10));\n                    this.onWordselect({ word: savedWord });\n                } else {\n                    this.helper.clickOnWord($targetNode);\n                }\n            }\n        }\n\n        /** Deletes all colors and words in text editor.\n        * @function clear\n        * @param {Function} callback Callback function (optional)\n        * @memberof module:text-colorizer.TextColorizer\n        * @instance\n        */\n        clear(callback) {\n            this.words.clear();\n            this.$root.empty();\n            this.switchToEditMode();\n            if (callback) {\n                callback();\n            }\n        }\n    },\n});\n\nexport default 'text-colorizer';\n\n\n\n// WEBPACK FOOTER //\n// ./modules/text-colorizer/text-colorizer.js","module.exports = \"<div class=text-colorizer__text ng-click=$ctrl.selectWord($event) ng-mousedown=$ctrl.handleMouseDown($event) ng-keydown=$ctrl.handleKeyDown($event) ng-paste=$ctrl.handlePaste($event) contenteditable={{$ctrl.editMode}} spellcheck=false placeholder=\\\"Insert text here...\\\"></div> \";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./modules/text-colorizer/template/text-colorizer.html\n// module id = 138\n// module chunks = 0","/**\r\n* Represents a word node in the parsing tree. Contains DOM node\r\n* for fast access and modifications.\r\n* @constructor\r\n* @param {Service} colorService Angularjs 'colorService' service\r\n* @param {Factory} calcFontcolor Angularjs factory for calculation of font color according to the background color\r\n* @memberof module:text-colorizer\r\n*/\r\nclass Words {\r\n    constructor(colorService, calcFontColor) {\r\n        this.wordNodes = new Map();\r\n        this.wordToWordNodes = new Map();\r\n        this.colorFactory = colorService;\r\n        this.calcFontColor = calcFontColor;\r\n    }\r\n\r\n    /** Assigns new dom node to the word node by id.\r\n    * @method updateWordNode\r\n    * @param {number} id Word node id\r\n    * @param {Object} $domNode DOM node in jquery wrapper\r\n    * @memberof module:text-colorizer.Words\r\n    * @instance\r\n    */\r\n    updateWordNode(id, $domNode) {\r\n        const wordNode = this.wordNodes.get(id);\r\n        if (wordNode) {\r\n            wordNode.$domNode = $domNode;\r\n        }\r\n    }\r\n\r\n\r\n    /** Get all word nodes associated with given word.\r\n    * @method getWordNodes\r\n    * @param {string} word Word\r\n    * @memberof module:text-colorizer.Words\r\n    * @return {WordNode[]}\r\n    * @instance\r\n    */\r\n    getWordNodes(word) {\r\n        return this.wordToWordNodes.get(word);\r\n    }\r\n\r\n    /** Returns word node by its id.\r\n    * @method getWordNode\r\n    * @param {number} id - Word node id\r\n    * @return {WordNode}\r\n    * @memberof module:text-colorizer.Words\r\n    * @instance\r\n    */\r\n    getWordNode(id) {\r\n        return this.wordNodes.get(id);\r\n    }\r\n\r\n    /** Returns ids of all word nodes.\r\n    * @method getIds\r\n    * @return {number[]}\r\n    * @memberof module:text-colorizer.Words\r\n    * @instance\r\n    */\r\n    getIds() {\r\n        return this.wordNodes.keys();\r\n    }\r\n\r\n    /** Returns all word nodes.\r\n    * @method getAllWordNodes\r\n    * @return {WordNode[]}\r\n    * @memberof module:text-colorizer.Words\r\n    * @instance\r\n    */\r\n    getAllWordNodes() {\r\n        return this.wordNodes;\r\n    }\r\n\r\n    /** Returns a HashMap\r\n    * @method getWordsToWordNodesMap\r\n    * @return {Map<string, WordNode[]>}\r\n    * @memberof module:text-colorizer.Words\r\n    * @instance\r\n    */\r\n    getWordsToWordNodesMap() {\r\n        return this.wordToWordNodes;\r\n    }\r\n\r\n    /** Inserts new word node.\r\n    * @method addWordNode\r\n    * @param {WordNode} wordNode\r\n    * @memberof module:text-colorizer.Words\r\n    * @instance\r\n    */\r\n    addWordNode(wordNode) {\r\n        this.wordNodes.set(wordNode.id, wordNode);\r\n        if (!this.wordToWordNodes.has(wordNode.word)) {\r\n            this.wordToWordNodes.set(wordNode.word, new Map());\r\n        }\r\n        const wordNodes = this.wordToWordNodes.get(wordNode.word);\r\n        wordNodes.set(wordNode.id, wordNode);\r\n    }\r\n\r\n    /** Removes word node by id.\r\n    * @method removeWordNode\r\n    * @param {number} id\r\n    * @memberof module:text-colorizer.Words\r\n    * @instance\r\n    */\r\n    removeWordNode(id) {\r\n        this.wordNodes.delete(id);\r\n        for (const wordNodes of this.wordToWordNodes.values()) {\r\n            if (wordNodes.has(id)) {\r\n                wordNodes.delete(id);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    /** Reset colors of word node by id.\r\n    * Resets all word nodes with the same word.\r\n    * @method resetColor\r\n    * @param {number} id\r\n    * @memberof module:text-colorizer.Words\r\n    * @instance\r\n    */\r\n    resetColor(id) {\r\n        const wordNode = this.wordNodes.get(id);\r\n        const wordNodes = this.wordToWordNodes.get(wordNode.word);\r\n        for (const node of wordNodes.values()) {\r\n            node.resetColor();\r\n        }\r\n    }\r\n\r\n    /** Resets color only in word node with given id.\r\n    * @method resetOneColor\r\n    * @param {number} id\r\n    * @memberof module:text-colorizer.Words\r\n    * @instance\r\n    */\r\n    resetOneColor(id) {\r\n        const wordNode = this.wordNodes.get(id);\r\n        wordNode.resetColor();\r\n    }\r\n\r\n    /** Set color in one specific word node by given id.\r\n    * @method setColorOnce\r\n    * @param {number} id Word node id\r\n    * @param {Color} color Color object\r\n    * @memberof module:text-colorizer.Words\r\n    * @instance\r\n    */\r\n    setColorOnce(id, color) {\r\n        const fontColor = this.calcFontColor(color);\r\n        const wordNode = this.wordNodes.get(id);\r\n        wordNode.setColor(color, fontColor);\r\n    }\r\n\r\n    /** Set color in all word nodes with the same word by given id.\r\n    * @method setColor\r\n    * @param {number} id Word node id\r\n    * @param {Color} color Color object\r\n    * @memberof module:text-colorizer.Words\r\n    * @instance\r\n    */\r\n    setColor(id, color) {\r\n        const wordNode = this.wordNodes.get(id);\r\n        this.setColorByWord(wordNode.word, color);\r\n    }\r\n\r\n    /** Set color in all word nodes with the same word by given word.\r\n    * @method setColorByWord\r\n    * @param {string} word Word\r\n    * @param {Color} color Color object\r\n    * @memberof module:text-colorizer.Words\r\n    * @instance\r\n    */\r\n    setColorByWord(word, color) {\r\n        const wordNodes = this.wordToWordNodes.get(word);\r\n        if (wordNodes) {\r\n            const fontColor = this.calcFontColor(color);\r\n            for (const node of wordNodes.values()) {\r\n                node.setColor(color, fontColor);\r\n            }\r\n        }\r\n    }\r\n\r\n    /** Resets all word nodes (decolorize words).\r\n    * @method resetAllColors\r\n    * @memberof module:text-colorizer.Words\r\n    * @instance\r\n    */\r\n    resetAllColors() {\r\n        for (const wordNode of this.wordNodes.values()) {\r\n            wordNode.resetColor();\r\n        }\r\n    }\r\n\r\n    /** Deletes all word nodes\r\n    * @method clear\r\n    * @memberof module:text-colorizer.Words\r\n    * @instance\r\n    */\r\n    clear() {\r\n        this.wordNodes.clear();\r\n        this.wordToWordNodes.clear();\r\n    }\r\n}\r\n\r\nexport default Words;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/text-colorizer/classes/Words.js","/**\r\n* Helper class for caret position in text editor\r\n* @constructor\r\n* @param {Service} $window - Angularjs $window service wrapper for window object\r\n* @memberof module:text-colorizer\r\n*/\r\nclass Caret {\r\n\r\n    constructor($window) {\r\n        this.$window = $window;\r\n    }\r\n\r\n    // move caret to the html node\r\n    // @params: html node\r\n    moveTo(node) {\r\n        const range = this.$window.document.createRange();\r\n        const sel = this.$window.getSelection();\r\n        range.setStartAfter(node);\r\n        range.setEndAfter(node);\r\n        sel.removeAllRanges();\r\n        sel.addRange(range);\r\n    }\r\n\r\n    // move caret to special position in textnode\r\n    moveInText(position, textNode) {\r\n        const caret = position;\r\n        const range = this.$window.document.createRange();\r\n        range.setStart(textNode, caret);\r\n        range.collapse(true);\r\n        const sel = this.$window.getSelection();\r\n        sel.removeAllRanges();\r\n        sel.addRange(range);\r\n    }\r\n\r\n    insertTextAtCursor(text) {\r\n        const sel = this.$window.getSelection();\r\n        const range = sel.getRangeAt(0);\r\n        const node = this.$window.document.createTextNode(text);\r\n        range.insertNode(node);\r\n        range.setStartAfter(node);\r\n        range.setEndAfter(node);\r\n        sel.removeAllRanges();\r\n        sel.addRange(range);\r\n    }\r\n\r\n    insertTextNodeAtCursor(node) {\r\n        const sel = this.$window.getSelection();\r\n        const range = sel.getRangeAt(0);\r\n        range.insertNode(node);\r\n        range.setStartAfter(node);\r\n        range.setEndAfter(node);\r\n        sel.removeAllRanges();\r\n        sel.addRange(range);\r\n    }\r\n\r\n    // https://stackoverflow.com/questions/4811822/get-a-ranges-start-and-end-offsets-relative-to-its-parent-container/4812022#4812022\r\n    getCaretCharacterOffsetWithin(element) {\r\n        let caretOffset = 0;\r\n        const doc = element.ownerDocument || element.document;\r\n        const win = doc.defaultView || doc.parentWindow;\r\n        let sel;\r\n        if (typeof win.getSelection !== \"undefined\") {\r\n            sel = win.getSelection();\r\n            if (sel.rangeCount > 0) {\r\n                const range = win.getSelection().getRangeAt(0);\r\n                const preCaretRange = range.cloneRange();\r\n                preCaretRange.selectNodeContents(element);\r\n                preCaretRange.setEnd(range.endContainer, range.endOffset);\r\n                caretOffset = preCaretRange.toString().length;\r\n            }\r\n        } else if ((sel = doc.selection) && sel.type != \"Control\") {\r\n            const textRange = sel.createRange();\r\n            const preCaretTextRange = doc.body.createTextRange();\r\n            preCaretTextRange.moveToElementText(element);\r\n            preCaretTextRange.setEndPoint(\"EndToEnd\", textRange);\r\n            caretOffset = preCaretTextRange.text.length;\r\n        }\r\n        return caretOffset;\r\n    }\r\n}\r\n\r\nexport default Caret;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/text-colorizer/classes/Caret.js","export default class Helper {\r\n\r\n    constructor($window, $, root, caret) {\r\n        this.$window = $window;\r\n        this.root = root;\r\n        this.$ = $;\r\n        this.caret = caret;\r\n    }\r\n\r\n    handleKeyDown(event) {\r\n        // prevents \"enter\" within detected words\r\n        const anchorNode = this.$window.getSelection().anchorNode;\r\n        const target = (anchorNode && anchorNode.parentNode) ? anchorNode.parentNode : null;\r\n        if (event.keyCode === 13 && this.$(target).is(\"[data-word]\")) {\r\n            event.preventDefault();\r\n        }\r\n    }\r\n\r\n    // workaround for webkit / chrome\r\n    // https://stackoverflow.com/questions/19243432/prevent-contenteditable-mode-from-creating-span-tags\r\n    // https://github.com/yabwe/medium-editor/issues/543\r\n    observeEditorChanges() {\r\n        const observer = new MutationObserver((mutations) => {\r\n            mutations.forEach((mutation) => {\r\n                const editable = (this.root.attr(\"contentEditable\") === \"true\");\r\n                if (mutation.type === \"childList\" && editable) {\r\n                    const nodes = mutation.addedNodes;\r\n                    for (const node of nodes) {\r\n                        if ((node.nodeName === \"FONT\") ||\r\n                            (node.nodeName === \"SPAN\" && node.parentNode &&\r\n                            node.parentNode.nodeName !== \"FONT\")) {\r\n                                this.replaceElementWithTextContent(node);\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        });\r\n       const config = { childList: true };\r\n       observer.observe(this.root[0], config);\r\n    }\r\n\r\n    replaceElementWithTextContent(node) {\r\n        const $elem = this.$(node);\r\n        const text = $elem.text();\r\n        const textNode = this.$window.document.createTextNode(text);\r\n        $elem.replaceWith(textNode);\r\n        const anchor = this.$window.getSelection().anchorNode;\r\n        if (anchor && anchor.nodeType === 3) {\r\n            this.caret.moveTo(textNode);\r\n        }\r\n    }\r\n\r\n    doubleClick(event) {\r\n        const sel = this.$window.getSelection();\r\n        const anchorNode = sel.anchorNode;\r\n        let wordNode = null;\r\n        if (this.$(anchorNode).is(\"[data-word]\")) {\r\n            wordNode = anchorNode;\r\n        } else if (this.$(anchorNode.parentNode).is(\"[data-word]\")) {\r\n            wordNode = anchorNode.parentNode;\r\n        } else if (this.$(event.target).is(\"[data-word]\")) {\r\n            wordNode = event.target;\r\n        }\r\n        const spaceNode = this.$window.document.createTextNode('\\u00A0');\r\n        if (!wordNode) {\r\n            this.caret.insertTextNodeAtCursor(spaceNode);\r\n            this.caret.moveTo(spaceNode);\r\n        } else if (wordNode && !this.$(anchorNode).is(this.root)) {\r\n            const position = this.caret.getCaretCharacterOffsetWithin(wordNode);\r\n            const text = this.$(wordNode).text();\r\n            if (position === text.length) {\r\n                this.$(wordNode).after(spaceNode);\r\n                this.caret.moveTo(spaceNode);\r\n            } else if (position === 0) {\r\n                this.$(wordNode).before(spaceNode);\r\n                this.caret.moveTo(spaceNode);\r\n            }\r\n        }\r\n    }\r\n\r\n    handlePaste(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        const target = e.target;\r\n        if (this.$(target).is(\"[data-word]\")) {\r\n            return;\r\n        }\r\n        let text = '';\r\n        if (e.clipboardData || e.originalEvent.clipboardData) {\r\n            text = (e.originalEvent || e).clipboardData.getData('Text');\r\n        } else if (this.$window.clipboardData) {\r\n            text = this.$window.clipboardData.getData('Text');\r\n        }\r\n        if (this.$window.document.queryCommandSupported('insertText')) {\r\n            this.$window.document.execCommand('insertText', false, text);\r\n        } else {\r\n            this.$window.document.execCommand('paste', false, text);\r\n        }\r\n    }\r\n\r\n    clickOnWord($node) {\r\n        // for better handling in webkit\r\n        const textNode = $node.contents().first()[0];\r\n        const anchorNode = this.$window.getSelection().anchorNode;\r\n        const position = this.caret.getCaretCharacterOffsetWithin(textNode);\r\n        if (anchorNode && position === 0) {\r\n            const text = $node.text().trim();\r\n            if (text.length > 0) {\r\n                const spacedText = this.$window.document.createTextNode(`\\u00A0${text}`);\r\n                this.$(textNode).replaceWith(spacedText);\r\n                this.caret.moveInText(1, spacedText);\r\n            }\r\n        }\r\n    }\r\n\r\n    getLast($node) {\r\n        const $last = $node.contents().last();\r\n        const $prev = $node;\r\n        if ($last[0] && ($last[0].nodeType === 3 || $last[0].hasAttribute(\"data-word\"))) {\r\n            return $last;\r\n        } else if (!$last[0]) {\r\n            return $prev;\r\n        }\r\n        return this.getLast($last);\r\n    }\r\n\r\n    removeEmptyLast($node) {\r\n        const $last = $node.contents().last();\r\n        let remove = false;\r\n        if ($last.is(\"br\")) {\r\n            remove = true;\r\n        } else if ($last[0] && $last[0].nodeType === 3) {\r\n            const value = $last[0].nodeValue.trim();\r\n            if (value.length < 1) {\r\n                remove = true;\r\n            }\r\n        }\r\n        if (remove) {\r\n            $last.remove();\r\n            this.removeEmptyLast(this.root);\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/text-colorizer/classes/Helper.js","import XRegExp from 'xregexp';\r\nimport WordNode from './WordNode';\r\n\r\n/**\r\n* Parser for parsing user text in text editor. Splits text into words and handles\r\n* changes in already dicovered words.\r\n* @constructor\r\n* @param {Object} $  Jquery selector for element in the component scope\r\n* @param {Service} $window  Angularjs '$window' service wrapper for window object\r\n* @param {Object} $root Juery selector for text editor\r\n* @param {Service} colorService 'colorService' service\r\n* @param {Words} words Words\r\n* @memberof module:text-colorizer\r\n*/\r\nclass Parser {\r\n\r\n    constructor($, $window, $root, colorService, words) {\r\n        this.$ = $;\r\n        this.$window = $window;\r\n        this.$root = $root;\r\n        this._colorService = colorService;\r\n        this._idCounter = 0;\r\n        this._words = words;\r\n        this._wordRegex = XRegExp(\"\\\\pL+(?:[-']?\\\\pL+)*\", 'gi');\r\n        this._wordFormatRegex = XRegExp(\"^(?:\\\\pL+(?:[-']?\\\\pL+)*)$\", 'i');\r\n    }\r\n\r\n    /** Parse text in text editor and splits it into separate words.\r\n    * There are two different nodes possible: raw text nodes and\r\n    * already processed (and eventually colorized) words.\r\n    * Raw text nodes will be splitted into separate words. Word nodes will be checked\r\n    * for changes. If the word node containes actually more than one word,\r\n    * it will be splitted in multiple word nodes with new ids.\r\n    * @method parse\r\n    * @memberof module:text-colorizer.Parser\r\n    * @instance\r\n    */\r\n    parse() {\r\n        this._parseElement(this.$root);\r\n    }\r\n\r\n    _createWordDOMNode(id, txt, backgroundColor, fontColor, cssClass) {\r\n        const element = this.$window.document.createElement(\"span\");\r\n        element.setAttribute(\"data-word\", id);\r\n        element.setAttribute(\"style\", `background-color: ${backgroundColor}; color: ${fontColor};`);\r\n        const textNode = this._createTextDOMNode(txt);\r\n        element.appendChild(textNode);\r\n        if (cssClass) {\r\n            element.setAttribute(\"class\", cssClass);\r\n        } else {\r\n            element.setAttribute(\"class\", \"unselected\");\r\n        }\r\n        return element;\r\n    }\r\n\r\n    _createTextDOMNode(text) {\r\n        return this.$window.document.createTextNode(text);\r\n    }\r\n\r\n    _parseElement(element) {\r\n        this.$(element).contents()\r\n        .each((i, node) => {\r\n            switch (node.nodeType) {\r\n                case 1:\r\n                    if (!node.hasAttribute(\"data-word\")) {\r\n                        this._parseElement(node);\r\n                    } else {\r\n                        this._analyzeWordElement(node);\r\n                    } break;\r\n                case 3: this._parseTextNode(node); break;\r\n                default: break;\r\n            }\r\n        });\r\n    }\r\n\r\n    _parseText(node, txt, callback) {\r\n        const DOMNodes = [];\r\n        let result = [];\r\n        let index = 0;\r\n        let textLength = 0;\r\n        while ((result = this._wordRegex.exec(txt)) !== null) {\r\n            const needle = result[0];\r\n            const currentIndex = result.index;\r\n            if (currentIndex - index + textLength > 1) {\r\n                const text = txt.substring(index + textLength, currentIndex);\r\n                const notWord = this._createTextDOMNode(text);\r\n                DOMNodes.push(notWord);\r\n            }\r\n            index = currentIndex;\r\n            textLength = needle.length;\r\n            const wordDOMNode = callback(needle);\r\n            DOMNodes.push(wordDOMNode);\r\n        }\r\n        if (index + textLength < txt.length) {\r\n            const text = txt.substring(index + textLength);\r\n            const notWord = this._createTextDOMNode(text);\r\n            DOMNodes.push(notWord);\r\n        }\r\n        if (DOMNodes.length > 0) {\r\n            this.$(node).replaceWith(DOMNodes);\r\n        }\r\n    }\r\n\r\n    _parseTextNode(node) {\r\n        this._parseText(node, node.nodeValue, (needle) => {\r\n            const id = this._idCounter++;\r\n            const domNode = this._createWordDOMNode(id, needle);\r\n            const wordNode = new WordNode(id, needle.toLowerCase(),\r\n            this._colorService.getColorInstance(), this.$(domNode));\r\n            this._words.addWordNode(wordNode);\r\n            return domNode;\r\n        });\r\n    }\r\n\r\n    _analyzeWordElement(element) {\r\n        const $word = this.$(element);\r\n        const id = parseInt($word.attr(\"data-word\"), 10);\r\n        const elementText = $word.text();\r\n        const text = elementText.trim();\r\n        const wordNode = this._words.getWordNode(id);\r\n        if (elementText.length > text.length) {\r\n            $word.text(text);\r\n        }\r\n        if (!text.match(this._wordFormatRegex) || wordNode.word.trim() !== text) {\r\n            const backgroundColor = $word.css(\"background-color\");\r\n            const cssClass = $word.attr('class');\r\n            const fontColor = $word.css(\"color\");\r\n            this._words.removeWordNode(id);\r\n            this._parseText($word, text, (needle) => {\r\n                const newId = this._idCounter++;\r\n                const domNode = this._createWordDOMNode(newId, needle,\r\n                                backgroundColor, fontColor, cssClass);\r\n                const newWordNode = new WordNode(newId, needle.toLowerCase(),\r\n                this._colorService.getColorInstance(wordNode.color), this.$(domNode));\r\n                this._words.addWordNode(newWordNode);\r\n                return domNode;\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nexport default Parser;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/text-colorizer/classes/Parser.js","/**\r\n* Represents a word node in the parsing tree. Contains DOM node\r\n* for fast access and modifications.\r\n* @constructor\r\n* @param {Number} id Id of the word node\r\n* @param {String} word Word\r\n* @param {Color} color Color\r\n* @param {Object} $domNode DOM node in jquery wrapper\r\n* @property {Number} id\r\n* @property {String} word\r\n* @property {HSLColor} color\r\n* @property {Object} $domNode\r\n* @memberof module:text-colorizer\r\n*/\r\n\r\nclass WordNode {\r\n    constructor(id, word, color, $domNode) {\r\n        this.id = id;\r\n        this.word = word;\r\n        this.color = color;\r\n        this.$domNode = $domNode;\r\n    }\r\n\r\n    /** Resets color object and style in dom node.\r\n    * @method resetColor\r\n    * @memberof module:text-colorizer.WordNode\r\n    * @instance\r\n    */\r\n    resetColor() {\r\n        this.color.reset();\r\n        this.$domNode.removeAttr(\"style\");\r\n        this.$domNode.removeClass();\r\n        this.$domNode.addClass(\"unselected\");\r\n    }\r\n\r\n    /** Set color\r\n    * @method setColor\r\n    * @param {Color} color Color object\r\n    * @param {Color} fontColor Color object with calculated color for font\r\n    * @memberof module:text-colorizer.WordNode\r\n    * @instance\r\n    */\r\n    setColor(color, fontColor) {\r\n        this.color.setColor(color);\r\n        this.$domNode.css({ \"background-color\": color.toString() });\r\n        this.$domNode.css({ color: fontColor });\r\n        this.$domNode.removeClass();\r\n        this.$domNode.addClass(\"selected\");\r\n        if (color.l > 97) {\r\n            this.$domNode.addClass(\"selected_white\");\r\n        }\r\n    }\r\n}\r\n\r\nexport default WordNode;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/text-colorizer/classes/WordNode.js","import slider from 'angularjs-slider';\nimport './scss/color-toolbar.scss';\nimport template from './template/color-toolbar.html';\n\n/**\n* @module color-toolbar\n* @requires module:angularjs-slider\n*/\nangular.module('color-toolbar', [slider])\n/**\n* Adjusting and vizualization of selected word color. Each color modification is \n* transfered to the main component through the 'colorModified' binding.\n* The word color selection in the main component is transfered\n* to the toolbar component through 'inputColor' binding.\n* @member {Component} colorToolbar\n* @memberof module:color-toolbar\n* @property {ColorToolbarCtrl} controller\n* @property {String} template\n* @property {Object} bindings {colorModified: '&', onClose: '&', closed: '<', inputColor: '<'}\n* @instance\n*/\n.component('colorToolbar', {\n    template,\n    bindings: {\n        colorModified: '&',\n        onClose: '&',\n        closed: '<',\n        inputColor: '<',\n    },\n    /**\n    * Controller for 'colorToolbar' component.\n    * @constructor ColorToolbarCtrl\n    * @param {Service} $scope Angularjs '$scope' service\n    * @param {Service} $timeout Angularjs '$timeout' service\n    * @param {Service} $element Angularjs '$element' service\n    * @param {Service} colorService 'colorService' service\n    * @param {Factory} calculateFontColor 'calculateFontColor' factory\n    * @see colorToolbar component\n    * @memberof module:color-toolbar\n    */\n    controller: class ColorToolbarCtrl {\n        static get $inject() {\n            return ['$scope', '$timeout', '$element', 'colorService', 'calculateFontColor'];\n        }\n        constructor($scope, $timeout, $element, colorService, calculateFontColor) {\n            this.$scope = $scope;\n            this.$element = $element;\n            this.$timeout = $timeout;\n            this._colorService = colorService;\n            this._calculateFontColor = calculateFontColor;\n            this.wordLinking = true;\n            this.colors = [];\n            for (let i = 0; i < 360; i += 30) {\n                const color = colorService.getColorInstance({ h: i, s: 80, l: 50 });\n                this.colors.push(color);\n            }\n            const black = colorService.getColorInstance({ h: 0, s: 0, l: 0 }).setAchromatic();\n            const white = colorService.getColorInstance({ h: 0, s: 0, l: 100 }).setAchromatic();\n            this.colors.push(black);\n            this.colors.push(white);\n            this.color = colorService.getColorInstance();\n            const self = this;\n            this.slider = {\n                value: 50,\n                options: {\n                    floor: 0,\n                    ceil: 100,\n                    step: 1,\n                    onChange() {\n                        self.colorModified({ color: self.color, linking: self.wordLinking });\n                    },\n                    onEnd() {\n                        self.colorModified({ color: self.color, linking: self.wordLinking });\n                    },\n                    hidePointerLabels: true,\n                    hideLimitLabels: true,\n                    disabled: true,\n                },\n            };\n        }\n\n        $onInit() {\n            if (this.closed === true) {\n                this.close();\n            }\n        }\n\n        $onChanges(changes) {\n            const color = changes.inputColor.currentValue;\n            if (color) {\n                this.setCurrentColor(color);\n                if (this.$element.hasClass(\"hide\")) {\n                    this.open();\n                }\n            }\n        }\n\n        /**\n        * @method increaseWeight\n        * @memberof module:color-toolbar.ColorToolbar\n        * @instance\n        */\n        increaseWeight() {\n            const self = this;\n            if (this.color && this.color.isSet() && this.color.weight < 100) {\n                this.color.weight ++;\n                this.colorModified({ color: self.color, linking: self.wordLinking });\n            }\n        }\n\n        /**\n        * @method decreaseWeight\n        * @memberof module:color-toolbar.ColorToolbar\n        * @instance\n        */\n        decreaseWeight() {\n            const self = this;\n            if (this.color && this.color.isSet() && this.color.weight > 1) {\n                self.color.weight --;\n                this.colorModified({ color: self.color, linking: self.wordLinking });\n            }\n        }\n\n        /**\n        * @method endSlide\n        * @memberof module:color-toolbar.ColorToolbar\n        * @instance\n        */\n        endSlide() {\n            const self = this;\n            this.colorModified({ color: self.color, linking: self.wordLinking });\n        }\n\n        /**\n        * @method linkingIconColor\n        * @memberof module:color-toolbar.ColorToolbar\n        * @instance\n        */\n        linkingIconColor() {\n            return this.color.isSet() ? this._calculateFontColor(this.color) : \"black\";\n        }\n\n        /**\n        * @method selectColor\n        * @param {Object} $event Angularjs $event object\n        * @memberof module:color-toolbar.ColorToolbar\n        * @instance\n        */\n        selectColor($event) {\n            const self = this;\n            const target = $event.target;\n            if (target.hasAttribute(\"data-toolbar-color\") || target.parentElement.hasAttribute(\"data-toolbar-color\")) {\n                $event.stopPropagation();\n                const colorElement = target.hasAttribute(\"data-toolbar-color\") ? target : target.parentElement;\n                const colorIndex = angular.element(colorElement).attr(\"data-toolbar-color\");\n                if (colorIndex && colorIndex !== \"null\") {\n                    const color = this._colorService.getColorInstance(this.colors[colorIndex]);\n                    this.changeColor(color);\n                    this.slider.options.disabled = this.color.isAchromatic();\n                } else {\n                    this.setInitialColor();\n                }\n                this.colorModified({ color: self.color, linking: self.wordLinking });\n            }\n        }\n\n        /**\n        * @method changecolor\n        * @memberof module:color-toolbar.ColorToolbar\n        * @instance\n        */\n        changeColor(color) {\n            color.weight = this.color.weight;\n            if (!color.isAchromatic() && !this.color.isAchromatic()\n                && this.color.s && this.color.l) {\n                color.s = this.color.s;\n                color.l = this.color.l;\n            }\n            this.color = color;\n        }\n\n        /**\n        * @method setCurrentColor\n        * @memberof module:color-toolbar.ColorToolbar\n        * @instance\n        */\n        setCurrentColor(color) {\n            if (color && color.isSet()) {\n                this.color = color;\n                this.slider.options.disabled = this.color.isAchromatic();\n            } else {\n                this.setInitialColor();\n            }\n        }\n\n        /**\n        * @method setInitialColor\n        * @memberof module:color-toolbar.ColorToolbar\n        * @instance\n        */\n        setInitialColor() {\n            this.color = this._colorService.getColorInstance();\n            this.slider.options.disabled = true;\n        }\n\n        /**\n        * @method close\n        * @memberof module:color-toolbar.ColorToolbar\n        * @instance\n        */\n        close() {\n            this.$element.addClass(\"hide\");\n            this.onClose();\n        }\n\n        /**\n        * @method open\n        * @memberof module:color-toolbar.ColorToolbar\n        * @instance\n        */\n        open() {\n            this.$element.removeClass(\"hide\");\n            this.$scope.$broadcast('rzSliderForceRender');\n        }\n    },\n});\n\nexport default 'color-toolbar';\n\n\n\n\n// WEBPACK FOOTER //\n// ./modules/color-toolbar/color-toolbar.js","module.exports = \"<div class=toolbar> <div class=toolbar__content> <div class=toolbar__left> <div class=toolbar__colorbox ng-click=$ctrl.selectColor($event)> <div ng-repeat=\\\"c in $ctrl.colors track by $index\\\"> <div class=toolbar__color data-toolbar-color={{$index}} ng-style=\\\"{'background-color': c}\\\"></div> </div> <div class=toolbar__color data-toolbar-color=null><span class=\\\"glyphicon glyphicon-remove toolbar__clear\\\"></span></div> <div style=clear:both></div> </div> </div> <div class=toolbar__center> <div class=toolbar__adjuster> <div class=toolbar__sliders ng-disabled=!$ctrl.color.isSet()> <div class=toolbar__sliders-content> <div class=toolbar__saturation-slider> <span class=\\\"glyphicon glyphicon-signal\\\"></span> <span>{{$ctrl.color.isSet() ? $ctrl.color.s : 0 }}%</span> <rzslider rz-slider-model=$ctrl.color.s rz-slider-options=$ctrl.slider.options></rzslider> </div> <div class=toolbar__lightness-slider> <span class=\\\"glyphicon glyphicon-adjust icon-flipped\\\"></span> <span>{{$ctrl.color.isSet() ? $ctrl.color.l : 0 }}%</span> <rzslider rz-slider-model=$ctrl.color.l rz-slider-options=$ctrl.slider.options></rzslider> </div> </div> </div> <div class=toolbar__weight> <div class=toolbar__weight-title>Weight</div> <div class=toolbar__weight-controls> <div class=\\\"toolbar__weight-buttons btn-group-vertical\\\" role=group> <a type=button class=\\\"btn btn-default btn-block btn-square toolbar__weight-button\\\" ng-click=$ctrl.increaseWeight()>+</a> <a type=button class=\\\"btn btn-default btn-block btn-square toolbar__weight-button\\\" ng-click=$ctrl.decreaseWeight()>-</a> </div> <div class=toolbar__weight-value>{{$ctrl.color.weight}}</div> </div> </div> </div> </div> <div class=toolbar__right> <div class=toolbar__selected> <div class=toolbar__selected-color ng-click=\\\"$ctrl.wordLinking = !$ctrl.wordLinking\\\" ng-style=\\\"{'background-color': $ctrl.color}\\\"><span ng-show=$ctrl.wordLinking class=\\\"toolbar__linking-icon glyphicon glyphicon-link\\\" ng-style=\\\"{color: $ctrl.linkingIconColor()}\\\"></span></div> <div class=toolbar__selected-background></div> </div> <div class=toolbar__close ng-click=$ctrl.close()> <span class=\\\"glyphicon glyphicon-menu-up toolbar__close-icon\\\"></span> </div> </div> </div> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./modules/color-toolbar/template/color-toolbar.html\n// module id = 147\n// module chunks = 0","import scroll from 'ng-infinite-scroll';\nimport 'ng-error';\nimport 'ng-load';\nimport './scss/image-finder.scss';\nimport template from './template/image-finder.html';\nimport Images from './classes/Images';\nimport ImagesRPCService from './classes/ImagesRPCService';\nimport ImageInspector from './classes/ImageInspector';\nimport { imageViewerCompName, imageViewerComp } from \"./image-viewer/image-viewer\";\n\n/**\n* Module for image search and result representation.\n* Uses 'jsonrpc' module for server connection and scrolling module\n* for the on-scroll lazy loading of images.\n* @module image-finder\n* @requires module:jsonrpc\n* @requires module:ng-infinite-scroll\n* @requires module:ng-error\n* @requires module:ng-load\n*/\nangular.module('image-finder', ['jsonrpc', scroll, 'ngError', 'ngLoad'])\n/** Images model.\n* @member {Service} images\n* @memberof module:image-finder\n* @see Images class\n* @instance\n*/\n.service('images', ['jsonrpc', 'login', function (jsonrpc, login) {\n    return new Images(new ImagesRPCService(jsonrpc, login));\n}])\n/** Image inspector model.\n* @member {Service} imageInspector\n* @memberof module:image-finder\n* @see ImageInspector class\n* @instance\n*/\n.service('imageInspector', ['$window', '$document', 'images', function ($window, $document, images) {\n    return new ImageInspector($window, $document, images);\n}])\n/** Component for image detailed view.\n* @member {Component} imageViewer\n* @property {ImageViewerCtrl} controller\n* @property {String} template\n* @property {Object} bindings {image: '<', onClose: '&', onImagesUpdated: '&'}\n* @memberof module:image-finder\n* @instance\n*/\n.component(imageViewerCompName, imageViewerComp)\n/** Main component of the module.\n* Searches for images and represents the search results.\n* @member {Component} imageFinder\n* @property {ImageFinderCtrl} controller\n* @property {String} template\n* @property {Object} bindings {onImagesFound: '&', search: '<'}\n* @memberof module:image-finder\n* @instance\n*/\n.component('imageFinder', {\n    template,\n    bindings: {\n        onImagesFound: '&',\n        search: '<',\n    },\n    /**\n    * Controller for 'imageFinder' component.\n    * @constructor ImageFinderCtrl\n    * @param {Service} $document Angularjs '$document'\n    * @param {Service} images 'images' service\n    * @param {Service} imageInspector 'imageInspectro' service\n    * @param {Service} usSpinnerService 'usSpinnerService' service\n    * @see imageFinder component\n    * @memberof module:image-finder\n    */\n    controller: class ImageFinderCtrl {\n        static get $inject() {\n            return ['$document', 'images', 'imageInspector', 'usSpinnerService'];\n        }\n\n        constructor($document, images, imageInspector, spinner) {\n            this.$document = $document;\n            this._imageInspector = imageInspector;\n            this._spinner = spinner;\n            this._step = 10;\n            this._images = images;\n            this._findPending = false;\n            this.selectedImage = null;\n            this.imagesToShow = [];\n        }\n\n        /** Component hook method\n        * @method $onInit\n        * @memberof module:image-finder.ImageFinderCtrl\n        * @instance\n        */\n        $onInit() {\n            this.imagesToShow = this._images.getImagesInInterval(0, this._images.showIndex);\n        }\n\n        /** Component hook method\n        * @method $onChanges\n        * @param {Object} changes\n        * @memberof module:image-finder.ImageFinderCtrl\n        * @instance\n        */\n        $onChanges(changes) {\n            const search = changes.search.currentValue;\n            if (search && !this._findPending) {\n                this.imagesToShow.length = 0;\n                const wordsAndColors = search.words;\n                const settings = search.settings;\n                if (settings && wordsAndColors) {\n                    this._findPending = true;\n                    this._spinner.spin('spinner-1');\n                    this._images.findImages(wordsAndColors, settings, () => {\n                        this._findPending = false;\n                        this._spinner.stop('spinner-1');\n                        this.imagesToShow = this._images.getImagesInInterval(0, this._step);\n                        this._images.showIndex = this._step;\n                        this.onImagesFound({\n                            images: this._images.getImagesArray(),\n                        });\n                    });\n                }\n            }\n        }\n\n        /**\n        * @method checkForImageFailure\n        * @param {Image} img\n        * @param {Object} imgNode Image DOM node\n        * @memberof module:image-finder.ImageFinderCtrl\n        * @instance\n        */\n        checkForImageFailure(img, imgNode) {\n            this._images.checkForImageFailure(img, (failure) => {\n                if (failure) {\n                    this._images.removeImage(img);\n                    angular.element(imgNode).remove();\n                    this.showMore();\n                }\n            });\n        }\n\n        /** Event handler\n        * @method  thumbnailLoaded\n        * @param {Object} $event Angularjs '$event'\n        * @param {Image} img\n        * @memberof module:image-finder.ImageFinderCtrl\n        * @instance\n        */\n        thumbnailLoaded($event, img) {\n            this._imageInspector.inspect(img, $event.target,\n            this.checkForImageFailure.bind(this));\n        }\n\n        /** Event handler\n        * @method thumbnailLoadingError\n        * @param {Object} $event Angularjs '$event'\n        * @param {Image} img\n        * @memberof module:image-finder.ImageFinderCtrl\n        * @instance\n        */\n        thumbnailLoadingError($event, img) {\n            this.checkForImageFailure(img, $event.target);\n        }\n\n         /** Show more images on scroll.\n        * @method showMore\n        * @memberof module:image-finder.ImageFinderCtrl\n        * @instance\n        */\n        showMore() {\n            this.imagesToShow = this.imagesToShow\n            .concat(this._images.getImagesInInterval(this._images.showIndex, this._images.showIndex + this._step));\n            this._images.showIndex += this._step;\n        }\n\n        /** Selects current image. A change of current\n        * image will be propagated to the 'imageViewer'\n        *  component through bindings. Thus a selected\n        * image will be shown in detailed view.\n        * @method selectImage\n        * @param {Object} $event Angularjs '$event'\n        * @memberof module:image-finder.ImageFinderCtrl\n        * @instance\n        */\n        selectImage($event) {\n            const target = $event.target;\n            if (target.hasAttribute('imagefinder-image') ||\n            angular.element(target).parent()[0].hasAttribute('imagefinder-image')) {\n                $event.stopPropagation();\n                const id = (target.hasAttribute('imagefinder-image')) ?\n                            angular.element(target).attr('imagefinder-image') :\n                            angular.element(target).parent().attr('imagefinder-image');\n                this.selectedImage = this._images.getImage(id);\n            }\n        }\n\n        /** Invoked if the result set was updated, for example if some\n        * images were removed.\n        * @method imagesUpdated\n        * @memberof module:image-finder.ImageFinderCtrl\n        * @instance\n        */\n        imagesUpdated() {\n            this.imagesToShow = this._images.getImagesInInterval(0, this._images.showIndex);\n        }\n    },\n});\n\nexport default 'image-finder';\n\n\n\n// WEBPACK FOOTER //\n// ./modules/image-finder/image-finder.js","module.exports = \"<div class=image-finder> <div class=image-finder__container> <div ng-click=$ctrl.selectImage($event) class=image-finder__images infinite-scroll=$ctrl.showMore() infinite-scroll-distance=0> <div ng-repeat=\\\"img in $ctrl.imagesToShow track by img.id\\\"> <img imagefinder-image={{img.id}} ng-src={{img.previewURL}} class=image-finder__image ng-error=\\\"$ctrl.thumbnailLoadingError($event, img)\\\" ng-load=\\\"$ctrl.thumbnailLoaded($event, img)\\\"> </div> </div> </div> <image-viewer ng-show=$ctrl.selectedImage image=$ctrl.selectedImage on-images-updated=$ctrl.imagesUpdated() on-close=\\\"$ctrl.selectedImage = null\\\"></image-viewer> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./modules/image-finder/template/image-finder.html\n// module id = 152\n// module chunks = 0","import Image from \"./Image\";\r\n\r\n/**\r\n* Images model class.\r\n* Manages images and requests server with the help of 'ImagesRPCService'.\r\n* @constructor:\r\n* @param {ImagesRPCService} service 'ImagesRPCService' instance\r\n* @memberof module:image-finder\r\n*/\r\nclass Images {\r\n\r\n    constructor(service) {\r\n        this.images = [];\r\n        this.service = service;\r\n        this.showIndex = 0;\r\n    }\r\n\r\n    /** Creates new image and adds it to the result set.\r\n    * @method addImage\r\n    * @param {Object} o Object that contains data for image creation\r\n    * @memberof module:image-finder.Images\r\n    * @instance\r\n    */\r\n    addImage(o) {\r\n        const img = new Image(o);\r\n        this.images.push(img);\r\n    }\r\n\r\n    /** Removes image from result set.\r\n    * @method removeImage\r\n    * @param {Image} image Image object\r\n    * @memberof module:image-finder.Images\r\n    * @instance\r\n    */\r\n    removeImage(image) {\r\n        for (let i = 0; i < this.images.length; i++) {\r\n            if (this.images[i].id == image.id) {\r\n                this.images.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    /** Returns image by id.\r\n    * @method getImage\r\n    * @param {Number} id Image id\r\n    * @return {Image}\r\n    * @memberof module:image-finder.Images\r\n    * @instance\r\n    */\r\n    getImage(id) {\r\n        let image = null;\r\n        for (let i = 0, k = this.images.length; i < k; i++) {\r\n            if (this.images[i].id == id) {\r\n                image = this.images[i];\r\n                break;\r\n            }\r\n        }\r\n        return image;\r\n    }\r\n\r\n    /** Returns all images (result set) as array.\r\n    * @method getImagesArray\r\n    * @return {Image[]}\r\n    * @memberof module:image-finder.Images\r\n    * @instance\r\n    */\r\n    getImagesArray() {\r\n        return this.images;\r\n    }\r\n\r\n    /** Number of images in result set.\r\n    * @method count\r\n    * @return {Number}\r\n    * @memberof module:image-finder.Images\r\n    * @instance\r\n    */\r\n    count() {\r\n        return this.images.length;\r\n    }\r\n\r\n    /** Returns images from result set in given interval.\r\n    * @method getImagesInInterval\r\n    * @param {Number} start Start index\r\n    * @param {Number} end End index\r\n    * @return {Image[]}\r\n    * @memberof module:image-finder.Images\r\n    * @instance\r\n    */\r\n    getImagesInInterval(start, end) {\r\n        if (start >= 0 && start < this.images.length) {\r\n            if (end > this.images.length) {\r\n                end = this.images.length;\r\n            }\r\n            return this.images.slice(start, end);\r\n        }\r\n        return [];\r\n    }\r\n\r\n    /** Deletes all images from result set.\r\n    * @method empty\r\n    * @memberof module:image-finder.Images\r\n    * @instance\r\n    */\r\n    empty() {\r\n        this.images.length = 0;\r\n    }\r\n\r\n    /** Checks if the image is faulty.\r\n    * @method checkForImageFailure\r\n    * @param {Image} img Image to check\r\n    * @param {Function} callback Callback function (optional).\r\n    * @memberof module:image-finder.Images\r\n    * @instance\r\n    */\r\n    checkForImageFailure(img, callback) {\r\n        this.service.checkForImageFailure(img, callback);\r\n    }\r\n\r\n    /** Search for images.\r\n    * @method findImages\r\n    * @param {Object} data Colors and words.\r\n    * @param {Service} searchSettings Search settings model.\r\n    * @param {Function} callback Callback function.\r\n    * @memberof module:image-finder.Images\r\n    * @instance\r\n    */\r\n    findImages(data, searchSettings, callback) {\r\n        this.empty();\r\n        this.service.findImages(this, data, searchSettings, callback);\r\n    }\r\n}\r\n\r\nexport default Images;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/image-finder/classes/Images.js","/**\r\n* Represents image.\r\n* @constructor\r\n* @param {Object} conf Configuration object with image data\r\n* @property {Number} id\r\n* @property {String} url\r\n* @property {String} previewURL\r\n* @property {Number} score\r\n* @property {String} source\r\n* @property {String} title\r\n* @property {String} owner\r\n* @memberof module:image-finder\r\n*/\r\nclass Image {\r\n    constructor(conf) {\r\n        this.id = conf.id;\r\n        this.url = conf.url;\r\n        this.previewURL = conf.previewURL;\r\n        this.originalURL = conf.originalURL;\r\n        this.score = parseFloat(conf.score).toFixed(2);\r\n        this.source = conf.source;\r\n        this.title = conf.title || \"unknown\";\r\n        this.owner = conf.owner || \"unknown\";\r\n    }\r\n}\r\n\r\nexport default Image;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/image-finder/classes/Image.js","/**\r\n* Sends requests to the server using JsonRPC service.\r\n* Uses Login service for client-server authentication.\r\n* @constructor\r\n* @param {Service} jsonrpc - 'jsonrpc' service\r\n* @param {Service} login - 'login' service\r\n* @memberof module:image-finder\r\n*/\r\nclass ImagesRPCService {\r\n\r\n    constructor(jsonrpc, login) {\r\n        this.jsonrpc = jsonrpc;\r\n        this.login = login;\r\n    }\r\n\r\n    /** Check image for failure. Sends request to the server.\r\n    * @method checkForImageFailure\r\n    * @param {Image} img Object that contains data for image creation\r\n    * @param {Function} callback (optional) Callback function\r\n    * @memberof module:image-finder.ImagesRPCService\r\n    * @instance\r\n    */\r\n    checkForImageFailure(img, callback) {\r\n        this.jsonrpc.request('checkImage', { image: img })\r\n        .then((failure) => {\r\n            if (callback) {\r\n                callback(failure);\r\n            }\r\n        })\r\n        .catch((error) => {\r\n            console.error(error);\r\n        });\r\n    }\r\n\r\n    /** Searching for similar images. Sends request to the server.\r\n    * @method findImages\r\n    * @param {Images} images Images model\r\n    * @param {Object} data Object with data for search {colors: HSLImage[], words: string[]}\r\n    * @param {Settings} searchSettings Settings model\r\n    * @param {Function} callback Callback function\r\n    * @memberof module:image-finder.ImagesRPCService\r\n    * @instance\r\n    */\r\n    findImages(images, data, searchSettings, callback) {\r\n        const self = this;\r\n        this.jsonrpc.request('find', { colors: data.colors, words: data.words, settings: searchSettings.serialize(), auth: self.login.auth })\r\n        .then((result) => {\r\n            if (result && result.imgs && result.imgs.length > 0) {\r\n                images.empty();\r\n                for (let i = 0; i < result.imgs.length; i++) {\r\n                    images.addImage(result.imgs[i]);\r\n                }\r\n            }\r\n            result = null;\r\n            if (callback) {\r\n                callback();\r\n            }\r\n        })\r\n        .catch((error) => {\r\n            console.error(error);\r\n            if (callback) {\r\n                callback();\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nexport default ImagesRPCService;\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/image-finder/classes/ImagesRPCService.js","/**\r\n* Inspects flickr images and decides if an image could be faulty.\r\n* Calls user callback if the image is suspicious.\r\n* @constructor FlickrInspectingStrategy\r\n* @memberof module:image-finder\r\n*/\r\nclass FlickrInspectingStrategy {\r\n\r\n    constructor() {\r\n        this._errorWidth = [320, 500];\r\n        this._errorHeight = [240, 374];\r\n    }\r\n\r\n    /** Inspects one element and call callback function if\r\n    * image tend to be faulty.\r\n    * @method inspect\r\n    * @param {Object} elem {imageNode: DOMnode, image: Image, callback: Function}\r\n    * @memberof module:image-finder.FlickrInspectingStrategy\r\n    * @instance\r\n    */\r\n    inspect(elem) {\r\n        const width = elem.imageNode.naturalWidth;\r\n        const height = elem.imageNode.naturalHeight;\r\n        if ((width === this._errorWidth[0] && height === this._errorHeight[0]) ||\r\n            (width === this._errorWidth[1] && height === this._errorHeight[1])) {\r\n            if (elem.callback) {\r\n                elem.callback(elem.image, elem.imageNode);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n* Batch for loaded images, which must be inspected.\r\n* @constructor InspectingBatch\r\n* @param {$window} $window Angularjs '$window' service\r\n* @param {$document} $document Angularjs '$document' service\r\n* @param {Map} strategies HashMap with inspecting strategies\r\n* @param {number} portion Portion of images which will be inspected in one step\r\n* @memberof module:image-finder\r\n*/\r\nclass InspectingBatch {\r\n\r\n    constructor($window, $document, strategies, portion) {\r\n        this._imagesToInspect = [];\r\n        this._strategies = strategies;\r\n        this._portion = portion;\r\n        this.$window = $window;\r\n        setInterval(this._inspect.bind(this), 500);\r\n    }\r\n\r\n    /** Size of the batch\r\n    * @method size\r\n    * @return {Number}\r\n    * @memberof module:image-finder.InspectingBatch\r\n    * @instance\r\n    */\r\n    size() {\r\n        return this._imagesToInspect.length;\r\n    }\r\n\r\n    /** Adds one element into batch.\r\n    * @method add\r\n    * @param {Object} element {imageNode: DOMnode, image: Image, callback: Function}\r\n    * @memberof module:image-finder.InspectingBatch\r\n    * @instance\r\n    */\r\n    add(element) {\r\n        this._imagesToInspect.push(element);\r\n    }\r\n\r\n    _inspect() {\r\n        const list = this._imagesToInspect.splice(0, this._portion);\r\n        for (const elem of list) {\r\n            const strategy = this._strategies.get(elem.image.source);\r\n            if (strategy) {\r\n                strategy.inspect(elem);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n* Inspects images for failure\r\n* @constructor\r\n* @param {$window} $window Angularjs '$window' service\r\n* @param {$document} $document Angularjs '$document' service\r\n* @memberof module:image-finder\r\n*/\r\nclass ImageInspector {\r\n\r\n    constructor($window, $document) {\r\n        const strategies = new Map()\r\n        .set(\"flickr\", new FlickrInspectingStrategy());\r\n        this.batch = new InspectingBatch($window, $document, strategies, 20);\r\n    }\r\n\r\n    /** Add element for inspection.\r\n    * @method inspect\r\n    * @param {Image} image Image object\r\n    * @param {Object} imageNode Image DOM node\r\n    * @param {function} callback Callback function will be called, if image tend to be faulty.\r\n    * @memberof module:image-finder.ImageInspector\r\n    * @instance\r\n    */\r\n    inspect(image, imageNode, callback) {\r\n        this.batch.add({ image, imageNode, callback });\r\n    }\r\n}\r\n\r\nexport default ImageInspector;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/image-finder/classes/ImageInspector.js","import './scss/image-viewer.scss';\r\nimport template from './template/image-viewer.html';\r\n\r\nexport const imageViewerCompName = 'imageViewer';\r\nexport const imageViewerComp = {\r\n    template,\r\n    bindings: {\r\n        image: '<',\r\n        onClose: '&',\r\n        onImagesUpdated: '&',\r\n    },\r\n    controller: class ImageViewerCtrl {\r\n\r\n        static get $inject() {\r\n            return ['$scope', '$window', '$element', '$timeout', '$document', 'imageInspector', 'images', 'usSpinnerService'];\r\n        }\r\n\r\n        constructor($scope, $window, $element, $timeout, $document, imageInspector, images, spinner) {\r\n            this.$scope = $scope;\r\n            this.$window = $window;\r\n            this.$element = $element;\r\n            this.$timeout = $timeout;\r\n            this._imageInspector = imageInspector;\r\n            this._spinner = spinner;\r\n            this._images = images;\r\n            this._canvas = $document[0].createElement('canvas');\r\n            this._canvasContext = this._canvas.getContext(\"2d\");\r\n            this._imageDownload = $element.find(\".image-viewer__download\")[0];\r\n        }\r\n\r\n        $onChanges(changes) {\r\n            this.selectedImage = angular.copy(changes.image.currentValue);\r\n            if (this.selectedImage) {\r\n                this._spinner.spin('spinner-1');\r\n                angular.element('body').addClass('stop-scrolling');\r\n            }\r\n        }\r\n\r\n        $postLink() {\r\n            this.$window.addEventListener('keydown', (event) => {\r\n                if (this.selectedImage && event.keyCode === 27) {\r\n                    this.close(event);\r\n                    this.$scope.$apply();\r\n                }\r\n            });\r\n        }\r\n\r\n        getScore() {\r\n            if (this.selectedImage) {\r\n                return parseFloat(this.selectedImage.score * 100).toFixed(2);\r\n            }\r\n            return null;\r\n        }\r\n\r\n        originalURL() {\r\n            this.$window.open(this.selectedImage.originalURL);\r\n        }\r\n\r\n        loaded($event, img) {\r\n            this._spinner.stop('spinner-1');\r\n            const imageNode = $event.target;\r\n            this._imageInspector.inspect(img, $event.target,\r\n                this._images.checkForImageFailure(img, (failure) => {\r\n                    if (failure) {\r\n                        this._images.removeImage(img);\r\n                        angular.element('body').removeClass('stop-scrolling');\r\n                        this.selectedImage = null;\r\n                        this.onClose();\r\n                        this.onImagesUpdated();\r\n                    }\r\n            }));\r\n        }\r\n\r\n        loadingError(image) {\r\n            this._spinner.stop('spinner-1');\r\n            this._images.checkForImageFailure(image);\r\n            this._images.removeImage(image);\r\n            angular.element('body').removeClass('stop-scrolling');\r\n            this.selectedImage = null;\r\n            this.onClose();\r\n            this.onImagesUpdated();\r\n        }\r\n\r\n        save() {\r\n            this._canvasContext.clearRect(0, 0, this._canvas.width, this._canvas.height);\r\n            this._imageDownload.href = \"\";\r\n            this._imageDownload.download = \"\";\r\n            if (this.selectedImage) {\r\n                const image = new Image();\r\n                image.crossOrigin = \"anonymous\";\r\n                image.onload = () => {\r\n                    this._canvas.width = image.naturalWidth;\r\n                    this._canvas.height = image.naturalHeight;\r\n                    let url = null;\r\n                    try {\r\n                        this._canvasContext.drawImage(image, 0, 0);\r\n                        if (image.src.indexOf(\".jpg\") > -1) {\r\n                            url = this._canvas.toDataURL(\"image/jpeg\");\r\n                        } else if (image.src.indexOf(\".gif\") > -1) {\r\n                            url = this._canvas.toDataURL(\"image/gif\");\r\n                        } else {\r\n                            url = this._canvas.toDataURL(\"image/png\");\r\n                        }\r\n                    } catch (e) {\r\n                        console.error(e);\r\n                    }\r\n                    if (url) {\r\n                        this._imageDownload.href = url;\r\n                        this._imageDownload.download = image.src.split(/(\\\\|\\/)/g).pop();\r\n                        this.$timeout(() => {\r\n                            this._imageDownload.click();\r\n                        }, 100, false);\r\n                    }\r\n                };\r\n                image.onerror = (e) => {\r\n                    console.log(e);\r\n                    const win = this.$window.open(this.selectedImage.url, '_blank');\r\n                    win ? win.focus() : null;\r\n                };\r\n                image.src = this.selectedImage.url;\r\n            }\r\n        }\r\n\r\n        close($event) {\r\n            const target = $event.target;\r\n            if (target.hasAttribute(\"imageviewer-close\") || $event.keyCode === 27) {\r\n                $event.stopPropagation();\r\n                this._spinner.stop('spinner-1');\r\n                angular.element('body').removeClass('stop-scrolling');\r\n                this.selectedImage = null;\r\n                this._canvasContext.clearRect(0, 0, this._canvas.width, this._canvas.height);\r\n                this._imageDownload.href = \"\";\r\n                this._imageDownload.download = \"\";\r\n                this.onClose();\r\n            }\r\n        }\r\n    },\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/image-finder/image-viewer/image-viewer.js","module.exports = \"<div class=image-viewer> <div class=image-viewer__topline> <div class=image-viewer__topline-main> <div class=image-viewer__topline-content> <a class=image-viewer__original target=_blank href={{$ctrl.selectedImage.originalURL}}>Original</a> <span class=image-viewer__separator></span> <span class=image-viewer__score>{{$ctrl.getScore()}}%</span> <span class=image-viewer__separator></span> <a class=image-viewer__save ng-click=$ctrl.save()> <span class=\\\"glyphicon glyphicon-floppy-save image-viewer__save-icon\\\"></span> </a> <div ng-click=$ctrl.close($event) class=image-viewer__close-button imageviewer-close> <span class=\\\"glyphicon glyphicon-remove image-viewer__close-icon\\\" aria-hidden=true imageviewer-close></span> </div> </div> </div> <div class=image-viewer__info> <div class=image-viewer__attribution> <div class=image-viewer__title>{{$ctrl.selectedImage.title}}</div> <div>by</div> <div class=image-viewer__owner>{{$ctrl.selectedImage.owner}}</div> </div> </div> </div> <div class=image-viewer__image-container ng-click=$ctrl.close($event) imageviewer-close> <img class=image-viewer__image src={{$ctrl.selectedImage.url}} ng-load=\\\"$ctrl.loaded($event, $ctrl.selectedImage)\\\" ng-error=$ctrl.loadingError($ctrl.selectedImage)> <a class=image-viewer__download></a> </div> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./modules/image-finder/image-viewer/template/image-viewer.html\n// module id = 159\n// module chunks = 0","import './scss/settings.scss';\r\nimport template from './template/settings.html';\r\n\r\n/**\r\n* @module settings\r\n*/\r\nangular.module('settings', [])\r\n\r\n/** Settings component which is responsible for visualization\r\n* of app (search) settings.\r\n* @member {Component} settings\r\n* @property {SettingsCtrl} controller\r\n* @property {String} template\r\n* @memberof module:settings\r\n* @instance\r\n*/\r\n.component('settings', {\r\n    template,\r\n\r\n    /**\r\n    * Controller class of 'settings' component\r\n    * @constructor SettingsCtrl\r\n    * @param {Service} $scope Angularjs '$scope' service\r\n    * @param {Service} appSettings 'appSettings' service\r\n    * @see settings component\r\n    * @memberof module:settings\r\n    */\r\n    controller: class SettingsCtrl {\r\n        static get $inject() {\r\n            return ['$scope', 'appSettings'];\r\n        }\r\n        constructor($scope, settings) {\r\n            const self = this;\r\n            this.$scope = $scope;\r\n            this._settingsOldState = Object.values(settings.serialize()).join();\r\n            this.settings = settings;\r\n            this.similarityLevel = settings.similarityLevel;\r\n            this.slider = {\r\n                value: 50,\r\n                options: {\r\n                    floor: 50,\r\n                    ceil: 100,\r\n                    step: 1,\r\n                    onChange: () => {},\r\n                    onEnd: () => {\r\n                        self.settings.similarityLevel = self.similarityLevel;\r\n                    },\r\n                    hidePointerLabels: true,\r\n                    hideLimitLabels: true,\r\n                    disabled: false,\r\n                },\r\n            };\r\n        }\r\n\r\n        $doCheck() {\r\n            const state = Object.values(this.settings.serialize()).join();\r\n            if (state !== this._settingsOldState) {\r\n                this._settingsOldState = state;\r\n                this.similarityLevel = this.settings.similarityLevel;\r\n                this.settings.save(() => {\r\n                }, (e) => {\r\n                    console.log(e);\r\n                });\r\n            }\r\n        }\r\n\r\n        $onInit() {\r\n            this.settings.load(() => {\r\n                this.similarityLevel = this.settings.similarityLevel;\r\n            }, (e) => {\r\n                console.log(e);\r\n            });\r\n        }\r\n    },\r\n});\r\n\r\nexport default 'settings';\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/settings/settings.js","module.exports = \"<div class=settings> <div class=checkbox> <label> <input ng-model=$ctrl.settings.checkSemanticSimilarity type=checkbox>Analyze semantics (experimental) </label> </div> <div> <div class=radio> <label> <input type=radio name=optionsRadios ng-model=$ctrl.settings.searchMode value=regular checked=checked>Regular search (fast) </label> </div> <div class=radio> <label> <input type=radio name=optionsRadios ng-model=$ctrl.settings.searchMode value=special>Special search (slow) </label> </div> </div> <div ng-class=\\\"$ctrl.settings.searchMode == 'special' ? 'settings__special-search_show' : 'settings__special-search_hide'\\\"> <select ng-model=$ctrl.settings.distance> <option ng-repeat=\\\"distance in $ctrl.settings.supportedDistances track by $index\\\" data-distances-distance={{$index}} value={{distance.id}}>{{distance.name}}</option> </select> <div class=settings__similarity-level> <div>Similarity level: <span>{{$ctrl.similarityLevel}}%</span></div> <rzslider rz-slider-model=$ctrl.similarityLevel rz-slider-options=$ctrl.slider.options></rzslider> </div> </div> </div> \";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./modules/settings/template/settings.html\n// module id = 167\n// module chunks = 0","import './scss/guide.scss';\r\nimport template from './template/guide.html';\r\n\r\n/**\r\n* Module \r\n* @module guide\r\n*/\r\nangular.module('guide', [])\r\n/** Guide component. Represents a 'guide' page in the web application.\r\n* @member {Component} guide\r\n* @property {String} template\r\n* @memberof module:guide\r\n* @instance\r\n*/\r\n.component('guide', {\r\n    template,\r\n});\r\n\r\nexport default 'guide';\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/guide/guide.js","module.exports = \"<div class=guide> <div class=guide__content> <p class=guide__title>This application allows you to find images by color!</p> <p>1. Write your text in the editor on main page</p> <p>2. Color your text with the color tool bar</p> <p>3. Set your desired search settings (optional)</p> <p class=guide__search-settings><span class=\\\"glyphicon glyphicon-triangle-right\\\"></span> The experimental feature for semantic similarity calculates the semantic similarity rank for each similar image and sorts the result set by this value. You can perform a specific search by choosing a desired similarity level and distance function. <br><span class=\\\"glyphicon glyphicon-triangle-right\\\"></span> You can create and manage multiple color profiles. Contents of the existing color profiles can be inspected in the \\\"Archive\\\" section.</p> <p>4. Search!</p> </div> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./modules/guide/template/guide.html\n// module id = 170\n// module chunks = 0","import scroll from 'ng-infinite-scroll';\r\nimport ColorProfiles from \"./classes/ColorProfiles\";\r\nimport { colorProfilesCompName, colorProfilesComp } from \"./color-profiles/color-profiles\";\r\nimport { profilesViewerCompName, profilesViewerComp } from \"./profiles-viewer/profiles-viewer\";\r\n\r\n/**\r\n* Module for color profiles\r\n* @module profiles\r\n* @requires module:ng-infinite-scroll\r\n*/\r\nangular.module('profiles', [scroll])\r\n/** Color profiles model.\r\n* @member {Service} colorProfiles\r\n* @memberof module:profiles\r\n* @see ColorProfiles class\r\n* @instance\r\n*/\r\n.service('colorProfiles', ['db', 'colorService', function (dbService, colorService) {\r\n    return new ColorProfiles(dbService, colorService);\r\n}])\r\n/** Color profiles component. Used to create, update and load of color profiles.\r\n* @member {Component} colorProfiles\r\n* @property {ColorProfilesCtrl} controller\r\n* @property {String} template\r\n* @memberof module:profiles\r\n* @instance\r\n*/\r\n.component(colorProfilesCompName, colorProfilesComp)\r\n/** Color profiles viewer component. Shows color profiles\r\n* which are saved in client database.\r\n* @member {Component} profilesViewer\r\n* @property {ProfilesViewerCtrl} controller\r\n* @property {String} template\r\n* @memberof module:profiles\r\n* @instance\r\n*/\r\n.component(profilesViewerCompName, profilesViewerComp);\r\n\r\nexport default 'profiles';\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/profiles/profiles.js","import ColorProfile from \"./ColorProfile\";\r\nimport ColorProfilesDAO from \"./ColorProfilesDAO\";\r\n\r\n/**\r\n* Saves, loads and updates color profiles.\r\n* @constructor\r\n* @param {Service} dbService - 'db' service\r\n* @param {Service} colorService - 'colorService' service\r\n* @memberof module:profiles\r\n*/\r\nclass ColorProfiles {\r\n\r\n    constructor(dbService, colorService) {\r\n        this.profileNames = [];\r\n        this.loadedProfile = null;\r\n        this.dao = new ColorProfilesDAO(dbService, colorService);\r\n    }\r\n\r\n    /** Loads all existing color profile names while initialization\r\n    * and sets the first one as a current color profile.\r\n    * @method init\r\n    * @memberof module:profiles.ColorProfiles\r\n    * @instance\r\n    */\r\n    init(callback) {\r\n        this.loadColorProfileNames(() => {\r\n            this.loadColorProfile(this.profileNames[0], () => {\r\n                callback();\r\n            });\r\n        });\r\n    }\r\n\r\n    /** Creates new color profile.\r\n    * @method createColorProfile\r\n    * @param {String} name Name of color profile\r\n    * @param {Map} colors Word-to-Color HashMap\r\n    * @param {Number} sPercentage Saturation settings\r\n    * @param {Number} lPercentage Lightness settings\r\n    * @param {Function} callback Callback function\r\n    * @memberof module:profiles.ColorProfiles\r\n    * @instance\r\n    */\r\n    createColorProfile(name, colors, sPercentage, lPercentage, callback) {\r\n        const profile = new ColorProfile(name, colors, sPercentage, lPercentage);\r\n        this.dao.saveColorProfile(profile, this, callback);\r\n    }\r\n\r\n    /** Loads and sets color profile from database.\r\n    * @method loadColorProfile\r\n    * @param {String} name Name of color profile\r\n    * @param {Function} callback Callback function\r\n    * @memberof module:profiles.ColorProfiles\r\n    * @instance\r\n    */\r\n    loadColorProfile(name, callback) {\r\n        this.dao.loadColorProfile(name, (profile) => {\r\n            this.loadedProfile = profile;\r\n            if (callback) {\r\n                callback();\r\n            }\r\n        });\r\n    }\r\n\r\n    /** Loads and returns color profile from database by name.\r\n    * @method getColorProfile\r\n    * @param {String} name Name of color profile\r\n    * @param {Function} callback Callback function\r\n    * @memberof module:profiles.ColorProfiles\r\n    * @instance\r\n    */\r\n    getColorProfile(name, callback) {\r\n        if (name) {\r\n            this.dao.loadColorProfile(name, (profile) => {\r\n                callback(profile);\r\n            });\r\n        }\r\n    }\r\n\r\n    /** Loads all existing color profile names from client database.\r\n    * @method loadColorProfileNames\r\n    * @param {Function} callback Callback function\r\n    * @memberof module:profiles.ColorProfiles\r\n    * @instance\r\n    */\r\n    loadColorProfileNames(callback) {\r\n        this.dao.loadColorProfiles(this, callback);\r\n    }\r\n\r\n    /** Updates current selected color profile.\r\n    * @method updateColorProfile\r\n    * @param {Map} colors Word-to-Color HashMap\r\n    * @param {Number} sPercentage Saturation settings\r\n    * @param {Number} lPercentage Lightness settings\r\n    * @param {Function} callback Callback function\r\n    * @memberof module:profiles.ColorProfiles\r\n    * @instance\r\n    */\r\n    updateColorProfile(...args) {\r\n        let colorProfile = null;\r\n        let clb = null;\r\n        if (args.length > 3) {\r\n            const [colors, sPercentage, lPercentage, callback] = [...args];\r\n            colorProfile = new ColorProfile(this.loadedProfile.name,\r\n            colors, sPercentage, lPercentage);\r\n            clb = callback;\r\n        } else if (args.length < 3) {\r\n            const [profile, callback] = [...args];\r\n            colorProfile = profile;\r\n            clb = callback;\r\n        }\r\n        if (colorProfile && colorProfile.name) {\r\n            this.dao.updateColorProfile(colorProfile, () => {\r\n                if (this.loadedProfile && colorProfile.name === this.loadedProfile.name) {\r\n                    this.loadColorProfile(this.loadedProfile.name, clb);\r\n                } else if (clb) {\r\n                    clb();\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /** Deletes color profile from client database.\r\n    * @method deleteColorProfile\r\n    * @param {String} name Name of color profile\r\n    * @param {Function} callback Callback function\r\n    * @memberof module:profiles.ColorProfiles\r\n    * @instance\r\n    */\r\n    deleteColorProfile(name, callback) {\r\n        if (name) {\r\n            const loadedProfileName = this.loadedProfile ? this.loadedProfile.name : null;\r\n            this.dao.deleteColorProfile(name, () => {\r\n                this._removeColorProfileName(name);\r\n                if (name === loadedProfileName) {\r\n                    const profileName = this.profileNames.length > 0 ?\r\n                    this.profileNames[0] : null;\r\n                    if (profileName) {\r\n                        this.loadColorProfile(profileName, callback);\r\n                    } else {\r\n                        this.loadedProfile = null;\r\n                        callback();\r\n                    }\r\n                } else {\r\n                    callback();\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    _removeColorProfileName(name) {\r\n        let index;\r\n        for (let i = 0; i < this.profileNames.length; i++) {\r\n            if (this.profileNames[i] === name) {\r\n                index = i;\r\n                break;\r\n            }\r\n        }\r\n        this.profileNames.splice(index, 1);\r\n    }\r\n\r\n    _addColorProfileName(name) {\r\n        this.profileNames.push(name);\r\n    }\r\n}\r\n\r\nexport default ColorProfiles;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/profiles/classes/ColorProfiles.js","import ColorProfile from \"./ColorProfile\";\r\n\r\n/**\r\n* Data Access Object for saving and loading color profiles from\r\n* client database.\r\n* @constructor\r\n* @param {Service} dbService - 'db' service\r\n* @param {Service} colorService - 'colorService' service\r\n* @memberof module:profiles\r\n*/\r\nclass ColorProfilesDAO {\r\n\r\n    constructor(dbService, colorService) {\r\n        this.colorFactory = colorService;\r\n        this.store = 'colorprofiles';\r\n        this.db = dbService;\r\n    }\r\n\r\n    /** Loads color profile from client database.\r\n    * @method loadColorProfile\r\n    * @param {String} name Name of color profile\r\n    * @param {Function} callback Callback function\r\n    * @memberof module:profiles.ColorProfilesDAO\r\n    * @instance\r\n    */\r\n    loadColorProfile(name, callback) {\r\n        if (name) {\r\n            this.db.getStore(this.store)\r\n            .getItem(name)\r\n            .then((item) => {\r\n                if (item) {\r\n                    const profile = ColorProfile.deserialize(item, this.colorFactory, this.db);\r\n                    callback(profile);\r\n                }\r\n            })\r\n            .catch((e) => {\r\n                console.error(e);\r\n            });\r\n        }\r\n    }\r\n\r\n    /** Deletes color profile from client database. \r\n    * @method deleteColorProfile\r\n    * @param {String} name Name of color profile\r\n    * @param {Function} callback Callback function\r\n    * @memberof module:profiles.ColorProfilesDAO\r\n    * @instance\r\n    */\r\n    deleteColorProfile(name, callback) {\r\n        if (name) {\r\n            this.db.getStore(this.store)\r\n            .removeItem(name)\r\n            .then(() => {\r\n                if (callback) {\r\n                    callback();\r\n                }\r\n            })\r\n            .catch((e) => {\r\n                console.error(e);\r\n            });\r\n        }\r\n    }\r\n\r\n    /** Save color profile in client database.\r\n    * @method saveColorProfile\r\n    * @param {ColorProfile} profile Color profile\r\n    * @param {ColorProfiles} profiles Color profiles model\r\n    * @param {Function} callback Callback function\r\n    * @memberof module:profiles.ColorProfilesDAO\r\n    * @instance\r\n    */\r\n    saveColorProfile(profile, profiles, callback) {\r\n        if (profile && profile.name) {\r\n            const store = this.db.getStore(this.store);\r\n            store.getItem(profile.name)\r\n            .then((item) => {\r\n                if (!item) {\r\n                    return store.setItem(profile.name, profile.serialize())\r\n                    .then(() => {\r\n                        profiles._addColorProfileName(profile.name);\r\n                        if (callback) {\r\n                            callback();\r\n                        }\r\n                    });\r\n                }\r\n                return null;\r\n            })\r\n            .catch((e) => {\r\n                console.error(e);\r\n            });\r\n        }\r\n    }\r\n\r\n    /** Load names of existing color profiles.\r\n    * @method loadColorProfiles\r\n    * @param {ColorProfiles} profiles Color profiles model\r\n    * @param {Function} callback Callback function\r\n    * @memberof module:profiles.ColorProfilesDAO\r\n    * @instance\r\n    */\r\n    loadColorProfiles(profiles, callback) {\r\n        this.db.getStore(this.store)\r\n        .iterate((value, key) =>\r\n            profiles._addColorProfileName(key))\r\n        .then(() => {\r\n            if (callback) {\r\n                callback();\r\n            }\r\n        })\r\n        .catch((e) => {\r\n            console.error(e);\r\n        });\r\n    }\r\n\r\n    /** Updates color profile.\r\n    * @method updateColorProfile\r\n    * @param {ColorProfile} profile Color profile with new values\r\n    * @param {Function} callback Callback function\r\n    * @memberof module:profiles.ColorProfilesDAO\r\n    * @instance\r\n    */\r\n    updateColorProfile(profile, callback) {\r\n        if (profile && profile.name) {\r\n            this.db.getStore(this.store)\r\n            .setItem(profile.name, profile.serialize())\r\n            .then(() => {\r\n                if (callback) {\r\n                    callback();\r\n                }\r\n            })\r\n            .catch((e) => {\r\n                console.error(e);\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nexport default ColorProfilesDAO;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/profiles/classes/ColorProfilesDAO.js","import './scss/color-profiles.scss';\nimport template from './template/color-profiles.html';\nimport Utils from '../classes/Utils';\n\nexport const colorProfilesCompName = 'colorProfiles';\nexport const colorProfilesComp = {\n    template,\n    bindings: {\n        colors: '<',\n        onLoadProfile: '&',\n    },\n    controller: class ColorProfilesCtrl {\n        static get $inject() {\n            return ['$rootScope', '$scope', '$timeout', 'colorProfiles', 'colorService', 'textColors', 'popupDialog'];\n        }\n\n        constructor($rootScope, $scope, $timeout, colorProfiles,\n            colorService, textColors, dialog) {\n            this.$rootScope = $rootScope;\n            this.$scope = $scope;\n            this.$timeout = $timeout;\n            this._colorService = colorService;\n            this._textColors = textColors;\n            this._dialog = dialog;\n            this._mode = \"\";\n            this._utils = new Utils();\n            this._singleColors = [];\n            this.colorProfiles = colorProfiles;\n            this.openCreateProfile = false;\n            this.openConflicts = false;\n            this.newProfileName = \"\";\n            this.colorProfiles = colorProfiles;\n            this.conflictColors = [];\n\n            this.$scope.$on(\"colorsChainged\", () => {\n                this.$timeout(() => {\n                    const profile = this.colorProfiles.loadedProfile;\n                    if (profile) {\n                        this._checkColorConflicts(profile.colors);\n                        this.$scope.$apply();\n                    }\n                }, 0, false);\n            });\n        }\n\n        $onInit() {\n            this.colorProfiles.init(() => {\n                this.$scope.$apply();\n            });\n        }\n\n        updateProfileDialog() {\n            const self = this;\n            this._resetColorConflicts();\n            if (this.colorProfiles.loadedProfile) {\n                this._dialog.confirmDialog(function () {\n                    this.yes = () => {\n                        self.updateProfile();\n                        self._dialog.close();\n                    };\n                    this.cancel = () => {\n                        self._dialog.close();\n                    };\n                    this.title = '\"update profile\"';\n                });\n            }\n        }\n\n        applyProfileDialog() {\n            const self = this;\n            if (this.colorProfiles.loadedProfile) {\n                this._dialog.confirmDialog(function () {\n                    this.yes = () => {\n                        self.applyProfile();\n                        self._dialog.close();\n                    };\n                    this.cancel = () => {\n                        self._dialog.close();\n                    };\n                    this.title = '\"apply profile\"';\n                });\n            }\n        }\n\n        deleteProfileDialog() {\n            const self = this;\n            if (this.colorProfiles.loadedProfile) {\n                this._dialog.confirmDialog(function () {\n                    this.yes = () => {\n                        self.deleteProfile();\n                        self._dialog.close();\n                    };\n                    this.cancel = () => {\n                        self._dialog.close();\n                    };\n                    this.title = '\"delete profile\"';\n                });\n            }\n        }\n\n        toggleNewProfile() {\n            this.openCreateProfile = !this.openCreateProfile;\n        }\n\n        haveProfiles() {\n            return this.colorProfiles.profileNames.length > 0;\n        }\n\n        selectProfile() {\n            if (this.colorProfiles.loadedProfile) {\n                this.colorProfiles.loadColorProfile(this.colorProfiles.loadedProfile.name);\n            }\n        }\n\n        saveProfile() {\n            const name = this.newProfileName;\n            this._resetColorConflicts();\n            this._mode = \"create\";\n            if (name && name.trim().length > 0) {\n                this._checkColorConflicts();\n                if (this.conflictColors.length < 1) {\n                    const colors = this._utils.convertColorArrayToMap(this._singleColors);\n                    this.createColorProfile(name, colors);\n                } else {\n                    this.openConflicts = true;\n                }\n            }\n        }\n\n        applyProfile() {\n            const profile = this.colorProfiles.loadedProfile;\n            this._resetColorConflicts();\n            if (profile && profile.name) {\n                this.onLoadProfile({\n                    colors: profile.colors,\n                    sPercentage: profile.sPercentage,\n                    lPercentage: profile.lPercentage,\n                });\n            }\n        }\n\n        updateProfile() {\n            const profile = this.colorProfiles.loadedProfile;\n            this._mode = \"update\";\n            if (profile) {\n                this._checkColorConflicts(profile.colors);\n                this.openConflicts = this.conflictColors.length > 0;\n                if (this.conflictColors.length < 1) {\n                    const colors = this._utils.convertColorArrayToMap(this._singleColors);\n                    this.updateColorProfile(profile.name, colors);\n                }\n            }\n        }\n\n        deleteProfile() {\n            const profile = this.colorProfiles.loadedProfile;\n            this.colorProfiles.deleteColorProfile(profile.name, () => {\n                this.$scope.$apply();\n                this.$rootScope.$broadcast(\"profilesUpdated\");\n            });\n        }\n\n        solveColorConflicts() {\n            const colors = this._utils\n            .concatColorArraysToMap(this.conflictColors, this._singleColors);\n            switch (this._mode) {\n                case 'update': {\n                    const name = this.colorProfiles.loadedProfile.name;\n                    if (name && colors.size > 0) {\n                        this.updateColorProfile(name, colors);\n                        this._resetColorConflicts();\n                        this._mode = \"\";\n                    }\n                } break;\n                case 'create': {\n                    const name = this.newProfileName;\n                    if (name) {\n                        this.createColorProfile(name, colors);\n                        this._resetColorConflicts();\n                        this._mode = \"\";\n                    }\n                } break;\n                default: break;\n            }\n        }\n\n        abortSolveColorConflicts() {\n            this.openConflicts = false;\n        }\n\n        createColorProfile(name, colors) {\n            for (const [word, color] of colors) {\n                if (!color.isSet()) {\n                    colors.delete(word);\n                }\n            }\n            this.colorProfiles.createColorProfile(name, colors,\n            this._textColors.sPercentage, this._textColors.lPercentage, () => {\n                this.newProfileName = \"\";\n                this.colorProfiles.loadColorProfile(name, () => {\n                    this.openCreateProfile = false;\n                    this.$scope.$apply();\n                });\n            });\n        }\n\n        updateColorProfile(name, colors) {\n            for (const [word, color] of colors) {\n                if (!color.isSet()) {\n                    colors.delete(word);\n                }\n            }\n            this.colorProfiles.updateColorProfile(colors, this._textColors.sPercentage,\n                this._textColors.lPercentage, () => {\n                this._resetColorConflicts();\n                this.$timeout(() => {\n                    this.$rootScope.$broadcast(\"profilesUpdated\");\n                }, 0, false);\n            });\n        }\n\n        _resetColorConflicts() {\n            this.conflictColors = [];\n            this._singleColors = [];\n            this.openConflicts = false;\n        }\n\n        _checkColorConflicts(colors) {\n            this._resetColorConflicts();\n            const colorsMapTemp = new Map();\n            for (const [word, mapColors] of this.colors) {\n                const colorsArray = mapColors.getValuesArray();\n                const colorSet = this._colorService.getColorSetInstance();\n                for (let i = 0; i < colorsArray.length; i++) {\n                    colorSet.add(colorsArray[i]);\n                }\n                colorsMapTemp.set(word, colorSet);\n            }\n\n            if (colors) {\n                for (const [word, color] of colors) {\n                    const c = this._colorService.getColorInstance(color);\n                    const entry = colorsMapTemp.get(word);\n                    if (entry) {\n                        entry.add(c);\n                    } else {\n                        const colorSet = this._colorService.getColorSetInstance();\n                        colorSet.add(c);\n                        colorsMapTemp.set(word, colorSet);\n                    }\n                }\n            }\n\n            for (const [word, mapColors] of colorsMapTemp) {\n                const colorsToWordArray = mapColors.getValuesArray();\n                if (colorsToWordArray.length > 1) {\n                    const sel = colorsToWordArray[0];\n                    this.conflictColors.push({ word, selected: sel, colors: colorsToWordArray });\n                } else {\n                    const color = colorsToWordArray[0];\n                    this._singleColors.push({ word, color });\n                }\n            }\n        }\n    },\n};\n\n\n\n// WEBPACK FOOTER //\n// ./modules/profiles/color-profiles/color-profiles.js","module.exports = \"<div class=color-profiles> <select class=color-profiles__profiles ng-change=$ctrl.selectProfile() ng-model=$ctrl.colorProfiles.loadedProfile.name> <option ng-show=\\\"$ctrl.colorProfiles.profileNames.length < 1\\\" value=\\\"\\\">Select profile...</option> <option ng-repeat=\\\"profileName in $ctrl.colorProfiles.profileNames\\\" value={{profileName}}>{{profileName}}</option> </select> <div class=color-profiles__controls> <a ng-click=$ctrl.applyProfileDialog() class=\\\"btn-bodyless btn-bodyless-primary\\\" ng-class=\\\"$ctrl.haveProfiles() ? '' : 'disabled'\\\"><span class=\\\"glyphicon glyphicon-tint\\\"></span> Apply</a> <a ng-click=$ctrl.updateProfileDialog() class=btn-bodyless ng-class=\\\"$ctrl.haveProfiles() ? '' : 'disabled'\\\"><span class=\\\"glyphicon glyphicon-floppy-save\\\"></span> Update</a> <a ng-click=$ctrl.toggleNewProfile() class=\\\"btn-bodyless btn-bodyless-success\\\"><span class=\\\"glyphicon glyphicon-plus\\\" aria-hidden=true></span> New</a> <a ng-click=$ctrl.deleteProfileDialog() class=\\\"btn-bodyless btn-bodyless-danger\\\" ng-class=\\\"$ctrl.haveProfiles() ? '' : 'disabled'\\\"><span class=\\\"glyphicon glyphicon-trash\\\"></span> Drop</a> </div> <div ng-show=$ctrl.openCreateProfile class=color-profiles__create-profile> <input ng-model=$ctrl.newProfileName type=text class=\\\"form-control create-profile__profile-name\\\" placeholder=Profile> <a ng-click=$ctrl.saveProfile() class=\\\"btn btn-success btn-block color-profiles__save-profile\\\"><span class=\\\"glyphicon glyphicon-save\\\" aria-hidden=true></span> Save</a> </div> <div ng-show=$ctrl.openConflicts class=color-profiles__conflicts> <div class=color-profiles__conflict-title><span> Resolve conflicts</span></div> <ul class=color-profiles__conflict-colors> <li ng-repeat=\\\"item in $ctrl.conflictColors track by $index\\\"> {{item.word}} <form> <div class=radio ng-repeat=\\\"color in item.colors track by $index\\\"> <label><input ng-model=$ctrl.conflictColors[$parent.$index].selected ng-value=color type=radio><span ng-show=color.isSet() class=color-profiles__conflict-color ng-style=\\\"{'background-color': color}\\\"></span><span ng-show=color.isSet() class=color-profile__conflict-weight> weight: {{color.weight}}</span><span ng-show=!color.isSet()> none</span></label> </div> </form> </li> </ul> <a ng-click=$ctrl.solveColorConflicts() class=\\\"btn btn-success\\\"><span class=\\\"glyphicon glyphicon-ok\\\" aria-hidden=true></span> OK</a> <a ng-click=$ctrl.abortSolveColorConflicts() class=\\\"btn btn-danger\\\"><span class=\\\"glyphicon glyphicon-remove\\\" aria-hidden=true></span> Cancel</a> </div> </div> \";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./modules/profiles/color-profiles/template/color-profiles.html\n// module id = 176\n// module chunks = 0","export default class Utils {\r\n\r\n    concatColorArraysToMap(conflictColors, singleColors) {\r\n        let colors = [];\r\n        conflictColors.forEach((item) => {\r\n            colors.push({ word: item.word, color: item.selected });\r\n        });\r\n        colors = colors.concat(singleColors);\r\n        const colorMap = this.convertColorArrayToMap(colors);\r\n        return colorMap;\r\n    }\r\n\r\n    convertColorArrayToMap(arr) {\r\n        const colorMap = new Map();\r\n        for (let i = 0, k = arr.length; i < k; i++) {\r\n            colorMap.set(arr[i].word, arr[i].color);\r\n        }\r\n        return colorMap;\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/profiles/classes/Utils.js","import './scss/profiles-viewer.scss';\r\nimport template from './template/profiles-viewer.html';\r\n\r\nexport const profilesViewerCompName = 'profilesViewer';\r\nexport const profilesViewerComp = {\r\n    template,\r\n    controller: class ProfilesViewerCtrl {\r\n        static get $inject() {\r\n            return ['$scope', '$timeout', 'colorProfiles', 'colorService', 'popupDialog', 'usSpinnerService'];\r\n        }\r\n\r\n        constructor($scope, $timeout, colorProfiles, colorService, dialog, spinner) {\r\n            this.$scope = $scope;\r\n            this.$timeout = $timeout;\r\n            this._colorService = colorService;\r\n            this._dialog = dialog;\r\n            this._spinner = spinner;\r\n            this._step = 10;\r\n            this._showIndex = 0;\r\n            this._wordsAndColors = [];\r\n            this.colorProfiles = colorProfiles;\r\n            this.words = [];\r\n            this.profileName = \"\";\r\n            this.selectedProfile = null;\r\n            this.searchWord = \"\";\r\n            this.foundWord = null;\r\n            this.selectedWord = null;\r\n\r\n            this.$scope.$watch(\"$ctrl.searchWord\", (newValue, oldValue) => {\r\n                    if (newValue !== oldValue) {\r\n                        this.findWordAndColor(newValue);\r\n                    }\r\n                },\r\n            );\r\n\r\n            this.$scope.$on(\"profilesUpdated\", () => {\r\n                if (this.selectedProfile) {\r\n                    this.loadColorProfile(true);\r\n                }\r\n            });\r\n        }\r\n\r\n        loadColorProfile(update) {\r\n            this._showIndex = update === true ? this._showIndex : 0;\r\n            this._wordsAndColors = [];\r\n            this.words = [];\r\n            this.selectedProfile = null;\r\n            this.selectedWord = null;\r\n            this.colorProfiles.getColorProfile(this.profileName, (profile) => {\r\n                this.selectedProfile = profile;\r\n                const profileColors = [];\r\n                for (const [word, color] of profile.colors) {\r\n                    const adjustedColor = this._colorService.getColorInstance(color);\r\n                    adjustedColor.interpolateS(profile.sPercentage).interpolateL(profile.lPercentage);\r\n                    profileColors.push({ word, color: adjustedColor, type: \"word\" });\r\n                }\r\n                profileColors.sort((a, b) => {\r\n                    if (a.word > b.word) {\r\n                        return 1;\r\n                    }\r\n                    if (a.word < b.word) {\r\n                        return -1;\r\n                    }\r\n                    return 0;\r\n                });\r\n                for (let i = 0, k = profileColors.length; i < k; i++) {\r\n                    const current = profileColors[i];\r\n                    const next = profileColors[i + 1];\r\n                    let added = false;\r\n                    if (i === 0) {\r\n                        this._wordsAndColors.push({ word: current.word.charAt(0).toUpperCase(), type: \"title\" });\r\n                        this._wordsAndColors.push(current);\r\n                        added = true;\r\n                    }\r\n                    if (next && next.word.charAt(0) !== current.word.charAt(0)) {\r\n                        if (!added) {\r\n                            this._wordsAndColors.push(current);\r\n                        }\r\n                        this._wordsAndColors.push({ word: next.word.charAt(0).toUpperCase(), type: \"title\" });\r\n                        added = true;\r\n                    }\r\n                    if (!added) {\r\n                        this._wordsAndColors.push(current);\r\n                    }\r\n                }\r\n                this.words = update === true ? this._wordsAndColors.slice(0, this._showIndex) :\r\n                this._wordsAndColors.slice(0, this._step);\r\n                this._showIndex += this._step;\r\n                this.findWordAndColor(this.searchWord);\r\n                this.$scope.$apply();\r\n            });\r\n        }\r\n\r\n        findWordAndColor(word) {\r\n            if (this.selectedProfile && this.selectedProfile.name) {\r\n                const color = this.selectedProfile.getColor(word);\r\n                if (color) {\r\n                const adjustedColor = this._colorService.getColorInstance(color);\r\n                adjustedColor.interpolateS(this.selectedProfile.sPercentage)\r\n                .interpolateL(this.selectedProfile.lPercentage);\r\n                this.foundWord = { word, color: adjustedColor };\r\n                } else {\r\n                    this.foundWord = null;\r\n                }\r\n            } else {\r\n                this.foundWord = null;\r\n            }\r\n        }\r\n\r\n        showMore() {\r\n            this.words = this.words\r\n            .concat(this._getWordsInInterval(this._showIndex,\r\n            this._showIndex + this._step, this._wordsAndColors));\r\n            this._showIndex += this._step;\r\n        }\r\n\r\n        clickHandler($event) {\r\n            const target = $event.target;\r\n            if (target.hasAttribute(\"word\")) {\r\n                $event.stopPropagation();\r\n                const word = target.getAttribute(\"word\");\r\n                this.selectedWord = this.selectedWord === word ? null : word;\r\n            } else if (target.hasAttribute(\"delete\")) {\r\n                $event.stopPropagation();\r\n                const word = target.getAttribute(\"delete\");\r\n                this.deleteWordDialog(word);\r\n            }\r\n        }\r\n\r\n        deleteWordDialog(word) {\r\n            const self = this;\r\n            this._dialog.confirmDialog(function () {\r\n                this.yes = () => {\r\n                    self.deleteWord(word);\r\n                    self._dialog.close();\r\n                };\r\n                this.cancel = () => {\r\n                    self._dialog.close();\r\n                };\r\n                this.title = '\"delete word\"';\r\n            });\r\n        }\r\n\r\n        deleteWord(word) {\r\n            this.selectedProfile.deleteWord(word);\r\n            this.colorProfiles.updateColorProfile(this.selectedProfile, () => {\r\n                this.foundWord = null;\r\n                this.searchWord = \"\";\r\n                this.loadColorProfile(true);\r\n            });\r\n        }\r\n\r\n        countProfileWords() {\r\n            return (this.selectedProfile && this.selectedProfile.countWords) ?\r\n            this.selectedProfile.countWords() : 0;\r\n        }\r\n\r\n        _getWordsInInterval(start, end, words) {\r\n            if (start >= 0 && start < words.length) {\r\n                if (end > words.length) {\r\n                    end = words.length;\r\n                }\r\n                return words.slice(start, end);\r\n            }\r\n            return [];\r\n        }\r\n    },\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/profiles/profiles-viewer/profiles-viewer.js","module.exports = \"<div class=profiles-viewer> <h4>Profiles archive</h4> <select class=profiles-viewer__profiles ng-change=$ctrl.loadColorProfile() ng-model=$ctrl.profileName> <option ng-show=\\\"$ctrl.colorProfiles.profileNames.length < 1\\\" value=\\\"\\\" selected=selected>Select profile...</option> <option ng-repeat=\\\"profile in $ctrl.colorProfiles.profileNames\\\" data-colorprofiles-profile={{$index}} value={{profile}}>{{profile}}</option> </select> <div class=profiles-viewer__search> <input class=profiles-viewer__search-input type=text ng-model=$ctrl.searchWord placeholder=\\\"search by word...\\\"> </div> <h5 ng-show=$ctrl.selectedProfile>Total: {{$ctrl.countProfileWords()}} {{$ctrl.countProfileWords() > 1 ? \\\"words\\\" : \\\"word\\\"}} <div ng-show=!$ctrl.foundWord ng-click=$ctrl.clickHandler($event) class=profiles-viewer__words infinite-scroll=$ctrl.showMore() infinite-scroll-distance=0> <div ng-repeat=\\\"word in $ctrl.words track by word.word\\\" class=profiles-viewer__section> <span ng-show=\\\"$ctrl.selectedWord === word.word\\\" class=\\\"glyphicon glyphicon-remove profiles-viewer__delete\\\" ng-attr-delete=\\\"{{$ctrl.selectedWord === word.word ? word.word : undefined}}\\\"></span> <div ng-class=\\\"{'profiles-viewer__section-title': word.type === 'title', 'profiles-viewer__section-word': word.type === 'word'}\\\" ng-attr-word=\\\"{{word.type === 'word' ? word.word : undefined}}\\\">{{word.word}}</div> <div ng-show=\\\"word.type === 'word'\\\" class=profiles-viewer__space></div> <div ng-show=\\\"word.type === 'word'\\\" class=profiles-viewer__color ng-style=\\\"{'background-color': word.color}\\\"></div> </div> </div> <div ng-click=$ctrl.clickHandler($event) ng-show=$ctrl.foundWord class=\\\"profiles-viewer__search-result profiles-viewer__section\\\"> <span ng-show=\\\"$ctrl.selectedWord === $ctrl.foundWord.word\\\" class=\\\"glyphicon glyphicon-remove profiles-viewer__delete\\\" ng-attr-delete={{$ctrl.foundWord.word}}></span> <div class=profiles-viewer__section-word ng-attr-word={{$ctrl.foundWord.word}}>{{$ctrl.foundWord.word}}</div> <div class=profiles-viewer__space></div> <div class=profiles-viewer__color ng-style=\\\"{'background-color': $ctrl.foundWord.color}\\\"></div> </div> </h5></div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./modules/profiles/profiles-viewer/template/profiles-viewer.html\n// module id = 180\n// module chunks = 0","module.exports = \"<span us-spinner=\\\"{position: 'fixed', color: '#428bca'}\\\" spinner-key=spinner-1></span> <div class=color-search__content> <div class=color-search__header> <div ng-click=$ctrl.goToMain() class=color-search__logo><div class=color-search__logo-image></div></div> <div class=color-search__navigation> <a class=\\\"btn-bodyless btn-bodyless-default\\\" ng-click=$ctrl.goToGuide()>Guide</a><span class=color-search__separator></span> <a class=\\\"btn-bodyless btn-bodyless-default\\\" ng-click=$ctrl.goToSettings()>Archive</a> </div> </div> <ui-view name=pages> <main ng-show=\\\"$ctrl.page == 'main'\\\"></main> <guide ng-show=\\\"$ctrl.page == 'guide'\\\"></guide> <profiles-viewer ng-show=\\\"$ctrl.page === 'profiles'\\\"></profiles-viewer> </ui-view> </div> \";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./modules/color-search/template/color-search.html\n// module id = 182\n// module chunks = 0","import md5 from 'md5';\r\n\r\n/**\r\n* Login model. Implements user login business logic.\r\n* @constructor:\r\n* @param {Service} $q Angularjs '$q' service\r\n* @param {Service} jsonrpc 'jsonrpc' service\r\n* @memberof module:color-search\r\n*/\r\nclass Login {\r\n\r\n    constructor($q, jsonrpc) {\r\n        this.required = null;\r\n        this.auth = null;\r\n        this.success = false;\r\n        this.password = null;\r\n        this.jsonrpc = jsonrpc;\r\n        this.$q = $q;\r\n    }\r\n\r\n    /** Check if login data exists.\r\n    * @method isSet\r\n    * @return {boolean}\r\n    * @memberof module:color-search.Login\r\n    * @instance\r\n    */\r\n    isSet() {\r\n        return this.password !== null;\r\n    }\r\n\r\n    /** Checks if login was successful.\r\n    * @method isSuccessful\r\n    * @return {boolean}\r\n    * @memberof module:color-search.Login\r\n    * @instance\r\n    */\r\n    isSuccessful() {\r\n        return this.auth !== null && this.success;\r\n    }\r\n\r\n    /** Sends server login request.\r\n    * @method login\r\n    * @memberof module:color-search.Login\r\n    * @instance\r\n    */\r\n    login() {\r\n        const self = this;\r\n        const auth = md5(`${this.password}`);\r\n        return this.jsonrpc.request('login', { login: auth })\r\n        .then((data) => {\r\n            if (data.success) {\r\n                self.auth = auth;\r\n                this.success = true;\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n    }\r\n\r\n    /** Sends server request and checks if login is requered.\r\n    * @method isRequired\r\n    * @memberof module:color-search.Login\r\n    * @instance\r\n    */\r\n    isRequired() {\r\n        if (this.required) {\r\n            return this.$q.resolve(true);\r\n        }\r\n        return this.jsonrpc.request('loginRequired', {})\r\n        .then((data) => {\r\n            this.required = data.required;\r\n            return this.required;\r\n        });\r\n    }\r\n}\r\n\r\nexport default Login;\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/color-search/core/models/Login.js","import './scss/dialog.scss';\r\nimport confirmTemplate from './templates/confirm.html';\r\nimport loginTemplate from './templates/login.html';\r\nimport errorTemplate from './templates/error.html';\r\n\r\n/**\r\n* Module for creating dialogs\r\n* @module dialog\r\n*/\r\nangular.module('dialog', [])\r\n/** Service for creating pop-up dialogs on-the-fly\r\n* @member {Service} popupDialog\r\n* @memberof module:dialog\r\n* @instance\r\n*/\r\n.service('popupDialog', ['$rootScope', '$compile',\r\nfunction ($rootScope, $compile) {\r\n    let scope = null;\r\n    let element = null;\r\n    const self = this;\r\n\r\n    function create(template, Control, closeByOutside) {\r\n        const html = `<div class=\"dialog\" ng-click=\"close($event)\">\r\n        <div class=\"dialog__window\">${template}</div></div>`;\r\n        scope = $rootScope.$new(true);\r\n        scope.$ctrl = new Control();\r\n        scope.closeByOutside = closeByOutside;\r\n        scope.close = ($event) => {\r\n            const target = angular.element($event.target);\r\n            if (target.hasClass(\"dialog\") && scope.closeByOutside) {\r\n                self.close();\r\n            }\r\n        };\r\n        const compiled = $compile(html)(scope);\r\n        element = angular.element(compiled).appendTo(\"body\");\r\n    }\r\n\r\n    this.close = () => {\r\n        if (element && scope) {\r\n            element.remove();\r\n            scope.$destroy();\r\n            element = null;\r\n            scope = null;\r\n            angular.element(\"*\").removeAttr(\"tabindex\");\r\n        }\r\n    };\r\n\r\n    this.errorDialog = (Control) => {\r\n        this.close();\r\n        angular.element(\"*\").attr(\"tabindex\", -1);\r\n        angular.element(\"*\").blur();\r\n        create(errorTemplate, Control, false);\r\n    };\r\n\r\n    this.confirmDialog = (Control) => {\r\n        this.close();\r\n        angular.element(\"*\").attr(\"tabindex\", -1);\r\n        angular.element(\"*\").blur();\r\n        create(confirmTemplate, Control, true);\r\n    };\r\n\r\n    this.loginDialog = (Control) => {\r\n        this.close();\r\n        angular.element(\"*\").attr(\"tabindex\", -1);\r\n        angular.element(\"*\").blur();\r\n        create(loginTemplate, Control, false);\r\n    };\r\n}]);\r\n\r\nexport default \"dialog\";\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/color-search/core/services/dialog/dialog.js","module.exports = \"<div class=confirm-dialog> <h4><span class=\\\"glyphicon glyphicon-question-sign\\\"></span> Confirm <span class=confirm-dialog__title>{{$ctrl.title}}</span></h4> <p>Are you sure you want to proceed?</p> <div style=float:right> <a class=\\\"btn btn-danger\\\" ng-click=$ctrl.cancel()>Cancel</a> <a class=\\\"btn btn-success\\\" ng-click=$ctrl.yes()>Yes</a> </div><div style=clear:both></div> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./modules/color-search/core/services/dialog/templates/confirm.html\n// module id = 189\n// module chunks = 0","module.exports = \"<div class=login-dialog> <div class=form-group><input ng-model=$ctrl.model.password type=password class=form-control placeholder=Password></div> <a ng-click=$ctrl.login() class=\\\"btn btn-success btn-block\\\"><span class=\\\"glyphicon glyphicon-cloud-upload\\\" aria-hidden=true></span> Log in</a> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./modules/color-search/core/services/dialog/templates/login.html\n// module id = 190\n// module chunks = 0","module.exports = \"<div class=error-dialog> <h4><span class=\\\"glyphicon glyphicon-warning-sign\\\"></span> {{$ctrl.title}}</h4> <p>{{$ctrl.description}}</p> <a ng-show=$ctrl.button ng-click=$ctrl.handle() class=\\\"btn btn-danger btn-block\\\"><span ng-show=$ctrl.icon ng-class=\\\"'glyphicon glyphicon-{{$ctrl.icon}}'\\\"></span> {{$ctrl.buttonTitle}}</a> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./modules/color-search/core/services/dialog/templates/error.html\n// module id = 191\n// module chunks = 0","import localforage from \"localforage\";\r\n/**\r\n* Abstracts client database technology from application.\r\n* Uses 'localforage' library, which supports INDEXEDDB, WEBSQL and LOCALSTORAGE.\r\n* @module db\r\n* @requires localforage\r\n*/\r\nangular.module('db', [])\r\n/** Service which returns 'store' object of configurated database.\r\n* @member {Service} db\r\n* @memberof module:db\r\n* @instance\r\n*/\r\n.service('db', [function () {\r\n    localforage.config({\r\n        driver: [localforage.INDEXEDDB,\r\n                localforage.WEBSQL,\r\n                localforage.LOCALSTORAGE],\r\n        name: 'ColorSearch',\r\n        version: 1.0,\r\n    });\r\n    this.getStore = store => localforage.createInstance({ name: 'ColorSearch', storeName: store });\r\n}]);\r\n\r\nexport default \"db\";\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/color-search/core/services/db/db.js"],"sourceRoot":""}
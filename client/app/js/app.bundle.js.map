{"version":3,"sources":["webpack:///js/app.bundle.js","webpack:///./app.js","webpack:///./color-search/color-search.js","webpack:///./routing/Routes.js","webpack:///./models/Settings.js","webpack:///./utils/ColorUtils.js","webpack:///./models/TextColors.js","webpack:///external \"angular\"","webpack:///./models/ColorFactory.js","webpack:///./models/ColorSetFactory.js","webpack:///./models/ColorSet.js","webpack:///./routing/RoutingCtrl.js","webpack:///./utils/JsonRpc.js","webpack:///./pages/main/main-page.js","webpack:///./pages/main/template/main-page.html","webpack:///./pages/main/MainCtrl.js","webpack:///./components/color-adjuster/color-adjuster.js","webpack:///./components/color-adjuster/template/color-adjuster.html","webpack:///./components/color-profiles/color-profiles.js","webpack:///./components/color-profiles/template/color-profiles.html","webpack:///./components/text-colorizer/text-colorizer.js","webpack:///./components/text-colorizer/template/text-colorizer.html","webpack:///./components/color-toolbar/color-toolbar.js","webpack:///./components/color-toolbar/template/color-toolbar.html","webpack:///./components/image-finder/image-finder.js","webpack:///./components/image-finder/template/image-finder.html","webpack:///./pages/settings/settings-page.js","webpack:///./pages/settings/template/settings-page.html","webpack:///./pages/settings/SettingsCtrl.js","webpack:///./pages/guide/guide-page.js","webpack:///./pages/guide/template/guide-page.html","webpack:///./color-search/template/color-search.html","webpack:///./models/Login.js","webpack:///./services/dialog/dialog.js","webpack:///./services/dialog/templates/confirm.html","webpack:///./services/dialog/templates/login.html","webpack:///./services/dialog/templates/error.html","webpack:///./services/db/db.js","webpack:///./utils/EventFilter.js","webpack:///./models/Color.js"],"names":["webpackJsonp","177","module","exports","__webpack_require__","_colorSearch","_colorSearch2","obj","__esModule","default","angular","178","180","_interopRequireDefault","Object","defineProperty","value","_angularjs","_angularjs2","_Routes","_Routes2","_Settings","_Settings2","_ColorUtils","_ColorUtils2","_TextColors","_TextColors2","_ColorFactory","_ColorFactory2","_ColorSetFactory","_ColorSetFactory2","_RoutingCtrl","_RoutingCtrl2","_JsonRpc","_JsonRpc2","_mainPage","_mainPage2","_settingsPage","_settingsPage2","_guidePage","_guidePage2","_Login","_Login2","_dialog","_dialog2","_db","_db2","_EventFilter","_EventFilter2","config","provider","set","url","service","controller","component","template","$scope","$window","login","dialog","openLoginDialog","loginDialog","_this","this","model","isSet","then","succ","close","isRequired","required","catch","err","errorDialog","title","description","buttonTitle","button","icon","handle","location","reload","184","Routes","$stateProvider","$urlRouterProvider","mainState","name","data","page","settingsState","guideState","state","otherwise","$inject","185","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","SettingsDAO","db","store","key","settings","getStore","getItem","item","deserialize","e","console","warn","setItem","serialize","Settings","dao","checkSemanticSimilarity","searchMode","similarityLevel","distance","distanceMode","supportedDistances","id","loadSettings","saveSettings","o","dto","editorFontSize","191","_tinycolor","_tinycolor2","ColorUtils","color","f","factor","h","s","l","toHexString","hex","hsl","toHsl","Math","round","string","cTemp","_len","arguments","length","colors","Array","_key","crTemp","cr","i","c1","c2","color1","toRgb","color2","lum1","_luminanceRGB","r","g","b","lum2","_ref","RsRGB","GsRGB","BsRGB","pow","193","_slicedToArray2","_slicedToArray3","_getIterator2","_getIterator3","_toConsumableArray2","_toConsumableArray3","_map","_map2","_Color","_Color2","TextColors","_words","colorOccurence","adjustedColorOccurence","sPercentage","lPercentage","word","push","concat","values","getColors","words","getWords","clearWords","clear","size","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","entries","next","done","_step$value","get","toString","setWeight","weight","return","calculateAdjustedColors","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_calculate","isAchromatic","setAchromatic","x","xPercentage","x1","20","227","ColorFactory","228","_ColorSet","_ColorSet2","ColorSetFactory","229","ColorSet","map","toIdString","233","RoutingCtrl","$transitions","$state","$timeout","onSuccess","transition","to","$broadcast","goToSettings","go","goToGuide","goToMain","234","_keys","_keys2","JsonRpcException","error","message","conf","$get","$q","$http","jsonrpcConfig","_getInputData","methodName","args","_id","jsonrpc","method","params","_inspectDataFormat","allowedKeys","keys","ret","forEach","indexOf","_url","_header","Content-Type","request","deferred","defer","req","headers","res","result","resolve","reject","status","promise","239","_MainCtrl","_MainCtrl2","_colorAdjuster","_colorAdjuster2","_colorProfiles","_colorProfiles2","_textColorizer","_textColorizer2","_colorToolbar","_colorToolbar2","_imageFinder","_imageFinder2","factory","colorUtils","getFittingColorWithGreaterCR","240","241","242","MainCtrl","$rootScope","textColors","appSettings","colorSetFactory","colorFactory","selectedWord","colorizer","cols","getAllColors","toLowerCase","addWord","entry","add","colorSet","getInstance","_this2","setColors","_updateColors","updateColors","_this3","toolbar","setColor","open","_this4","resetColor","_this5","inputComplete","_this6","self","confirmDialog","yes","drop","cancel","decolorizeText","_this7","resetAllColors","editMode","_this8","imageFinder","colorsAndWords","getColorsAndWords","search","getSearchSettings","243","_angularChart","_angularChart2","_angularjsSlider","_angularjsSlider2","$element","$attrs","eventFilter","adjuster","toggle","getS","abs","getL","colorsChainged","tempColors","wei","rgbHex","tempColor","col","_step2$value","$apply","labels","filter","options","tooltips","enabled","animation","animateRotate","events","slider","floor","ceil","step","onChange","event","onEnd","hidePointerLabels","hideLimitLabels","disabled","$on","$onInit","bindings","332","333","334","ColorProfiles","ColorProfilesDAO","colorProfiles","createProfile","notDeleteColors","newProfileName","profiles","conflictColors","singleColors","mode","updateProfileDialog","updateProfile","applyProfileDialog","applyProfile","deleteProfileDialog","deleteProfile","toggleNewProfile","haveProfiles","selectProfile","selectedProfile","_resetColorConflicts","loadColorProfile","saveProfile","_testForColorConflicts","_convertColorArrayToMap","_createColorProfile","onLoadProfile","getSelectedProfileColors","has","delete","cMap","_updateColorProfile","deleteColorProfile","profileName","solveColorConflicts","_concatColorArraysToMap","createColorProfile","updateColorProfile","colorsMapTemp","mapColors","colorsArray","getValuesArray","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","_step3$value","c","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","_step4$value","colorsToWordArray","sel","selected","arr","colorMap","k","load","getColorProfileNames","profileNames","setProfiles","callback","loadColorProfiles","profile","ColorProfile","saveColorProfile","index","splice","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","_step5$value","_setColorProfile","removeItem","_removeColorProfileName","_addColorProfileName","iterate","335","336","337","_set","_set2","_xregexp","_xregexp2","_htmlEntities","_htmlEntities2","entities","AllHtmlEntities","calculateFontColor","encodeSpecialChars","str","replace","m","specialChars","_colorizer","calcFontColor","_options","widgetSelector","wordSelector","colorSelector","weightSelector","helperSelector","_vars","root","element","find","wordsToRemove","idCounter","helperCounter","wordWidth","api","colorObject","_handlePaste","preventDefault","stopPropagation","text","clipboardData","originalEvent","getData","document","queryCommandSupported","execCommand","_handleKeydown","keyCode","setTimeout","_deleteEmpty","_updateFontStyle","getSelection","anchorNode","getRangeAt","target","parentNode","attr","focusNode","range","startIndex","startOffset","endIndex","endOffset","count","nodeValue","spaceReg","trim","match","slice","_moveCaretInText","css","font-size","line-height","_handleCut","_updateWordsStyle","each","elem","$wordNode","position","textNode","caret","createRange","setStart","collapse","removeAllRanges","addRange","parseInt","wordItem","_setWordColor","background-color","parent","is","remove","createWordMark","txt","backgroundColor","fontColor","_inWordTags","idString","format","newHtml","needle","wordId","replaceWith","encode","_notInTags","reg","contents","nodeType","html","end","_updateWords","_setCaretPosition","setStartAfter","setEndAfter","unwrap","currentIds","nextSibling","node","createTextNode","insertBefore","lastNodeType","last","space","append","focus","newColor","savedWord","removeAttr","reset","selectWord","$event","$targetNode","hasAttribute","first","isSameNode","nativeText","spaceText","textContent","replaceChild","onWordselect","empty","control","348","349","350","toolbarId","black","white","colorModifiedHandler","increaseWeight","decreaseWeight","endSlide","selectColor","parentElement","colorElement","colorIndex","changeColor","setInitialColor","setCurrentColor","addClass","removeClass","closed","bind","351","352","353","_ngInfiniteScroll","_ngInfiniteScroll2","Images","ImagesService","images","usSpinnerService","finder","selectedImage","imagesToShow","showImage","getImagesInInterval","showIndex","searchSettings","spin","findImages","stop","getImages","getImagesArray","imageLoadingError","thumbnailLoadingError","showMore","originalURL","selectImage","getImage","closeImagePopup","Image","score","img","start","auth","imgs","iObj","addImage","parseFloat","toFixed","356","357","358","_SettingsCtrl","_SettingsCtrl2","359","360","361","_values","_values2","SettingsCtrl","$appSettings","settingsOldState","join","$doCheck","save","log","367","368","369","370","371","372","_md","_md2","Login","success","user","password","376","_confirm","_confirm2","_login","_login2","_error","_error2","$compile","create","Control","closeByOutside","scope","$new","$ctrl","hasClass","compiled","appendTo","$destroy","377","378","379","380","381","_localforage","_localforage2","driver","INDEXEDDB","WEBSQL","LOCALSTORAGE","version","createInstance","storeName","384","EventFilter","timeWindow","_timeWindow","_callback","_$window","_lastEventTime","_timeoutId","now","Date","clearTimeout","58","Color","achromatic","w","test","re","exec"],"mappings":"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","file":"js/app.bundle.js","sourcesContent":["webpackJsonp([0],{\n\n/***/ 177:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n__webpack_require__(178);\n\nvar _colorSearch = __webpack_require__(180);\n\nvar _colorSearch2 = _interopRequireDefault(_colorSearch);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nangular.module('app', [_colorSearch2.default]);\n\n/***/ }),\n\n/***/ 178:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 180:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _angularjs = __webpack_require__(181);\n\nvar _angularjs2 = _interopRequireDefault(_angularjs);\n\n__webpack_require__(183);\n\nvar _Routes = __webpack_require__(184);\n\nvar _Routes2 = _interopRequireDefault(_Routes);\n\nvar _Settings = __webpack_require__(185);\n\nvar _Settings2 = _interopRequireDefault(_Settings);\n\nvar _ColorUtils = __webpack_require__(191);\n\nvar _ColorUtils2 = _interopRequireDefault(_ColorUtils);\n\nvar _TextColors = __webpack_require__(193);\n\nvar _TextColors2 = _interopRequireDefault(_TextColors);\n\nvar _ColorFactory = __webpack_require__(227);\n\nvar _ColorFactory2 = _interopRequireDefault(_ColorFactory);\n\nvar _ColorSetFactory = __webpack_require__(228);\n\nvar _ColorSetFactory2 = _interopRequireDefault(_ColorSetFactory);\n\nvar _RoutingCtrl = __webpack_require__(233);\n\nvar _RoutingCtrl2 = _interopRequireDefault(_RoutingCtrl);\n\nvar _JsonRpc = __webpack_require__(234);\n\nvar _JsonRpc2 = _interopRequireDefault(_JsonRpc);\n\nvar _mainPage = __webpack_require__(239);\n\nvar _mainPage2 = _interopRequireDefault(_mainPage);\n\nvar _settingsPage = __webpack_require__(358);\n\nvar _settingsPage2 = _interopRequireDefault(_settingsPage);\n\nvar _guidePage = __webpack_require__(367);\n\nvar _guidePage2 = _interopRequireDefault(_guidePage);\n\n__webpack_require__(370);\n\nvar _colorSearch = __webpack_require__(371);\n\nvar _colorSearch2 = _interopRequireDefault(_colorSearch);\n\nvar _Login = __webpack_require__(372);\n\nvar _Login2 = _interopRequireDefault(_Login);\n\nvar _dialog = __webpack_require__(376);\n\nvar _dialog2 = _interopRequireDefault(_dialog);\n\nvar _db = __webpack_require__(381);\n\nvar _db2 = _interopRequireDefault(_db);\n\nvar _EventFilter = __webpack_require__(384);\n\nvar _EventFilter2 = _interopRequireDefault(_EventFilter);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nangular.module('color-search', [_angularjs2.default, _JsonRpc2.default, _mainPage2.default, _settingsPage2.default, _guidePage2.default, _dialog2.default, _db2.default, _EventFilter2.default, 'angularSpinner']).config(_Routes2.default).config(['$JsonRpcProvider', function (provider) {\n    provider.set({ url: \"/\" });\n}]).service('colorUtils', _ColorUtils2.default).service('colorFactory', _ColorFactory2.default).service('colorSetFactory', _ColorSetFactory2.default).service('appSettings', ['db', _Settings2.default]).service('textColors', _TextColors2.default).service('login', ['$q', 'jsonrpc', _Login2.default]).controller('RoutingCtrl', _RoutingCtrl2.default).component('colorSearch', {\n    template: _colorSearch2.default,\n    controller: ['$scope', '$window', 'login', 'popupDialog', function Controller($scope, $window, login, dialog) {\n        function openLoginDialog() {\n            dialog.loginDialog(function () {\n                var _this = this;\n\n                this.model = login;\n                this.login = function () {\n                    if (_this.model.isSet()) {\n                        _this.model.login().then(function (succ) {\n                            if (succ) {\n                                dialog.close();\n                            }\n                        });\n                    }\n                };\n            });\n        }\n\n        login.isRequired().then(function (required) {\n            if (required) {\n                openLoginDialog();\n            }\n        }).catch(function (err) {\n            dialog.errorDialog(function () {\n                this.title = \"Connection error\";\n                this.description = \"Try to reload the application.\";\n                this.buttonTitle = \"Reload\";\n                this.button = true;\n                this.icon = 'refresh';\n                this.handle = function () {\n                    $window.location.reload(true);\n                };\n            });\n        });\n    }]\n});\n\nexports.default = 'color-search';\n\n/***/ }),\n\n/***/ 184:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nfunction Routes($stateProvider, $urlRouterProvider) {\n    var mainState = {\n        name: 'main',\n        url: '/main',\n        data: { page: \"main\" }\n    };\n\n    var settingsState = {\n        name: 'main.settings',\n        url: '^/settings',\n        data: { page: \"settings\" }\n    };\n\n    var guideState = {\n        name: 'main.guide',\n        url: '^/guide',\n        data: { page: \"guide\" }\n    };\n\n    $stateProvider.state(mainState);\n    $stateProvider.state(settingsState);\n    $stateProvider.state(guideState);\n    $urlRouterProvider.otherwise('/main');\n}\n\nRoutes.$inject = ['$stateProvider', '$urlRouterProvider'];\nexports.default = Routes;\n\n/***/ }),\n\n/***/ 185:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(1);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(2);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar SettingsDAO = function () {\n    function SettingsDAO(db) {\n        (0, _classCallCheck3.default)(this, SettingsDAO);\n\n        this.store = \"settings\";\n        this.db = db;\n    }\n\n    (0, _createClass3.default)(SettingsDAO, [{\n        key: 'loadSettings',\n        value: function loadSettings(settings, succ, err) {\n            this.db.getStore(this.store).getItem('settings').then(function (item) {\n                settings.deserialize(item);\n                if (succ) {\n                    succ();\n                }\n            }).catch(function (e) {\n                console.warn(e);\n                if (err) {\n                    err();\n                }\n            });\n        }\n    }, {\n        key: 'saveSettings',\n        value: function saveSettings(settings, succ, err) {\n            this.db.getStore(this.store).setItem('settings', settings.serialize()).then(function () {\n                if (succ) {\n                    succ();\n                }\n            }).catch(function (e) {\n                console.warn(e);\n                if (err) {\n                    err();\n                }\n            });\n        }\n    }]);\n    return SettingsDAO;\n}();\n\nvar Settings = function () {\n    function Settings(db) {\n        (0, _classCallCheck3.default)(this, Settings);\n\n        this.module = 'settings';\n        this.dao = new SettingsDAO(db);\n        this.checkSemanticSimilarity = false;\n        this.searchMode = 'regular';\n        this.similarityLevel = 85;\n        this.distance = 'euclidean';\n        this.distanceMode = 'strict';\n        this.supportedDistances = [{ id: 'euclidean', name: 'Euclidean' }, { id: 'chisquare', name: 'Chi-Square' }, { id: 's2jsd', name: 'S2JSD' }];\n    }\n\n    (0, _createClass3.default)(Settings, [{\n        key: 'load',\n        value: function load(succ, err) {\n            this.dao.loadSettings(this, succ, err);\n        }\n    }, {\n        key: 'save',\n        value: function save(succ, err) {\n            this.dao.saveSettings(this, succ, err);\n        }\n    }, {\n        key: 'serialize',\n        value: function serialize() {\n            var o = {};\n            o.module = 'settings';\n            o.checkSemanticSimilarity = this.checkSemanticSimilarity;\n            o.searchMode = this.searchMode;\n            o.similarityLevel = this.similarityLevel;\n            o.distance = this.distance;\n            o.distanceMode = this.distanceMode;\n            return o;\n        }\n    }, {\n        key: 'deserialize',\n        value: function deserialize(dto) {\n            if (dto) {\n                this.editorFontSize = dto.editorFontSize;\n                this.checkSemanticSimilarity = dto.checkSemanticSimilarity;\n                this.searchMode = dto.searchMode;\n                this.similarityLevel = dto.similarityLevel;\n                this.distance = dto.distance;\n                this.distanceMode = dto.distanceMode;\n            } else {\n                console.warn(\"Settings not loaded\");\n            }\n        }\n    }, {\n        key: 'getSearchSettings',\n        value: function getSearchSettings() {\n            var o = {};\n            o.checkSemanticSimilarity = this.checkSemanticSimilarity;\n            o.searchMode = this.searchMode;\n            o.similarityLevel = this.similarityLevel;\n            o.distance = this.distance;\n            o.distanceMode = this.distanceMode;\n            return o;\n        }\n    }]);\n    return Settings;\n}();\n\nexports.default = Settings;\n\n/***/ }),\n\n/***/ 191:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(1);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(2);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _tinycolor = __webpack_require__(192);\n\nvar _tinycolor2 = _interopRequireDefault(_tinycolor);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar ColorUtils = function () {\n    function ColorUtils() {\n        (0, _classCallCheck3.default)(this, ColorUtils);\n    }\n\n    (0, _createClass3.default)(ColorUtils, [{\n        key: 'hslToHexString',\n        value: function hslToHexString(color, f) {\n            var factor = f || 1;\n            return (0, _tinycolor2.default)({ h: color.h, s: color.s / factor, l: color.l / factor }).toHexString();\n        }\n    }, {\n        key: 'hexToHsl',\n        value: function hexToHsl(hex, f) {\n            var factor = f || 1;\n            var hsl = (0, _tinycolor2.default)(hex).toHsl();\n            hsl.s = Math.round(hsl.s * factor);\n            hsl.l = Math.round(hsl.l * factor);\n            return hsl;\n        }\n    }, {\n        key: 'toHexString',\n        value: function toHexString(string) {\n            return (0, _tinycolor2.default)(string).toHexString();\n        }\n    }, {\n        key: 'hslToHslString',\n        value: function hslToHslString(color) {\n            return 'hsl(' + color.h + ',' + color.s + '%,' + color.l + '%)';\n        }\n    }, {\n        key: 'hslStringToHsl',\n        value: function hslStringToHsl(string, f) {\n            if (string) {\n                var factor = f || 1;\n                var hsl = (0, _tinycolor2.default)(string).toHsl();\n                hsl.s = Math.round(hsl.s * factor);\n                hsl.l = Math.round(hsl.l * factor);\n                return hsl;\n            }\n            return { h: 0, s: 0, l: 0 };\n        }\n    }, {\n        key: 'getFittingColorWithGreaterCR',\n        value: function getFittingColorWithGreaterCR(color) {\n            var cTemp = color;\n\n            for (var _len = arguments.length, colors = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n                colors[_key - 1] = arguments[_key];\n            }\n\n            if (colors && colors.length > 0) {\n                cTemp = colors[0];\n                var crTemp = this.cr(color, colors[0]);\n                for (var i = 0; i < colors.length; i++) {\n                    var cr = this.cr(color, colors[i]);\n                    if (crTemp < cr) {\n                        crTemp = cr;\n                        cTemp = colors[i];\n                    }\n                }\n            }\n            return cTemp;\n        }\n\n        // W3C recommendation\n\n    }, {\n        key: 'cr',\n        value: function cr(c1, c2) {\n            var color1 = (0, _tinycolor2.default)(c1).toRgb();\n            var color2 = (0, _tinycolor2.default)(c2).toRgb();\n            var lum1 = this._luminanceRGB(color1.r, color1.g, color1.b);\n            var lum2 = this._luminanceRGB(color2.r, color2.g, color2.b);\n            if (lum2 > lum1) {\n                var _ref = [lum2, lum1];\n                lum1 = _ref[0];\n                lum2 = _ref[1];\n            }\n            return (lum1 + 0.05) / (lum2 + 0.05);\n        }\n    }, {\n        key: '_luminanceRGB',\n        value: function _luminanceRGB(r, g, b) {\n            var RsRGB = r / 255;\n            var GsRGB = g / 255;\n            var BsRGB = b / 255;\n            var R = RsRGB <= 0.03928 ? RsRGB / 12.92 : Math.pow((RsRGB + 0.055) / 1.055, 2.4);\n            var G = GsRGB <= 0.03928 ? GsRGB / 12.92 : Math.pow((GsRGB + 0.055) / 1.055, 2.4);\n            var B = BsRGB <= 0.03928 ? BsRGB / 12.92 : Math.pow((BsRGB + 0.055) / 1.055, 2.4);\n            return 0.2126 * R + 0.7152 * G + 0.0722 * B;\n        }\n    }]);\n    return ColorUtils;\n}();\n\nexports.default = ColorUtils;\n\n/***/ }),\n\n/***/ 193:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _slicedToArray2 = __webpack_require__(26);\n\nvar _slicedToArray3 = _interopRequireDefault(_slicedToArray2);\n\nvar _getIterator2 = __webpack_require__(15);\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _toConsumableArray2 = __webpack_require__(37);\n\nvar _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);\n\nvar _map = __webpack_require__(16);\n\nvar _map2 = _interopRequireDefault(_map);\n\nvar _classCallCheck2 = __webpack_require__(1);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(2);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _Color = __webpack_require__(58);\n\nvar _Color2 = _interopRequireDefault(_Color);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar TextColors = function () {\n    function TextColors() {\n        (0, _classCallCheck3.default)(this, TextColors);\n\n        this._words = [];\n        this.colorOccurence = new _map2.default();\n        this.adjustedColorOccurence = new _map2.default();\n        this.sPercentage = 100;\n        this.lPercentage = 100;\n    }\n\n    (0, _createClass3.default)(TextColors, [{\n        key: 'clearWords',\n        value: function clearWords() {\n            this._words = [];\n        }\n    }, {\n        key: 'addWord',\n        value: function addWord(word) {\n            this._words.push(word);\n        }\n    }, {\n        key: 'getWords',\n        value: function getWords() {\n            return this._words;\n        }\n    }, {\n        key: 'getColors',\n        value: function getColors() {\n            return [].concat((0, _toConsumableArray3.default)(this.adjustedColorOccurence.values()));\n        }\n    }, {\n        key: 'getColorsAndWords',\n        value: function getColorsAndWords() {\n            var o = {};\n            o.colors = this.getColors();\n            o.words = this.getWords();\n            return o;\n        }\n    }, {\n        key: 'clear',\n        value: function clear() {\n            this.clearWords();\n            this.colorOccurence.clear();\n            this.adjustedColorOccurence.clear();\n        }\n    }, {\n        key: 'updateColors',\n        value: function updateColors(colors) {\n            this.colorOccurence.clear();\n            if (colors && colors.size > 0) {\n                var _iteratorNormalCompletion = true;\n                var _didIteratorError = false;\n                var _iteratorError = undefined;\n\n                try {\n                    for (var _iterator = (0, _getIterator3.default)(colors.entries()), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                        var _step$value = (0, _slicedToArray3.default)(_step.value, 2),\n                            key = _step$value[0],\n                            value = _step$value[1];\n\n                        if (value.color && value.color.isSet()) {\n                            var color = this.colorOccurence.get(value.color.toString());\n                            if (color) {\n                                color.setWeight(color.weight + value.color.weight);\n                            } else {\n                                color = new _Color2.default(value.color);\n                                this.colorOccurence.set(color.toString(), color);\n                            }\n                        }\n                    }\n                } catch (err) {\n                    _didIteratorError = true;\n                    _iteratorError = err;\n                } finally {\n                    try {\n                        if (!_iteratorNormalCompletion && _iterator.return) {\n                            _iterator.return();\n                        }\n                    } finally {\n                        if (_didIteratorError) {\n                            throw _iteratorError;\n                        }\n                    }\n                }\n            }\n            this.calculateAdjustedColors();\n        }\n\n        // from -100 to +100\n\n    }, {\n        key: 'calculateAdjustedColors',\n        value: function calculateAdjustedColors() {\n            this.adjustedColorOccurence.clear();\n            var _iteratorNormalCompletion2 = true;\n            var _didIteratorError2 = false;\n            var _iteratorError2 = undefined;\n\n            try {\n                for (var _iterator2 = (0, _getIterator3.default)(this.colorOccurence.values()), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                    var value = _step2.value;\n\n                    var s = this._calculate(value.s, this.sPercentage);\n                    var l = this._calculate(value.l, this.lPercentage);\n                    var color = new _Color2.default({ h: value.h, s: s, l: l, weight: value.weight });\n                    if (value.isAchromatic()) {\n                        color.setAchromatic();\n                    }\n                    this.adjustedColorOccurence.set(color.toString(), color);\n                }\n            } catch (err) {\n                _didIteratorError2 = true;\n                _iteratorError2 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                        _iterator2.return();\n                    }\n                } finally {\n                    if (_didIteratorError2) {\n                        throw _iteratorError2;\n                    }\n                }\n            }\n        }\n\n        // Lagrange interpolation\n\n    }, {\n        key: '_calculate',\n        value: function _calculate(x, xPercentage) {\n            var x0 = 100;\n            var x1 = xPercentage > 100 ? 200 : 0;\n            var y0 = x;\n            var y1 = xPercentage > 100 ? 100 : 0;\n            return y0 * ((xPercentage - x1) / (x0 - x1)) + y1 * ((xPercentage - x0) / (x1 - x0));\n        }\n    }]);\n    return TextColors;\n}();\n\nexports.default = TextColors;\n\n/***/ }),\n\n/***/ 20:\n/***/ (function(module, exports) {\n\nmodule.exports = angular;\n\n/***/ }),\n\n/***/ 227:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(1);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(2);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _Color = __webpack_require__(58);\n\nvar _Color2 = _interopRequireDefault(_Color);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar ColorFactory = function () {\n    function ColorFactory() {\n        (0, _classCallCheck3.default)(this, ColorFactory);\n    }\n\n    (0, _createClass3.default)(ColorFactory, [{\n        key: 'getInstance',\n        value: function getInstance(o) {\n            return new _Color2.default(o);\n        }\n    }]);\n    return ColorFactory;\n}();\n\nexports.default = ColorFactory;\n\n/***/ }),\n\n/***/ 228:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(1);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(2);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _ColorSet = __webpack_require__(229);\n\nvar _ColorSet2 = _interopRequireDefault(_ColorSet);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar ColorSetFactory = function () {\n    function ColorSetFactory() {\n        (0, _classCallCheck3.default)(this, ColorSetFactory);\n    }\n\n    (0, _createClass3.default)(ColorSetFactory, [{\n        key: 'getInstance',\n        value: function getInstance() {\n            return new _ColorSet2.default();\n        }\n    }]);\n    return ColorSetFactory;\n}();\n\nexports.default = ColorSetFactory;\n\n/***/ }),\n\n/***/ 229:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _toConsumableArray2 = __webpack_require__(37);\n\nvar _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);\n\nvar _iterator = __webpack_require__(230);\n\nvar _iterator2 = _interopRequireDefault(_iterator);\n\nvar _map = __webpack_require__(16);\n\nvar _map2 = _interopRequireDefault(_map);\n\nvar _classCallCheck2 = __webpack_require__(1);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(2);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar ColorSet = function () {\n    function ColorSet() {\n        (0, _classCallCheck3.default)(this, ColorSet);\n\n        this.map = new _map2.default();\n        this[_iterator2.default] = this.values;\n    }\n\n    (0, _createClass3.default)(ColorSet, [{\n        key: \"add\",\n        value: function add(color) {\n            this.map.set(color.toIdString(), color);\n        }\n    }, {\n        key: \"values\",\n        value: function values() {\n            return this.map.values();\n        }\n    }, {\n        key: \"getValuesArray\",\n        value: function getValuesArray() {\n            return [].concat((0, _toConsumableArray3.default)(this.map.values()));\n        }\n    }]);\n    return ColorSet;\n}();\n\nexports.default = ColorSet;\n\n/***/ }),\n\n/***/ 233:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(1);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar RoutingCtrl = function RoutingCtrl($scope, $transitions, $state, $timeout) {\n    var _this = this;\n\n    (0, _classCallCheck3.default)(this, RoutingCtrl);\n\n    $scope.page = \"main\";\n    // router event\n    $transitions.onSuccess({}, function (transition) {\n        var data = transition.to().data;\n        $scope.page = data[\"page\"];\n        $timeout(function () {\n            $scope.$broadcast('rzSliderForceRender');\n        }, 0);\n    });\n\n    $scope.goToSettings = function () {\n        _this.page = \"settings\";\n        $state.go('main.settings');\n    };\n\n    $scope.goToGuide = function () {\n        _this.page = \"guide\";\n        $state.go('main.guide');\n    };\n\n    $scope.goToMain = function () {\n        _this.page = \"main\";\n        $state.go('main');\n    };\n};\n\nRoutingCtrl.$inject = ['$scope', '$transitions', '$state', '$timeout'];\nexports.default = RoutingCtrl;\n\n/***/ }),\n\n/***/ 234:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _keys = __webpack_require__(235);\n\nvar _keys2 = _interopRequireDefault(_keys);\n\nvar _classCallCheck2 = __webpack_require__(1);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar JsonRpcException = function JsonRpcException(error) {\n    (0, _classCallCheck3.default)(this, JsonRpcException);\n\n    this.name = \"jsonRpcException\";\n    this.message = error;\n};\n\nangular.module('jsonrpc', []).provider('$JsonRpc', function () {\n    var url = \"\";\n    this.set = function (conf) {\n        url = conf[\"url\"];\n    };\n    this.$get = function () {\n        return {\n            url: url\n        };\n    };\n}).service('jsonrpc', ['$q', '$http', '$JsonRpc', function ($q, $http, jsonrpcConfig) {\n    var _url = jsonrpcConfig.url;\n    if (!_url) {\n        throw new JsonRpcException('Please configure server url');\n    }\n    var _header = { 'Content-Type': 'application/json' };\n    var _id = 0;\n    this.request = function (method, data) {\n        var deferred = $q.defer();\n        var req = {\n            method: 'POST',\n            url: _url,\n            headers: _header,\n            data: _getInputData(method, data)\n        };\n\n        $http(req).then(function (res) {\n            var data = res.data;\n            if (!res || !data) {\n                deferred.reject(new JsonRpcException(\"Unknown Error occured. No data received\"));\n            } else if (data && data.result !== undefined) {\n                if (!_inspectDataFormat(data)) {\n                    deferred.reject(new JsonRpcException(\"JSON-RPC 2.0 data format must be used.\"));\n                } else {\n                    deferred.resolve(data.result);\n                }\n            } else {\n                deferred.reject(new JsonRpcException('No data received. HTTP status code: ' + data.status));\n            }\n        }, function (error) {\n            if (error) {\n                deferred.reject(new JsonRpcException('Error occured. HTTP status code: ' + error.status));\n            } else {\n                deferred.reject(new JsonRpcException(\"Unknown Error occurred\"));\n            }\n        });\n        return deferred.promise;\n    };\n\n    function _getInputData(methodName, args) {\n        _id += 1;\n        return {\n            jsonrpc: '2.0',\n            id: _id,\n            method: methodName,\n            params: args\n        };\n    }\n\n    function _inspectDataFormat(data) {\n        var allowedKeys = [\"jsonrpc\", \"id\", \"result\"];\n        var keys = (0, _keys2.default)(data);\n        var ret = false;\n        if (keys.length === allowedKeys.length) {\n            ret = true;\n            keys.forEach(function (key) {\n                if (allowedKeys.indexOf(key) < 0) {\n                    ret = false;\n                }\n                if (key === \"jsonrpc\" && data[key] !== \"2.0\") {\n                    ret = false;\n                }\n            });\n        }\n        return ret;\n    }\n}]);\n\nexports.default = 'jsonrpc';\n\n/***/ }),\n\n/***/ 239:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\n__webpack_require__(240);\n\nvar _mainPage = __webpack_require__(241);\n\nvar _mainPage2 = _interopRequireDefault(_mainPage);\n\nvar _MainCtrl = __webpack_require__(242);\n\nvar _MainCtrl2 = _interopRequireDefault(_MainCtrl);\n\nvar _colorAdjuster = __webpack_require__(243);\n\nvar _colorAdjuster2 = _interopRequireDefault(_colorAdjuster);\n\nvar _colorProfiles = __webpack_require__(334);\n\nvar _colorProfiles2 = _interopRequireDefault(_colorProfiles);\n\nvar _textColorizer = __webpack_require__(337);\n\nvar _textColorizer2 = _interopRequireDefault(_textColorizer);\n\nvar _colorToolbar = __webpack_require__(350);\n\nvar _colorToolbar2 = _interopRequireDefault(_colorToolbar);\n\nvar _imageFinder = __webpack_require__(353);\n\nvar _imageFinder2 = _interopRequireDefault(_imageFinder);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nangular.module('main-page', [_colorAdjuster2.default, _colorProfiles2.default, _textColorizer2.default, _colorToolbar2.default, _imageFinder2.default]).factory('calculateFontColor', ['colorUtils', function (colorUtils) {\n    return function (color) {\n        return colorUtils.getFittingColorWithGreaterCR(color, \"#000000\", \"#ffffff\");\n    };\n}]).component('mainPage', {\n    template: _mainPage2.default,\n    controller: ['$rootScope', '$scope', 'textColors', '$timeout', 'appSettings', 'colorSetFactory', 'colorFactory', 'popupDialog', _MainCtrl2.default]\n});\n\nexports.default = 'main-page';\n\n/***/ }),\n\n/***/ 240:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 241:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=main-page> <color-toolbar closed=true color-modified-handler=$ctrl.colorModifiedHandler(color)></color-toolbar> <div class=\\\"colorizer main-page__colorizer\\\"> <text-colorizer colorizer-id=01 on-wordselect=$ctrl.selectWord(word)></text-colorizer> <div class=colorizer__controls> <a class=\\\"btn-bodyless btn-bodyless-success colorizer__button\\\" ng-click=$ctrl.inputComplete()><span class=\\\"glyphicon glyphicon-ok\\\"></span> OK</a><span class=colorizer__separator></span> <a class=\\\"btn-bodyless colorizer__button\\\" ng-click=$ctrl.edit()><span class=\\\"glyphicon glyphicon-pencil\\\"></span> Edit</a><span class=colorizer__separator></span> <a class=\\\"btn-bodyless btn-bodyless-danger colorizer__button\\\" ng-click=$ctrl.decolorizeDialog()><span class=\\\"glyphicon glyphicon-remove\\\"></span> Clear</a><span class=colorizer__separator></span> <a class=\\\"btn-bodyless btn-bodyless-danger colorizer__button\\\" ng-click=$ctrl.dropDialog()><span class=\\\"glyphicon glyphicon-trash\\\"></span> Drop</a> </div> </div> <div class=main-page__adjustments-container> <div class=\\\"panel panel-default main-page__adjustments adjustments\\\"> <div class=adjustments__label>Adjustments & Profiles</div> <div class=adjustments__inner> <div class=adjustments__content> <color-adjuster class=adjustments__adjuster text-colors=$ctrl.textColors></color-adjuster> <div class=adjustments__open-profiles-button> <a ng-model=collapsed ng-click=\\\"collapsed=!collapsed\\\" class=btn-bodyless><span class=\\\"glyphicon glyphicon-triangle-bottom\\\" ng-class=\\\"collapsed ? 'glyphicon-triangle-top' : 'glyphicon-triangle-bottom'\\\"></span> Profiles</a> </div> <div ng-show=collapsed class=adjustments__profiles> <color-profiles colors=$ctrl.colors on-load-profile=$ctrl.loadColorProfile(colors)></color-profiles> </div> </div> </div> </div> </div> <div class=main-page__find-button-container> <a class=\\\"btn btn-success main-page__find-button\\\" ng-click=$ctrl.search()><span class=\\\"glyphicon glyphicon-search\\\"></span> Find!</a> </div> <image-finder></image-finder> </div>\";\n\n/***/ }),\n\n/***/ 242:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _getIterator2 = __webpack_require__(15);\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _map = __webpack_require__(16);\n\nvar _map2 = _interopRequireDefault(_map);\n\nvar _classCallCheck2 = __webpack_require__(1);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(2);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar MainCtrl = function () {\n    function MainCtrl($rootScope, $scope, textColors, $timeout, appSettings, colorSetFactory, colorFactory, dialog) {\n        (0, _classCallCheck3.default)(this, MainCtrl);\n\n        this.appSettings = appSettings;\n        this.colors = new _map2.default();\n        this.textColors = textColors;\n        this.selectedWord = {};\n        this.$scope = $scope;\n        this.colorSetFactory = colorSetFactory;\n        this.colorFactory = colorFactory;\n        this.dialog = dialog;\n    }\n\n    (0, _createClass3.default)(MainCtrl, [{\n        key: \"_updateColors\",\n        value: function _updateColors() {\n            var _this = this;\n\n            this.$scope.$broadcast(\"text-colorizer\", function (colorizer) {\n                var cols = colorizer.getAllColors();\n                _this.textColors.clearWords();\n                _this.colors.clear();\n                var _iteratorNormalCompletion = true;\n                var _didIteratorError = false;\n                var _iteratorError = undefined;\n\n                try {\n                    for (var _iterator = (0, _getIterator3.default)(cols.values()), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                        var value = _step.value;\n\n                        var word = value.word.toLowerCase();\n                        var color = value.color;\n                        if (color.isSet()) {\n                            _this.textColors.addWord(word);\n                            var entry = _this.colors.get(word);\n                            if (entry) {\n                                entry.add(color);\n                            } else {\n                                var colorSet = _this.colorSetFactory.getInstance();\n                                colorSet.add(color);\n                                _this.colors.set(word, colorSet);\n                            }\n                        }\n                    }\n                } catch (err) {\n                    _didIteratorError = true;\n                    _iteratorError = err;\n                } finally {\n                    try {\n                        if (!_iteratorNormalCompletion && _iterator.return) {\n                            _iterator.return();\n                        }\n                    } finally {\n                        if (_didIteratorError) {\n                            throw _iteratorError;\n                        }\n                    }\n                }\n            });\n        }\n    }, {\n        key: \"loadColorProfile\",\n        value: function loadColorProfile(colors) {\n            var _this2 = this;\n\n            this.$scope.$broadcast(\"text-colorizer\", function (colorizer) {\n                colorizer.setColors(colors, function () {\n                    _this2._updateColors();\n                    _this2.textColors.updateColors(colorizer.getAllColors());\n                    _this2.$scope.$broadcast(\"colorsChainged\");\n                });\n            });\n        }\n    }, {\n        key: \"selectWord\",\n        value: function selectWord(word) {\n            var _this3 = this;\n\n            this.$scope.$broadcast(\"color-toolbar\", function (toolbar) {\n                _this3.selectedWord = word;\n                toolbar.setColor(word.color);\n                toolbar.open();\n            });\n        }\n    }, {\n        key: \"colorModifiedHandler\",\n        value: function colorModifiedHandler(color) {\n            var _this4 = this;\n\n            this.$scope.$broadcast(\"text-colorizer\", function (colorizer) {\n                if (color && colorizer) {\n                    if (color.isSet()) {\n                        colorizer.setColor(_this4.selectedWord, color, function () {\n                            _this4.textColors.updateColors(colorizer.getAllColors());\n                            _this4.$scope.$broadcast(\"colorsChainged\");\n                        });\n                    } else {\n                        colorizer.resetColor(_this4.selectedWord, function () {\n                            _this4.textColors.updateColors(colorizer.getAllColors());\n                            _this4.$scope.$broadcast(\"colorsChainged\");\n                        });\n                    }\n                    _this4._updateColors();\n                }\n            });\n        }\n    }, {\n        key: \"inputComplete\",\n        value: function inputComplete() {\n            var _this5 = this;\n\n            this.$scope.$broadcast(\"text-colorizer\", function (colorizer) {\n                colorizer.inputComplete(function () {\n                    _this5._updateColors();\n                    _this5.textColors.updateColors(colorizer.getAllColors());\n                    _this5.$scope.$broadcast(\"colorsChainged\");\n                });\n            });\n        }\n    }, {\n        key: \"drop\",\n        value: function drop() {\n            var _this6 = this;\n\n            this.$scope.$broadcast(\"text-colorizer\", function (colorizer) {\n                colorizer.clear(function () {\n                    _this6._updateColors();\n                    _this6.textColors.clear();\n                    _this6.$scope.$broadcast(\"colorsChainged\");\n                });\n            });\n        }\n    }, {\n        key: \"dropDialog\",\n        value: function dropDialog() {\n            var self = this;\n            this.dialog.confirmDialog(function () {\n                this.yes = function () {\n                    self.drop();\n                    self.dialog.close();\n                };\n                this.cancel = function () {\n                    self.dialog.close();\n                };\n                this.title = '\"drop\"';\n            });\n        }\n    }, {\n        key: \"decolorizeDialog\",\n        value: function decolorizeDialog() {\n            var self = this;\n            this.dialog.confirmDialog(function () {\n                this.yes = function () {\n                    self.decolorizeText();\n                    self.dialog.close();\n                };\n                this.cancel = function () {\n                    self.dialog.close();\n                };\n                this.title = '\"clear\"';\n            });\n        }\n    }, {\n        key: \"decolorizeText\",\n        value: function decolorizeText() {\n            var _this7 = this;\n\n            this.$scope.$broadcast(\"text-colorizer\", function (colorizer) {\n                colorizer.resetAllColors(function () {\n                    _this7._updateColors();\n                    _this7.textColors.clear();\n                    _this7.$scope.$broadcast(\"colorsChainged\");\n                });\n            });\n        }\n    }, {\n        key: \"edit\",\n        value: function edit() {\n            this.$scope.$broadcast(\"text-colorizer\", function (colorizer) {\n                colorizer.editMode();\n            });\n        }\n    }, {\n        key: \"search\",\n        value: function search() {\n            var _this8 = this;\n\n            this.$scope.$broadcast(\"image-finder\", function (imageFinder) {\n                var colorsAndWords = _this8.textColors.getColorsAndWords();\n                if (!_this8.appSettings.checkSemanticSimilarity) {\n                    colorsAndWords.words = [];\n                }\n                imageFinder.search(colorsAndWords, _this8.appSettings.getSearchSettings());\n            });\n        }\n    }]);\n    return MainCtrl;\n}();\n\nexports.default = MainCtrl;\n\n/***/ }),\n\n/***/ 243:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _slicedToArray2 = __webpack_require__(26);\n\nvar _slicedToArray3 = _interopRequireDefault(_slicedToArray2);\n\nvar _getIterator2 = __webpack_require__(15);\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _map = __webpack_require__(16);\n\nvar _map2 = _interopRequireDefault(_map);\n\n__webpack_require__(244);\n\nvar _angularChart = __webpack_require__(293);\n\nvar _angularChart2 = _interopRequireDefault(_angularChart);\n\nvar _angularjsSlider = __webpack_require__(174);\n\nvar _angularjsSlider2 = _interopRequireDefault(_angularjsSlider);\n\n__webpack_require__(332);\n\nvar _colorAdjuster = __webpack_require__(333);\n\nvar _colorAdjuster2 = _interopRequireDefault(_colorAdjuster);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nangular.module('color-adjuster', [_angularjsSlider2.default, _angularChart2.default]).component('colorAdjuster', {\n    template: _colorAdjuster2.default,\n    controller: [\"$scope\", \"$element\", \"$attrs\", \"$timeout\", \"colorUtils\", \"colorFactory\", \"eventFilter\", function Controller($scope, $element, $attrs, $timeout, colorUtils, colorFactory, eventFilter) {\n        var _this = this;\n\n        var adjuster = this;\n\n        this.toggle = function () {\n            $timeout(function () {\n                $scope.$broadcast('rzSliderForceRender');\n            }, 0, false);\n        };\n\n        this.getS = function () {\n            return _this.textColors.sPercentage < 100 ? '-' + Math.abs(adjuster.textColors.sPercentage - 100) : '+' + Math.abs(adjuster.textColors.sPercentage - 100);\n        };\n        this.getL = function () {\n            return _this.textColors.lPercentage < 100 ? '-' + Math.abs(adjuster.textColors.lPercentage - 100) : '+' + Math.abs(adjuster.textColors.lPercentage - 100);\n        };\n\n        var colorsChainged = function colorsChainged() {\n            var tempColors = new _map2.default();\n            var wei = [];\n            var cols = [];\n\n            var _iteratorNormalCompletion = true;\n            var _didIteratorError = false;\n            var _iteratorError = undefined;\n\n            try {\n                for (var _iterator = (0, _getIterator3.default)(_this.textColors.adjustedColorOccurence.entries()), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                    var _step$value = (0, _slicedToArray3.default)(_step.value, 2),\n                        key = _step$value[0],\n                        color = _step$value[1];\n\n                    var rgbHex = colorUtils.toHexString(key);\n                    var tempColor = tempColors.get(rgbHex);\n                    if (tempColor) {\n                        tempColor.weight += color.weight;\n                    } else {\n                        var col = colorFactory.getInstance(color);\n                        tempColors.set(rgbHex, col);\n                    }\n                }\n            } catch (err) {\n                _didIteratorError = true;\n                _iteratorError = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion && _iterator.return) {\n                        _iterator.return();\n                    }\n                } finally {\n                    if (_didIteratorError) {\n                        throw _iteratorError;\n                    }\n                }\n            }\n\n            var _iteratorNormalCompletion2 = true;\n            var _didIteratorError2 = false;\n            var _iteratorError2 = undefined;\n\n            try {\n                for (var _iterator2 = (0, _getIterator3.default)(tempColors), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                    var _step2$value = (0, _slicedToArray3.default)(_step2.value, 2),\n                        key = _step2$value[0],\n                        value = _step2$value[1];\n\n                    cols.push(key);\n                    wei.push(value.weight);\n                }\n            } catch (err) {\n                _didIteratorError2 = true;\n                _iteratorError2 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                        _iterator2.return();\n                    }\n                } finally {\n                    if (_didIteratorError2) {\n                        throw _iteratorError2;\n                    }\n                }\n            }\n\n            adjuster.data = wei;\n            adjuster.colors = cols;\n\n            $timeout(function () {\n                $scope.$apply();\n            }, 0, false);\n        };\n\n        this.labels = ['huhu', 'lol'];\n        this.data = [];\n        this.colors = [];\n\n        var timeWindow = 1000 / 30;\n        var filter = eventFilter(timeWindow, function () {\n            adjuster.textColors.calculateAdjustedColors();\n            colorsChainged();\n        });\n\n        this.options = {\n            tooltips: {\n                enabled: false\n            },\n            animation: {\n                animateRotate: false\n            },\n            events: []\n        };\n\n        this.slider = {\n            value: 50,\n            options: {\n                floor: 0,\n                ceil: 200,\n                step: 1,\n                onChange: function onChange() {\n                    filter.event();\n                },\n                onEnd: function onEnd() {\n                    adjuster.textColors.calculateAdjustedColors();\n                    colorsChainged();\n                },\n                hidePointerLabels: true,\n                hideLimitLabels: true,\n                disabled: false\n            }\n        };\n\n        $scope.$on(\"colorsChainged\", colorsChainged);\n\n        this.$onInit = function () {\n            colorsChainged();\n        };\n    }],\n\n    bindings: {\n        textColors: '<'\n    }\n});\n\nexports.default = 'color-adjuster';\n\n/***/ }),\n\n/***/ 332:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 333:\n/***/ (function(module, exports) {\n\nmodule.exports = \" <div class=color-adjuster> <canvas class=\\\"chart chart-doughnut color-adjuster__diagram\\\" chart-data=$ctrl.data chart-colors=$ctrl.colors chart-labels=$ctrl.labels chart-options=$ctrl.options></canvas> <div class=\\\"sliders color-adjuster__sliders\\\"> <div class=sliders__content> <div class=color-adjuster__slider> <div><span class=\\\"glyphicon glyphicon-signal\\\"></span> <span>{{$ctrl.getS()}}%</span></div> <rzslider rz-slider-model=$ctrl.textColors.sPercentage rz-slider-options=$ctrl.slider.options></rzslider> </div> <div class=color-adjuster__slider> <div><span class=\\\"glyphicon glyphicon-adjust icon-flipped\\\"></span> <span>{{$ctrl.getL()}}%</span></div> <rzslider rz-slider-model=$ctrl.textColors.lPercentage rz-slider-options=$ctrl.slider.options></rzslider> </div> </div> </div> </div> \";\n\n/***/ }),\n\n/***/ 334:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _toConsumableArray2 = __webpack_require__(37);\n\nvar _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);\n\nvar _classCallCheck2 = __webpack_require__(1);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(2);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _slicedToArray2 = __webpack_require__(26);\n\nvar _slicedToArray3 = _interopRequireDefault(_slicedToArray2);\n\nvar _map = __webpack_require__(16);\n\nvar _map2 = _interopRequireDefault(_map);\n\nvar _getIterator2 = __webpack_require__(15);\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\n__webpack_require__(335);\n\nvar _colorProfiles = __webpack_require__(336);\n\nvar _colorProfiles2 = _interopRequireDefault(_colorProfiles);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nangular.module('color-profiles', []).service('colorProfiles', ['db', 'colorFactory', function (db, colorFactory) {\n    return new ColorProfiles(new ColorProfilesDAO(db, colorFactory));\n}]).component('colorProfiles', {\n    template: _colorProfiles2.default,\n    controller: ['$rootScope', '$scope', '$timeout', 'colorProfiles', 'colorFactory', 'colorSetFactory', 'popupDialog', function Controller($rootScope, $scope, $timeout, colorProfiles, colorFactory, colorSetFactory, dialog) {\n        var _this = this;\n\n        this.createProfile = false;\n        this.notDeleteColors = false;\n        this.newProfileName = '';\n        this.colorProfiles = colorProfiles;\n        this.profiles = [];\n        this.conflictColors = [];\n        var singleColors = [];\n        var mode = '';\n\n        this.updateProfileDialog = function () {\n            var self = _this;\n            dialog.confirmDialog(function () {\n                this.yes = function () {\n                    self.updateProfile();\n                    dialog.close();\n                };\n                this.cancel = function () {\n                    dialog.close();\n                };\n                this.title = '\"update profile\"';\n            });\n        };\n\n        this.applyProfileDialog = function () {\n            var self = _this;\n            dialog.confirmDialog(function () {\n                this.yes = function () {\n                    self.applyProfile();\n                    dialog.close();\n                };\n                this.cancel = function () {\n                    dialog.close();\n                };\n                this.title = '\"apply profile\"';\n            });\n        };\n\n        this.deleteProfileDialog = function () {\n            var self = _this;\n            dialog.confirmDialog(function () {\n                this.yes = function () {\n                    self.deleteProfile();\n                    dialog.close();\n                };\n                this.cancel = function () {\n                    dialog.close();\n                };\n                this.title = '\"delete profile\"';\n            });\n        };\n\n        this.toggleNewProfile = function () {\n            _this.createProfile = !_this.createProfile;\n        };\n\n        this.haveProfiles = function () {\n            return _this.profiles.length > 0;\n        };\n\n        this.selectProfile = function () {\n            var name = colorProfiles.selectedProfile.name;\n            if (name !== null && name !== undefined) {\n                _this._resetColorConflicts();\n                colorProfiles.loadColorProfile(name, function () {});\n            }\n        };\n\n        this.saveProfile = function () {\n            var name = _this.newProfileName;\n            if (name !== undefined && name !== null && name.length > 0) {\n                _this._resetColorConflicts();\n                mode = 'create';\n                _this._testForColorConflicts();\n                if (_this.conflictColors.length < 1) {\n                    var colors = _this._convertColorArrayToMap(singleColors);\n                    _this._createColorProfile(name, colors);\n                }\n            }\n        };\n\n        this.applyProfile = function () {\n            var name = colorProfiles.selectedProfile.name;\n            if (name !== null && name !== undefined) {\n                _this._resetColorConflicts();\n                _this.onLoadProfile({\n                    colors: colorProfiles.getSelectedProfileColors()\n                });\n            }\n        };\n\n        this.updateProfile = function () {\n            var name = colorProfiles.selectedProfile.name;\n            if (name !== null && name !== undefined) {\n                _this._resetColorConflicts();\n                mode = 'update';\n                var colors = colorProfiles.getSelectedProfileColors();\n\n                if (!_this.notDeleteColors) {\n                    var _iteratorNormalCompletion = true;\n                    var _didIteratorError = false;\n                    var _iteratorError = undefined;\n\n                    try {\n                        for (var _iterator = (0, _getIterator3.default)(colors.keys()), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                            var word = _step.value;\n\n                            if (!_this.colors.has(word)) {\n                                colors.delete(word);\n                            }\n                        }\n                    } catch (err) {\n                        _didIteratorError = true;\n                        _iteratorError = err;\n                    } finally {\n                        try {\n                            if (!_iteratorNormalCompletion && _iterator.return) {\n                                _iterator.return();\n                            }\n                        } finally {\n                            if (_didIteratorError) {\n                                throw _iteratorError;\n                            }\n                        }\n                    }\n                }\n\n                _this._testForColorConflicts(colors);\n                if (_this.conflictColors.length < 1) {\n                    var cMap = _this._convertColorArrayToMap(singleColors);\n                    _this._updateColorProfile(name, cMap);\n                }\n            }\n        };\n\n        this.deleteProfile = function () {\n            var name = colorProfiles.selectedProfile.name;\n            if (name !== null && name !== undefined) {\n                colorProfiles.deleteColorProfile(name, function () {\n                    $scope.$apply();\n                    var profileName = _this.profiles[_this.profiles.length - 1];\n                    _this._resetColorConflicts();\n                    colorProfiles.loadColorProfile(profileName, function () {\n                        $scope.$apply();\n                    });\n                });\n            }\n        };\n\n        this.solveColorConflicts = function () {\n            var colors = _this._concatColorArraysToMap();\n            switch (mode) {\n                case 'update':\n                    {\n                        var name = colorProfiles.selectedProfile.name;\n                        if (name !== null && name !== undefined) {\n                            _this._updateColorProfile(name, colors);\n                        }\n                    }break;\n                case 'create':\n                    {\n                        var _name = _this.newProfileName;\n                        if (_name !== null && _name !== undefined) {\n                            _this._createColorProfile(_name, colors);\n                        }\n                    }break;\n            }\n        };\n\n        // helper functions\n        this._resetColorConflicts = function () {\n            _this.conflictColors = [];\n            singleColors = [];\n            mode = '';\n        };\n\n        this._createColorProfile = function (name, colors) {\n            colorProfiles.createColorProfile(name, colors, function () {\n                _this.newProfileName = \"\";\n                _this._resetColorConflicts();\n                colorProfiles.loadColorProfile(name, function () {\n                    $scope.$apply();\n                });\n            });\n        };\n\n        this._updateColorProfile = function (name, colors) {\n            colorProfiles.updateColorProfile(name, colors, function () {\n                _this._resetColorConflicts();\n                $timeout(function () {\n                    $scope.$apply();\n                }, 0);\n            });\n        };\n\n        this._testForColorConflicts = function (colors) {\n            var colorsMapTemp = new _map2.default();\n            var _iteratorNormalCompletion2 = true;\n            var _didIteratorError2 = false;\n            var _iteratorError2 = undefined;\n\n            try {\n                for (var _iterator2 = (0, _getIterator3.default)(_this.colors), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                    var _step2$value = (0, _slicedToArray3.default)(_step2.value, 2),\n                        word = _step2$value[0],\n                        mapColors = _step2$value[1];\n\n                    var colorsArray = mapColors.getValuesArray();\n                    var _colorSet = colorSetFactory.getInstance();\n                    for (var i = 0; i < colorsArray.length; i++) {\n                        _colorSet.add(colorsArray[i]);\n                    }\n                    colorsMapTemp.set(word, _colorSet);\n                }\n            } catch (err) {\n                _didIteratorError2 = true;\n                _iteratorError2 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                        _iterator2.return();\n                    }\n                } finally {\n                    if (_didIteratorError2) {\n                        throw _iteratorError2;\n                    }\n                }\n            }\n\n            if (colors) {\n                var _iteratorNormalCompletion3 = true;\n                var _didIteratorError3 = false;\n                var _iteratorError3 = undefined;\n\n                try {\n                    for (var _iterator3 = (0, _getIterator3.default)(colors), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n                        var _step3$value = (0, _slicedToArray3.default)(_step3.value, 2),\n                            word = _step3$value[0],\n                            color = _step3$value[1];\n\n                        var c = colorFactory.getInstance(color);\n                        var entry = colorsMapTemp.get(word);\n                        if (entry) {\n                            entry.add(c);\n                        } else {\n                            var colorSet = colorSetFactory.getInstance();\n                            colorSet.add(c);\n                            colorsMapTemp.set(word, colorSet);\n                        }\n                    }\n                } catch (err) {\n                    _didIteratorError3 = true;\n                    _iteratorError3 = err;\n                } finally {\n                    try {\n                        if (!_iteratorNormalCompletion3 && _iterator3.return) {\n                            _iterator3.return();\n                        }\n                    } finally {\n                        if (_didIteratorError3) {\n                            throw _iteratorError3;\n                        }\n                    }\n                }\n            }\n\n            var _iteratorNormalCompletion4 = true;\n            var _didIteratorError4 = false;\n            var _iteratorError4 = undefined;\n\n            try {\n                for (var _iterator4 = (0, _getIterator3.default)(colorsMapTemp), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n                    var _step4$value = (0, _slicedToArray3.default)(_step4.value, 2),\n                        word = _step4$value[0],\n                        mapColors = _step4$value[1];\n\n                    var colorsToWordArray = mapColors.getValuesArray();\n                    if (colorsToWordArray.length > 1) {\n                        var sel = colorsToWordArray[0];\n                        _this.conflictColors.push({ word: word, selected: sel, colors: colorsToWordArray });\n                    } else {\n                        var color = colorsToWordArray[0];\n                        singleColors.push({ word: word, color: color });\n                    }\n                }\n            } catch (err) {\n                _didIteratorError4 = true;\n                _iteratorError4 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion4 && _iterator4.return) {\n                        _iterator4.return();\n                    }\n                } finally {\n                    if (_didIteratorError4) {\n                        throw _iteratorError4;\n                    }\n                }\n            }\n        };\n\n        this._concatColorArraysToMap = function () {\n            var colors = [];\n            _this.conflictColors.forEach(function (item) {\n                colors.push({ word: item.word, color: item.selected });\n            });\n            colors = colors.concat(singleColors);\n            var cMap = _this._convertColorArrayToMap(colors);\n            return cMap;\n        };\n\n        this._convertColorArrayToMap = function (arr) {\n            var colorMap = new _map2.default();\n            for (var i = 0, k = arr.length; i < k; i++) {\n                var item = arr[i];\n                colorMap.set(item.word, item.color);\n            }\n            return colorMap;\n        };\n\n        this.$onInit = function () {\n            // bind model and viewmodel\n            colorProfiles.load(function () {\n                _this.profiles = colorProfiles.getColorProfileNames();\n                if (_this.profiles && _this.profiles.length > 0) {\n                    var name = _this.profiles[_this.profiles.length - 1];\n                    colorProfiles.loadColorProfile(name, function () {\n                        $scope.$apply();\n                    });\n                }\n            });\n        };\n    }],\n\n    bindings: {\n        colors: '<',\n        onLoadProfile: '&'\n    }\n});\n\nvar ColorProfiles = function () {\n    function ColorProfiles(dao) {\n        (0, _classCallCheck3.default)(this, ColorProfiles);\n\n        this.profileNames = [];\n        this.selectedProfile = {};\n        this.dao = dao;\n        this.dao.setProfiles(this);\n    }\n\n    (0, _createClass3.default)(ColorProfiles, [{\n        key: 'loadColorProfile',\n        value: function loadColorProfile(name, callback) {\n            this.dao.loadColorProfile(name, callback);\n        }\n\n        // get profiles\n\n    }, {\n        key: 'load',\n        value: function load(callback) {\n            this.dao.loadColorProfiles(callback);\n        }\n    }, {\n        key: 'createColorProfile',\n        value: function createColorProfile(name, colors, callback) {\n            var profile = new ColorProfile(name, colors);\n            this.dao.saveColorProfile(profile, callback);\n        }\n    }, {\n        key: 'deleteColorProfile',\n        value: function deleteColorProfile(name, callback) {\n            this.dao.deleteColorProfile(name, callback);\n        }\n    }, {\n        key: 'getColorProfileNames',\n        value: function getColorProfileNames() {\n            return this.profileNames;\n        }\n    }, {\n        key: 'getSelectedProfileColors',\n        value: function getSelectedProfileColors() {\n            return this.selectedProfile.colors;\n        }\n    }, {\n        key: 'updateColorProfile',\n        value: function updateColorProfile(name, colors, callback) {\n            if (this.selectedProfile.name === name) {\n                var profile = new ColorProfile(name, colors);\n                this.dao.updateColorProfile(profile, callback);\n            }\n        }\n    }, {\n        key: '_removeColorProfileName',\n        value: function _removeColorProfileName(name) {\n            var index = void 0;\n            for (var i = 0; i < this.profileNames.length; i++) {\n                if (this.profileNames[i] === name) {\n                    index = i;\n                    break;\n                }\n            }\n            this.profileNames.splice(index, 1);\n        }\n    }, {\n        key: '_setColorProfile',\n        value: function _setColorProfile(profile) {\n            this.selectedProfile = profile;\n        }\n    }, {\n        key: '_addColorProfileName',\n        value: function _addColorProfileName(name) {\n            this.profileNames.push(name);\n        }\n    }]);\n    return ColorProfiles;\n}();\n\nvar ColorProfile = function () {\n    function ColorProfile(name, colors) {\n        (0, _classCallCheck3.default)(this, ColorProfile);\n\n        this.name = name;\n        this.colors = colors;\n    }\n\n    (0, _createClass3.default)(ColorProfile, [{\n        key: 'serialize',\n        value: function serialize() {\n            var self = this;\n            var o = {};\n            o.name = this.name;\n            o.colors = [].concat((0, _toConsumableArray3.default)(self.colors));\n            return o;\n        }\n    }], [{\n        key: 'deserialize',\n        value: function deserialize(o, colorFactory) {\n            var name = o.name;\n            var colors = new _map2.default(o.colors);\n            var _iteratorNormalCompletion5 = true;\n            var _didIteratorError5 = false;\n            var _iteratorError5 = undefined;\n\n            try {\n                for (var _iterator5 = (0, _getIterator3.default)(colors), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n                    var _step5$value = (0, _slicedToArray3.default)(_step5.value, 2),\n                        word = _step5$value[0],\n                        color = _step5$value[1];\n\n                    colors.set(word, colorFactory.getInstance(color));\n                }\n            } catch (err) {\n                _didIteratorError5 = true;\n                _iteratorError5 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion5 && _iterator5.return) {\n                        _iterator5.return();\n                    }\n                } finally {\n                    if (_didIteratorError5) {\n                        throw _iteratorError5;\n                    }\n                }\n            }\n\n            return new ColorProfile(name, colors);\n        }\n    }]);\n    return ColorProfile;\n}();\n\nvar ColorProfilesDAO = function () {\n    function ColorProfilesDAO(db, colorFactory) {\n        (0, _classCallCheck3.default)(this, ColorProfilesDAO);\n\n        this.colorFactory = colorFactory;\n        this.profiles = [];\n        this.store = 'colorprofiles';\n        this.db = db;\n    }\n\n    (0, _createClass3.default)(ColorProfilesDAO, [{\n        key: 'setProfiles',\n        value: function setProfiles(profiles) {\n            this.profiles = profiles;\n        }\n    }, {\n        key: 'loadColorProfile',\n        value: function loadColorProfile(name, callback) {\n            var _this2 = this;\n\n            this.db.getStore(this.store).getItem(name).then(function (item) {\n                if (item) {\n                    var profile = ColorProfile.deserialize(item, _this2.colorFactory);\n                    _this2.profiles._setColorProfile(profile);\n                }\n                if (callback) {\n                    callback();\n                }\n            }).catch(function () {\n                console.warn(\"Database error\");\n            });\n        }\n    }, {\n        key: 'deleteColorProfile',\n        value: function deleteColorProfile(name, callback) {\n            var _this3 = this;\n\n            this.db.getStore(this.store).removeItem(name).then(function () {\n                _this3.profiles._removeColorProfileName(name);\n                if (callback) {\n                    callback();\n                }\n            }).catch(function () {\n                console.warn(\"Database error\");\n            });\n        }\n    }, {\n        key: 'saveColorProfile',\n        value: function saveColorProfile(profile, callback) {\n            var _this4 = this;\n\n            var store = this.db.getStore(this.store);\n            store.getItem(profile.name).then(function (item) {\n                if (!item) {\n                    return store.setItem(profile.name, profile.serialize()).then(function () {\n                        _this4.profiles._addColorProfileName(profile.name);\n                        _this4.profiles._setColorProfile(profile);\n                        if (callback) {\n                            callback();\n                        }\n                    });\n                }\n                return null;\n            }).catch(function (e) {\n                console.warn(\"Database error\");\n                console.error(e);\n            });\n        }\n    }, {\n        key: 'loadColorProfiles',\n        value: function loadColorProfiles(callback) {\n            var _this5 = this;\n\n            this.db.getStore(this.store).iterate(function (value, key) {\n                return _this5.profiles._addColorProfileName(key);\n            }).then(function () {\n                if (callback) {\n                    callback();\n                }\n            }).catch(function () {\n                console.warn(\"Database error\");\n            });\n        }\n    }, {\n        key: 'updateColorProfile',\n        value: function updateColorProfile(profile, callback) {\n            var _this6 = this;\n\n            this.db.getStore(this.store).setItem(profile.name, profile.serialize()).then(function () {\n                _this6.loadColorProfile(profile.name, function () {\n                    if (callback) {\n                        callback();\n                    }\n                });\n            }).catch(function () {\n                console.warn(\"Database connection error\");\n            });\n        }\n    }]);\n    return ColorProfilesDAO;\n}();\n\nexports.default = 'color-profiles';\n\n/***/ }),\n\n/***/ 335:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 336:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div> <select class=color-profiles__profiles ng-change=$ctrl.selectProfile() ng-model=$ctrl.colorProfiles.selectedProfile.name> <option ng-repeat=\\\"profile in $ctrl.profiles track by $index\\\" data-colorprofiles-profile={{$index}} value={{profile}}>{{profile}}</option> </select> <div class=\\\"control-buttons color-profiles__control-buttons\\\"> <a ng-click=$ctrl.applyProfileDialog() class=\\\"btn-bodyless btn-bodyless-success\\\" ng-class=\\\"$ctrl.haveProfiles() ? '' : 'disabled'\\\"><span class=\\\"glyphicon glyphicon-tint\\\"></span> Apply</a> <a ng-click=$ctrl.updateProfileDialog() class=btn-bodyless ng-class=\\\"$ctrl.haveProfiles() ? '' : 'disabled'\\\"><span class=\\\"glyphicon glyphicon-floppy-save\\\"></span> Update</a> <a ng-click=$ctrl.deleteProfileDialog() class=\\\"btn-bodyless btn-bodyless-danger\\\" ng-class=\\\"$ctrl.haveProfiles() ? '' : 'disabled'\\\"><span class=\\\"glyphicon glyphicon-trash\\\"></span> Drop</a> <a ng-click=$ctrl.toggleNewProfile() class=\\\"btn-bodyless btn-bodyless-success\\\"><span class=\\\"glyphicon glyphicon-plus\\\" aria-hidden=true></span> Create</a> </div> <div class=\\\"create-profile color-profiles__create-profile\\\"> <div ng-show=$ctrl.createProfile> <input ng-model=$ctrl.newProfileName type=text class=\\\"form-control create-profile__profile-name\\\" placeholder=Profile> <a ng-click=$ctrl.saveProfile() class=\\\"btn btn-success btn-block\\\"><span class=\\\"glyphicon glyphicon-save\\\" aria-hidden=true></span> Save</a> </div> </div> <div ng-show=\\\"$ctrl.conflictColors.length>0\\\" class=\\\"conflicts color-profiles__conflicts\\\"> <div class=conflicts__title><span>Conflicts</span></div> <div ng-repeat=\\\"item in $ctrl.conflictColors track by $index\\\"> {{item.word}} <form> <div ng-repeat=\\\"color in item.colors track by $index\\\"> <input ng-model=$ctrl.conflictColors[$parent.$index].selected ng-value=color type=radio> <div class=conflicts__color ng-style=\\\"{'background-color': color}\\\"></div><span class=conflicts__weight> weight: {{color.weight}}</span> </div> </form> </div> <a ng-click=\\\"$ctrl.solveColorConflicts() \\\" class=\\\"btn btn-success\\\"><span class=\\\"glyphicon glyphicon-ok\\\" aria-hidden=true></span> OK</a> </div> </div>\";\n\n/***/ }),\n\n/***/ 337:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _getIterator2 = __webpack_require__(15);\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nvar _set = __webpack_require__(338);\n\nvar _set2 = _interopRequireDefault(_set);\n\nvar _map = __webpack_require__(16);\n\nvar _map2 = _interopRequireDefault(_map);\n\nvar _xregexp = __webpack_require__(344);\n\nvar _xregexp2 = _interopRequireDefault(_xregexp);\n\nvar _htmlEntities = __webpack_require__(345);\n\nvar _htmlEntities2 = _interopRequireDefault(_htmlEntities);\n\n__webpack_require__(348);\n\nvar _textColorizer = __webpack_require__(349);\n\nvar _textColorizer2 = _interopRequireDefault(_textColorizer);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar entities = _htmlEntities2.default.AllHtmlEntities;\nangular.module('text-colorizer', []).component('textColorizer', {\n    template: _textColorizer2.default,\n    controller: [\"$scope\", \"$element\", \"$attrs\", \"$timeout\", \"$window\", \"calculateFontColor\", \"colorFactory\", function ($scope, $element, $attrs, $timeout, $window, calculateFontColor, colorFactory) {\n        var _this = this;\n\n        var _colorizer = this;\n        var calcFontColor = calculateFontColor;\n        var _options = {\n            widgetSelector: 'data-textcolorizer-text',\n            wordSelector: 'data-textcolorizer-word',\n            colorSelector: 'data-textcolorizer-color',\n            weightSelector: 'data-textcolorizer-weight',\n            helperSelector: 'data-textcolorizer-helper'\n        };\n\n        var _vars = {\n            root: angular.element($element.find('div[' + _options.widgetSelector + ']')[0]),\n            words: new _map2.default(),\n            wordsToRemove: new _set2.default(),\n            editMode: false,\n            idCounter: 0,\n            helperCounter: 0,\n            wordWidth: 5\n        };\n\n        var specialChars = new _map2.default();\n        specialChars.set('#%%%#;', '<');\n        specialChars.set('#%%#%;', '>');\n        specialChars.set('#%#%%;', '</');\n        specialChars.set('##%%%;', '\"');\n\n        function encodeSpecialChars(str) {\n            return str.replace(/#%%%#;|#%%#%;|#%#%%;|##%%%;/g, function (m) {\n                return specialChars.get(m);\n            });\n        }\n\n        // public api\n        var api = {\n            inputComplete: function inputComplete(callback) {\n                _colorizer.inputComplete(callback);\n            },\n            editMode: function editMode() {\n                _colorizer.editMode();\n            },\n            setColor: function setColor(colorObject, conf, callback) {\n                _colorizer.setColor(colorObject, conf, callback);\n            },\n            resetColor: function resetColor(colorObject, callback) {\n                _colorizer.resetColor(colorObject, callback);\n            },\n            resetAllColors: function resetAllColors(callback) {\n                _colorizer.resetAllColors(callback);\n            },\n            getAllColors: function getAllColors() {\n                return _colorizer.getAllColors();\n            },\n            setColors: function setColors(colors, callback) {\n                _colorizer.setColors(colors, callback);\n            },\n            clear: function clear(callback) {\n                _colorizer.clear(callback);\n            }\n        };\n\n        $scope.$on(\"text-colorizer\", function (event, callback) {\n            if (typeof callback === \"function\") {\n                callback(api);\n            }\n        });\n\n        // allows only plain text paste\n        this._handlePaste = function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            var text = '';\n            if (e.clipboardData || e.originalEvent.clipboardData) {\n                text = (e.originalEvent || e).clipboardData.getData('Text');\n            } else if ($window.clipboardData) {\n                text = $window.clipboardData.getData('Text');\n            }\n            if ($window.document.queryCommandSupported('insertText')) {\n                $window.document.execCommand('insertText', false, text);\n            } else {\n                $window.document.execCommand('paste', false, text);\n            }\n        };\n\n        // Chrome workaround for proper style and behavior\n        // handler for \"keydown\" events in widget\n        this._handleKeydown = function (event) {\n            // update & delete word nodes if enter or delete keyevents performed\n            if (event.keyCode === 13 || event.keyCode === 8 || event.keyCode === 46) {\n                $window.setTimeout(function () {\n                    _colorizer._deleteEmpty();\n                    _colorizer._updateFontStyle();\n                }, 0);\n            }\n\n            if (event.keyCode === 8 || event.keyCode === 46) {\n                if ($window && $window.getSelection && $window.getSelection().anchorNode && $window.getSelection().getRangeAt(0)) {\n                    var target = $window.getSelection().anchorNode.parentNode;\n                    if (angular.element(target).attr('' + _options.wordSelector)) {\n                        var sel = $window.getSelection();\n                        // if different nodes are involved\n                        // check all nodes\n                        if (sel.anchorNode === sel.focusNode) {\n                            var range = sel.getRangeAt(0);\n                            var startIndex = range.startOffset;\n                            var endIndex = range.endOffset;\n                            var count = Math.abs(startIndex - endIndex);\n                            var text = sel.anchorNode.nodeValue;\n                            var spaceReg = (0, _xregexp2.default)('^(\\xA0)$', \"gi\");\n\n                            if (count < 2) {\n                                if (event.keyCode === 8) {\n                                    if (startIndex === 1 || startIndex === 0 || endIndex === 1 || endIndex === 0) {\n                                        if (text.trim().length > 0 && text[startIndex - 1].match(spaceReg)) {\n                                            event.preventDefault();\n                                        }\n                                    } else if (startIndex === text.length || endIndex === text.length) {\n                                        event.preventDefault();\n                                        sel.anchorNode.nodeValue = text.slice(0, -2) + '\\xA0';\n                                        _this._moveCaretInText(sel.anchorNode.nodeValue.length, sel.anchorNode);\n                                    }\n                                } else if (event.keyCode === 46) {\n                                    if (startIndex === 0 || startIndex === text.length || endIndex === 0 || endIndex === text.length) {\n                                        event.preventDefault();\n                                    }\n                                }\n                            }\n\n                            if (count > 1 && count < text.length) {\n                                if (startIndex === 0) {\n                                    event.preventDefault();\n                                    sel.anchorNode.nodeValue = '\\xA0' + text.slice(endIndex);\n                                    _this._moveCaretInText(1, sel.anchorNode);\n                                } else if (endIndex === text.length) {\n                                    event.preventDefault();\n                                    sel.anchorNode.nodeValue = text.slice(0, -count) + '\\xA0';\n                                    _this._moveCaretInText(sel.anchorNode.nodeValue.length, sel.anchorNode);\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        };\n\n        // Chrome fonts\n        this._updateFontStyle = function () {\n            _vars.root.css({\n                'font-size': '1em',\n                'line-height': '1.7em'\n            });\n        };\n\n        this._handleCut = function () {\n            $window.setTimeout(function () {\n                return colorizer._updateWordsStyle();\n            }, 0);\n        };\n\n        this._updateWordsStyle = function () {\n            angular.element(_vars.root).find('mark[' + _options.wordSelector + ']').each(function (i, elem) {\n                var $wordNode = angular.element(elem);\n                var text = $wordNode.text().trim();\n                $wordNode.text('\\xA0' + text + '\\xA0');\n            });\n            _this._deleteEmpty();\n            _this._updateFontStyle();\n        };\n\n        // helper function: move caret to special position in textnode\n        this._moveCaretInText = function (position, textNode) {\n            var caret = position;\n            var range = $window.document.createRange();\n            range.setStart(textNode, caret);\n            range.collapse(true);\n            var sel = $window.getSelection();\n            sel.removeAllRanges();\n            sel.addRange(range);\n        };\n\n        /** *********  main methods ********** */\n\n        // colorize words\n        // @params: colors map, callback function (optional)\n        this.setColors = function (colors, callback) {\n            _this.inputComplete(function () {\n                _vars.root.find('mark[' + _options.wordSelector + ']').each(function (i, elem) {\n                    var id = parseInt(angular.element(elem).attr('' + _options.wordSelector), 10);\n                    var wordItem = _vars.words.get(id);\n                    var color = colors.get(wordItem.word);\n                    if (color) {\n                        _colorizer._setWordColor(wordItem, color, angular.element(elem));\n                    }\n                });\n                if (callback) {\n                    callback();\n                }\n            });\n        };\n\n        // apply color to word\n        // @param: word, new color, \"word\" node\n        this._setWordColor = function (wordItem, color, $wordNode) {\n            wordItem.color.setColor(color);\n            $wordNode.css({ \"background-color\": color.toString() });\n            $wordNode.css({ color: calcFontColor(color) });\n        };\n\n        // subroutine: delete empty \"words\"\n        this._deleteEmpty = function () {\n            _vars.root.find('mark[' + _options.wordSelector + ']').filter(function (i, elem) {\n                var ret = true;\n                var $wordNode = angular.element(elem);\n                if (!($wordNode.text().trim().length < 1 || $wordNode.text().trim() === '&nbsp;' || $wordNode.text().trim() === '' || $wordNode.find(\"br\").length > 0 && !$wordNode.parent().is(_vars.root))) {\n                    ret = false;\n                }\n                return ret;\n            }).remove();\n            return _this;\n        };\n\n        this.createWordMark = function (id, txt, backgroundColor, fontColor) {\n            return '#%%%#;mark ' + _options.wordSelector + '=' + id + ' style = ##%%%;background-color: ' + backgroundColor + '; color: ' + fontColor + ';##%%%;#%%#%;\\xA0' + txt + '\\xA0#%#%%;mark#%%#%;';\n        };\n\n        // subroutine: handle changes in detected words\n        this._inWordTags = function () {\n            _vars.root.find('mark[' + _options.wordSelector + ']').each(function (i, elem) {\n                var $wordNode = angular.element(elem);\n                var idString = $wordNode.attr(_options.wordSelector);\n                var id = parseInt(idString, 10);\n                var backgroundColor = $wordNode.css(\"background-color\");\n                var fontColor = $wordNode.css(\"color\");\n                var text = $wordNode.text();\n                var format = (0, _xregexp2.default)('^(?:\\xA0[\\\\pN\\\\pL]+\\xA0)$', 'i');\n                var word = _vars.words.get(id);\n                if (!text.match(format)) {\n                    var newHtml = text.replace((0, _xregexp2.default)('[\\\\pN\\\\pL]+', 'gi'), function (needle) {\n                        var color = colorFactory.getInstance(word.color);\n                        var wordId = _vars.idCounter++;\n                        _vars.words.set(wordId, { id: wordId, color: color, word: needle.toLowerCase() });\n                        return _this.createWordMark(wordId, needle, backgroundColor, fontColor);\n                    });\n                    _vars.wordsToRemove.add(id);\n                    $wordNode.replaceWith(encodeSpecialChars(entities.encode(newHtml)));\n                }\n            });\n            return _this;\n        };\n\n        // handle (new) text outside from detected words\n        // find all strings, which are not in (mark) tags and create new marks\n        this._notInTags = function () {\n            var reg = (0, _xregexp2.default)('[\\\\pN\\\\pL]+', 'gi');\n            _vars.root.contents().filter(function (i, item) {\n                return item.nodeType === 3;\n            }).each(function (i, item) {\n                var txt = item.nodeValue.trim().replace(/\\s+/g, ' ');\n                var html = txt.replace(reg, function (needle) {\n                    var color = colorFactory.getInstance();\n                    var wordId = _vars.idCounter++;\n                    _vars.words.set(wordId, { id: wordId, color: color, word: needle.toLowerCase() });\n                    return _this.createWordMark(wordId, needle, null, null);\n                });\n                angular.element(item).replaceWith(encodeSpecialChars(entities.encode(html)));\n            }).end();\n            _vars.root.find(\"br\").replaceWith(\" \");\n            return _this;\n        };\n\n        this._updateWords = function (word) {\n            _vars.root.find('mark[' + _options.wordSelector + '=' + word.id + ']').each(function (i, elem) {\n                var $wordNode = angular.element(elem);\n                var text = $wordNode.text();\n                var color = colorFactory.getInstance(word.color);\n                var wordId = _vars.idCounter++;\n                $wordNode.attr('' + _options.wordSelector, wordId);\n                _vars.words.set(wordId, { id: wordId, color: color, word: text.toLowerCase() });\n            });\n        };\n\n        // set carte to the end of element\n        // @params: element node\n        this._setCaretPosition = function (element) {\n            var range = $window.document.createRange();\n            var sel = $window.getSelection();\n            range.setStartAfter(element);\n            range.setEndAfter(element);\n            sel.removeAllRanges();\n            sel.addRange(range);\n        };\n\n        // detect words in text\n        // @param: callback function (optional)\n        this.inputComplete = function (callback) {\n            _vars.editMode = false;\n            // unwrape, if text was wrapped in tags by browser\n            _vars.root.find(':not(mark[' + _options.wordSelector + '])').contents().unwrap();\n            _vars.root.find(':not(mark[' + _options.wordSelector + '])').remove();\n            _this._deleteEmpty()._inWordTags()._notInTags();\n            _vars.root.find(':not(mark[' + _options.wordSelector + '])').remove();\n            _vars.root.attr(\"contentEditable\", false);\n            var currentIds = new _set2.default();\n            _vars.root.find('mark[' + _options.wordSelector + ']').each(function (i, elem) {\n                var idString = angular.element(elem).attr(_options.wordSelector);\n                var id = parseInt(idString, 10);\n                currentIds.add(id);\n            });\n\n            _vars.root.find('mark[' + _options.wordSelector + ']').each(function (i, elem) {\n                if (elem.nextSibling && elem.nextSibling.nodeType !== 3) {\n                    var node = $window.document.createTextNode('\\xA0');\n                    elem.parentNode.insertBefore(node, elem.nextSibling);\n                }\n            });\n\n            var _iteratorNormalCompletion = true;\n            var _didIteratorError = false;\n            var _iteratorError = undefined;\n\n            try {\n                for (var _iterator = (0, _getIterator3.default)(_vars.words.keys()), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                    var id = _step.value;\n\n                    if (_vars.wordsToRemove.has(id) || !currentIds.has(id)) {\n                        _vars.words.delete(id);\n                    }\n                }\n            } catch (err) {\n                _didIteratorError = true;\n                _iteratorError = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion && _iterator.return) {\n                        _iterator.return();\n                    }\n                } finally {\n                    if (_didIteratorError) {\n                        throw _iteratorError;\n                    }\n                }\n            }\n\n            _vars.wordsToRemove.clear();\n            if (callback) {\n                callback();\n            }\n        };\n\n        // switch to edit mode and move caret to the end\n        this.editMode = function () {\n            _vars.editMode = true;\n            _vars.root.attr(\"contentEditable\", true);\n            var lastNodeType = _vars.root.contents().last()[0] ? _vars.root.contents().last()[0].nodeType : undefined;\n            if (lastNodeType && lastNodeType !== 3) {\n                var space = $window.document.createTextNode('\\xA0');\n                _vars.root.append(angular.element(space));\n                _colorizer._setCaretPosition(_vars.root.contents().last()[0]);\n            } else if (lastNodeType) {\n                _vars.root.append('<span ' + _options.helperSelector + '></span>');\n                _colorizer._setCaretPosition(_vars.root.find('span[' + _options.helperSelector + ']')[0]);\n                $timeout(function () {\n                    _vars.root.find('span[' + _options.helperSelector + ']').remove();\n                }, 0);\n            }\n            _vars.root[0].focus();\n        };\n\n        // set one color\n        // @params: color object, new color, callback function (optional)\n        this.setColor = function (word, newColor, callback) {\n            if (!_vars.editMode && word) {\n                var $wordNode = _vars.root.find('mark[' + _options.wordSelector + '=' + word.id + ']');\n                if ($wordNode && $wordNode.length > 0) {\n                    var savedWord = _vars.words.get(word.id);\n                    savedWord.color.setColor(newColor);\n                    $wordNode.css({ \"background-color\": savedWord.color.toString(),\n                        color: calcFontColor(savedWord.color) });\n                }\n            }\n            if (callback) {\n                callback();\n            }\n        };\n\n        // return all colors as map\n        this.getAllColors = function () {\n            return _vars.words;\n        };\n\n        // reset one color (decolorize word)\n        // @params: color object, callback function (optional)\n        this.resetColor = function (word, callback) {\n            if (!_vars.editMode && word) {\n                var $wordNode = _vars.root.find('mark[' + _options.wordSelector + '=' + word.id + ']');\n                if ($wordNode && $wordNode.length > 0) {\n                    $wordNode.removeAttr(\"style\");\n                    var savedWord = _vars.words.get(word.id);\n                    if (savedWord) {\n                        savedWord.color.reset();\n                    }\n                }\n            }\n            if (callback) {\n                callback(_this);\n            }\n        };\n\n        this.resetAllColors = function (callback) {\n            _vars.root.find('mark[' + _options.wordSelector + ']').removeAttr(\"style\");\n            var _iteratorNormalCompletion2 = true;\n            var _didIteratorError2 = false;\n            var _iteratorError2 = undefined;\n\n            try {\n                for (var _iterator2 = (0, _getIterator3.default)(_vars.words.values()), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                    var word = _step2.value;\n\n                    word.color.reset();\n                }\n            } catch (err) {\n                _didIteratorError2 = true;\n                _iteratorError2 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                        _iterator2.return();\n                    }\n                } finally {\n                    if (_didIteratorError2) {\n                        throw _iteratorError2;\n                    }\n                }\n            }\n\n            if (callback) {\n                callback();\n            }\n        };\n\n        // event handler for \"click\" events in the widget\n        // event delegation -> handles clicks on words in editor\n        // @params: event object\n        this.selectWord = function ($event) {\n            var $targetNode = angular.element($event.target);\n            if ($targetNode.length > 0 && $targetNode[0].hasAttribute(_options.wordSelector)) {\n                if (!_vars.editMode) {\n                    $event.stopPropagation();\n                    var id = $targetNode.attr(_options.wordSelector);\n                    var savedWord = _vars.words.get(parseInt(id, 10));\n                    _this.onWordselect({ word: savedWord });\n                } else {\n                    // for better handling in webkit\n                    var textNode = $targetNode.contents().first()[0];\n                    var anchorNode = $window.getSelection().anchorNode;\n                    if (anchorNode && !textNode.isSameNode(anchorNode)) {\n                        var nativeText = $targetNode.text();\n                        if (nativeText[0].trim().length > 0) {\n                            var spaceText = $window.document.createTextNode('\\xA0' + textNode.textContent.trim() + '\\xA0');\n                            textNode.parentNode.replaceChild(spaceText, textNode);\n                            _this._moveCaretInText(1, spaceText);\n                        }\n                    }\n                }\n            }\n        };\n\n        // delete all color assignments and empty colors map\n        // @params: callback function (optional)\n        this.clear = function (callback) {\n            _vars.words.clear();\n            _vars.root.attr(\"contentEditable\", true);\n            _vars.root.empty();\n            _vars.root[0].focus();\n            callback();\n        };\n    }],\n\n    bindings: {\n        control: '<',\n        onWordselect: '&'\n    }\n});\n\nexports.default = 'text-colorizer';\n\n/***/ }),\n\n/***/ 348:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 349:\n/***/ (function(module, exports) {\n\nmodule.exports = \" <div class=textcolorizer> <div data-textcolorizer-text ng-click=$ctrl.selectWord($event) ng-keydown=$ctrl._handleKeydown($event) ng-paste=$ctrl._handlePaste($event) ng-cut=$ctrl._handleCut($event) contenteditable=true>Lorem ipsum dolor sit amet</div> <div data-textcolorizer-background></div> </div>\";\n\n/***/ }),\n\n/***/ 350:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _angularjsSlider = __webpack_require__(174);\n\nvar _angularjsSlider2 = _interopRequireDefault(_angularjsSlider);\n\n__webpack_require__(351);\n\nvar _colorToolbar = __webpack_require__(352);\n\nvar _colorToolbar2 = _interopRequireDefault(_colorToolbar);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nangular.module('color-toolbar', [_angularjsSlider2.default]).component('colorToolbar', {\n    template: _colorToolbar2.default,\n    controller: [\"$rootScope\", \"$scope\", \"$element\", \"$attrs\", \"$timeout\", \"$window\", \"colorFactory\", \"eventFilter\", function Controller($rootScope, $scope, $element, $attrs, $timeout, $window, colorFactory, eventFilter) {\n        var _this = this;\n\n        var toolbar = this;\n        this.id = $attrs[\"toolbarId\"];\n        this.colors = [];\n\n        for (var i = 0; i < 360; i += 30) {\n            var color = colorFactory.getInstance({ h: i, s: 50, l: 50 });\n            this.colors.push(color);\n        }\n        var black = colorFactory.getInstance({ h: 0, s: 0, l: 0 }).setAchromatic();\n        var white = colorFactory.getInstance({ h: 0, s: 0, l: 100 }).setAchromatic();\n        this.colors.push(black);\n        this.colors.push(white);\n        this.color = colorFactory.getInstance();\n\n        var timeWindow = 1000 / 30;\n        var filter = eventFilter(timeWindow, function () {\n            toolbar.colorModifiedHandler({ color: toolbar.color });\n        });\n\n        this.slider = {\n            value: 50,\n            options: {\n                floor: 0,\n                ceil: 100,\n                step: 1,\n                onChange: function onChange() {\n                    filter.event();\n                },\n                onEnd: function onEnd() {\n                    toolbar.colorModifiedHandler({ color: toolbar.color });\n                },\n\n                hidePointerLabels: true,\n                hideLimitLabels: true,\n                disabled: true\n            }\n        };\n\n        this.increaseWeight = function () {\n            if (_this.color && _this.color.isSet() && _this.color.weight < 100) {\n                toolbar.color.weight++;\n                _this.colorModifiedHandler({ color: toolbar.color });\n            }\n        };\n\n        this.decreaseWeight = function () {\n            if (_this.color && _this.color.isSet() && _this.color.weight > 1) {\n                toolbar.color.weight--;\n                _this.colorModifiedHandler({ color: toolbar.color });\n            }\n        };\n\n        this.endSlide = function () {\n            _this.colorModifiedHandler({ color: toolbar.color });\n        };\n\n        this.selectColor = function ($event) {\n            var target = $event.target;\n            if (target.hasAttribute(\"data-toolbar-color\") || target.parentElement.hasAttribute(\"data-toolbar-color\")) {\n                $event.stopPropagation();\n                var colorElement = target.hasAttribute(\"data-toolbar-color\") ? target : target.parentElement;\n                var colorIndex = angular.element(colorElement).attr(\"data-toolbar-color\");\n                if (colorIndex && colorIndex !== \"null\") {\n                    var _color = colorFactory.getInstance(_this.colors[colorIndex]);\n                    _this.changeColor(_color);\n                    _this.slider.options.disabled = _this.color.isAchromatic();\n                } else {\n                    _this.setInitialColor();\n                }\n                _this.colorModifiedHandler({ color: toolbar.color });\n            }\n        };\n\n        this.changeColor = function (color) {\n            color.weight = _this.color.weight;\n            if (!color.isAchromatic() && !_this.color.isAchromatic() && _this.color.s && _this.color.l) {\n                color.s = _this.color.s;\n                color.l = _this.color.l;\n            }\n            _this.color = color;\n        };\n\n        this.setCurrentColor = function (color) {\n            if (color && color.isSet()) {\n                _this.color = color;\n                _this.slider.options.disabled = _this.color.isAchromatic();\n            } else {\n                _this.setInitialColor();\n            }\n        };\n\n        this.setInitialColor = function () {\n            _this.color = colorFactory.getInstance();\n            _this.slider.options.disabled = true;\n        };\n\n        this.close = function () {\n            $element.addClass(\"hide\");\n        };\n\n        this.open = function () {\n            $element.removeClass(\"hide\");\n            $timeout(function () {\n                $scope.$broadcast('rzSliderForceRender');\n            }, 0);\n        };\n\n        // public api\n        var api = {\n            setColor: function setColor(color) {\n                toolbar.setCurrentColor(color);\n            },\n            close: function close() {\n                toolbar.close();\n            },\n            open: function open() {\n                toolbar.open();\n            }\n        };\n\n        $scope.$on(\"color-toolbar\", function (event, callback) {\n            if (typeof callback === \"function\") {\n                callback(api);\n            }\n        });\n\n        this.$onInit = function () {\n            if (_this.closed === true) {\n                _this.close();\n            }\n            angular.element($window).bind('resize orientationchange', function () {\n                $rootScope.$broadcast('rzSliderForceRender');\n            });\n        };\n    }],\n\n    bindings: {\n        colorModifiedHandler: '&',\n        closed: '<'\n    }\n});\n\nexports.default = 'color-toolbar';\n\n/***/ }),\n\n/***/ 351:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 352:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=toolbar> <div class=toolbar__content> <div class=toolbar__left> <div class=colorbox ng-click=$ctrl.selectColor($event)> <div ng-repeat=\\\"c in $ctrl.colors track by $index\\\"> <div class=colorbox__color data-toolbar-color={{$index}} ng-style=\\\"{'background-color': c}\\\"></div> </div> <div class=colorbox__color data-toolbar-color=null><span class=\\\"glyphicon glyphicon-remove colorbox__clear-icon\\\"></span></div> <div style=clear:both></div> </div> </div> <div class=toolbar__center> <div class=toolbar__adjuster> <div class=\\\"sliders toolbar__sliders\\\" ng-disabled=!$ctrl.color.isSet()> <div class=sliders__content> <div class=sliders__saturation-slider> <span class=\\\"glyphicon glyphicon-signal\\\"></span> <span>{{$ctrl.color.isSet() ? $ctrl.color.s : 0 }}%</span> <rzslider rz-slider-model=$ctrl.color.s rz-slider-options=$ctrl.slider.options></rzslider> </div> <div class=sliders__lightness-slider> <span class=\\\"glyphicon glyphicon-adjust icon-flipped\\\"></span> <span>{{$ctrl.color.isSet() ? $ctrl.color.l : 0 }}%</span> <rzslider rz-slider-model=$ctrl.color.l rz-slider-options=$ctrl.slider.options></rzslider> </div> </div> </div> <div class=\\\"weight toolbar__weight\\\"> <div class=weight__title><span class=\\\"glyphicon glyphicon-stats\\\"></span> Weight</div> <div class=weight__controls> <div class=\\\"weight__buttons btn-group-vertical\\\" role=group> <a type=button class=\\\"btn btn-default btn-block btn-square weight__button\\\" ng-click=$ctrl.increaseWeight()>+</a> <a type=button class=\\\"btn btn-default btn-block btn-square weight__button\\\" ng-click=$ctrl.decreaseWeight()>-</a> </div> <div class=weight__value>{{$ctrl.color.weight}}</div> </div> </div> </div> </div> <div class=toolbar__right> <div class=\\\"selected-color toolbar__selected-color\\\"> <div class=selected-color__value ng-style=\\\"{'background-color': $ctrl.color}\\\"></div> <div class=selected-color__background></div> </div> <div class=\\\"close-button toolbar__close-button\\\" ng-click=$ctrl.close()> <span class=\\\"glyphicon glyphicon-menu-up close-button__icon\\\"></span> </div> </div> </div> </div>\";\n\n/***/ }),\n\n/***/ 353:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass2 = __webpack_require__(2);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _classCallCheck2 = __webpack_require__(1);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _ngInfiniteScroll = __webpack_require__(354);\n\nvar _ngInfiniteScroll2 = _interopRequireDefault(_ngInfiniteScroll);\n\n__webpack_require__(355);\n\n__webpack_require__(356);\n\nvar _imageFinder = __webpack_require__(357);\n\nvar _imageFinder2 = _interopRequireDefault(_imageFinder);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nangular.module('image-finder', ['jsonrpc', _ngInfiniteScroll2.default, 'ngError']).service('images', ['jsonrpc', 'login', function (jsonrpc, login) {\n    return new Images(new ImagesService(jsonrpc, login));\n}]).component('imageFinder', {\n    template: _imageFinder2.default,\n    controller: ['$scope', '$element', 'images', '$window', 'usSpinnerService', function Controller($scope, $element, images, $window, usSpinnerService) {\n        var _this = this;\n\n        var step = 10;\n        var finder = this;\n        this.selectedImage = {};\n        this.imagesToShow = [];\n        this.showImage = false;\n\n        this.$onInit = function () {\n            // restore view state\n            this.imagesToShow = images.getImagesInInterval(0, images.showIndex);\n        };\n\n        var api = {\n            search: function search(data, searchSettings) {\n                if (data && data.colors && data.colors.length > 0) {\n                    usSpinnerService.spin('spinner-1');\n                    images.findImages(data, searchSettings, function () {\n                        usSpinnerService.stop('spinner-1');\n                        finder.imagesToShow = images.getImagesInInterval(0, step);\n                        images.showIndex = step;\n                    });\n                }\n            },\n            getImages: function getImages() {\n                return images.getImagesArray();\n            }\n        };\n\n        $scope.$on(\"image-finder\", function (event, callback) {\n            if (typeof callback === \"function\") {\n                callback(api);\n            }\n        });\n\n        this.imageLoadingError = function () {\n            _this.showImage = false;\n        };\n\n        this.thumbnailLoadingError = function ($event) {\n            angular.element($event.target.parentNode).addClass(\"hidden\");\n            _this.showMore();\n        };\n\n        this.originalURL = function () {\n            $window.open(_this.selectedImage.originalURL);\n        };\n\n        this.showMore = function () {\n            _this.imagesToShow = _this.imagesToShow.concat(images.getImagesInInterval(images.showIndex, images.showIndex + step));\n            images.showIndex += step;\n        };\n\n        this.selectImage = function ($event) {\n            var target = $event.target;\n            if (target.hasAttribute('data-imagefinder-image') || angular.element(target).parent()[0].hasAttribute('data-imagefinder-image')) {\n                $event.stopPropagation();\n                var index = target.hasAttribute('data-imagefinder-image') ? parseInt(angular.element(target).attr('data-imagefinder-image')) : parseInt(angular.element(target).parent().attr('data-imagefinder-image'));\n                _this.selectedImage = images.getImage(index);\n                if (_this.selectedImage) {\n                    angular.element('body').addClass('stop-scrolling');\n                    _this.showImage = true;\n                }\n            }\n        };\n\n        this.closeImagePopup = function ($event) {\n            var target = $event.target;\n            if (target.hasAttribute('data-imagefinder-close')) {\n                $event.stopPropagation();\n                angular.element('body').removeClass('stop-scrolling');\n                this.showImage = false;\n            }\n        };\n    }]\n});\n\nvar Image = function Image(url, originalURL, score) {\n    (0, _classCallCheck3.default)(this, Image);\n\n    this.url = url;\n    this.originalURL = originalURL;\n    this.score = score;\n};\n\nvar Images = function () {\n    function Images(service) {\n        (0, _classCallCheck3.default)(this, Images);\n\n        this.images = [];\n        this.service = service;\n        this.showIndex = 0;\n    }\n\n    (0, _createClass3.default)(Images, [{\n        key: 'addImage',\n        value: function addImage(url, originalURL, score) {\n            var img = new Image(url, originalURL, score);\n            this.images.push(img);\n        }\n    }, {\n        key: 'getImage',\n        value: function getImage(i) {\n            return this.images[i];\n        }\n    }, {\n        key: 'getImagesArray',\n        value: function getImagesArray() {\n            return this.images;\n        }\n    }, {\n        key: 'getImagesInInterval',\n        value: function getImagesInInterval(start, end) {\n            if (start >= 0 && start < this.images.length) {\n                if (end > this.images.length) {\n                    end = this.images.length;\n                }\n                return this.images.slice(start, end);\n            }\n            return [];\n        }\n    }, {\n        key: 'findImages',\n        value: function findImages(data, searchSettings, callback) {\n            this.images.length = 0;\n            this.service.findImages(this, data, searchSettings, callback);\n        }\n    }]);\n    return Images;\n}();\n\nvar ImagesService = function () {\n    function ImagesService(jsonrpc, login) {\n        (0, _classCallCheck3.default)(this, ImagesService);\n\n        this.jsonrpc = jsonrpc;\n        this.login = login;\n    }\n\n    (0, _createClass3.default)(ImagesService, [{\n        key: 'findImages',\n        value: function findImages(images, data, searchSettings, callback) {\n            var self = this;\n            this.jsonrpc.request('find', { colors: data.colors, words: data.words, settings: searchSettings, auth: self.login.auth }).then(function (result) {\n                if (result && result.imgs && result.imgs.length > 0) {\n                    for (var i = 0; i < result.imgs.length; i++) {\n                        var iObj = result.imgs[i];\n                        images.addImage(iObj.url, iObj.originalURL, parseFloat(iObj.score).toFixed(2));\n                    }\n                }\n                result = null;\n                if (callback) {\n                    callback();\n                }\n            }).catch(function (error) {\n                console.error(error);\n                if (callback) {\n                    callback();\n                }\n            });\n        }\n    }]);\n    return ImagesService;\n}();\n\nexports.default = 'image-finder';\n\n/***/ }),\n\n/***/ 356:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 357:\n/***/ (function(module, exports) {\n\nmodule.exports = \" <div class=image-finder> <div class=image-finder__container> <div ng-click=$ctrl.selectImage($event) class=\\\"images image-finder__images\\\" infinite-scroll=$ctrl.showMore() infinite-scroll-distance=0> <div ng-repeat=\\\"img in $ctrl.imagesToShow track by $index\\\"> <div data-imagefinder-image={{$index}} class=images__image> <img ng-src={{img.url}} ng-error=$ctrl.thumbnailLoadingError($event)> </div> </div> </div> </div> <div ng-show=$ctrl.showImage class=\\\"image-popup image-finder__popup\\\"> <div class=image-popup__topline> <div class=image-popup__title> <a target=_blank href={{$ctrl.selectedImage.originalURL}}><span class=\\\"glyphicon glyphicon-link\\\"></span> Original</a> </div> </div> <div ng-click=$ctrl.closeImagePopup($event) class=image-popup__close-button data-imagefinder-close><span data-imagefinder-close class=\\\"glyphicon glyphicon-remove image-popup__close-icon\\\" aria-hidden=true></span></div> <div class=image-popup__image-container ng-click=$ctrl.closeImagePopup($event) data-imagefinder-close> <img class=image-popup__image ng-src={{$ctrl.selectedImage.url}} ng-error=$ctrl.imageLoadingError($event)> </div> </div> </div>\";\n\n/***/ }),\n\n/***/ 358:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\n__webpack_require__(359);\n\nvar _settingsPage = __webpack_require__(360);\n\nvar _settingsPage2 = _interopRequireDefault(_settingsPage);\n\nvar _SettingsCtrl = __webpack_require__(361);\n\nvar _SettingsCtrl2 = _interopRequireDefault(_SettingsCtrl);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nangular.module('settings-page', []).component('settingsPage', {\n    template: _settingsPage2.default,\n    controller: [\"$scope\", \"appSettings\", _SettingsCtrl2.default],\n    bindings: {}\n});\n\nexports.default = 'settings-page';\n\n/***/ }),\n\n/***/ 359:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 360:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=settings-page> <div class=\\\"panel panel-default settings-panel settings-page__content\\\"> <div class=\\\"panel-heading settings-panel__heading\\\"> <h3 class=panel-title><span class=\\\"glyphicon glyphicon-cog\\\"></span>&nbsp;Settings</h3> </div> <div class=\\\"panel-body settings-panel__body\\\"> <div class=\\\"checkbox analyze-text\\\"> <label> <input ng-model=$ctrl.settings.checkSemanticSimilarity type=checkbox>Analyze semantics (experimental) </label> </div> <div class=search-type> <div class=\\\"radio search-type__option\\\"> <label> <input type=radio name=optionsRadios ng-model=$ctrl.settings.searchMode value=regular checked=checked>Regular search (fast) </label> </div> <div class=\\\"radio search-type__option\\\"> <label> <input type=radio name=optionsRadios ng-model=$ctrl.settings.searchMode value=special>Special search (slow) </label> </div> </div> <div ng-class=\\\"{'soft-comparison_enabled': $ctrl.settings.searchMode === 'special'}\\\" class=\\\"checkbox soft-comparison soft-comparison_disabled\\\"> <label> <input ng-model=$ctrl.settings.distanceMode ng-true-value=\\\"'soft'\\\" ng-false-value=\\\"'strict'\\\" ng-disabled=\\\"$ctrl.settings.searchMode!=='special'\\\" class=soft-comparison__input type=checkbox>Soft comparison </label> </div> <select ng-model=$ctrl.settings.distance ng-disabled=\\\"$ctrl.settings.searchMode!=='special' \\\" disabled=disabled ng-class=\\\"{'similarity-slider_enabled': $ctrl.settings.searchMode==='special'}\\\" class=\\\"distances distances_disabled\\\"> <option ng-repeat=\\\"distance in $ctrl.settings.supportedDistances track by $index\\\" data-distances-distance={{$index}} value={{distance.id}}>{{distance.name}}</option> </select> <div ng-class=\\\"{'similarity-slider_enabled': $ctrl.settings.searchMode === 'special'}\\\" class=\\\"similarity-slider similarity-slider_disabled settings__similarity-level\\\"> <div class=similarity-slider__title>Similarity level: <span>{{$ctrl.similarityLevel}}%</span></div> <rzslider rz-slider-model=$ctrl.similarityLevel rz-slider-options=$ctrl.slider.options></rzslider> </div> </div> </div> </div>\";\n\n/***/ }),\n\n/***/ 361:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _values = __webpack_require__(362);\n\nvar _values2 = _interopRequireDefault(_values);\n\nvar _classCallCheck2 = __webpack_require__(1);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar SettingsCtrl = function SettingsCtrl($scope, $appSettings) {\n    var _this = this;\n\n    (0, _classCallCheck3.default)(this, SettingsCtrl);\n\n    var controller = this;\n    this.settings = $appSettings;\n    var settingsOldState = (0, _values2.default)(this.settings.serialize()).join();\n    this.slider = {\n        value: 50,\n        options: {\n            floor: 0,\n            ceil: 100,\n            step: 1,\n            onChange: function onChange() {},\n            onEnd: function onEnd() {\n                controller.settings.similarityLevel = controller.similarityLevel;\n            },\n            hidePointerLabels: true,\n            hideLimitLabels: true,\n            disabled: true\n        }\n    };\n    this.similarityLevel = $appSettings.similarityLevel;\n\n    this.$doCheck = function () {\n        controller.slider.options.disabled = controller.settings.searchMode === \"regular\";\n        var state = (0, _values2.default)(controller.settings.serialize()).join();\n        if (state !== settingsOldState) {\n            settingsOldState = state;\n            controller.settings.save(function () {\n                controller.similarityLevel = $appSettings.similarityLevel;\n                $scope.$apply();\n            }, function (e) {\n                console.log(\"SettingsCtrl: Error occured\");\n                console.log(e);\n            });\n        }\n    };\n\n    this.$onInit = function () {\n        $appSettings.load(function () {\n            _this.similarityLevel = $appSettings.similarityLevel;\n            $scope.$apply();\n        }, function (e) {\n            console.log(\"SettingsCtrl: Error occured\");\n            console.log(e);\n        });\n    };\n};\n\nexports.default = SettingsCtrl;\n\n/***/ }),\n\n/***/ 367:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\n__webpack_require__(368);\n\nvar _guidePage = __webpack_require__(369);\n\nvar _guidePage2 = _interopRequireDefault(_guidePage);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nangular.module('guide-page', []).component('guidePage', {\n    template: _guidePage2.default\n});\n\nexports.default = 'guide-page';\n\n/***/ }),\n\n/***/ 368:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 369:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=guide-page> <div class=\\\"panel panel-default guide-panel guide-page__content\\\"> <div class=\\\"panel-heading guide-panel__heading\\\"> <h3 class=panel-title><span class=\\\"glyphicon glyphicon-info-sign\\\"></span>&nbsp;Guide</h3> </div> <div class=\\\"panel-body guide-panel__body\\\"> Huhu! </div> </div> </div>\";\n\n/***/ }),\n\n/***/ 370:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 371:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div ng-controller=RoutingCtrl> <span us-spinner=\\\"{position: 'fixed', color: '#428bca'}\\\" spinner-key=spinner-1></span> <div class=app__content> <div class=\\\"header app__header\\\"> <div ng-click=goToMain() class=\\\"logo header__logo\\\"><div class=logo__image></div></div> <div class=header__buttons> <a class=\\\"btn btn-default header__button_left\\\" ng-click=goToGuide()>How to use?</a> <a class=\\\"btn btn-default header__button_right\\\" ng-click=goToSettings()>Settings <span class=\\\"glyphicon glyphicon-cog\\\"></span></a> </div> </div> <div class=app__header-line></div> <ui-view name=pages> <main-page class=main-page ng-show=\\\"page === 'main'\\\"></main-page> <settings-page ng-show=\\\"page === 'settings'\\\"></settings-page> <guide-page ng-show=\\\"page === 'guide'\\\"></guide-page> </ui-view> </div> </div>\";\n\n/***/ }),\n\n/***/ 372:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(1);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(2);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _md = __webpack_require__(373);\n\nvar _md2 = _interopRequireDefault(_md);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Login = function () {\n    function Login($q, jsonrpc) {\n        (0, _classCallCheck3.default)(this, Login);\n\n        this.required = null;\n        this.auth = null;\n        this.success = false;\n        this.user = null;\n        this.password = null;\n        this.jsonrpc = jsonrpc;\n        this.$q = $q;\n    }\n\n    (0, _createClass3.default)(Login, [{\n        key: 'isSet',\n        value: function isSet() {\n            return this.user && this.password;\n        }\n    }, {\n        key: 'isSuccessful',\n        value: function isSuccessful() {\n            return this.auth !== null && this.success;\n        }\n    }, {\n        key: 'login',\n        value: function login() {\n            var _this = this;\n\n            var self = this;\n            var auth = (0, _md2.default)('' + this.user + this.password);\n            return this.jsonrpc.request('login', { login: auth }).then(function (data) {\n                if (data.success) {\n                    self.auth = auth;\n                    _this.success = true;\n                    return true;\n                }\n                return false;\n            });\n        }\n    }, {\n        key: 'isRequired',\n        value: function isRequired() {\n            var _this2 = this;\n\n            if (this.required) {\n                return this.$q.resolve(true);\n            }\n            return this.jsonrpc.request('login-required', {}).then(function (data) {\n                _this2.required = data.required;\n                return _this2.required;\n            });\n        }\n    }]);\n    return Login;\n}();\n\nexports.default = Login;\n\n/***/ }),\n\n/***/ 376:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\n__webpack_require__(377);\n\nvar _confirm = __webpack_require__(378);\n\nvar _confirm2 = _interopRequireDefault(_confirm);\n\nvar _login = __webpack_require__(379);\n\nvar _login2 = _interopRequireDefault(_login);\n\nvar _error = __webpack_require__(380);\n\nvar _error2 = _interopRequireDefault(_error);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nangular.module('dialog', []).service('popupDialog', ['$rootScope', '$compile', function ($rootScope, $compile) {\n    var _this = this;\n\n    var scope = null;\n    var element = null;\n    var self = this;\n\n    function create(template, Control, closeByOutside) {\n        var html = '<div class=\"dialog\" ng-click=\"close($event)\">\\n        <div class=\"dialog__window\">' + template + '</div></div>';\n        scope = $rootScope.$new(true);\n        scope.$ctrl = new Control();\n        scope.closeByOutside = closeByOutside;\n        scope.close = function ($event) {\n            var target = angular.element($event.target);\n            if (target.hasClass(\"dialog\") && scope.closeByOutside) {\n                self.close();\n            }\n        };\n        var compiled = $compile(html)(scope);\n        element = angular.element(compiled).appendTo(\"body\");\n    }\n\n    this.close = function () {\n        if (element && scope) {\n            element.remove();\n            scope.$destroy();\n            element = null;\n            scope = null;\n        }\n    };\n\n    this.errorDialog = function (Control) {\n        _this.close();\n        create(_error2.default, Control, false);\n    };\n\n    this.confirmDialog = function (Control) {\n        _this.close();\n        create(_confirm2.default, Control, true);\n    };\n\n    this.loginDialog = function (Control) {\n        _this.close();\n        create(_login2.default, Control, false);\n    };\n}]);\n\nexports.default = \"dialog\";\n\n/***/ }),\n\n/***/ 377:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 378:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=confirm-dialog> <h4><span class=\\\"glyphicon glyphicon-question-sign\\\"></span> Confirm <span class=confirm-dialog__title>{{$ctrl.title}}</span></h4> <p>Are you sure you want to proceed?</p> <div style=float:right> <a class=\\\"btn btn-danger\\\" ng-click=$ctrl.cancel()>Cancel</a> <a class=\\\"btn btn-success\\\" ng-click=$ctrl.yes()>Yes</a> </div><div style=clear:both></div> </div>\";\n\n/***/ }),\n\n/***/ 379:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=login-dialog> <div class=form-group><input ng-model=$ctrl.model.user type=text class=form-control placeholder=User></div> <div class=form-group><input ng-model=$ctrl.model.password type=password class=form-control placeholder=Password></div> <a ng-click=$ctrl.login() class=\\\"btn btn-success btn-block\\\"><span class=\\\"glyphicon glyphicon-cloud-upload\\\" aria-hidden=true></span> log in</a> </div>\";\n\n/***/ }),\n\n/***/ 380:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=error-dialog> <h4><span class=\\\"glyphicon glyphicon-warning-sign\\\"></span> {{$ctrl.title}}</h4> <p>{{$ctrl.description}}</p> <a ng-show=$ctrl.button ng-click=$ctrl.handle() class=\\\"btn btn-danger btn-block\\\"><span ng-show=$ctrl.icon ng-class=\\\"'glyphicon glyphicon-{{$ctrl.icon}}'\\\"></span> {{$ctrl.buttonTitle}}</a> </div>\";\n\n/***/ }),\n\n/***/ 381:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _localforage = __webpack_require__(382);\n\nvar _localforage2 = _interopRequireDefault(_localforage);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nangular.module('db', []).service('db', ['popupDialog', function (dialog) {\n    _localforage2.default.config({\n        driver: [_localforage2.default.INDEXEDDB, _localforage2.default.WEBSQL, _localforage2.default.LOCALSTORAGE],\n        name: 'ColorSearch',\n        version: 1.0\n    });\n    this.getStore = function (store) {\n        return _localforage2.default.createInstance({ name: 'ColorSearch', storeName: store });\n    };\n}]);\n\nexports.default = \"db\";\n\n/***/ }),\n\n/***/ 384:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(1);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(2);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar EventFilter = function () {\n    function EventFilter(timeWindow, callback, $window) {\n        (0, _classCallCheck3.default)(this, EventFilter);\n\n        this._timeWindow = timeWindow;\n        this._callback = callback;\n        this._$window = $window;\n        this._lastEventTime = 0;\n        this._timeoutId = null;\n    }\n\n    (0, _createClass3.default)(EventFilter, [{\n        key: \"event\",\n        value: function event() {\n            var _this = this;\n\n            var now = Date.now();\n            if (now - this._lastEventTime >= this._timeWindow) {\n                if (this._timeoutId) {\n                    this._$window.clearTimeout(this._timeoutId);\n                }\n                this._lastEventTime = now;\n                this._callback();\n            } else {\n                if (this._timeoutId) {\n                    this._$window.clearTimeout(this._timeoutId);\n                }\n                this._timeoutId = this._$window.setTimeout(function () {\n                    _this._lastEventTime = now;\n                    _this._callback();\n                }, this._timeWindow);\n            }\n        }\n    }]);\n    return EventFilter;\n}();\n\nangular.module(\"event-filter\", []).factory(\"eventFilter\", [\"$window\", function ($window) {\n    return function (timeWindow, callback) {\n        return new EventFilter(timeWindow, callback, $window);\n    };\n}]);\n\nexports.default = \"event-filter\";\n\n/***/ }),\n\n/***/ 58:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _classCallCheck2 = __webpack_require__(1);\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = __webpack_require__(2);\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Color = function () {\n    function Color(o) {\n        (0, _classCallCheck3.default)(this, Color);\n\n        this.weight = 1;\n        this.h = undefined;\n        this.s = undefined;\n        this.l = undefined;\n        this.achromatic = false;\n\n        if (o && o[\"h\"] !== undefined && o[\"s\"] !== undefined && o[\"l\"] !== undefined) {\n            this.h = parseInt(o[\"h\"], 10);\n            this.s = parseInt(o[\"s\"], 10);\n            this.l = parseInt(o[\"l\"], 10);\n        }\n\n        if (o && o[\"weight\"]) {\n            this.weight = parseInt(o[\"weight\"], 10);\n        }\n\n        if (o && typeof o[\"achromatic\"] === \"boolean\") {\n            this.achromatic = o[\"achromatic\"];\n        }\n    }\n\n    (0, _createClass3.default)(Color, [{\n        key: \"toString\",\n        value: function toString() {\n            if (this.isSet) {\n                return \"hsl(\" + this.h + \",\" + this.s + \"%,\" + this.l + \"%)\";\n            }\n            return undefined;\n        }\n    }, {\n        key: \"toIdString\",\n        value: function toIdString() {\n            return \"hsl(\" + this.h + \",\" + this.s + \"%,\" + this.l + \"%)\" + this.weight;\n        }\n    }, {\n        key: \"isSet\",\n        value: function isSet() {\n            return this.h !== undefined && this.s !== undefined && this.l !== undefined;\n        }\n    }, {\n        key: \"setH\",\n        value: function setH(h) {\n            this.h = this.achromatic ? 0 : parseInt(h, 10);\n            return this;\n        }\n    }, {\n        key: \"setS\",\n        value: function setS(s) {\n            this.s = this.achromatic ? 0 : parseInt(s, 10);\n            return this;\n        }\n    }, {\n        key: \"setL\",\n        value: function setL(l) {\n            this.l = parseInt(l, 10);\n            return this;\n        }\n    }, {\n        key: \"setWeight\",\n        value: function setWeight(w) {\n            this.weight = parseInt(w, 10);\n            return this;\n        }\n    }, {\n        key: \"setAchromatic\",\n        value: function setAchromatic() {\n            this.h = 0;\n            this.s = 0;\n            this.achromatic = true;\n            return this;\n        }\n    }, {\n        key: \"isAchromatic\",\n        value: function isAchromatic() {\n            return this.achromatic;\n        }\n    }, {\n        key: \"setColor\",\n        value: function setColor(o) {\n            if (o[\"h\"] !== undefined && o[\"s\"] !== undefined && o[\"l\"] !== undefined) {\n                this.h = parseInt(o[\"h\"], 10);\n                this.s = parseInt(o[\"s\"], 10);\n                this.l = parseInt(o[\"l\"], 10);\n            }\n\n            if (o[\"weight\"]) {\n                this.weight = parseInt(o[\"weight\"], 10);\n            }\n\n            if (o && typeof o[\"achromatic\"] === \"boolean\") {\n                this.achromatic = o[\"achromatic\"];\n            }\n\n            return this;\n        }\n    }, {\n        key: \"setColorFromString\",\n        value: function setColorFromString(str) {\n            var r = /^hsl\\(\\d+(\\.\\d+)?,\\d+(\\.\\d+)?%?,\\d+(\\.\\d+)?%?\\)$/i;\n            if (str && r.test(str)) {\n                var re = /\\d+(\\.\\d+)?/g;\n                this.h = parseInt(re.exec(str)[0], 10);\n                this.s = parseInt(re.exec(str)[0], 10);\n                this.l = parseInt(re.exec(str)[0], 10);\n            }\n            return this;\n        }\n    }, {\n        key: \"reset\",\n        value: function reset() {\n            this.h = undefined;\n            this.s = undefined;\n            this.l = undefined;\n            this.weight = 1;\n            this.achromatic = false;\n            return this;\n        }\n    }, {\n        key: \"toJSON\",\n        value: function toJSON() {\n            var o = {};\n            o.achromatic = this.achromatic;\n            o.l = this.l;\n            o.s = this.s;\n            o.h = this.h;\n            o.weight = this.weight;\n            return o;\n        }\n    }]);\n    return Color;\n}();\n\nexports.default = Color;\n\n/***/ })\n\n},[177]);\n\n\n// WEBPACK FOOTER //\n// js/app.bundle.js","import './assets/scss/styles.scss';\nimport colorSearch from \"./color-search/color-search\";\nangular.module('app', [colorSearch]);\n\n\n\n// WEBPACK FOOTER //\n// ./app.js","import uirouter from '@uirouter/angularjs';\r\nimport 'angular-spinner';\r\nimport Routes from '../routing/Routes';\r\nimport Settings from '../models/Settings';\r\nimport ColorUtils from '../utils/ColorUtils';\r\nimport TextColors from '../models/TextColors';\r\nimport ColorFactory from '../models/ColorFactory';\r\nimport ColorSetFactory from '../models/ColorSetFactory';\r\nimport RoutingCtrl from '../routing/RoutingCtrl';\r\nimport JSONrpc from '../utils/JsonRpc';\r\nimport main from \"../pages/main/main-page\";\r\nimport settings from \"../pages/settings/settings-page\";\r\nimport guide from \"../pages/guide/guide-page\";\r\nimport './scss/color-search.scss';\r\nimport template from './template/color-search.html';\r\nimport Login from '../models/Login';\r\nimport popupDialog from '../services/dialog/dialog';\r\nimport db from '../services/db/db';\r\nimport eventFilter from '../utils/EventFilter';\r\n\r\nangular.module('color-search', [uirouter, JSONrpc, main, settings, guide, popupDialog, db, eventFilter, 'angularSpinner'])\r\n.config(Routes)\r\n.config(['$JsonRpcProvider', (provider) => {\r\n    provider.set({ url: \"/\" });\r\n}])\r\n.service('colorUtils', ColorUtils)\r\n.service('colorFactory', ColorFactory)\r\n.service('colorSetFactory', ColorSetFactory)\r\n.service('appSettings', ['db', Settings])\r\n.service('textColors', TextColors)\r\n.service('login', ['$q', 'jsonrpc', Login])\r\n.controller('RoutingCtrl', RoutingCtrl)\r\n.component('colorSearch', {\r\n    template,\r\n    controller: ['$scope', '$window', 'login', 'popupDialog',\r\n    function Controller($scope, $window, login, dialog) {\r\n        function openLoginDialog() {\r\n            dialog.loginDialog(function () {\r\n                this.model = login;\r\n                this.login = () => {\r\n                    if (this.model.isSet()) {\r\n                        this.model.login()\r\n                        .then((succ) => {\r\n                            if (succ) {\r\n                                dialog.close();\r\n                            }\r\n                        });\r\n                    }\r\n                };\r\n            });\r\n        }\r\n\r\n        login.isRequired()\r\n        .then((required) => {\r\n            if (required) {\r\n                openLoginDialog();\r\n            }\r\n        }).catch((err) => {\r\n            dialog.errorDialog(function () {\r\n                this.title = \"Connection error\";\r\n                this.description = \"Try to reload the application.\";\r\n                this.buttonTitle = \"Reload\";\r\n                this.button = true;\r\n                this.icon = 'refresh';\r\n                this.handle = () => {\r\n                    $window.location.reload(true);\r\n                };\r\n            });\r\n        });\r\n    }],\r\n});\r\n\r\nexport default 'color-search';\r\n\n\n\n// WEBPACK FOOTER //\n// ./color-search/color-search.js","function Routes($stateProvider, $urlRouterProvider) {\n    const mainState = {\n        name: 'main',\n        url: '/main',\n        data: { page: \"main\" },\n    };\n\n    const settingsState = {\n        name: 'main.settings',\n        url: '^/settings',\n        data: { page: \"settings\" },\n    };\n\n    const guideState = {\n        name: 'main.guide',\n        url: '^/guide',\n        data: { page: \"guide\" },\n    };\n\n    $stateProvider.state(mainState);\n    $stateProvider.state(settingsState);\n    $stateProvider.state(guideState);\n    $urlRouterProvider.otherwise('/main');\n}\n\nRoutes.$inject = ['$stateProvider', '$urlRouterProvider'];\nexport default Routes;\n\n\n\n\n// WEBPACK FOOTER //\n// ./routing/Routes.js","class SettingsDAO {\n\n    constructor(db) {\n        this.store = \"settings\";\n        this.db = db;\n    }\n\n    loadSettings(settings, succ, err) {\n        this.db.getStore(this.store)\n        .getItem('settings')\n        .then((item) => {\n            settings.deserialize(item);\n            if (succ) {\n                succ();\n            }\n        })\n        .catch((e) => {\n            console.warn(e);\n            if (err) {\n                err();\n            }\n        });\n    }\n\n    saveSettings(settings, succ, err) {\n        this.db.getStore(this.store)\n        .setItem('settings', settings.serialize())\n        .then(() => {\n            if (succ) {\n                succ();\n            }\n        })\n        .catch((e) => {\n            console.warn(e);\n            if (err) {\n                err();\n            }\n        });\n    }\n}\n\n\nexport default class Settings {\n\n    constructor(db) {\n        this.module = 'settings';\n        this.dao = new SettingsDAO(db);\n        this.checkSemanticSimilarity = false;\n        this.searchMode = 'regular';\n        this.similarityLevel = 85;\n        this.distance = 'euclidean';\n        this.distanceMode = 'strict';\n        this.supportedDistances = [\n            { id: 'euclidean', name: 'Euclidean' },\n            { id: 'chisquare', name: 'Chi-Square' },\n            { id: 's2jsd', name: 'S2JSD' }];\n    }\n\n    load(succ, err) {\n        this.dao.loadSettings(this, succ, err);\n    }\n\n    save(succ, err) {\n        this.dao.saveSettings(this, succ, err);\n    }\n\n    serialize() {\n        const o = {};\n        o.module = 'settings';\n        o.checkSemanticSimilarity = this.checkSemanticSimilarity;\n        o.searchMode = this.searchMode;\n        o.similarityLevel = this.similarityLevel;\n        o.distance = this.distance;\n        o.distanceMode = this.distanceMode;\n        return o;\n    }\n\n    deserialize(dto) {\n        if (dto) {\n            this.editorFontSize = dto.editorFontSize;\n            this.checkSemanticSimilarity = dto.checkSemanticSimilarity;\n            this.searchMode = dto.searchMode;\n            this.similarityLevel = dto.similarityLevel;\n            this.distance = dto.distance;\n            this.distanceMode = dto.distanceMode;\n        } else {\n            console.warn(\"Settings not loaded\");\n        }\n    }\n\n    getSearchSettings() {\n        const o = {};\n        o.checkSemanticSimilarity = this.checkSemanticSimilarity;\n        o.searchMode = this.searchMode;\n        o.similarityLevel = this.similarityLevel;\n        o.distance = this.distance;\n        o.distanceMode = this.distanceMode;\n        return o;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./models/Settings.js","import tc from 'tinycolor2';\n\nexport default class ColorUtils {\n\n    hslToHexString(color, f) {\n        const factor = f || 1;\n        return tc({ h: color.h, s: color.s / factor, l: color.l / factor }).toHexString();\n    }\n\n    hexToHsl(hex, f) {\n        const factor = f || 1;\n        const hsl = tc(hex).toHsl();\n        hsl.s = Math.round(hsl.s * factor);\n        hsl.l = Math.round(hsl.l * factor);\n        return hsl;\n    }\n\n    toHexString(string) {\n        return tc(string).toHexString();\n    }\n\n    hslToHslString(color) {\n        return `hsl(${color.h},${color.s}%,${color.l}%)`;\n    }\n\n    hslStringToHsl(string, f) {\n        if (string) {\n            const factor = f || 1;\n            const hsl = tc(string).toHsl();\n            hsl.s = Math.round(hsl.s * factor);\n            hsl.l = Math.round(hsl.l * factor);\n            return hsl;\n        }\n        return { h: 0, s: 0, l: 0 };\n    }\n\n    getFittingColorWithGreaterCR(color, ...colors) {\n        let cTemp = color;\n        if (colors && colors.length > 0) {\n            cTemp = colors[0];\n            let crTemp = this.cr(color, colors[0]);\n            for (let i = 0; i < colors.length; i++) {\n                const cr = this.cr(color, colors[i]);\n                if (crTemp < cr) {\n                    crTemp = cr;\n                    cTemp = colors[i];\n                }\n            }\n        }\n        return cTemp;\n    }\n\n    // W3C recommendation\n    cr(c1, c2) {\n        const color1 = tc(c1).toRgb();\n        const color2 = tc(c2).toRgb();\n        let lum1 = this._luminanceRGB(color1.r, color1.g, color1.b);\n        let lum2 = this._luminanceRGB(color2.r, color2.g, color2.b);\n        if (lum2 > lum1) {\n            [lum1, lum2] = [lum2, lum1];\n        }\n        return (lum1 + 0.05) / (lum2 + 0.05);\n    }\n\n    _luminanceRGB(r, g, b) {\n        const RsRGB = r / 255;\n        const GsRGB = g / 255;\n        const BsRGB = b / 255;\n        const R = (RsRGB <= 0.03928) ? RsRGB / 12.92 : Math.pow(((RsRGB + 0.055) / 1.055), 2.4);\n        const G = (GsRGB <= 0.03928) ? GsRGB / 12.92 : Math.pow(((GsRGB + 0.055) / 1.055), 2.4);\n        const B = (BsRGB <= 0.03928) ? BsRGB / 12.92 : Math.pow(((BsRGB + 0.055) / 1.055), 2.4);\n        return 0.2126 * R + 0.7152 * G + 0.0722 * B;\n    }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./utils/ColorUtils.js","import Color from './Color';\n\nexport default class TextColors {\n\n    constructor() {\n        this._words = [];\n        this.colorOccurence = new Map();\n        this.adjustedColorOccurence = new Map();\n        this.sPercentage = 100;\n        this.lPercentage = 100;\n    }\n\n    clearWords() {\n        this._words = [];\n    }\n\n    addWord(word) {\n        this._words.push(word);\n    }\n\n    getWords() {\n        return this._words;\n    }\n\n    getColors() {\n        return [...this.adjustedColorOccurence.values()];\n    }\n\n    getColorsAndWords() {\n        const o = {};\n        o.colors = this.getColors();\n        o.words = this.getWords();\n        return o;\n    }\n\n    clear() {\n        this.clearWords();\n        this.colorOccurence.clear();\n        this.adjustedColorOccurence.clear();\n    }\n\n    updateColors(colors) {\n        this.colorOccurence.clear();\n        if (colors && colors.size > 0) {\n            for (const [key, value] of colors.entries()) {\n                if (value.color && value.color.isSet()) {\n                    let color = this.colorOccurence.get(value.color.toString());\n                    if (color) {\n                        color.setWeight(color.weight + value.color.weight);\n                    } else {\n                        color = new Color(value.color);\n                        this.colorOccurence.set(color.toString(), color);\n                    }\n                }\n            }\n        }\n        this.calculateAdjustedColors();\n    }\n\n    // from -100 to +100\n    calculateAdjustedColors() {\n        this.adjustedColorOccurence.clear();\n        for (const value of this.colorOccurence.values()) {\n            const s = this._calculate(value.s, this.sPercentage);\n            const l = this._calculate(value.l, this.lPercentage);\n            const color = new Color({ h: value.h, s, l, weight: value.weight });\n            if (value.isAchromatic()) {\n                color.setAchromatic();\n            }\n            this.adjustedColorOccurence.set(color.toString(), color);\n        }\n    }\n\n    // Lagrange interpolation\n    _calculate(x, xPercentage) {\n        const x0 = 100;\n        const x1 = (xPercentage > 100) ? 200 : 0;\n        const y0 = x;\n        const y1 = (xPercentage > 100) ? 100 : 0;\n        return y0 * ((xPercentage - x1) / (x0 - x1)) + y1 * ((xPercentage - x0) / (x1 - x0));\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./models/TextColors.js","module.exports = angular;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"angular\"\n// module id = 20\n// module chunks = 0","import Color from './Color';\n\nclass ColorFactory {\n    getInstance(o) {\n        return new Color(o);\n    }\n}\n\nexport default ColorFactory;\n\n\n\n// WEBPACK FOOTER //\n// ./models/ColorFactory.js","import ColorSet from './ColorSet';\n\nclass ColorSetFactory {\n    getInstance() {\n        return new ColorSet();\n    }\n}\n\nexport default ColorSetFactory;\n\n\n\n// WEBPACK FOOTER //\n// ./models/ColorSetFactory.js","class ColorSet {\n\n    constructor() {\n        this.map = new Map();\n        this[Symbol.iterator] = this.values;\n    }\n\n    add(color) {\n        this.map.set(color.toIdString(), color);\n    }\n\n    values() {\n        return this.map.values();\n    }\n\n    getValuesArray() {\n        return [...this.map.values()];\n    }\n}\n\nexport default ColorSet;\n\n\n\n\n// WEBPACK FOOTER //\n// ./models/ColorSet.js","class RoutingCtrl {\r\n    constructor($scope, $transitions, $state, $timeout) {\r\n        $scope.page = \"main\";\r\n        // router event\r\n        $transitions.onSuccess({}, (transition) => {\r\n            const data = transition.to().data;\r\n            $scope.page = data[\"page\"];\r\n            $timeout(() => {\r\n                $scope.$broadcast('rzSliderForceRender');\r\n            }, 0);\r\n        });\r\n\r\n        $scope.goToSettings = () => {\r\n            this.page = \"settings\";\r\n            $state.go('main.settings');\r\n        };\r\n\r\n        $scope.goToGuide = () => {\r\n            this.page = \"guide\";\r\n            $state.go('main.guide');\r\n        };\r\n\r\n        $scope.goToMain = () => {\r\n            this.page = \"main\";\r\n            $state.go('main');\r\n        };\r\n    }\r\n}\r\n\r\nRoutingCtrl.$inject = ['$scope', '$transitions', '$state', '$timeout'];\r\nexport default RoutingCtrl;\r\n\n\n\n// WEBPACK FOOTER //\n// ./routing/RoutingCtrl.js","\nclass JsonRpcException {\n    constructor(error) {\n        this.name = \"jsonRpcException\";\n        this.message = error;\n    }\n}\n\nangular.module('jsonrpc', [])\n.provider('$JsonRpc', function () {\n    let url = \"\";\n    this.set = (conf) => {\n        url = conf[\"url\"];\n    };\n    this.$get = () => ({\n        url,\n    });\n})\n.service('jsonrpc', ['$q', '$http', '$JsonRpc', function ($q, $http, jsonrpcConfig) {\n    const _url = jsonrpcConfig.url;\n    if (!_url) {\n        throw new JsonRpcException('Please configure server url');\n    }\n    const _header = { 'Content-Type': 'application/json' };\n    let _id = 0;\n    this.request = (method, data) => {\n        const deferred = $q.defer();\n        const req = {\n            method: 'POST',\n            url: _url,\n            headers: _header,\n            data: _getInputData(method, data),\n        };\n\n        $http(req).then((res) => {\n            const data = res.data;\n            if (!res || !data) {\n                deferred.reject(new JsonRpcException(\"Unknown Error occured. No data received\"));\n            } else if (data && data.result !== undefined) {\n                if (!_inspectDataFormat(data)) {\n                deferred.reject(new JsonRpcException(\"JSON-RPC 2.0 data format must be used.\"));\n                } else {\n                deferred.resolve(data.result);\n                }\n            } else {\n            deferred.reject(new JsonRpcException(`No data received. HTTP status code: ${data.status}`));\n            }\n        }, (error) => {\n            if (error) {\n                deferred.reject(new JsonRpcException(`Error occured. HTTP status code: ${error.status}`));\n            } else {\n            deferred.reject(new JsonRpcException(\"Unknown Error occurred\"));\n            }\n        });\n        return deferred.promise;\n    };\n\n    function _getInputData(methodName, args) {\n    _id += 1;\n        return {\n            jsonrpc: '2.0',\n            id: _id,\n            method: methodName,\n            params: args,\n        };\n    }\n\n    function _inspectDataFormat(data) {\n        const allowedKeys = [\"jsonrpc\", \"id\", \"result\"];\n        const keys = Object.keys(data);\n        let ret = false;\n        if (keys.length === allowedKeys.length) {\n            ret = true;\n            keys.forEach((key) => {\n                if (allowedKeys.indexOf(key) < 0) {\n                    ret = false;\n                }\n                if (key === \"jsonrpc\" && data[key] !== \"2.0\") {\n                    ret = false;\n                }\n            });\n        }\n        return ret;\n    }\n}]);\n\n\nexport default 'jsonrpc';\n\n\n\n// WEBPACK FOOTER //\n// ./utils/JsonRpc.js","import './scss/main-page.scss';\r\nimport template from './template/main-page.html';\r\nimport MainCtrl from './MainCtrl';\r\nimport colorAdjuster from '../../components/color-adjuster/color-adjuster';\r\nimport colorProfiles from '../../components/color-profiles/color-profiles';\r\nimport textColorizer from '../../components/text-colorizer/text-colorizer';\r\nimport toolbar from '../../components/color-toolbar/color-toolbar';\r\nimport imageFinder from '../../components/image-finder/image-finder';\r\n\r\nangular.module('main-page', [colorAdjuster, colorProfiles, textColorizer, toolbar, imageFinder])\r\n.factory('calculateFontColor', ['colorUtils', colorUtils =>\r\n    color => colorUtils.getFittingColorWithGreaterCR(color, \"#000000\", \"#ffffff\")])\r\n.component('mainPage', {\r\n    template,\r\n    controller: ['$rootScope', '$scope', 'textColors',\r\n    '$timeout', 'appSettings', 'colorSetFactory', 'colorFactory', 'popupDialog',\r\n    MainCtrl],\r\n});\r\n\r\nexport default 'main-page';\r\n\n\n\n// WEBPACK FOOTER //\n// ./pages/main/main-page.js","module.exports = \"<div class=main-page> <color-toolbar closed=true color-modified-handler=$ctrl.colorModifiedHandler(color)></color-toolbar> <div class=\\\"colorizer main-page__colorizer\\\"> <text-colorizer colorizer-id=01 on-wordselect=$ctrl.selectWord(word)></text-colorizer> <div class=colorizer__controls> <a class=\\\"btn-bodyless btn-bodyless-success colorizer__button\\\" ng-click=$ctrl.inputComplete()><span class=\\\"glyphicon glyphicon-ok\\\"></span> OK</a><span class=colorizer__separator></span> <a class=\\\"btn-bodyless colorizer__button\\\" ng-click=$ctrl.edit()><span class=\\\"glyphicon glyphicon-pencil\\\"></span> Edit</a><span class=colorizer__separator></span> <a class=\\\"btn-bodyless btn-bodyless-danger colorizer__button\\\" ng-click=$ctrl.decolorizeDialog()><span class=\\\"glyphicon glyphicon-remove\\\"></span> Clear</a><span class=colorizer__separator></span> <a class=\\\"btn-bodyless btn-bodyless-danger colorizer__button\\\" ng-click=$ctrl.dropDialog()><span class=\\\"glyphicon glyphicon-trash\\\"></span> Drop</a> </div> </div> <div class=main-page__adjustments-container> <div class=\\\"panel panel-default main-page__adjustments adjustments\\\"> <div class=adjustments__label>Adjustments & Profiles</div> <div class=adjustments__inner> <div class=adjustments__content> <color-adjuster class=adjustments__adjuster text-colors=$ctrl.textColors></color-adjuster> <div class=adjustments__open-profiles-button> <a ng-model=collapsed ng-click=\\\"collapsed=!collapsed\\\" class=btn-bodyless><span class=\\\"glyphicon glyphicon-triangle-bottom\\\" ng-class=\\\"collapsed ? 'glyphicon-triangle-top' : 'glyphicon-triangle-bottom'\\\"></span> Profiles</a> </div> <div ng-show=collapsed class=adjustments__profiles> <color-profiles colors=$ctrl.colors on-load-profile=$ctrl.loadColorProfile(colors)></color-profiles> </div> </div> </div> </div> </div> <div class=main-page__find-button-container> <a class=\\\"btn btn-success main-page__find-button\\\" ng-click=$ctrl.search()><span class=\\\"glyphicon glyphicon-search\\\"></span> Find!</a> </div> <image-finder></image-finder> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./pages/main/template/main-page.html\n// module id = 241\n// module chunks = 0","export default class MainCtrl {\n\n    constructor($rootScope, $scope, textColors,\n        $timeout, appSettings, colorSetFactory, colorFactory, dialog) {\n        this.appSettings = appSettings;\n        this.colors = new Map();\n        this.textColors = textColors;\n        this.selectedWord = {};\n        this.$scope = $scope;\n        this.colorSetFactory = colorSetFactory;\n        this.colorFactory = colorFactory;\n        this.dialog = dialog;\n    }\n\n    _updateColors() {\n        this.$scope.$broadcast(\"text-colorizer\", (colorizer) => {\n            const cols = colorizer.getAllColors();\n            this.textColors.clearWords();\n            this.colors.clear();\n            for (const value of cols.values()) {\n                const word = value.word.toLowerCase();\n                const color = value.color;\n                if (color.isSet()) {\n                    this.textColors.addWord(word);\n                    const entry = this.colors.get(word);\n                    if (entry) {\n                        entry.add(color);\n                    } else {\n                        const colorSet = this.colorSetFactory.getInstance();\n                        colorSet.add(color);\n                        this.colors.set(word, colorSet);\n                    }\n                }\n            }\n        });\n    }\n\n    loadColorProfile(colors) {\n        this.$scope.$broadcast(\"text-colorizer\", (colorizer) => {\n            colorizer.setColors(colors, () => {\n                this._updateColors();\n                this.textColors.updateColors(colorizer.getAllColors());\n                this.$scope.$broadcast(\"colorsChainged\");\n            });\n        });\n    }\n\n    selectWord(word) {\n        this.$scope.$broadcast(\"color-toolbar\", (toolbar) => {\n            this.selectedWord = word;\n            toolbar.setColor(word.color);\n            toolbar.open();\n        });\n    }\n\n    colorModifiedHandler(color) {\n        this.$scope.$broadcast(\"text-colorizer\", (colorizer) => {\n            if (color && colorizer) {\n                if (color.isSet()) {\n                    colorizer.setColor(this.selectedWord, color, () => {\n                        this.textColors.updateColors(colorizer.getAllColors());\n                        this.$scope.$broadcast(\"colorsChainged\");\n                    });\n                } else {\n                    colorizer.resetColor(this.selectedWord, () => {\n                        this.textColors.updateColors(colorizer.getAllColors());\n                        this.$scope.$broadcast(\"colorsChainged\");\n                    });\n                }\n                this._updateColors();\n            }\n        });\n    }\n\n    inputComplete() {\n        this.$scope.$broadcast(\"text-colorizer\", (colorizer) => {\n            colorizer.inputComplete(() => {\n                this._updateColors();\n                this.textColors.updateColors(colorizer.getAllColors());\n                this.$scope.$broadcast(\"colorsChainged\");\n            });\n        });\n    }\n\n    drop() {\n        this.$scope.$broadcast(\"text-colorizer\", (colorizer) => {\n            colorizer.clear(() => {\n                this._updateColors();\n                this.textColors.clear();\n                this.$scope.$broadcast(\"colorsChainged\");\n            });\n        });\n    }\n\n    dropDialog() {\n        const self = this;\n        this.dialog.confirmDialog(function () {\n            this.yes = () => {\n                self.drop();\n                self.dialog.close();\n            };\n            this.cancel = () => {\n                self.dialog.close();\n            };\n            this.title = '\"drop\"';\n        });\n    }\n\n    decolorizeDialog() {\n        const self = this;\n        this.dialog.confirmDialog(function () {\n            this.yes = () => {\n                self.decolorizeText();\n                self.dialog.close();\n            };\n            this.cancel = () => {\n                self.dialog.close();\n            };\n            this.title = '\"clear\"';\n        });\n    }\n\n    decolorizeText() {\n        this.$scope.$broadcast(\"text-colorizer\", (colorizer) => {\n            colorizer.resetAllColors(() => {\n                this._updateColors();\n                this.textColors.clear();\n                this.$scope.$broadcast(\"colorsChainged\");\n            });\n        });\n    }\n\n    edit() {\n        this.$scope.$broadcast(\"text-colorizer\", (colorizer) => {\n            colorizer.editMode();\n        });\n    }\n\n    search() {\n        this.$scope.$broadcast(\"image-finder\", (imageFinder) => {\n            const colorsAndWords = this.textColors.getColorsAndWords();\n            if (!this.appSettings.checkSemanticSimilarity) {\n                colorsAndWords.words = [];\n            }\n            imageFinder.search(colorsAndWords, this.appSettings.getSearchSettings());\n        });\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./pages/main/MainCtrl.js","import 'chart.js';\nimport chart from 'angular-chart.js';\nimport slider from 'angularjs-slider';\nimport './scss/color-adjuster.scss';\nimport template from './template/color-adjuster.html';\n\nangular.module('color-adjuster', [slider, chart])\n.component('colorAdjuster', {\n    template,\n    controller: [\"$scope\", \"$element\", \"$attrs\", \"$timeout\", \"colorUtils\", \"colorFactory\", \"eventFilter\",\n    function Controller($scope, $element, $attrs, $timeout, colorUtils, colorFactory, eventFilter) {\n        const adjuster = this;\n\n        this.toggle = () => {\n            $timeout(() => {\n                $scope.$broadcast('rzSliderForceRender');\n            }, 0, false);\n        };\n\n        this.getS = () => this.textColors.sPercentage < 100 ? `-${Math.abs(adjuster.textColors.sPercentage - 100)}` : `+${Math.abs(adjuster.textColors.sPercentage - 100)}`;\n        this.getL = () => this.textColors.lPercentage < 100 ? `-${Math.abs(adjuster.textColors.lPercentage - 100)}` : `+${Math.abs(adjuster.textColors.lPercentage - 100)}`;\n\n        const colorsChainged = () => {\n            const tempColors = new Map();\n            const wei = [];\n            const cols = [];\n\n            for (const [key, color] of this.textColors.adjustedColorOccurence.entries()) {\n                const rgbHex = colorUtils.toHexString(key);\n                const tempColor = tempColors.get(rgbHex);\n                if (tempColor) {\n                    tempColor.weight += color.weight;\n                } else {\n                    const col = colorFactory.getInstance(color);\n                    tempColors.set(rgbHex, col);\n                }\n            }\n\n            for (const [key, value] of tempColors) {\n                cols.push(key);\n                wei.push(value.weight);\n            }\n\n            adjuster.data = wei;\n            adjuster.colors = cols;\n\n            $timeout(() => {\n                $scope.$apply();\n            }, 0, false);\n        };\n\n        this.labels = ['huhu','lol'];\n        this.data = [];\n        this.colors = [];\n\n        const timeWindow = 1000 / 30;\n        const filter = eventFilter(timeWindow, () => {\n            adjuster.textColors.calculateAdjustedColors();\n            colorsChainged();\n        });\n\n        this.options = {\n            tooltips: {\n                enabled: false,\n            },\n            animation: {\n                animateRotate: false,\n            },\n            events: [],\n        };\n\n        this.slider = {\n            value: 50,\n            options: {\n                floor: 0,\n                ceil: 200,\n                step: 1,\n                onChange: () => {\n                    filter.event();\n                },\n                onEnd: () => {\n                    adjuster.textColors.calculateAdjustedColors();\n                    colorsChainged();\n                },\n                hidePointerLabels: true,\n                hideLimitLabels: true,\n                disabled: false,\n            },\n        };\n\n        $scope.$on(\"colorsChainged\", colorsChainged);\n\n        this.$onInit = () => {\n            colorsChainged();\n        };\n    }],\n\n    bindings: {\n        textColors: '<',\n    },\n});\n\n\nexport default 'color-adjuster';\n\n\n\n// WEBPACK FOOTER //\n// ./components/color-adjuster/color-adjuster.js","module.exports = \" <div class=color-adjuster> <canvas class=\\\"chart chart-doughnut color-adjuster__diagram\\\" chart-data=$ctrl.data chart-colors=$ctrl.colors chart-labels=$ctrl.labels chart-options=$ctrl.options></canvas> <div class=\\\"sliders color-adjuster__sliders\\\"> <div class=sliders__content> <div class=color-adjuster__slider> <div><span class=\\\"glyphicon glyphicon-signal\\\"></span> <span>{{$ctrl.getS()}}%</span></div> <rzslider rz-slider-model=$ctrl.textColors.sPercentage rz-slider-options=$ctrl.slider.options></rzslider> </div> <div class=color-adjuster__slider> <div><span class=\\\"glyphicon glyphicon-adjust icon-flipped\\\"></span> <span>{{$ctrl.getL()}}%</span></div> <rzslider rz-slider-model=$ctrl.textColors.lPercentage rz-slider-options=$ctrl.slider.options></rzslider> </div> </div> </div> </div> \";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./components/color-adjuster/template/color-adjuster.html\n// module id = 333\n// module chunks = 0","import './scss/color-profiles.scss';\nimport template from './template/color-profiles.html';\n\nangular.module('color-profiles', [])\n.service('colorProfiles', ['db', 'colorFactory', function (db, colorFactory) {\n    return new ColorProfiles(new ColorProfilesDAO(db, colorFactory));\n}])\n.component('colorProfiles', {\n    template,\n    controller: ['$rootScope', '$scope', '$timeout', 'colorProfiles', 'colorFactory', 'colorSetFactory', 'popupDialog',\n    function Controller($rootScope, $scope, $timeout, colorProfiles, colorFactory, colorSetFactory, dialog) {\n        this.createProfile = false;\n        this.notDeleteColors = false;\n        this.newProfileName = '';\n        this.colorProfiles = colorProfiles;\n        this.profiles = [];\n        this.conflictColors = [];\n        let singleColors = [];\n        let mode = '';\n\n        this.updateProfileDialog = () => {\n            const self = this;\n            dialog.confirmDialog(function () {\n                this.yes = () => {\n                    self.updateProfile();\n                    dialog.close();\n                };\n                this.cancel = () => {\n                    dialog.close();\n                };\n                this.title = '\"update profile\"';\n            });\n        };\n\n        this.applyProfileDialog = () => {\n            const self = this;\n            dialog.confirmDialog(function () {\n                this.yes = () => {\n                    self.applyProfile();\n                    dialog.close();\n                };\n                this.cancel = () => {\n                    dialog.close();\n                };\n                this.title = '\"apply profile\"';\n            });\n        };\n\n        this.deleteProfileDialog = () => {\n            const self = this;\n            dialog.confirmDialog(function () {\n                this.yes = () => {\n                    self.deleteProfile();\n                    dialog.close();\n                };\n                this.cancel = () => {\n                    dialog.close();\n                };\n                this.title = '\"delete profile\"';\n            });\n        };\n\n        this.toggleNewProfile = () => {\n            this.createProfile = !this.createProfile;\n        };\n\n        this.haveProfiles = () => this.profiles.length > 0;\n\n        this.selectProfile = () => {\n            const name = colorProfiles.selectedProfile.name;\n            if (name !== null && name !== undefined) {\n                this._resetColorConflicts();\n                colorProfiles.loadColorProfile(name, () => {});\n            }\n        };\n\n        this.saveProfile = () => {\n            const name = this.newProfileName;\n            if (name !== undefined && name !== null && name.length > 0) {\n                this._resetColorConflicts();\n                mode = 'create';\n                this._testForColorConflicts();\n                if (this.conflictColors.length < 1) {\n                    const colors = this._convertColorArrayToMap(singleColors);\n                    this._createColorProfile(name, colors);\n                }\n            }\n        };\n\n        this.applyProfile = () => {\n            const name = colorProfiles.selectedProfile.name;\n            if (name !== null && name !== undefined) {\n                this._resetColorConflicts();\n                this.onLoadProfile({\n                    colors: colorProfiles.getSelectedProfileColors(),\n                });\n            }\n        };\n\n        this.updateProfile = () => {\n            const name = colorProfiles.selectedProfile.name;\n            if (name !== null && name !== undefined) {\n                this._resetColorConflicts();\n                mode = 'update';\n                const colors = colorProfiles.getSelectedProfileColors();\n\n                if (!this.notDeleteColors) {\n                    for (const word of colors.keys()) {\n                        if (!this.colors.has(word)) {\n                            colors.delete(word);\n                        }\n                    }\n                }\n\n                this._testForColorConflicts(colors);\n                if (this.conflictColors.length < 1) {\n                    const cMap = this._convertColorArrayToMap(singleColors);\n                    this._updateColorProfile(name, cMap);\n                }\n            }\n        };\n\n        this.deleteProfile = () => {\n            const name = colorProfiles.selectedProfile.name;\n            if (name !== null && name !== undefined) {\n                colorProfiles.deleteColorProfile(name, () => {\n                    $scope.$apply();\n                    const profileName = this.profiles[this.profiles.length - 1];\n                    this._resetColorConflicts();\n                    colorProfiles.loadColorProfile(profileName, () => {\n                        $scope.$apply();\n                    });\n                });\n            }\n        };\n\n        this.solveColorConflicts = () => {\n            const colors = this._concatColorArraysToMap();\n            switch (mode) {\n                case 'update': {\n                    const name = colorProfiles.selectedProfile.name;\n                    if (name !== null && name !== undefined) {\n                        this._updateColorProfile(name, colors);\n                    }\n                } break;\n                case 'create': {\n                    const name = this.newProfileName;\n                    if (name !== null && name !== undefined) {\n                        this._createColorProfile(name, colors);\n                    }\n                } break;\n            }\n        };\n\n        // helper functions\n        this._resetColorConflicts = () => {\n            this.conflictColors = [];\n            singleColors = [];\n            mode = '';\n        };\n\n        this._createColorProfile = (name, colors) => {\n            colorProfiles.createColorProfile(name, colors, () => {\n            this.newProfileName = \"\";\n            this._resetColorConflicts();\n            colorProfiles.loadColorProfile(name, () => {\n                $scope.$apply();\n                });\n            });\n        };\n\n        this._updateColorProfile = (name, colors) => {\n            colorProfiles.updateColorProfile(name, colors, () => {\n                this._resetColorConflicts();\n                $timeout(() => {\n                    $scope.$apply();\n                }, 0);\n            });\n        };\n\n        this._testForColorConflicts = (colors) => {\n            const colorsMapTemp = new Map();\n            for (const [word, mapColors] of this.colors) {\n                const colorsArray = mapColors.getValuesArray();\n                const colorSet = colorSetFactory.getInstance();\n                for (let i = 0; i < colorsArray.length; i++) {\n                    colorSet.add(colorsArray[i]);\n                }\n                colorsMapTemp.set(word, colorSet);\n            }\n\n            if (colors) {\n                for (const [word, color] of colors) {\n                    const c = colorFactory.getInstance(color);\n                    const entry = colorsMapTemp.get(word);\n                    if (entry) {\n                        entry.add(c);\n                    } else {\n                        const colorSet = colorSetFactory.getInstance();\n                        colorSet.add(c);\n                        colorsMapTemp.set(word, colorSet);\n                    }\n                }\n            }\n\n            for (const [word, mapColors] of colorsMapTemp) {\n                const colorsToWordArray = mapColors.getValuesArray();\n                if (colorsToWordArray.length > 1) {\n                    const sel = colorsToWordArray[0];\n                    this.conflictColors.push({ word, selected: sel, colors: colorsToWordArray });\n                } else {\n                    const color = colorsToWordArray[0];\n                    singleColors.push({ word, color });\n                }\n            }\n        };\n\n        this._concatColorArraysToMap = () => {\n            let colors = [];\n            this.conflictColors.forEach((item) => {\n                colors.push({ word: item.word, color: item.selected });\n            });\n            colors = colors.concat(singleColors);\n            const cMap = this._convertColorArrayToMap(colors);\n            return cMap;\n        };\n\n        this._convertColorArrayToMap = (arr) => {\n            const colorMap = new Map();\n            for (let i = 0, k = arr.length; i < k; i++) {\n                const item = arr[i];\n                colorMap.set(item.word, item.color);\n            }\n            return colorMap;\n        };\n\n        this.$onInit = () => {\n            // bind model and viewmodel\n            colorProfiles.load(() => {\n                this.profiles = colorProfiles.getColorProfileNames();\n                if (this.profiles && this.profiles.length > 0) {\n                    const name = this.profiles[this.profiles.length - 1];\n                    colorProfiles.loadColorProfile(name, () => {\n                        $scope.$apply();\n                    });\n                }\n            });\n        };\n    }],\n\n    bindings: {\n        colors: '<',\n        onLoadProfile: '&',\n    },\n});\n\n\nclass ColorProfiles {\n\n    constructor(dao) {\n        this.profileNames = [];\n        this.selectedProfile = {};\n        this.dao = dao;\n        this.dao.setProfiles(this);\n    }\n\n    loadColorProfile(name, callback) {\n        this.dao.loadColorProfile(name, callback);\n    }\n\n    // get profiles\n    load(callback) {\n        this.dao.loadColorProfiles(callback);\n    }\n\n    createColorProfile(name, colors, callback) {\n        const profile = new ColorProfile(name, colors);\n        this.dao.saveColorProfile(profile, callback);\n    }\n\n    deleteColorProfile(name, callback) {\n        this.dao.deleteColorProfile(name, callback);\n    }\n\n    getColorProfileNames() {\n        return this.profileNames;\n    }\n\n    getSelectedProfileColors() {\n        return this.selectedProfile.colors;\n    }\n\n    updateColorProfile(name, colors, callback) {\n        if (this.selectedProfile.name === name) {\n            const profile = new ColorProfile(name, colors);\n            this.dao.updateColorProfile(profile, callback);\n        }\n    }\n\n    _removeColorProfileName(name) {\n        let index;\n        for (let i = 0; i < this.profileNames.length; i++) {\n            if (this.profileNames[i] === name) {\n                index = i;\n                break;\n            }\n        }\n        this.profileNames.splice(index, 1);\n    }\n\n    _setColorProfile(profile) {\n        this.selectedProfile = profile;\n    }\n\n    _addColorProfileName(name) {\n        this.profileNames.push(name);\n    }\n}\n\nclass ColorProfile {\n    constructor(name, colors) {\n        this.name = name;\n        this.colors = colors;\n    }\n\n    static deserialize(o, colorFactory) {\n        const name = o.name;\n        const colors = new Map(o.colors);\n        for (const [word, color] of colors) {\n            colors.set(word, colorFactory.getInstance(color));\n        }\n        return new ColorProfile(name, colors);\n    }\n\n    serialize() {\n        const self = this;\n        const o = {};\n        o.name = this.name;\n        o.colors = [...self.colors];\n        return o;\n    }\n}\n\nclass ColorProfilesDAO {\n\n    constructor(db, colorFactory) {\n        this.colorFactory = colorFactory;\n        this.profiles = [];\n        this.store = 'colorprofiles';\n        this.db = db;\n    }\n\n    setProfiles(profiles) {\n        this.profiles = profiles;\n    }\n\n    loadColorProfile(name, callback) {\n        this.db.getStore(this.store)\n        .getItem(name)\n        .then((item) => {\n            if (item) {\n                const profile = ColorProfile.deserialize(item, this.colorFactory);\n                this.profiles._setColorProfile(profile);\n            }\n            if (callback) {\n                callback();\n            }\n        })\n        .catch(() => {\n            console.warn(\"Database error\");\n        });\n    }\n\n    deleteColorProfile(name, callback) {\n        this.db.getStore(this.store)\n        .removeItem(name)\n        .then(() => {\n            this.profiles._removeColorProfileName(name);\n            if (callback) {\n                callback();\n            }\n        })\n        .catch(() => {\n            console.warn(\"Database error\");\n        });\n    }\n\n    saveColorProfile(profile, callback) {\n        const store = this.db.getStore(this.store);\n        store.getItem(profile.name)\n        .then((item) => {\n            if (!item) {\n                return store.setItem(profile.name, profile.serialize())\n                .then(() => {\n                    this.profiles._addColorProfileName(profile.name);\n                    this.profiles._setColorProfile(profile);\n                    if (callback) {\n                        callback();\n                    }\n                });\n            }\n            return null;\n        })\n        .catch((e) => {\n            console.warn(\"Database error\");\n            console.error(e);\n        });\n    }\n\n    loadColorProfiles(callback) {\n        this.db.getStore(this.store)\n        .iterate((value, key) =>\n            this.profiles._addColorProfileName(key))\n        .then(() => {\n            if (callback) {\n                callback();\n            }\n        })\n        .catch(() => {\n            console.warn(\"Database error\");\n        });\n    }\n\n    updateColorProfile(profile, callback) {\n        this.db.getStore(this.store)\n        .setItem(profile.name, profile.serialize())\n        .then(() => {\n            this.loadColorProfile(profile.name, () => {\n                if (callback) {\n                    callback();\n                }\n            });\n        })\n        .catch(() => {\n            console.warn(\"Database connection error\");\n        });\n    }\n}\n\nexport default 'color-profiles';\n\n\n\n// WEBPACK FOOTER //\n// ./components/color-profiles/color-profiles.js","module.exports = \"<div> <select class=color-profiles__profiles ng-change=$ctrl.selectProfile() ng-model=$ctrl.colorProfiles.selectedProfile.name> <option ng-repeat=\\\"profile in $ctrl.profiles track by $index\\\" data-colorprofiles-profile={{$index}} value={{profile}}>{{profile}}</option> </select> <div class=\\\"control-buttons color-profiles__control-buttons\\\"> <a ng-click=$ctrl.applyProfileDialog() class=\\\"btn-bodyless btn-bodyless-success\\\" ng-class=\\\"$ctrl.haveProfiles() ? '' : 'disabled'\\\"><span class=\\\"glyphicon glyphicon-tint\\\"></span> Apply</a> <a ng-click=$ctrl.updateProfileDialog() class=btn-bodyless ng-class=\\\"$ctrl.haveProfiles() ? '' : 'disabled'\\\"><span class=\\\"glyphicon glyphicon-floppy-save\\\"></span> Update</a> <a ng-click=$ctrl.deleteProfileDialog() class=\\\"btn-bodyless btn-bodyless-danger\\\" ng-class=\\\"$ctrl.haveProfiles() ? '' : 'disabled'\\\"><span class=\\\"glyphicon glyphicon-trash\\\"></span> Drop</a> <a ng-click=$ctrl.toggleNewProfile() class=\\\"btn-bodyless btn-bodyless-success\\\"><span class=\\\"glyphicon glyphicon-plus\\\" aria-hidden=true></span> Create</a> </div> <div class=\\\"create-profile color-profiles__create-profile\\\"> <div ng-show=$ctrl.createProfile> <input ng-model=$ctrl.newProfileName type=text class=\\\"form-control create-profile__profile-name\\\" placeholder=Profile> <a ng-click=$ctrl.saveProfile() class=\\\"btn btn-success btn-block\\\"><span class=\\\"glyphicon glyphicon-save\\\" aria-hidden=true></span> Save</a> </div> </div> <div ng-show=\\\"$ctrl.conflictColors.length>0\\\" class=\\\"conflicts color-profiles__conflicts\\\"> <div class=conflicts__title><span>Conflicts</span></div> <div ng-repeat=\\\"item in $ctrl.conflictColors track by $index\\\"> {{item.word}} <form> <div ng-repeat=\\\"color in item.colors track by $index\\\"> <input ng-model=$ctrl.conflictColors[$parent.$index].selected ng-value=color type=radio> <div class=conflicts__color ng-style=\\\"{'background-color': color}\\\"></div><span class=conflicts__weight> weight: {{color.weight}}</span> </div> </form> </div> <a ng-click=\\\"$ctrl.solveColorConflicts() \\\" class=\\\"btn btn-success\\\"><span class=\\\"glyphicon glyphicon-ok\\\" aria-hidden=true></span> OK</a> </div> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./components/color-profiles/template/color-profiles.html\n// module id = 336\n// module chunks = 0","import XRegExp from 'xregexp';\nimport Entities from 'html-entities';\nimport './scss/text-colorizer.scss';\nimport template from './template/text-colorizer.html';\n\nconst entities = Entities.AllHtmlEntities;\nangular.module('text-colorizer', [])\n.component('textColorizer', {\n    template,\n    controller: [\"$scope\", \"$element\", \"$attrs\", \"$timeout\", \"$window\", \"calculateFontColor\", \"colorFactory\",\n    function ($scope, $element, $attrs, $timeout, $window, calculateFontColor, colorFactory) {\n        const _colorizer = this;\n        const calcFontColor = calculateFontColor;\n        const _options = {\n            widgetSelector: 'data-textcolorizer-text',\n            wordSelector: 'data-textcolorizer-word',\n            colorSelector: 'data-textcolorizer-color',\n            weightSelector: 'data-textcolorizer-weight',\n            helperSelector: 'data-textcolorizer-helper',\n        };\n\n        const _vars = {\n            root: angular.element($element.find(`div[${_options.widgetSelector}]`)[0]),\n            words: new Map(),\n            wordsToRemove: new Set(),\n            editMode: false,\n            idCounter: 0,\n            helperCounter: 0,\n            wordWidth: 5,\n        };\n\n        const specialChars = new Map();\n        specialChars.set('#%%%#;', '<');\n        specialChars.set('#%%#%;', '>');\n        specialChars.set('#%#%%;', '</');\n        specialChars.set('##%%%;', '\"');\n\n        function encodeSpecialChars(str) {\n            return str.replace(/#%%%#;|#%%#%;|#%#%%;|##%%%;/g, m => specialChars.get(m));\n        }\n\n        // public api\n        const api = {\n            inputComplete(callback) {\n                _colorizer.inputComplete(callback);\n            },\n            editMode() {\n                _colorizer.editMode();\n            },\n            setColor(colorObject, conf, callback) {\n                _colorizer.setColor(colorObject, conf, callback);\n            },\n            resetColor(colorObject, callback) {\n                _colorizer.resetColor(colorObject, callback);\n            },\n            resetAllColors(callback) {\n                _colorizer.resetAllColors(callback);\n            },\n            getAllColors() {\n                return _colorizer.getAllColors();\n            },\n            setColors(colors, callback) {\n                _colorizer.setColors(colors, callback);\n            },\n            clear(callback) {\n                _colorizer.clear(callback);\n            },\n        };\n\n        $scope.$on(\"text-colorizer\", (event, callback) => {\n            if (typeof callback === \"function\") {\n                callback(api);\n            }\n        });\n\n        // allows only plain text paste\n        this._handlePaste = (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            let text = '';\n            if (e.clipboardData || e.originalEvent.clipboardData) {\n                text = (e.originalEvent || e).clipboardData.getData('Text');\n            } else if ($window.clipboardData) {\n                text = $window.clipboardData.getData('Text');\n            }\n            if ($window.document.queryCommandSupported('insertText')) {\n                $window.document.execCommand('insertText', false, text);\n            } else {\n                $window.document.execCommand('paste', false, text);\n            }\n        };\n\n        \n        // Chrome workaround for proper style and behavior\n        // handler for \"keydown\" events in widget\n        this._handleKeydown = (event) => {\n            // update & delete word nodes if enter or delete keyevents performed\n            if (event.keyCode === 13 || event.keyCode === 8 || event.keyCode === 46) {\n                $window.setTimeout(() => {\n                    _colorizer._deleteEmpty();\n                    _colorizer._updateFontStyle();\n                }, 0);\n            }\n            \n            if (event.keyCode === 8 || event.keyCode === 46) {\n                if ($window && $window.getSelection && $window.getSelection().anchorNode\n                    && $window.getSelection().getRangeAt(0)) {\n                    const target = $window.getSelection().anchorNode.parentNode;\n                    if (angular.element(target).attr(`${_options.wordSelector}`)) {\n                        const sel = $window.getSelection();\n                        // if different nodes are involved\n                        // check all nodes\n                        if (sel.anchorNode === sel.focusNode) {\n                            const range = sel.getRangeAt(0);\n                            const startIndex = range.startOffset;\n                            const endIndex = range.endOffset;\n                            const count = Math.abs(startIndex - endIndex);\n                            const text = sel.anchorNode.nodeValue;\n                            const spaceReg = XRegExp('^(\\u00A0)$', \"gi\");\n\n                            if (count < 2) {\n                                if (event.keyCode === 8) {\n                                    if (startIndex === 1 || startIndex === 0 || endIndex === 1 || endIndex === 0) {\n                                        if (text.trim().length > 0 && text[startIndex - 1].match(spaceReg)) {\n                                            event.preventDefault();\n                                        }\n                                    } else if (startIndex === text.length || endIndex === text.length) {\n                                        event.preventDefault();\n                                        sel.anchorNode.nodeValue = `${text.slice(0, -2)}\\u00A0`;\n                                        this._moveCaretInText(sel.anchorNode.nodeValue.length, sel.anchorNode);\n                                    }\n                                } else if (event.keyCode === 46) {\n                                    if (startIndex === 0 || startIndex === text.length ||\n                                        endIndex === 0 || endIndex === text.length) {\n                                        event.preventDefault();\n                                    }\n                                }\n                            }\n                            \n                            if (count > 1 && count < text.length) {\n                                if (startIndex === 0) {\n                                    event.preventDefault();\n                                    sel.anchorNode.nodeValue = `\\u00A0${text.slice(endIndex)}`;\n                                    this._moveCaretInText(1, sel.anchorNode);\n                                } else if (endIndex === text.length) {\n                                    event.preventDefault();\n                                    sel.anchorNode.nodeValue = `${text.slice(0, -count)}\\u00A0`;\n                                    this._moveCaretInText(sel.anchorNode.nodeValue.length, sel.anchorNode);\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        };\n\n        // Chrome fonts\n        this._updateFontStyle = () => {\n            _vars.root.css({\n                'font-size': '1em',\n                'line-height': '1.7em',\n            });\n        };\n\n        this._handleCut = () => {\n            $window.setTimeout(() => colorizer._updateWordsStyle(), 0);\n        };\n\n        this._updateWordsStyle = () => {\n            angular.element(_vars.root).find(`mark[${_options.wordSelector}]`).each((i, elem)=>{\n                const $wordNode = angular.element(elem);\n                const text = $wordNode.text().trim();\n                $wordNode.text(`\\u00A0${text}\\u00A0`);\n            });\n            this._deleteEmpty();\n            this._updateFontStyle();\n        };\n\n        // helper function: move caret to special position in textnode\n        this._moveCaretInText = (position, textNode) => {\n            const caret = position;\n            const range = $window.document.createRange();\n            range.setStart(textNode, caret);\n            range.collapse(true);\n            const sel = $window.getSelection();\n            sel.removeAllRanges();\n            sel.addRange(range);\n        };\n\n\n        /** *********  main methods ********** */\n\n        // colorize words\n        // @params: colors map, callback function (optional)\n        this.setColors = (colors, callback) => {\n            this.inputComplete(() => {\n                _vars.root.find(`mark[${_options.wordSelector}]`).each((i, elem) => {\n                    const id = parseInt(angular.element(elem).attr(`${_options.wordSelector}`), 10);\n                    const wordItem = _vars.words.get(id);\n                    const color = colors.get(wordItem.word);\n                    if (color) {\n                        _colorizer._setWordColor(wordItem, color, angular.element(elem));\n                    }\n                });\n                if (callback) {\n                    callback();\n                }\n            });\n        };\n\n        // apply color to word\n        // @param: word, new color, \"word\" node\n        this._setWordColor = (wordItem, color, $wordNode) => {\n            wordItem.color.setColor(color);\n            $wordNode.css({ \"background-color\": color.toString() });\n            $wordNode.css({ color: calcFontColor(color) });\n        };\n\n        // subroutine: delete empty \"words\"\n        this._deleteEmpty = () => {\n            _vars.root.find(`mark[${_options.wordSelector}]`).filter((i, elem) => {\n                let ret = true;\n                const $wordNode = angular.element(elem);\n                if (!($wordNode.text().trim().length < 1 || $wordNode.text().trim() === '&nbsp;' ||\n                    $wordNode.text().trim() === '' || $wordNode.find(\"br\").length > 0\n                    && !$wordNode.parent().is(_vars.root))) {\n                    ret = false;\n                }\n                return ret;\n            }).remove();\n            return this;\n        };\n\n        this.createWordMark = (id, txt, backgroundColor, fontColor) => `#%%%#;mark ${_options.wordSelector}=${id} style = ##%%%;background-color: ${backgroundColor}; color: ${fontColor};##%%%;#%%#%;\\u00A0${txt}\\u00A0#%#%%;mark#%%#%;`;\n\n            // subroutine: handle changes in detected words\n            this._inWordTags = () => {\n                _vars.root.find(`mark[${_options.wordSelector}]`).each((i, elem) => {\n                    const $wordNode = angular.element(elem);\n                    const idString = $wordNode.attr(_options.wordSelector);\n                    const id = parseInt(idString, 10);\n                    const backgroundColor = $wordNode.css(\"background-color\");\n                    const fontColor = $wordNode.css(\"color\");\n                    const text = $wordNode.text();\n                    const format = XRegExp('^(?:\\u00A0[\\\\pN\\\\pL]+\\u00A0)$', 'i');\n                    const word = _vars.words.get(id);\n                    if (!text.match(format)) {\n                        const newHtml = text.replace(XRegExp('[\\\\pN\\\\pL]+', 'gi'), (needle) => {\n                            const color = colorFactory.getInstance(word.color);\n                            const wordId = _vars.idCounter++;\n                            _vars.words.set(wordId, { id: wordId, color, word: needle.toLowerCase() });\n                            return this.createWordMark(wordId, needle, backgroundColor, fontColor);\n                        });\n                        _vars.wordsToRemove.add(id);\n                        $wordNode.replaceWith(encodeSpecialChars(entities.encode(newHtml)));\n                    }\n                });\n                return this;\n            };\n    \n            // handle (new) text outside from detected words\n            // find all strings, which are not in (mark) tags and create new marks\n            this._notInTags = () => {\n                const reg = XRegExp('[\\\\pN\\\\pL]+', 'gi');\n                _vars.root.contents()\n                .filter((i, item) => item.nodeType === 3)\n                .each((i, item) => {\n                    const txt = item.nodeValue.trim().replace(/\\s+/g, ' ');\n                    const html = txt.replace(reg, (needle) => {\n                        const color = colorFactory.getInstance();\n                        const wordId = _vars.idCounter++;\n                        _vars.words.set(wordId, { id: wordId, color, word: needle.toLowerCase() });\n                        return this.createWordMark(wordId, needle, null, null);\n                    });\n                    angular.element(item).replaceWith(encodeSpecialChars(entities.encode(html)));\n                })\n                .end();\n                _vars.root.find(\"br\").replaceWith(\" \");\n                return this;\n            };\n\n        this._updateWords = (word) => {\n            _vars.root.find(`mark[${_options.wordSelector}=${word.id}]`).each((i, elem) => {\n                const $wordNode = angular.element(elem);\n                const text = $wordNode.text();\n                const color = colorFactory.getInstance(word.color);\n                const wordId = _vars.idCounter++;\n                $wordNode.attr(`${_options.wordSelector}`, wordId);\n                _vars.words.set(wordId, { id: wordId, color, word: text.toLowerCase() });\n            });\n        };\n\n        // set carte to the end of element\n        // @params: element node\n        this._setCaretPosition = (element) => {\n            const range = $window.document.createRange();\n            const sel = $window.getSelection();\n            range.setStartAfter(element);\n            range.setEndAfter(element);\n            sel.removeAllRanges();\n            sel.addRange(range);\n        };\n\n        // detect words in text\n        // @param: callback function (optional)\n        this.inputComplete = (callback) => {\n            _vars.editMode = false;\n            // unwrape, if text was wrapped in tags by browser\n            _vars.root.find(`:not(mark[${_options.wordSelector}])`).contents().unwrap();\n           _vars.root.find(`:not(mark[${_options.wordSelector}])`).remove();\n           this._deleteEmpty()._inWordTags()._notInTags();\n            _vars.root.find(`:not(mark[${_options.wordSelector}])`).remove();\n            _vars.root.attr(\"contentEditable\", false);\n            const currentIds = new Set();\n            _vars.root.find(`mark[${_options.wordSelector}]`).each((i, elem) => {\n                const idString = angular.element(elem).attr(_options.wordSelector);\n                const id = parseInt(idString, 10);\n                currentIds.add(id);\n            });\n\n            _vars.root.find(`mark[${_options.wordSelector}]`).each((i, elem) => {\n                if (elem.nextSibling && elem.nextSibling.nodeType !== 3) {\n                    const node = $window.document.createTextNode('\\u00A0');\n                    elem.parentNode.insertBefore(node, elem.nextSibling);\n                }\n            });\n\n            for (const id of _vars.words.keys()) {\n                if (_vars.wordsToRemove.has(id) || !currentIds.has(id)) {\n                    _vars.words.delete(id);\n                }\n            }\n            _vars.wordsToRemove.clear();\n            if (callback) {\n                callback();\n            }\n        };\n\n        // switch to edit mode and move caret to the end\n        this.editMode = () => {\n            _vars.editMode = true;\n            _vars.root.attr(\"contentEditable\", true);\n            const lastNodeType = _vars.root.contents().last()[0] ?\n            _vars.root.contents().last()[0].nodeType : undefined;\n            if (lastNodeType && lastNodeType !== 3) {\n                const space = $window.document.createTextNode('\\u00A0');\n                _vars.root.append(angular.element(space));\n                _colorizer._setCaretPosition(_vars.root.contents().last()[0]);\n            } else if (lastNodeType) {\n                _vars.root.append(`<span ${_options.helperSelector}></span>`);\n                _colorizer._setCaretPosition(_vars.root.find(`span[${_options.helperSelector}]`)[0]);\n                $timeout(() => {\n                    _vars.root.find(`span[${_options.helperSelector}]`).remove();\n                }, 0);\n            }\n            _vars.root[0].focus();\n        };\n\n        // set one color\n        // @params: color object, new color, callback function (optional)\n        this.setColor = (word, newColor, callback) => {\n            if (!_vars.editMode && word) {\n                const $wordNode = _vars.root.find(`mark[${_options.wordSelector}=${word.id}]`);\n                if ($wordNode && $wordNode.length > 0) {\n                    const savedWord = _vars.words.get(word.id);\n                    savedWord.color.setColor(newColor);\n                    $wordNode.css({ \"background-color\": savedWord.color.toString(),\n                                    color: calcFontColor(savedWord.color) });\n                }\n            }\n            if (callback) {\n                callback();\n            }\n        };\n\n        // return all colors as map\n        this.getAllColors = () => _vars.words;\n\n        // reset one color (decolorize word)\n        // @params: color object, callback function (optional)\n        this.resetColor = (word, callback) => {\n            if (!_vars.editMode && word) {\n                const $wordNode = _vars.root.find(`mark[${_options.wordSelector}=${word.id}]`);\n                if ($wordNode && $wordNode.length > 0) {\n                    $wordNode.removeAttr(\"style\");\n                    const savedWord = _vars.words.get(word.id);\n                    if (savedWord) {\n                        savedWord.color.reset();\n                    }\n                }\n            }\n            if (callback) {\n                callback(this);\n            }\n        };\n\n        this.resetAllColors = (callback) => {\n            _vars.root.find(`mark[${_options.wordSelector}]`)\n            .removeAttr(\"style\");\n            for (const word of _vars.words.values()) {\n                word.color.reset();\n            }\n            if (callback) {\n                callback();\n            }\n        };\n\n        // event handler for \"click\" events in the widget\n        // event delegation -> handles clicks on words in editor\n        // @params: event object\n        this.selectWord = ($event) => {\n            const $targetNode = angular.element($event.target);\n            if ($targetNode.length > 0 && $targetNode[0].hasAttribute(_options.wordSelector)) {\n                if (!_vars.editMode) {\n                    $event.stopPropagation();\n                    const id = $targetNode.attr(_options.wordSelector);\n                    const savedWord = _vars.words.get(parseInt(id, 10));\n                    this.onWordselect({ word: savedWord });\n                } else {\n                    // for better handling in webkit\n                    const textNode = $targetNode.contents().first()[0];\n                    const anchorNode = $window.getSelection().anchorNode;\n                    if (anchorNode && !textNode.isSameNode(anchorNode)) {\n                        const nativeText = $targetNode.text();\n                        if (nativeText[0].trim().length > 0) {\n                            const spaceText = $window.document.createTextNode(`\\u00A0${textNode.textContent.trim()}\\u00A0`);\n                            textNode.parentNode.replaceChild(spaceText, textNode);\n                            this._moveCaretInText(1, spaceText);\n                        }\n                    }\n                }\n            }\n        };\n\n        // delete all color assignments and empty colors map\n        // @params: callback function (optional)\n        this.clear = (callback) => {\n            _vars.words.clear();\n            _vars.root.attr(\"contentEditable\", true);\n            _vars.root.empty();\n            _vars.root[0].focus();\n            callback();\n        };\n    }],\n\n    bindings: {\n        control: '<',\n        onWordselect: '&',\n    },\n});\n\nexport default 'text-colorizer';\n\n\n\n// WEBPACK FOOTER //\n// ./components/text-colorizer/text-colorizer.js","module.exports = \" <div class=textcolorizer> <div data-textcolorizer-text ng-click=$ctrl.selectWord($event) ng-keydown=$ctrl._handleKeydown($event) ng-paste=$ctrl._handlePaste($event) ng-cut=$ctrl._handleCut($event) contenteditable=true>Lorem ipsum dolor sit amet</div> <div data-textcolorizer-background></div> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./components/text-colorizer/template/text-colorizer.html\n// module id = 349\n// module chunks = 0","import slider from 'angularjs-slider';\nimport './scss/color-toolbar.scss';\nimport template from './template/color-toolbar.html';\n\nangular.module('color-toolbar', [slider])\n.component('colorToolbar', {\n    template,\n    controller: [\"$rootScope\", \"$scope\", \"$element\", \"$attrs\",\n    \"$timeout\", \"$window\", \"colorFactory\", \"eventFilter\",\n    function Controller($rootScope, $scope, $element, $attrs,\n        $timeout, $window, colorFactory, eventFilter) {\n        const toolbar = this;\n        this.id = $attrs[\"toolbarId\"];\n        this.colors = [];\n\n        for (let i = 0; i < 360; i += 30) {\n            const color = colorFactory.getInstance({ h: i, s: 50, l: 50 });\n            this.colors.push(color);\n        }\n        const black = colorFactory.getInstance({ h: 0, s: 0, l: 0 }).setAchromatic();\n        const white = colorFactory.getInstance({ h: 0, s: 0, l: 100 }).setAchromatic();\n        this.colors.push(black);\n        this.colors.push(white);\n        this.color = colorFactory.getInstance();\n\n        const timeWindow = 1000 / 30;\n        const filter = eventFilter(timeWindow, () => {\n            toolbar.colorModifiedHandler({ color: toolbar.color });\n        });\n\n        this.slider = {\n            value: 50,\n            options: {\n                floor: 0,\n                ceil: 100,\n                step: 1,\n                onChange() {\n                    filter.event();\n                },\n                onEnd() {\n                    toolbar.colorModifiedHandler({ color: toolbar.color });\n                },\n                hidePointerLabels: true,\n                hideLimitLabels: true,\n                disabled: true,\n            },\n        };\n\n        this.increaseWeight = () => {\n            if (this.color && this.color.isSet() && this.color.weight < 100) {\n                toolbar.color.weight ++;\n                this.colorModifiedHandler({ color: toolbar.color });\n            }\n        };\n\n        this.decreaseWeight = () => {\n            if (this.color && this.color.isSet() && this.color.weight > 1) {\n                toolbar.color.weight --;\n                this.colorModifiedHandler({ color: toolbar.color });\n            }\n        };\n\n        this.endSlide = () => {\n            this.colorModifiedHandler({ color: toolbar.color });\n        };\n\n        this.selectColor = ($event) => {\n            const target = $event.target;\n            if (target.hasAttribute(\"data-toolbar-color\") || target.parentElement.hasAttribute(\"data-toolbar-color\")) {\n                $event.stopPropagation();\n                const colorElement = target.hasAttribute(\"data-toolbar-color\") ? target : target.parentElement;\n                const colorIndex = angular.element(colorElement).attr(\"data-toolbar-color\");\n                if (colorIndex && colorIndex !== \"null\") {\n                    const color = colorFactory.getInstance(this.colors[colorIndex]);\n                    this.changeColor(color);\n                    this.slider.options.disabled = this.color.isAchromatic();\n                } else {\n                    this.setInitialColor();\n                }\n                this.colorModifiedHandler({ color: toolbar.color });\n            }\n        };\n\n        this.changeColor = (color) => {\n            color.weight = this.color.weight;\n            if (!color.isAchromatic() && !this.color.isAchromatic()\n                && this.color.s && this.color.l) {\n                color.s = this.color.s;\n                color.l = this.color.l;\n            }\n            this.color = color;\n        };\n\n        this.setCurrentColor = (color) => {\n            if (color && color.isSet()) {\n                this.color = color;\n                this.slider.options.disabled = this.color.isAchromatic();\n            } else {\n                this.setInitialColor();\n            }\n        };\n\n        this.setInitialColor = () => {\n            this.color = colorFactory.getInstance();\n            this.slider.options.disabled = true;\n        };\n\n        this.close = () => {\n            $element.addClass(\"hide\");\n        };\n\n        this.open = () => {\n            $element.removeClass(\"hide\");\n            $timeout(() => {\n                $scope.$broadcast('rzSliderForceRender');\n            }, 0);\n        };\n\n        // public api\n        const api = {\n            setColor(color) {\n                toolbar.setCurrentColor(color);\n            },\n            close() {\n                toolbar.close();\n            },\n            open() {\n                toolbar.open();\n            },\n        };\n\n        $scope.$on(\"color-toolbar\", (event, callback) => {\n            if (typeof callback === \"function\") {\n                callback(api);\n            }\n        });\n\n        this.$onInit = () => {\n            if (this.closed === true) {\n                this.close();\n            }\n            angular.element($window).bind('resize orientationchange', () => {\n                $rootScope.$broadcast('rzSliderForceRender');\n            });\n        };\n    }],\n\n    bindings: {\n        colorModifiedHandler: '&',\n        closed: '<',\n    },\n});\n\nexport default 'color-toolbar';\n\n\n\n\n// WEBPACK FOOTER //\n// ./components/color-toolbar/color-toolbar.js","module.exports = \"<div class=toolbar> <div class=toolbar__content> <div class=toolbar__left> <div class=colorbox ng-click=$ctrl.selectColor($event)> <div ng-repeat=\\\"c in $ctrl.colors track by $index\\\"> <div class=colorbox__color data-toolbar-color={{$index}} ng-style=\\\"{'background-color': c}\\\"></div> </div> <div class=colorbox__color data-toolbar-color=null><span class=\\\"glyphicon glyphicon-remove colorbox__clear-icon\\\"></span></div> <div style=clear:both></div> </div> </div> <div class=toolbar__center> <div class=toolbar__adjuster> <div class=\\\"sliders toolbar__sliders\\\" ng-disabled=!$ctrl.color.isSet()> <div class=sliders__content> <div class=sliders__saturation-slider> <span class=\\\"glyphicon glyphicon-signal\\\"></span> <span>{{$ctrl.color.isSet() ? $ctrl.color.s : 0 }}%</span> <rzslider rz-slider-model=$ctrl.color.s rz-slider-options=$ctrl.slider.options></rzslider> </div> <div class=sliders__lightness-slider> <span class=\\\"glyphicon glyphicon-adjust icon-flipped\\\"></span> <span>{{$ctrl.color.isSet() ? $ctrl.color.l : 0 }}%</span> <rzslider rz-slider-model=$ctrl.color.l rz-slider-options=$ctrl.slider.options></rzslider> </div> </div> </div> <div class=\\\"weight toolbar__weight\\\"> <div class=weight__title><span class=\\\"glyphicon glyphicon-stats\\\"></span> Weight</div> <div class=weight__controls> <div class=\\\"weight__buttons btn-group-vertical\\\" role=group> <a type=button class=\\\"btn btn-default btn-block btn-square weight__button\\\" ng-click=$ctrl.increaseWeight()>+</a> <a type=button class=\\\"btn btn-default btn-block btn-square weight__button\\\" ng-click=$ctrl.decreaseWeight()>-</a> </div> <div class=weight__value>{{$ctrl.color.weight}}</div> </div> </div> </div> </div> <div class=toolbar__right> <div class=\\\"selected-color toolbar__selected-color\\\"> <div class=selected-color__value ng-style=\\\"{'background-color': $ctrl.color}\\\"></div> <div class=selected-color__background></div> </div> <div class=\\\"close-button toolbar__close-button\\\" ng-click=$ctrl.close()> <span class=\\\"glyphicon glyphicon-menu-up close-button__icon\\\"></span> </div> </div> </div> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./components/color-toolbar/template/color-toolbar.html\n// module id = 352\n// module chunks = 0","import scroll from 'ng-infinite-scroll';\nimport 'ng-error';\nimport './scss/image-finder.scss';\nimport template from './template/image-finder.html';\n\nangular.module('image-finder', ['jsonrpc', scroll, 'ngError'])\n.service('images', ['jsonrpc', 'login', function (jsonrpc, login) {\n    return new Images(new ImagesService(jsonrpc, login));\n}])\n.component('imageFinder', {\n    template,\n    controller: ['$scope', '$element', 'images', '$window', 'usSpinnerService',\n    function Controller($scope, $element, images, $window, usSpinnerService) {\n        const step = 10;\n        const finder = this;\n        this.selectedImage = {};\n        this.imagesToShow = [];\n        this.showImage = false;\n\n        this.$onInit = function () {\n            // restore view state\n            this.imagesToShow = images.getImagesInInterval(0, images.showIndex);\n        };\n\n        const api = {\n            search: (data, searchSettings) => {\n                if (data && data.colors && data.colors.length > 0) {\n                    usSpinnerService.spin('spinner-1');\n                    images.findImages(data, searchSettings, () => {\n                        usSpinnerService.stop('spinner-1');\n                        finder.imagesToShow = images.getImagesInInterval(0, step);\n                        images.showIndex = step;\n                    });\n                }\n            },\n            getImages: () => images.getImagesArray(),\n        };\n\n        $scope.$on(\"image-finder\", (event, callback) => {\n            if (typeof callback === \"function\") {\n                callback(api);\n            }\n        });\n\n        this.imageLoadingError = () => {\n            this.showImage = false;\n        };\n\n        this.thumbnailLoadingError = ($event) => {\n            angular.element($event.target.parentNode).addClass(\"hidden\");\n            this.showMore();\n        };\n\n        this.originalURL = () => {\n            $window.open(this.selectedImage.originalURL);\n        };\n\n        this.showMore = () => {\n            this.imagesToShow = this.imagesToShow\n            .concat(images.getImagesInInterval(images.showIndex, images.showIndex + step));\n            images.showIndex += step;\n        };\n\n        this.selectImage = ($event) => {\n            const target = $event.target;\n            if (target.hasAttribute('data-imagefinder-image') || angular.element(target).parent()[0].hasAttribute('data-imagefinder-image')) {\n                $event.stopPropagation();\n                const index = (target.hasAttribute('data-imagefinder-image')) ? parseInt(angular.element(target).attr('data-imagefinder-image')) : parseInt(angular.element(target).parent().attr('data-imagefinder-image'));\n                this.selectedImage = images.getImage(index);\n                if (this.selectedImage) {\n                    angular.element('body').addClass('stop-scrolling');\n                    this.showImage = true;\n                }\n            }\n        };\n\n        this.closeImagePopup = function ($event) {\n            const target = $event.target;\n            if (target.hasAttribute('data-imagefinder-close')) {\n                $event.stopPropagation();\n                angular.element('body').removeClass('stop-scrolling');\n                this.showImage = false;\n            }\n        };\n    }],\n});\n\nclass Image {\n\n    constructor(url, originalURL, score) {\n        this.url = url;\n        this.originalURL = originalURL;\n        this.score = score;\n    }\n}\n\nclass Images {\n\n    constructor(service) {\n        this.images = [];\n        this.service = service;\n        this.showIndex = 0;\n    }\n\n    addImage(url, originalURL, score) {\n        const img = new Image(url, originalURL, score);\n        this.images.push(img);\n    }\n\n    getImage(i) {\n        return this.images[i];\n    }\n\n    getImagesArray() {\n        return this.images;\n    }\n\n    getImagesInInterval(start, end) {\n        if (start >= 0 && start < this.images.length) {\n            if (end > this.images.length) {\n                end = this.images.length;\n            }\n            return this.images.slice(start, end);\n        }\n        return [];\n    }\n\n    findImages(data, searchSettings, callback) {\n        this.images.length = 0;\n        this.service.findImages(this, data, searchSettings, callback);\n    }\n}\n\nclass ImagesService {\n\n    constructor(jsonrpc, login) {\n        this.jsonrpc = jsonrpc;\n        this.login = login;\n    }\n\n    findImages(images, data, searchSettings, callback) {\n        const self = this;\n        this.jsonrpc.request('find', { colors: data.colors, words: data.words, settings: searchSettings, auth: self.login.auth })\n        .then((result) => {\n            if (result && result.imgs && result.imgs.length > 0) {\n                for (let i = 0; i < result.imgs.length; i++) {\n                    const iObj = result.imgs[i];\n                    images.addImage(iObj.url, iObj.originalURL, parseFloat(iObj.score).toFixed(2));\n                }\n            }\n            result = null;\n            if (callback) {\n                callback();\n            }\n        })\n        .catch((error) => {\n            console.error(error);\n            if (callback) {\n                callback();\n            }\n        });\n    }\n}\n\nexport default 'image-finder';\n\n\n\n// WEBPACK FOOTER //\n// ./components/image-finder/image-finder.js","module.exports = \" <div class=image-finder> <div class=image-finder__container> <div ng-click=$ctrl.selectImage($event) class=\\\"images image-finder__images\\\" infinite-scroll=$ctrl.showMore() infinite-scroll-distance=0> <div ng-repeat=\\\"img in $ctrl.imagesToShow track by $index\\\"> <div data-imagefinder-image={{$index}} class=images__image> <img ng-src={{img.url}} ng-error=$ctrl.thumbnailLoadingError($event)> </div> </div> </div> </div> <div ng-show=$ctrl.showImage class=\\\"image-popup image-finder__popup\\\"> <div class=image-popup__topline> <div class=image-popup__title> <a target=_blank href={{$ctrl.selectedImage.originalURL}}><span class=\\\"glyphicon glyphicon-link\\\"></span> Original</a> </div> </div> <div ng-click=$ctrl.closeImagePopup($event) class=image-popup__close-button data-imagefinder-close><span data-imagefinder-close class=\\\"glyphicon glyphicon-remove image-popup__close-icon\\\" aria-hidden=true></span></div> <div class=image-popup__image-container ng-click=$ctrl.closeImagePopup($event) data-imagefinder-close> <img class=image-popup__image ng-src={{$ctrl.selectedImage.url}} ng-error=$ctrl.imageLoadingError($event)> </div> </div> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./components/image-finder/template/image-finder.html\n// module id = 357\n// module chunks = 0","import './scss/settings-page.scss';\r\nimport template from './template/settings-page.html';\r\nimport SettingsCtrl from './SettingsCtrl';\r\n\r\nangular.module('settings-page', [])\r\n.component('settingsPage', {\r\n    template,\r\n    controller: [\"$scope\", \"appSettings\", SettingsCtrl],\r\n    bindings: {},\r\n});\r\n\r\nexport default 'settings-page';\r\n\n\n\n// WEBPACK FOOTER //\n// ./pages/settings/settings-page.js","module.exports = \"<div class=settings-page> <div class=\\\"panel panel-default settings-panel settings-page__content\\\"> <div class=\\\"panel-heading settings-panel__heading\\\"> <h3 class=panel-title><span class=\\\"glyphicon glyphicon-cog\\\"></span>&nbsp;Settings</h3> </div> <div class=\\\"panel-body settings-panel__body\\\"> <div class=\\\"checkbox analyze-text\\\"> <label> <input ng-model=$ctrl.settings.checkSemanticSimilarity type=checkbox>Analyze semantics (experimental) </label> </div> <div class=search-type> <div class=\\\"radio search-type__option\\\"> <label> <input type=radio name=optionsRadios ng-model=$ctrl.settings.searchMode value=regular checked=checked>Regular search (fast) </label> </div> <div class=\\\"radio search-type__option\\\"> <label> <input type=radio name=optionsRadios ng-model=$ctrl.settings.searchMode value=special>Special search (slow) </label> </div> </div> <div ng-class=\\\"{'soft-comparison_enabled': $ctrl.settings.searchMode === 'special'}\\\" class=\\\"checkbox soft-comparison soft-comparison_disabled\\\"> <label> <input ng-model=$ctrl.settings.distanceMode ng-true-value=\\\"'soft'\\\" ng-false-value=\\\"'strict'\\\" ng-disabled=\\\"$ctrl.settings.searchMode!=='special'\\\" class=soft-comparison__input type=checkbox>Soft comparison </label> </div> <select ng-model=$ctrl.settings.distance ng-disabled=\\\"$ctrl.settings.searchMode!=='special' \\\" disabled=disabled ng-class=\\\"{'similarity-slider_enabled': $ctrl.settings.searchMode==='special'}\\\" class=\\\"distances distances_disabled\\\"> <option ng-repeat=\\\"distance in $ctrl.settings.supportedDistances track by $index\\\" data-distances-distance={{$index}} value={{distance.id}}>{{distance.name}}</option> </select> <div ng-class=\\\"{'similarity-slider_enabled': $ctrl.settings.searchMode === 'special'}\\\" class=\\\"similarity-slider similarity-slider_disabled settings__similarity-level\\\"> <div class=similarity-slider__title>Similarity level: <span>{{$ctrl.similarityLevel}}%</span></div> <rzslider rz-slider-model=$ctrl.similarityLevel rz-slider-options=$ctrl.slider.options></rzslider> </div> </div> </div> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./pages/settings/template/settings-page.html\n// module id = 360\n// module chunks = 0","export default class SettingsCtrl {\n\n    constructor($scope, $appSettings) {\n        const controller = this;\n        this.settings = $appSettings;\n        let settingsOldState = Object.values(this.settings.serialize()).join();\n        this.slider = {\n            value: 50,\n            options: {\n                floor: 0,\n                ceil: 100,\n                step: 1,\n                onChange: () => {},\n                onEnd: () => {\n                    controller.settings.similarityLevel = controller.similarityLevel;\n                },\n                hidePointerLabels: true,\n                hideLimitLabels: true,\n                disabled: true,\n            },\n        };\n        this.similarityLevel = $appSettings.similarityLevel;\n\n        this.$doCheck = () => {\n            controller.slider.options.disabled = (controller.settings.searchMode === \"regular\");\n            const state = Object.values(controller.settings.serialize()).join();\n            if (state !== settingsOldState) {\n                settingsOldState = state;\n                controller.settings.save(() => {\n                    controller.similarityLevel = $appSettings.similarityLevel;\n                    $scope.$apply();\n                }, (e) => {\n                    console.log(\"SettingsCtrl: Error occured\");\n                    console.log(e);\n                });\n            }\n        };\n\n        this.$onInit = () => {\n            $appSettings.load(() => {\n                this.similarityLevel = $appSettings.similarityLevel;\n                $scope.$apply();\n            }, (e) => {\n                console.log(\"SettingsCtrl: Error occured\");\n                console.log(e);\n            });\n        };\n    }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./pages/settings/SettingsCtrl.js","import './scss/guide-page.scss';\r\nimport template from './template/guide-page.html';\r\n\r\nangular.module('guide-page', [])\r\n.component('guidePage', {\r\n    template,\r\n});\r\n\r\nexport default 'guide-page';\r\n\n\n\n// WEBPACK FOOTER //\n// ./pages/guide/guide-page.js","module.exports = \"<div class=guide-page> <div class=\\\"panel panel-default guide-panel guide-page__content\\\"> <div class=\\\"panel-heading guide-panel__heading\\\"> <h3 class=panel-title><span class=\\\"glyphicon glyphicon-info-sign\\\"></span>&nbsp;Guide</h3> </div> <div class=\\\"panel-body guide-panel__body\\\"> Huhu! </div> </div> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./pages/guide/template/guide-page.html\n// module id = 369\n// module chunks = 0","module.exports = \"<div ng-controller=RoutingCtrl> <span us-spinner=\\\"{position: 'fixed', color: '#428bca'}\\\" spinner-key=spinner-1></span> <div class=app__content> <div class=\\\"header app__header\\\"> <div ng-click=goToMain() class=\\\"logo header__logo\\\"><div class=logo__image></div></div> <div class=header__buttons> <a class=\\\"btn btn-default header__button_left\\\" ng-click=goToGuide()>How to use?</a> <a class=\\\"btn btn-default header__button_right\\\" ng-click=goToSettings()>Settings <span class=\\\"glyphicon glyphicon-cog\\\"></span></a> </div> </div> <div class=app__header-line></div> <ui-view name=pages> <main-page class=main-page ng-show=\\\"page === 'main'\\\"></main-page> <settings-page ng-show=\\\"page === 'settings'\\\"></settings-page> <guide-page ng-show=\\\"page === 'guide'\\\"></guide-page> </ui-view> </div> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./color-search/template/color-search.html\n// module id = 371\n// module chunks = 0","import md5 from 'md5';\r\n\r\nexport default class Login {\r\n\r\n    constructor($q, jsonrpc) {\r\n        this.required = null;\r\n        this.auth = null;\r\n        this.success = false;\r\n        this.user = null;\r\n        this.password = null;\r\n        this.jsonrpc = jsonrpc;\r\n        this.$q = $q;\r\n    }\r\n\r\n    isSet() {\r\n        return this.user && this.password;\r\n    }\r\n\r\n    isSuccessful() {\r\n        return this.auth !== null && this.success;\r\n    }\r\n\r\n    login() {\r\n        const self = this;\r\n        const auth = md5(`${this.user}${this.password}`);\r\n        return this.jsonrpc.request('login', { login: auth })\r\n        .then((data) => {\r\n            if (data.success) {\r\n                self.auth = auth;\r\n                this.success = true;\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n    }\r\n\r\n    isRequired() {\r\n        if (this.required) {\r\n            return this.$q.resolve(true);\r\n        }\r\n        return this.jsonrpc.request('login-required', {})\r\n        .then((data) => {\r\n            this.required = data.required;\r\n            return this.required;\r\n        });\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./models/Login.js","import './scss/dialog.scss';\r\nimport confirmTemplate from './templates/confirm.html';\r\nimport loginTemplate from './templates/login.html';\r\nimport errorTemplate from './templates/error.html';\r\n\r\nangular.module('dialog', [])\r\n.service('popupDialog', ['$rootScope', '$compile',\r\nfunction ($rootScope, $compile) {\r\n    let scope = null;\r\n    let element = null;\r\n    const self = this;\r\n\r\n    function create(template, Control, closeByOutside) {\r\n        const html = `<div class=\"dialog\" ng-click=\"close($event)\">\r\n        <div class=\"dialog__window\">${template}</div></div>`;\r\n        scope = $rootScope.$new(true);\r\n        scope.$ctrl = new Control();\r\n        scope.closeByOutside = closeByOutside;\r\n        scope.close = ($event) => {\r\n            const target = angular.element($event.target);\r\n            if (target.hasClass(\"dialog\") && scope.closeByOutside) {\r\n                self.close();\r\n            }\r\n        };\r\n        const compiled = $compile(html)(scope);\r\n        element = angular.element(compiled).appendTo(\"body\");\r\n    }\r\n\r\n    this.close = () => {\r\n        if (element && scope) {\r\n            element.remove();\r\n            scope.$destroy();\r\n            element = null;\r\n            scope = null;\r\n        }\r\n    };\r\n\r\n    this.errorDialog = (Control) => {\r\n        this.close();\r\n        create(errorTemplate, Control, false);\r\n    };\r\n\r\n    this.confirmDialog = (Control) => {\r\n        this.close();\r\n        create(confirmTemplate, Control, true);\r\n    };\r\n\r\n    this.loginDialog = (Control) => {\r\n        this.close();\r\n        create(loginTemplate, Control, false);\r\n    };\r\n}]);\r\n\r\nexport default \"dialog\";\r\n\n\n\n// WEBPACK FOOTER //\n// ./services/dialog/dialog.js","module.exports = \"<div class=confirm-dialog> <h4><span class=\\\"glyphicon glyphicon-question-sign\\\"></span> Confirm <span class=confirm-dialog__title>{{$ctrl.title}}</span></h4> <p>Are you sure you want to proceed?</p> <div style=float:right> <a class=\\\"btn btn-danger\\\" ng-click=$ctrl.cancel()>Cancel</a> <a class=\\\"btn btn-success\\\" ng-click=$ctrl.yes()>Yes</a> </div><div style=clear:both></div> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./services/dialog/templates/confirm.html\n// module id = 378\n// module chunks = 0","module.exports = \"<div class=login-dialog> <div class=form-group><input ng-model=$ctrl.model.user type=text class=form-control placeholder=User></div> <div class=form-group><input ng-model=$ctrl.model.password type=password class=form-control placeholder=Password></div> <a ng-click=$ctrl.login() class=\\\"btn btn-success btn-block\\\"><span class=\\\"glyphicon glyphicon-cloud-upload\\\" aria-hidden=true></span> log in</a> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./services/dialog/templates/login.html\n// module id = 379\n// module chunks = 0","module.exports = \"<div class=error-dialog> <h4><span class=\\\"glyphicon glyphicon-warning-sign\\\"></span> {{$ctrl.title}}</h4> <p>{{$ctrl.description}}</p> <a ng-show=$ctrl.button ng-click=$ctrl.handle() class=\\\"btn btn-danger btn-block\\\"><span ng-show=$ctrl.icon ng-class=\\\"'glyphicon glyphicon-{{$ctrl.icon}}'\\\"></span> {{$ctrl.buttonTitle}}</a> </div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./services/dialog/templates/error.html\n// module id = 380\n// module chunks = 0","import localforage from \"localforage\";\r\n\r\nangular.module('db', [])\r\n.service('db', ['popupDialog', function (dialog) {\r\n    localforage.config({\r\n        driver: [localforage.INDEXEDDB,\r\n                localforage.WEBSQL,\r\n                localforage.LOCALSTORAGE],\r\n        name: 'ColorSearch',\r\n        version: 1.0,\r\n    });\r\n    this.getStore = store => localforage.createInstance({ name: 'ColorSearch', storeName: store });\r\n}]);\r\n\r\nexport default \"db\";\r\n\n\n\n// WEBPACK FOOTER //\n// ./services/db/db.js","class EventFilter {\r\n\r\n    constructor(timeWindow, callback, $window) {\r\n        this._timeWindow = timeWindow;\r\n        this._callback = callback;\r\n        this._$window = $window;\r\n        this._lastEventTime = 0;\r\n        this._timeoutId = null;\r\n    }\r\n\r\n    event() {\r\n        const now = Date.now();\r\n        if ((now - this._lastEventTime) >= this._timeWindow) {\r\n            if (this._timeoutId) {\r\n                this._$window.clearTimeout(this._timeoutId);\r\n            }\r\n            this._lastEventTime = now;\r\n            this._callback();\r\n        } else {\r\n            if (this._timeoutId) {\r\n                this._$window.clearTimeout(this._timeoutId);\r\n            }\r\n            this._timeoutId = this._$window.setTimeout(() => {\r\n                this._lastEventTime = now;\r\n                this._callback();\r\n            }, this._timeWindow);\r\n        }\r\n    }\r\n}\r\n\r\nangular.module(\"event-filter\", [])\r\n.factory(\"eventFilter\", [\"$window\", function ($window) {\r\n    return (timeWindow, callback) => new EventFilter(timeWindow, callback, $window);\r\n}]);\r\n\r\nexport default \"event-filter\";\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./utils/EventFilter.js","class Color {\n\n    constructor(o) {\n        this.weight = 1;\n        this.h = undefined;\n        this.s = undefined;\n        this.l = undefined;\n        this.achromatic = false;\n\n        if (o && o[\"h\"] !== undefined && o[\"s\"] !== undefined && o[\"l\"] !== undefined) {\n            this.h = parseInt(o[\"h\"], 10);\n            this.s = parseInt(o[\"s\"], 10);\n            this.l = parseInt(o[\"l\"], 10);\n        }\n\n        if (o && o[\"weight\"]) {\n            this.weight = parseInt(o[\"weight\"], 10);\n        }\n\n        if (o && typeof o[\"achromatic\"] === \"boolean\") {\n            this.achromatic = o[\"achromatic\"];\n        }\n    }\n\n    toString() {\n        if (this.isSet) {\n            return `hsl(${this.h},${this.s}%,${this.l}%)`;\n        }\n        return undefined;\n    }\n\n    toIdString() {\n        return `hsl(${this.h},${this.s}%,${this.l}%)${this.weight}`;\n    }\n\n    isSet() {\n        return (this.h !== undefined && this.s !== undefined && this.l !== undefined);\n    }\n\n    setH(h) {\n       this.h = this.achromatic ? 0 : parseInt(h, 10);\n       return this;\n    }\n\n    setS(s) {\n       this.s = this.achromatic ? 0 : parseInt(s, 10);\n       return this;\n    }\n\n    setL(l) {\n       this.l = parseInt(l, 10);\n       return this;\n    }\n\n    setWeight(w) {\n        this.weight = parseInt(w, 10);\n        return this;\n    }\n\n    setAchromatic() {\n        this.h = 0;\n        this.s = 0;\n        this.achromatic = true;\n        return this;\n    }\n\n    isAchromatic() {\n        return this.achromatic;\n    }\n\n    setColor(o) {\n        if (o[\"h\"] !== undefined && o[\"s\"] !== undefined && o[\"l\"] !== undefined) {\n            this.h = parseInt(o[\"h\"], 10);\n            this.s = parseInt(o[\"s\"], 10);\n            this.l = parseInt(o[\"l\"], 10);\n        }\n\n        if (o[\"weight\"]) {\n            this.weight = parseInt(o[\"weight\"], 10);\n        }\n\n        if (o && typeof o[\"achromatic\"] === \"boolean\") {\n            this.achromatic = o[\"achromatic\"];\n        }\n\n        return this;\n    }\n\n    setColorFromString(str) {\n        const r = /^hsl\\(\\d+(\\.\\d+)?,\\d+(\\.\\d+)?%?,\\d+(\\.\\d+)?%?\\)$/i;\n        if (str && r.test(str)) {\n            const re = /\\d+(\\.\\d+)?/g;\n            this.h = parseInt(re.exec(str)[0], 10);\n            this.s = parseInt(re.exec(str)[0], 10);\n            this.l = parseInt(re.exec(str)[0], 10);\n        }\n        return this;\n    }\n\n    reset() {\n      this.h = undefined;\n      this.s = undefined;\n      this.l = undefined;\n      this.weight = 1;\n      this.achromatic = false;\n      return this;\n    }\n\n    toJSON() {\n        const o = {};\n        o.achromatic = this.achromatic;\n        o.l = this.l;\n        o.s = this.s;\n        o.h = this.h;\n        o.weight = this.weight;\n        return o;\n    }\n}\n\nexport default Color;\n\n\n\n// WEBPACK FOOTER //\n// ./models/Color.js"],"sourceRoot":""}
"use strict";var __awaiter=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,s){function c(e){try{p(r.next(e))}catch(e){s(e)}}function i(e){try{p(r.throw(e))}catch(e){s(e)}}function p(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(c,i)}p((r=r.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const mongodb_1=require("mongodb");class OpenShift{constructor(){this.serverUrl="http://www.colorsearch.a3c1.starter-us-west-1.openshiftapps.com",this.port=process.env.PORT||process.env.OPENSHIFT_NODEJS_PORT||8080,this.ip=process.env.IP||process.env.OPENSHIFT_NODEJS_IP||"0.0.0.0"}getServerUrl(){return this.serverUrl}getIp(){return this.ip}getPort(){return this.port}dbConnection(){return __awaiter(this,void 0,void 0,function*(){if(null==this.db){let e=null,t="";if(null==(e=process.env.OPENSHIFT_MONGODB_DB_URL||process.env.MONGO_URL)&&process.env.DATABASE_SERVICE_NAME){const n=process.env.DATABASE_SERVICE_NAME.toUpperCase(),r=process.env[n+"_SERVICE_HOST"],o=process.env[n+"_SERVICE_PORT"],s=process.env[n+"_DATABASE"],c=process.env[n+"_PASSWORD"],i=process.env[n+"_USER"];r&&o&&s&&(t=e="mongodb://",i&&c&&(e+=i+":"+c+"@"),t+=r+":"+o+"/"+s,e+=r+":"+o+"/"+s)}try{this.db=yield mongodb_1.MongoClient.connect(e)}catch(e){return console.error("Connection to MongoDB failed."),Promise.reject(new Error("OpenShift MongoDB connection failed."))}}return this.db})}}exports.default=OpenShift;
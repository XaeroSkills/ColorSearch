"use strict";function start(){iSaver.saveNext().then(()=>setTimeout(()=>{start()},timeGap)).catch(e=>{console.error("Process: FATAL ERROR"),console.error(e)})}Object.defineProperty(exports,"__esModule",{value:!0});const Debug=require("debug"),debug=Debug("ImageLoader: Process"),EventHub_1=require("../EventHub"),Settings_1=require("../Settings"),DirectorySource_1=require("./image-sources/DirectorySource"),FlickrSource_1=require("./image-sources/flickr/FlickrSource"),ImageSaver_1=require("./ImageSaver"),config=Settings_1.default.imageLoader(),timeGap=config.timeGap,sleepIfTaggingFailed=config.sleepIfTaggingFailed,sleepIfTranslationFailed=config.sleepIfTranslationFailed,ds=new DirectorySource_1.default,fs=new FlickrSource_1.default,iSaver=new ImageSaver_1.default([ds,fs]);EventHub_1.default.on("tagging-failed",e=>{sleepIfTaggingFailed&&process.send&&process.send({message:"sleep"})}),EventHub_1.default.on("translation-failed",e=>{sleepIfTranslationFailed&&process.send&&process.send({message:"sleep"})}),EventHub_1.default.on("images-saved",e=>{process.send({message:"images-saved",images:e})}),start();
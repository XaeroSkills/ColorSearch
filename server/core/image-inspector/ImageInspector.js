"use strict";var __awaiter=this&&this.__awaiter||function(e,t,s,r){return new(s||(s=Promise))(function(i,a){function n(e){try{o(r.next(e))}catch(e){a(e)}}function c(e){try{o(r.throw(e))}catch(e){a(e)}}function o(e){e.done?i(e.value):new s(function(t){t(e.value)}).then(n,c)}o((r=r.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});const Cluster_1=require("../cluster/Cluster"),FlickrImageInspectingStrategy_1=require("./strategies/FlickrImageInspectingStrategy"),LocalImageInspectingStrategy_1=require("./strategies/LocalImageInspectingStrategy");class ImageInspector{constructor(e){this.index=e,this.strategies=new Map;const t=new FlickrImageInspectingStrategy_1.default,s=new LocalImageInspectingStrategy_1.default;this.strategies.set(t.sourceName(),t),this.strategies.set(s.sourceName(),s)}imageIsOk(e){return __awaiter(this,void 0,void 0,function*(){let t=!0;if(this.strategies.has(e.source)){!1===(t=yield this.strategies.get(e.source).imageIsOk(e))&&(Cluster_1.default.deleteDescriptor(e.id),this.index.remove(e.id))}return t})}}exports.default=ImageInspector;
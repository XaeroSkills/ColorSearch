"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const express=require("express"),bodyParser=require("body-parser"),ImageLoader_1=require("./core/image-loader/ImageLoader"),Settings_1=require("./core/Settings"),IndexLSH_1=require("./index/IndexLSH"),AppRouter_1=require("./routing/AppRouter"),imgsPath=Settings_1.default.global()["imgs-path"],app=express(),loader=new ImageLoader_1.default,index=new IndexLSH_1.default;index.buildIndex().then(()=>loader.start(index)),app.use(express.static(imgsPath)),app.use(express.static("client/")),app.use((e,r,s)=>{e.headers.origin&&r.setHeader("Access-Control-Allow-Origin",e.headers.origin),e.headers["access-control-request-method"]&&r.setHeader("Access-Control-Allow-Methods",e.headers["access-control-request-method"]),e.headers["access-control-request-headers"]&&r.setHeader("Access-Control-Allow-Headers",e.headers["access-control-request-headers"]),r.setHeader("Access-Control-Allow-Credentials","true"),s()}),app.use(bodyParser.json());const router=new AppRouter_1.default(app,index);app.listen(8080,()=>console.warn("Server started..."));